<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>CompOptCert.PromiseConsistent</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library CompOptCert.PromiseConsistent</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.omega.Omega.html#"><span class="id" title="library">Omega</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Classes.RelationClasses.html#"><span class="id" title="library">RelationClasses</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.sflib.html#"><span class="id" title="library">sflib</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Paco</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">paco</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Axioms.html#"><span class="id" title="library">Axioms</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Basic.html#"><span class="id" title="library">Basic</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.DataStructure.html#"><span class="id" title="library">DataStructure</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.DenseOrder.html#"><span class="id" title="library">DenseOrder</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Loc.html#"><span class="id" title="library">Loc</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Event.html#"><span class="id" title="library">Event</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Time.html#"><span class="id" title="library">Time</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Language.html#"><span class="id" title="library">Language</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.View.html#"><span class="id" title="library">View</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Cell.html#"><span class="id" title="library">Cell</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Memory.html#"><span class="id" title="library">Memory</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.TView.html#"><span class="id" title="library">TView</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Local.html#"><span class="id" title="library">Local</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Thread.html#"><span class="id" title="library">Thread</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.WFConfig.html#"><span class="id" title="library">WFConfig</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="promise_step_promise_consistent" class="idref" href="#promise_step_promise_consistent"><span class="id" title="lemma">promise_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc1:1" class="idref" href="#lc1:1"><span class="id" title="binder">lc1</span></a> <a id="mem1:2" class="idref" href="#mem1:2"><span class="id" title="binder">mem1</span></a> <a id="loc:3" class="idref" href="#loc:3"><span class="id" title="binder">loc</span></a> <a id="from:4" class="idref" href="#from:4"><span class="id" title="binder">from</span></a> <a id="to:5" class="idref" href="#to:5"><span class="id" title="binder">to</span></a> <a id="msg:6" class="idref" href="#msg:6"><span class="id" title="binder">msg</span></a> <a id="lc2:7" class="idref" href="#lc2:7"><span class="id" title="binder">lc2</span></a> <a id="mem2:8" class="idref" href="#mem2:8"><span class="id" title="binder">mem2</span></a> <a id="kind:9" class="idref" href="#kind:9"><span class="id" title="binder">kind</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:10" class="idref" href="#STEP:10"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_step"><span class="id" title="inductive">Local.promise_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:1"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem1:2"><span class="id" title="variable">mem1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:3"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#from:4"><span class="id" title="variable">from</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:5"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#msg:6"><span class="id" title="variable">msg</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:7"><span class="id" title="variable">lc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem2:8"><span class="id" title="variable">mem2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#kind:9"><span class="id" title="variable">kind</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:11" class="idref" href="#CONS:11"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:7"><span class="id" title="variable">lc2</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:1"><span class="id" title="variable">lc1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">ii</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CompOptCert.Memory.html#Memory.op_kind_is_cancel"><span class="id" title="definition">Memory.op_kind_is_cancel</span></a> <span class="id" title="var">kind</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">KIND</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">kind</span>; <span class="id" title="var">ss</span>. <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <span class="id" title="var">loc0</span> <span class="id" title="var">ts</span> <span class="id" title="var">promises2</span>) <span class="id" title="keyword">as</span> [[]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">GET2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">dup</span> <span class="id" title="var">GET2</span>. <span class="id" title="var">revert</span> <span class="id" title="var">GET0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_o"><span class="id" title="lemma">Memory.remove_o</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">PROMISE0</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">inv</span> <span class="id" title="var">GET0</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">revert</span> <span class="id" title="var">GET2</span>. <span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_o"><span class="id" title="lemma">Memory.remove_o</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>; <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">des</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_get0"><span class="id" title="lemma">Memory.remove_get0</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>. <span class="id" title="var">congr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">congr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.promise_get1_promise"><span class="id" title="lemma">Memory.promise_get1_promise</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">MSG_LE</span>. <span class="id" title="var">exploit</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="read_step_promise_consistent" class="idref" href="#read_step_promise_consistent"><span class="id" title="lemma">read_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc1:12" class="idref" href="#lc1:12"><span class="id" title="binder">lc1</span></a> <a id="mem1:13" class="idref" href="#mem1:13"><span class="id" title="binder">mem1</span></a> <a id="loc:14" class="idref" href="#loc:14"><span class="id" title="binder">loc</span></a> <a id="to:15" class="idref" href="#to:15"><span class="id" title="binder">to</span></a> <a id="val:16" class="idref" href="#val:16"><span class="id" title="binder">val</span></a> <a id="released:17" class="idref" href="#released:17"><span class="id" title="binder">released</span></a> <a id="ord:18" class="idref" href="#ord:18"><span class="id" title="binder">ord</span></a> <a id="lc2:19" class="idref" href="#lc2:19"><span class="id" title="binder">lc2</span></a> <a id="lo:20" class="idref" href="#lo:20"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:21" class="idref" href="#STEP:21"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.read_step"><span class="id" title="inductive">Local.read_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:12"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem1:13"><span class="id" title="variable">mem1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:14"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:15"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#val:16"><span class="id" title="variable">val</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#released:17"><span class="id" title="variable">released</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:18"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:19"><span class="id" title="variable">lc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:20"><span class="id" title="variable">lo</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:22" class="idref" href="#CONS:22"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:19"><span class="id" title="variable">lc2</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:12"><span class="id" title="variable">lc1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">ii</span>. <span class="id" title="var">exploit</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Time.html#TimeFacts.le_lt_lt"><span class="id" title="lemma">TimeFacts.le_lt_lt</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">etrans</span>; [|<span class="id" title="tactic">apply</span> <a class="idref" href="CompOptCert.Time.html#Time.join_l"><span class="id" title="lemma">Time.join_l</span></a>]. <span class="id" title="var">etrans</span>; [|<span class="id" title="tactic">apply</span> <a class="idref" href="CompOptCert.Time.html#Time.join_l"><span class="id" title="lemma">Time.join_l</span></a>]. <span class="id" title="var">refl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fulfill_unset_promises" class="idref" href="#fulfill_unset_promises"><span class="id" title="lemma">fulfill_unset_promises</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="loc:23" class="idref" href="#loc:23"><span class="id" title="binder">loc</span></a> <a id="from:24" class="idref" href="#from:24"><span class="id" title="binder">from</span></a> <a id="ts:25" class="idref" href="#ts:25"><span class="id" title="binder">ts</span></a> <a id="msg:26" class="idref" href="#msg:26"><span class="id" title="binder">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="promises1:27" class="idref" href="#promises1:27"><span class="id" title="binder">promises1</span></a> <a id="promises2:28" class="idref" href="#promises2:28"><span class="id" title="binder">promises2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="l:29" class="idref" href="#l:29"><span class="id" title="binder">l</span></a> <a id="t:30" class="idref" href="#t:30"><span class="id" title="binder">t</span></a> <a id="f:31" class="idref" href="#f:31"><span class="id" title="binder">f</span></a> <a id="m:32" class="idref" href="#m:32"><span class="id" title="binder">m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="FULFILL:33" class="idref" href="#FULFILL:33"><span class="id" title="binder">FULFILL</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.remove"><span class="id" title="inductive">Memory.remove</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#promises1:27"><span class="id" title="variable">promises1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:23"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#from:24"><span class="id" title="variable">from</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ts:25"><span class="id" title="variable">ts</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#msg:26"><span class="id" title="variable">msg</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#promises2:28"><span class="id" title="variable">promises2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="TH1:34" class="idref" href="#TH1:34"><span class="id" title="binder">TH1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#l:29"><span class="id" title="variable">l</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:30"><span class="id" title="variable">t</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#promises1:27"><span class="id" title="variable">promises1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CompOptCert.PromiseConsistent.html#f:31"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#m:32"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="TH2:35" class="idref" href="#TH2:35"><span class="id" title="binder">TH2</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#l:29"><span class="id" title="variable">l</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:30"><span class="id" title="variable">t</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#promises2:28"><span class="id" title="variable">promises2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.PromiseConsistent.html#l:29"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:23"><span class="id" title="variable">loc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:30"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ts:25"><span class="id" title="variable">ts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#f:31"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#from:24"><span class="id" title="variable">from</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="CompOptCert.Cell.html#Message.le"><span class="id" title="inductive">Message.le</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#msg:26"><span class="id" title="variable">msg</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#m:32"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">TH2</span>. <span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_o"><span class="id" title="lemma">Memory.remove_o</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>; [|<span class="id" title="var">congr</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">des</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_get0"><span class="id" title="lemma">Memory.remove_get0</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">GET</span> <span class="id" title="tactic">in</span> <span class="id" title="var">TH1</span>. <span class="id" title="var">inv</span> <span class="id" title="var">TH1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">esplits</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">refl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="write_step_promise_consistent" class="idref" href="#write_step_promise_consistent"><span class="id" title="lemma">write_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc1:36" class="idref" href="#lc1:36"><span class="id" title="binder">lc1</span></a> <a id="sc1:37" class="idref" href="#sc1:37"><span class="id" title="binder">sc1</span></a> <a id="mem1:38" class="idref" href="#mem1:38"><span class="id" title="binder">mem1</span></a> <a id="loc:39" class="idref" href="#loc:39"><span class="id" title="binder">loc</span></a> <a id="from:40" class="idref" href="#from:40"><span class="id" title="binder">from</span></a> <a id="to:41" class="idref" href="#to:41"><span class="id" title="binder">to</span></a> <a id="val:42" class="idref" href="#val:42"><span class="id" title="binder">val</span></a> <a id="releasedm:43" class="idref" href="#releasedm:43"><span class="id" title="binder">releasedm</span></a> <a id="released:44" class="idref" href="#released:44"><span class="id" title="binder">released</span></a> <a id="ord:45" class="idref" href="#ord:45"><span class="id" title="binder">ord</span></a> <a id="lc2:46" class="idref" href="#lc2:46"><span class="id" title="binder">lc2</span></a> <a id="sc2:47" class="idref" href="#sc2:47"><span class="id" title="binder">sc2</span></a> <a id="mem2:48" class="idref" href="#mem2:48"><span class="id" title="binder">mem2</span></a> <a id="kind:49" class="idref" href="#kind:49"><span class="id" title="binder">kind</span></a> <a id="lo:50" class="idref" href="#lo:50"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:51" class="idref" href="#STEP:51"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.write_step"><span class="id" title="inductive">Local.write_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:36"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#sc1:37"><span class="id" title="variable">sc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem1:38"><span class="id" title="variable">mem1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:39"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#from:40"><span class="id" title="variable">from</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:41"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#val:42"><span class="id" title="variable">val</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#releasedm:43"><span class="id" title="variable">releasedm</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#released:44"><span class="id" title="variable">released</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:45"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:46"><span class="id" title="variable">lc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#sc2:47"><span class="id" title="variable">sc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem2:48"><span class="id" title="variable">mem2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#kind:49"><span class="id" title="variable">kind</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:50"><span class="id" title="variable">lo</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:52" class="idref" href="#CONS:52"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:46"><span class="id" title="variable">lc2</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:36"><span class="id" title="variable">lc1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">WRITE</span>. <span class="id" title="var">ii</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.promise_get1_promise"><span class="id" title="lemma">Memory.promise_get1_promise</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="var">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">i</span>. <span class="id" title="var">des</span>. <span class="id" title="var">inv</span> <span class="id" title="var">MSG_LE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <span class="id" title="var">loc0</span> <span class="id" title="var">ts</span> <span class="id" title="var">promises2</span>) <span class="id" title="keyword">as</span> [[]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">dup</span> <span class="id" title="var">X</span>. <span class="id" title="var">revert</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_o"><span class="id" title="lemma">Memory.remove_o</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>; <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">GET</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">inv</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CONS</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Time.html#TimeFacts.le_lt_lt"><span class="id" title="lemma">TimeFacts.le_lt_lt</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span>. <span class="id" title="var">etrans</span>; [|<span class="id" title="tactic">apply</span> <a class="idref" href="CompOptCert.Time.html#Time.join_l"><span class="id" title="lemma">Time.join_l</span></a>]. <span class="id" title="var">refl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#fulfill_unset_promises"><span class="id" title="lemma">fulfill_unset_promises</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">WRITABLE</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fence_step_promise_consistent" class="idref" href="#fence_step_promise_consistent"><span class="id" title="lemma">fence_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc1:53" class="idref" href="#lc1:53"><span class="id" title="binder">lc1</span></a> <a id="sc1:54" class="idref" href="#sc1:54"><span class="id" title="binder">sc1</span></a> <a id="mem1:55" class="idref" href="#mem1:55"><span class="id" title="binder">mem1</span></a> <a id="ordr:56" class="idref" href="#ordr:56"><span class="id" title="binder">ordr</span></a> <a id="ordw:57" class="idref" href="#ordw:57"><span class="id" title="binder">ordw</span></a> <a id="lc2:58" class="idref" href="#lc2:58"><span class="id" title="binder">lc2</span></a> <a id="sc2:59" class="idref" href="#sc2:59"><span class="id" title="binder">sc2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:60" class="idref" href="#STEP:60"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.fence_step"><span class="id" title="inductive">Local.fence_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:53"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#sc1:54"><span class="id" title="variable">sc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ordr:56"><span class="id" title="variable">ordr</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ordw:57"><span class="id" title="variable">ordw</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:58"><span class="id" title="variable">lc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#sc2:59"><span class="id" title="variable">sc2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WF:61" class="idref" href="#WF:61"><span class="id" title="binder">WF</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:53"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem1:55"><span class="id" title="variable">mem1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:62" class="idref" href="#CONS:62"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:58"><span class="id" title="variable">lc2</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:53"><span class="id" title="variable">lc1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">ii</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Time.html#TimeFacts.le_lt_lt"><span class="id" title="lemma">TimeFacts.le_lt_lt</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="CompOptCert.TView.html#TView.le"><span class="id" title="definition">TView.le</span></a> (<a class="idref" href="CompOptCert.Local.html#Local.tview"><span class="id" title="projection">Local.tview</span></a> <span class="id" title="var">lc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CompOptCert.TView.html#TView.write_fence_tview"><span class="id" title="definition">TView.write_fence_tview</span></a> (<a class="idref" href="CompOptCert.TView.html#TView.read_fence_tview"><span class="id" title="definition">TView.read_fence_tview</span></a> (<a class="idref" href="CompOptCert.Local.html#Local.tview"><span class="id" title="projection">Local.tview</span></a> <span class="id" title="var">lc1</span>) <span class="id" title="var">ordr</span>) <span class="id" title="var">sc1</span> <span class="id" title="var">ordw</span>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">i</span>. <span class="id" title="var">inv</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">CUR</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">etrans</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.TView.html#TViewFacts.write_fence_tview_incr"><span class="id" title="lemma">TViewFacts.write_fence_tview_incr</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">WF</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.TView.html#TViewFacts.write_fence_tview_mon"><span class="id" title="lemma">TViewFacts.write_fence_tview_mon</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">refl</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">WF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.TView.html#TViewFacts.read_fence_tview_incr"><span class="id" title="lemma">TViewFacts.read_fence_tview_incr</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">WF</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="ordering_relaxed_dec" class="idref" href="#ordering_relaxed_dec"><span class="id" title="lemma">ordering_relaxed_dec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="ord:63" class="idref" href="#ord:63"><span class="id" title="binder">ord</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Event.html#Ordering.le"><span class="id" title="definition">Ordering.le</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:63"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.Event.html#Ordering.relaxed"><span class="id" title="constructor">Ordering.relaxed</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a> <a class="idref" href="CompOptCert.Event.html#Ordering.le"><span class="id" title="definition">Ordering.le</span></a> <a class="idref" href="CompOptCert.Event.html#Ordering.strong_relaxed"><span class="id" title="constructor">Ordering.strong_relaxed</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:63"><span class="id" title="variable">ord</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ord</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="step_promise_consistent" class="idref" href="#step_promise_consistent"><span class="id" title="lemma">step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:64" class="idref" href="#lang:64"><span class="id" title="binder">lang</span></a> <a id="pf:65" class="idref" href="#pf:65"><span class="id" title="binder">pf</span></a> <a id="lo:66" class="idref" href="#lo:66"><span class="id" title="binder">lo</span></a> <a id="e:67" class="idref" href="#e:67"><span class="id" title="binder">e</span></a> <a id="th1:68" class="idref" href="#th1:68"><span class="id" title="binder">th1</span></a> <a id="th2:69" class="idref" href="#th2:69"><span class="id" title="binder">th2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:70" class="idref" href="#STEP:70"><span class="id" title="binder">STEP</span></a>: @<a class="idref" href="CompOptCert.Thread.html#Thread.step"><span class="id" title="inductive">Thread.step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:66"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:64"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#pf:65"><span class="id" title="variable">pf</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:67"><span class="id" title="variable">e</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:68"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:69"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:71" class="idref" href="#CONS:71"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:69"><span class="id" title="variable">th2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WF1:72" class="idref" href="#WF1:72"><span class="id" title="binder">WF1</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:68"><span class="id" title="variable">th1</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:68"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="MEM1:73" class="idref" href="#MEM1:73"><span class="id" title="binder">MEM1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed"><span class="id" title="inductive">Memory.closed</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:68"><span class="id" title="variable">th1</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:68"><span class="id" title="variable">th1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>; [<span class="id" title="var">inv</span> <span class="id" title="var">STEP0</span>|<span class="id" title="var">inv</span> <span class="id" title="var">STEP0</span>; <span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>]; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#promise_step_promise_consistent"><span class="id" title="lemma">promise_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#read_step_promise_consistent"><span class="id" title="lemma">read_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#write_step_promise_consistent"><span class="id" title="lemma">write_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#read_step_promise_consistent"><span class="id" title="lemma">read_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#write_step_promise_consistent"><span class="id" title="lemma">write_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#fence_step_promise_consistent"><span class="id" title="lemma">fence_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#fence_step_promise_consistent"><span class="id" title="lemma">fence_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="opt_step_promise_consistent" class="idref" href="#opt_step_promise_consistent"><span class="id" title="lemma">opt_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:74" class="idref" href="#lang:74"><span class="id" title="binder">lang</span></a> <a id="e:75" class="idref" href="#e:75"><span class="id" title="binder">e</span></a> <a id="th1:76" class="idref" href="#th1:76"><span class="id" title="binder">th1</span></a> <a id="th2:77" class="idref" href="#th2:77"><span class="id" title="binder">th2</span></a> <a id="lo:78" class="idref" href="#lo:78"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:79" class="idref" href="#STEP:79"><span class="id" title="binder">STEP</span></a>: @<a class="idref" href="CompOptCert.Thread.html#Thread.opt_step"><span class="id" title="inductive">Thread.opt_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:74"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:78"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:75"><span class="id" title="variable">e</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:76"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:77"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:80" class="idref" href="#CONS:80"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:77"><span class="id" title="variable">th2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WF1:81" class="idref" href="#WF1:81"><span class="id" title="binder">WF1</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:76"><span class="id" title="variable">th1</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:76"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="MEM1:82" class="idref" href="#MEM1:82"><span class="id" title="binder">MEM1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed"><span class="id" title="inductive">Memory.closed</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:76"><span class="id" title="variable">th1</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:76"><span class="id" title="variable">th1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#step_promise_consistent"><span class="id" title="lemma">step_promise_consistent</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rtc_all_step_promise_consistent" class="idref" href="#rtc_all_step_promise_consistent"><span class="id" title="lemma">rtc_all_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:83" class="idref" href="#lang:83"><span class="id" title="binder">lang</span></a> <a id="th1:84" class="idref" href="#th1:84"><span class="id" title="binder">th1</span></a> <a id="th2:85" class="idref" href="#th2:85"><span class="id" title="binder">th2</span></a> <a id="lo:86" class="idref" href="#lo:86"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:87" class="idref" href="#STEP:87"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtc"><span class="id" title="abbreviation">rtc</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.all_step"><span class="id" title="definition">Thread.all_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:83"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:86"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:85"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:88" class="idref" href="#CONS:88"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:85"><span class="id" title="variable">th2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WF1:89" class="idref" href="#WF1:89"><span class="id" title="binder">WF1</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="SC1:90" class="idref" href="#SC1:90"><span class="id" title="binder">SC1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed_timemap"><span class="id" title="definition">Memory.closed_timemap</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.sc"><span class="id" title="projection">Thread.sc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="MEM1:91" class="idref" href="#MEM1:91"><span class="id" title="binder">MEM1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed"><span class="id" title="inductive">Memory.closed</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:84"><span class="id" title="variable">th1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert_until</span> <span class="id" title="var">STEP</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">STEP</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">H</span>. <span class="id" title="var">inv</span> <span class="id" title="var">USTEP</span>. <span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Thread.html#Thread.step_future"><span class="id" title="lemma">Thread.step_future</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#step_promise_consistent"><span class="id" title="lemma">step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rtc_tau_step_promise_consistent" class="idref" href="#rtc_tau_step_promise_consistent"><span class="id" title="lemma">rtc_tau_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:92" class="idref" href="#lang:92"><span class="id" title="binder">lang</span></a> <a id="th1:93" class="idref" href="#th1:93"><span class="id" title="binder">th1</span></a> <a id="th2:94" class="idref" href="#th2:94"><span class="id" title="binder">th2</span></a> <a id="lo:95" class="idref" href="#lo:95"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:96" class="idref" href="#STEP:96"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtc"><span class="id" title="abbreviation">rtc</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.tau_step"><span class="id" title="definition">Thread.tau_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:92"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:95"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:94"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:97" class="idref" href="#CONS:97"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:94"><span class="id" title="variable">th2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WF1:98" class="idref" href="#WF1:98"><span class="id" title="binder">WF1</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="SC1:99" class="idref" href="#SC1:99"><span class="id" title="binder">SC1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed_timemap"><span class="id" title="definition">Memory.closed_timemap</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.sc"><span class="id" title="projection">Thread.sc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="MEM1:100" class="idref" href="#MEM1:100"><span class="id" title="binder">MEM1</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed"><span class="id" title="inductive">Memory.closed</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:93"><span class="id" title="variable">th1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#rtc_all_step_promise_consistent"><span class="id" title="lemma">rtc_all_step_promise_consistent</span></a>; <span class="id" title="var">cycle</span> 1; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Basic.html#rtc_implies"><span class="id" title="lemma">rtc_implies</span></a>; [|<span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">inv</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rtc_reserve_step_promise_consistent" class="idref" href="#rtc_reserve_step_promise_consistent"><span class="id" title="lemma">rtc_reserve_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:101" class="idref" href="#lang:101"><span class="id" title="binder">lang</span></a> <a id="th1:102" class="idref" href="#th1:102"><span class="id" title="binder">th1</span></a> <a id="th2:103" class="idref" href="#th2:103"><span class="id" title="binder">th2</span></a> <a id="lo:104" class="idref" href="#lo:104"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEPS:105" class="idref" href="#STEPS:105"><span class="id" title="binder">STEPS</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtc"><span class="id" title="abbreviation">rtc</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.reserve_step"><span class="id" title="inductive">Thread.reserve_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:101"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:104"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:102"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:103"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:106" class="idref" href="#CONS:106"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:103"><span class="id" title="variable">th2</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:102"><span class="id" title="variable">th1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ginduction</span> <span class="id" title="var">STEPS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHSTEPS</span> <span class="id" title="tactic">in</span> <span class="id" title="var">CONS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">H</span>. <span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>. <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.add_get1"><span class="id" title="lemma">Memory.add_get1</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rtc_cancel_step_promise_consistent" class="idref" href="#rtc_cancel_step_promise_consistent"><span class="id" title="lemma">rtc_cancel_step_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:107" class="idref" href="#lang:107"><span class="id" title="binder">lang</span></a> <a id="th1:108" class="idref" href="#th1:108"><span class="id" title="binder">th1</span></a> <a id="th2:109" class="idref" href="#th2:109"><span class="id" title="binder">th2</span></a> <a id="lo:110" class="idref" href="#lo:110"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEPS:111" class="idref" href="#STEPS:111"><span class="id" title="binder">STEPS</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtc"><span class="id" title="abbreviation">rtc</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.cancel_step"><span class="id" title="inductive">Thread.cancel_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:107"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:110"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:108"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:109"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:112" class="idref" href="#CONS:112"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:109"><span class="id" title="variable">th2</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:108"><span class="id" title="variable">th1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ginduction</span> <span class="id" title="var">STEPS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHSTEPS</span> <span class="id" title="tactic">in</span> <span class="id" title="var">CONS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">H</span>. <span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>. <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="var">dup</span> <span class="id" title="var">PROMISE</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_get1"><span class="id" title="lemma">Memory.remove_get1</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">des</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">clarify</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_get0"><span class="id" title="lemma">Memory.remove_get0</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">PROMISES</span>. <span class="id" title="var">des</span>. <span class="id" title="var">clarify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rtc_reserve_step_promise_consistent2" class="idref" href="#rtc_reserve_step_promise_consistent2"><span class="id" title="lemma">rtc_reserve_step_promise_consistent2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:113" class="idref" href="#lang:113"><span class="id" title="binder">lang</span></a> (<a id="th1:114" class="idref" href="#th1:114"><span class="id" title="binder">th1</span></a> <a id="th2:115" class="idref" href="#th2:115"><span class="id" title="binder">th2</span></a>: <a class="idref" href="CompOptCert.Thread.html#Thread.t"><span class="id" title="record">Thread.t</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:113"><span class="id" title="variable">lang</span></a>) <a id="lo:116" class="idref" href="#lo:116"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:117" class="idref" href="#CONS:117"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:114"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEPS:118" class="idref" href="#STEPS:118"><span class="id" title="binder">STEPS</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtc"><span class="id" title="abbreviation">rtc</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.reserve_step"><span class="id" title="inductive">Thread.reserve_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:113"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:116"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:114"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:115"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:115"><span class="id" title="variable">th2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ginduction</span> <span class="id" title="var">STEPS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHSTEPS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">H</span>. <span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>. <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.add_o"><span class="id" title="lemma">Memory.add_o</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">des_ifs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="rtc_cancel_step_promise_consistent2" class="idref" href="#rtc_cancel_step_promise_consistent2"><span class="id" title="lemma">rtc_cancel_step_promise_consistent2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:119" class="idref" href="#lang:119"><span class="id" title="binder">lang</span></a> (<a id="th1:120" class="idref" href="#th1:120"><span class="id" title="binder">th1</span></a> <a id="th2:121" class="idref" href="#th2:121"><span class="id" title="binder">th2</span></a>: <a class="idref" href="CompOptCert.Thread.html#Thread.t"><span class="id" title="record">Thread.t</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:119"><span class="id" title="variable">lang</span></a>) <a id="lo:122" class="idref" href="#lo:122"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:123" class="idref" href="#CONS:123"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:120"><span class="id" title="variable">th1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEPS:124" class="idref" href="#STEPS:124"><span class="id" title="binder">STEPS</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtc"><span class="id" title="abbreviation">rtc</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.cancel_step"><span class="id" title="inductive">Thread.cancel_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:119"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:122"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#th1:120"><span class="id" title="variable">th1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:121"><span class="id" title="variable">th2</span></a>)<br/>
&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th2:121"><span class="id" title="variable">th2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ginduction</span> <span class="id" title="var">STEPS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHSTEPS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">H</span>. <span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>. <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_o"><span class="id" title="lemma">Memory.remove_o</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">des_ifs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="consistent_promise_consistent" class="idref" href="#consistent_promise_consistent"><span class="id" title="lemma">consistent_promise_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lang:125" class="idref" href="#lang:125"><span class="id" title="binder">lang</span></a> <a id="th:126" class="idref" href="#th:126"><span class="id" title="binder">th</span></a> <a id="lo:127" class="idref" href="#lo:127"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:128" class="idref" href="#CONS:128"><span class="id" title="binder">CONS</span></a>: @<a class="idref" href="CompOptCert.Thread.html#Thread.consistent"><span class="id" title="definition">Thread.consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:125"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:127"><span class="id" title="variable">lo</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WF:129" class="idref" href="#WF:129"><span class="id" title="binder">WF</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="SC:130" class="idref" href="#SC:130"><span class="id" title="binder">SC</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed_timemap"><span class="id" title="definition">Memory.closed_timemap</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.sc"><span class="id" title="projection">Thread.sc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="MEM:131" class="idref" href="#MEM:131"><span class="id" title="binder">MEM</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed"><span class="id" title="inductive">Memory.closed</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a>)):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#th:126"><span class="id" title="variable">th</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">th</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.cap_exists"><span class="id" title="lemma">Memory.cap_exists</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.cap_closed"><span class="id" title="lemma">Memory.cap_closed</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Local.html#Local.cap_wf"><span class="id" title="lemma">Local.cap_wf</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.max_concrete_timemap_exists"><span class="id" title="lemma">Memory.max_concrete_timemap_exists</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">x0</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">hexploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.max_concrete_timemap_closed"><span class="id" title="lemma">Memory.max_concrete_timemap_closed</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exploit</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">s</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">hexploit</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#rtc_tau_step_promise_consistent"><span class="id" title="lemma">rtc_tau_step_promise_consistent</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">STEPS</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">PROMISES</span>, <a class="idref" href="CompOptCert.Memory.html#Memory.bot_get"><span class="id" title="lemma">Memory.bot_get</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">congr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="promise_consistent_promise_read" class="idref" href="#promise_consistent_promise_read"><span class="id" title="lemma">promise_consistent_promise_read</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc1:132" class="idref" href="#lc1:132"><span class="id" title="binder">lc1</span></a> <a id="mem1:133" class="idref" href="#mem1:133"><span class="id" title="binder">mem1</span></a> <a id="loc:134" class="idref" href="#loc:134"><span class="id" title="binder">loc</span></a> <a id="to:135" class="idref" href="#to:135"><span class="id" title="binder">to</span></a> <a id="val:136" class="idref" href="#val:136"><span class="id" title="binder">val</span></a> <a id="ord:137" class="idref" href="#ord:137"><span class="id" title="binder">ord</span></a> <a id="released:138" class="idref" href="#released:138"><span class="id" title="binder">released</span></a> <a id="lc2:139" class="idref" href="#lc2:139"><span class="id" title="binder">lc2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="f:140" class="idref" href="#f:140"><span class="id" title="binder">f</span></a> <a id="t:141" class="idref" href="#t:141"><span class="id" title="binder">t</span></a> <a id="v:142" class="idref" href="#v:142"><span class="id" title="binder">v</span></a> <a id="r:143" class="idref" href="#r:143"><span class="id" title="binder">r</span></a> <a id="lo:144" class="idref" href="#lo:144"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:145" class="idref" href="#STEP:145"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.read_step"><span class="id" title="inductive">Local.read_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:132"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem1:133"><span class="id" title="variable">mem1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:134"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:135"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#val:136"><span class="id" title="variable">val</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#released:138"><span class="id" title="variable">released</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:137"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:139"><span class="id" title="variable">lc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:144"><span class="id" title="variable">lo</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="PROMISE:146" class="idref" href="#PROMISE:146"><span class="id" title="binder">PROMISE</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:134"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:141"><span class="id" title="variable">t</span></a> (<a class="idref" href="CompOptCert.Local.html#Local.promises"><span class="id" title="projection">Local.promises</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:132"><span class="id" title="variable">lc1</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CompOptCert.PromiseConsistent.html#f:140"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CompOptCert.Cell.html#Message.concrete"><span class="id" title="constructor">Message.concrete</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#v:142"><span class="id" title="variable">v</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#r:143"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:147" class="idref" href="#CONS:147"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:139"><span class="id" title="variable">lc2</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Time.html#Time.lt"><span class="id" title="definition">Time.lt</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:135"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:141"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">exploit</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">s</span>. <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CompOptCert.Time.html#TimeFacts.join_lt_des"><span class="id" title="lemma">TimeFacts.join_lt_des</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">x</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CompOptCert.Time.html#TimeFacts.join_lt_des"><span class="id" title="lemma">TimeFacts.join_lt_des</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">AC</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">BC0</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CompOptCert.View.html#View.singleton_ur_if"><span class="id" title="definition">View.singleton_ur_if</span></a>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="CompOptCert.View.html#TimeMap.singleton"><span class="id" title="definition">TimeMap.singleton</span></a>, <a class="idref" href="CompOptCert.Loc.html#LocFun.add"><span class="id" title="definition">LocFun.add</span></a>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="CompOptCert.View.html#TimeMap.singleton"><span class="id" title="definition">TimeMap.singleton</span></a>, <a class="idref" href="CompOptCert.Loc.html#LocFun.add"><span class="id" title="definition">LocFun.add</span></a>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="promise_consistent_promise_write" class="idref" href="#promise_consistent_promise_write"><span class="id" title="lemma">promise_consistent_promise_write</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc1:148" class="idref" href="#lc1:148"><span class="id" title="binder">lc1</span></a> <a id="sc1:149" class="idref" href="#sc1:149"><span class="id" title="binder">sc1</span></a> <a id="mem1:150" class="idref" href="#mem1:150"><span class="id" title="binder">mem1</span></a> <a id="loc:151" class="idref" href="#loc:151"><span class="id" title="binder">loc</span></a> <a id="from:152" class="idref" href="#from:152"><span class="id" title="binder">from</span></a> <a id="to:153" class="idref" href="#to:153"><span class="id" title="binder">to</span></a> <a id="val:154" class="idref" href="#val:154"><span class="id" title="binder">val</span></a> <a id="releasedm:155" class="idref" href="#releasedm:155"><span class="id" title="binder">releasedm</span></a> <a id="released:156" class="idref" href="#released:156"><span class="id" title="binder">released</span></a> <a id="ord:157" class="idref" href="#ord:157"><span class="id" title="binder">ord</span></a> <a id="lc2:158" class="idref" href="#lc2:158"><span class="id" title="binder">lc2</span></a> <a id="sc2:159" class="idref" href="#sc2:159"><span class="id" title="binder">sc2</span></a> <a id="mem2:160" class="idref" href="#mem2:160"><span class="id" title="binder">mem2</span></a> <a id="kind:161" class="idref" href="#kind:161"><span class="id" title="binder">kind</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="f:162" class="idref" href="#f:162"><span class="id" title="binder">f</span></a> <a id="t:163" class="idref" href="#t:163"><span class="id" title="binder">t</span></a> <a id="v:164" class="idref" href="#v:164"><span class="id" title="binder">v</span></a> <a id="r:165" class="idref" href="#r:165"><span class="id" title="binder">r</span></a> <a id="lo:166" class="idref" href="#lo:166"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="STEP:167" class="idref" href="#STEP:167"><span class="id" title="binder">STEP</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.write_step"><span class="id" title="inductive">Local.write_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:148"><span class="id" title="variable">lc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#sc1:149"><span class="id" title="variable">sc1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem1:150"><span class="id" title="variable">mem1</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:151"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#from:152"><span class="id" title="variable">from</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:153"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#val:154"><span class="id" title="variable">val</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#releasedm:155"><span class="id" title="variable">releasedm</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#released:156"><span class="id" title="variable">released</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:157"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:158"><span class="id" title="variable">lc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#sc2:159"><span class="id" title="variable">sc2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem2:160"><span class="id" title="variable">mem2</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#kind:161"><span class="id" title="variable">kind</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:166"><span class="id" title="variable">lo</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="PROMISE:168" class="idref" href="#PROMISE:168"><span class="id" title="binder">PROMISE</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:151"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:163"><span class="id" title="variable">t</span></a> (<a class="idref" href="CompOptCert.Local.html#Local.promises"><span class="id" title="projection">Local.promises</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc1:148"><span class="id" title="variable">lc1</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CompOptCert.PromiseConsistent.html#f:162"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CompOptCert.Cell.html#Message.concrete"><span class="id" title="constructor">Message.concrete</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#v:164"><span class="id" title="variable">v</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#r:165"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:169" class="idref" href="#CONS:169"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc2:158"><span class="id" title="variable">lc2</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="CompOptCert.Time.html#Time.le"><span class="id" title="definition">Time.le</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:153"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#t:163"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CompOptCert.Memory.html#Memory.get"><span class="id" title="definition">Memory.get</span></a> <span class="id" title="var">loc</span> <span class="id" title="var">t</span> (<a class="idref" href="CompOptCert.Local.html#Local.promises"><span class="id" title="projection">Local.promises</span></a> <span class="id" title="var">lc2</span>)) <span class="id" title="keyword">as</span> [[]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">WRITE</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dup</span> <span class="id" title="var">X</span>. <span class="id" title="var">revert</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_o"><span class="id" title="lemma">Memory.remove_o</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>. <span class="id" title="var">i</span>. <span class="id" title="var">guardH</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.promise_get1_promise"><span class="id" title="lemma">Memory.promise_get1_promise</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE0</span>; <span class="id" title="var">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">i</span>. <span class="id" title="var">des</span>. <span class="id" title="var">inv</span> <span class="id" title="var">MSG_LE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">X0</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">inv</span> <span class="id" title="var">GET</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exploit</span> <span class="id" title="var">CONS</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CompOptCert.Time.html#TimeFacts.join_lt_des"><span class="id" title="lemma">TimeFacts.join_lt_des</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">x</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="var">revert</span> <span class="id" title="var">BC</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CompOptCert.View.html#TimeMap.singleton"><span class="id" title="definition">TimeMap.singleton</span></a>, <a class="idref" href="CompOptCert.Loc.html#LocFun.add"><span class="id" title="definition">LocFun.add</span></a>. <span class="id" title="var">condtac</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inv</span> <span class="id" title="var">STEP</span>. <span class="id" title="var">inv</span> <span class="id" title="var">WRITE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.Memory.html#Memory.promise_get1_promise"><span class="id" title="lemma">Memory.promise_get1_promise</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inv</span> <span class="id" title="var">PROMISE0</span>; <span class="id" title="var">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">i</span>. <span class="id" title="var">des</span>. <span class="id" title="var">inv</span> <span class="id" title="var">MSG_LE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exploit</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#fulfill_unset_promises"><span class="id" title="lemma">fulfill_unset_promises</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">i</span>. <span class="id" title="var">des</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">refl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">read_step_promise_consistent</span> <span class="id" title="var">write_step_promise_consistent</span> <span class="id" title="var">promise_step_promise_consistent</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_promise_consistent</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="promise_consistent_prsv_thread_nprm_step" class="idref" href="#promise_consistent_prsv_thread_nprm_step"><span class="id" title="lemma">promise_consistent_prsv_thread_nprm_step</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="n:170" class="idref" href="#n:170"><span class="id" title="binder">n</span></a> <a id="lang:171" class="idref" href="#lang:171"><span class="id" title="binder">lang</span></a> <a id="lo:172" class="idref" href="#lo:172"><span class="id" title="binder">lo</span></a> (<a id="e:173" class="idref" href="#e:173"><span class="id" title="binder">e</span></a> <a id="e':174" class="idref" href="#e':174"><span class="id" title="binder">e'</span></a>: <a class="idref" href="CompOptCert.Thread.html#Thread.t"><span class="id" title="record">Thread.t</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:171"><span class="id" title="variable">lang</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CLOSED_MEM:175" class="idref" href="#CLOSED_MEM:175"><span class="id" title="binder">CLOSED_MEM</span></a>: <a class="idref" href="CompOptCert.Memory.html#Memory.closed"><span class="id" title="inductive">Memory.closed</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:173"><span class="id" title="variable">e</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="LOCAL_WF:176" class="idref" href="#LOCAL_WF:176"><span class="id" title="binder">LOCAL_WF</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.wf"><span class="id" title="inductive">Local.wf</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:173"><span class="id" title="variable">e</span></a>) (<a class="idref" href="CompOptCert.Thread.html#Thread.memory"><span class="id" title="projection">Thread.memory</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:173"><span class="id" title="variable">e</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="NPRM_STEPS:177" class="idref" href="#NPRM_STEPS:177"><span class="id" title="binder">NPRM_STEPS</span></a>: <a class="idref" href="CompOptCert.Basic.html#rtcn"><span class="id" title="inductive">rtcn</span></a> (@<a class="idref" href="CompOptCert.Thread.html#Thread.nprm_step"><span class="id" title="inductive">Thread.nprm_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lang:171"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:172"><span class="id" title="variable">lo</span></a>) <a class="idref" href="CompOptCert.PromiseConsistent.html#n:170"><span class="id" title="variable">n</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:173"><span class="id" title="variable">e</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e':174"><span class="id" title="variable">e'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:178" class="idref" href="#CONS:178"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e':174"><span class="id" title="variable">e'</span></a>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> (<a class="idref" href="CompOptCert.Thread.html#Thread.local"><span class="id" title="projection">Thread.local</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#e:173"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inv</span> <span class="id" title="var">NPRM_STEPS</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">inv</span> <span class="id" title="var">NPRM_STEPS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">A12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">PROG</span>; <span class="id" title="var">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A</span> <span class="id" title="var">IHn</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">solve_promise_consistent</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_read"><span class="id" title="lemma">local_wf_read</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#write_step_closed_mem"><span class="id" title="lemma">write_step_closed_mem</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_write"><span class="id" title="lemma">local_wf_write</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#write_step_closed_mem"><span class="id" title="lemma">write_step_closed_mem</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">releasedr</span> := <span class="id" title="var">releasedr</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#closed_mem_implies_closed_msg"><span class="id" title="lemma">closed_mem_implies_closed_msg</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_read"><span class="id" title="lemma">local_wf_read</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_upd"><span class="id" title="lemma">local_wf_upd</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CompOptCert.Event.html#Ordering.le"><span class="id" title="definition">Ordering.le</span></a> <a class="idref" href="CompOptCert.Event.html#Ordering.seqcst"><span class="id" title="constructor">Ordering.seqcst</span></a> <span class="id" title="var">ordw</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">SEQCST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ordw</span>; <span class="id" title="var">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Local.html#Local.bot_promise_consistent"><span class="id" title="lemma">Local.bot_promise_consistent</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exploit</span> <span class="id" title="var">PROMISES</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#fence_step_promise_consistent"><span class="id" title="lemma">fence_step_promise_consistent</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_fence_not_seqcst"><span class="id" title="lemma">local_wf_fence_not_seqcst</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lc1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">PF</span>. <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">kind</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg1</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.lower_closed"><span class="id" title="lemma">Memory.lower_closed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_promise"><span class="id" title="lemma">local_wf_promise</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lc1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>; <span class="id" title="var">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_not_sc_fence</span> <span class="id" title="var">A23</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.cancel_closed"><span class="id" title="lemma">Memory.cancel_closed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.WFConfig.html#local_wf_promise"><span class="id" title="lemma">local_wf_promise</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lc1</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="read_promise_not_consistent" class="idref" href="#read_promise_not_consistent"><span class="id" title="lemma">read_promise_not_consistent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="lc:179" class="idref" href="#lc:179"><span class="id" title="binder">lc</span></a> <a id="mem:180" class="idref" href="#mem:180"><span class="id" title="binder">mem</span></a> <a id="loc:181" class="idref" href="#loc:181"><span class="id" title="binder">loc</span></a> <a id="from:182" class="idref" href="#from:182"><span class="id" title="binder">from</span></a> <a id="to:183" class="idref" href="#to:183"><span class="id" title="binder">to</span></a> <a id="msg:184" class="idref" href="#msg:184"><span class="id" title="binder">msg</span></a> <a id="lc':185" class="idref" href="#lc':185"><span class="id" title="binder">lc'</span></a> <a id="mem':186" class="idref" href="#mem':186"><span class="id" title="binder">mem'</span></a> <a id="kind:187" class="idref" href="#kind:187"><span class="id" title="binder">kind</span></a> <a id="loc0:188" class="idref" href="#loc0:188"><span class="id" title="binder">loc0</span></a> <a id="to0:189" class="idref" href="#to0:189"><span class="id" title="binder">to0</span></a> <a id="val0:190" class="idref" href="#val0:190"><span class="id" title="binder">val0</span></a> <a id="released:191" class="idref" href="#released:191"><span class="id" title="binder">released</span></a> <a id="ord:192" class="idref" href="#ord:192"><span class="id" title="binder">ord</span></a> <a id="lc'':193" class="idref" href="#lc'':193"><span class="id" title="binder">lc''</span></a> <a id="lo:194" class="idref" href="#lo:194"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="PROMISE:195" class="idref" href="#PROMISE:195"><span class="id" title="binder">PROMISE</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_step"><span class="id" title="inductive">Local.promise_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc:179"><span class="id" title="variable">lc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem:180"><span class="id" title="variable">mem</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc:181"><span class="id" title="variable">loc</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#from:182"><span class="id" title="variable">from</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:183"><span class="id" title="variable">to</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#msg:184"><span class="id" title="variable">msg</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc':185"><span class="id" title="variable">lc'</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem':186"><span class="id" title="variable">mem'</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#kind:187"><span class="id" title="variable">kind</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="LOCAL:196" class="idref" href="#LOCAL:196"><span class="id" title="binder">LOCAL</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.read_step"><span class="id" title="inductive">Local.read_step</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc':185"><span class="id" title="variable">lc'</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#mem':186"><span class="id" title="variable">mem'</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#loc0:188"><span class="id" title="variable">loc0</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to0:189"><span class="id" title="variable">to0</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#val0:190"><span class="id" title="variable">val0</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#released:191"><span class="id" title="variable">released</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#ord:192"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc'':193"><span class="id" title="variable">lc''</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lo:194"><span class="id" title="variable">lo</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CONS:197" class="idref" href="#CONS:197"><span class="id" title="binder">CONS</span></a>: <a class="idref" href="CompOptCert.Local.html#Local.promise_consistent"><span class="id" title="definition">Local.promise_consistent</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#lc'':193"><span class="id" title="variable">lc''</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CompOptCert.PromiseConsistent.html#loc:181"><span class="id" title="variable">loc</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to:183"><span class="id" title="variable">to</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CompOptCert.PromiseConsistent.html#loc0:188"><span class="id" title="variable">loc0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CompOptCert.PromiseConsistent.html#to0:189"><span class="id" title="variable">to0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">CONTR</span>; <span class="id" title="var">inv</span> <span class="id" title="var">CONTR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">PROMISE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span>(<a class="idref" href="CompOptCert.Memory.html#Memory.op_kind_is_cancel"><span class="id" title="definition">Memory.op_kind_is_cancel</span></a> <span class="id" title="var">kind</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>); <span class="id" title="var">ii</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.promise_get2"><span class="id" title="lemma">Memory.promise_get2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">PROMISE0</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">dup</span> <span class="id" title="var">LOCAL</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL0</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">GET_MEM</span> <span class="id" title="tactic">in</span> <span class="id" title="var">GET</span>. <span class="id" title="var">inv</span> <span class="id" title="var">GET</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.PromiseConsistent.html#promise_consistent_promise_read"><span class="id" title="lemma">promise_consistent_promise_read</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">LOCAL</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Time.html#Time.lt_strorder"><span class="id" title="axiom">Time.lt_strorder</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">LOCAL</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CompOptCert.Memory.html#Memory.op_kind_is_cancel"><span class="id" title="definition">Memory.op_kind_is_cancel</span></a> <span class="id" title="var">kind</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">IS_CCL</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">kind</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">PROMISE0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Memory.html#Memory.remove_get0"><span class="id" title="lemma">Memory.remove_get0</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">MEM</span>; <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">LOCAL</span>; <span class="id" title="var">ss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">GET0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">GET1</span>; <span class="id" title="var">ss</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>