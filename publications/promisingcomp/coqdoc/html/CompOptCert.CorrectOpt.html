<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>CompOptCert.CorrectOpt</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library CompOptCert.CorrectOpt</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.sflib.html#"><span class="id" title="library">sflib</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Axioms.html#"><span class="id" title="library">Axioms</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Basic.html#"><span class="id" title="library">Basic</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.DataStructure.html#"><span class="id" title="library">DataStructure</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Loc.html#"><span class="id" title="library">Loc</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Language.html#"><span class="id" title="library">Language</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Time.html#"><span class="id" title="library">Time</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Event.html#"><span class="id" title="library">Event</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.View.html#"><span class="id" title="library">View</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Cell.html#"><span class="id" title="library">Cell</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Memory.html#"><span class="id" title="library">Memory</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.TView.html#"><span class="id" title="library">TView</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Local.html#"><span class="id" title="library">Local</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Thread.html#"><span class="id" title="library">Thread</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Configuration.html#"><span class="id" title="library">Configuration</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.NPConfiguration.html#"><span class="id" title="library">NPConfiguration</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.ww_RF.html#"><span class="id" title="library">ww_RF</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Behavior.html#"><span class="id" title="library">Behavior</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.LocalSim.html#"><span class="id" title="library">LocalSim</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.LibTactics.html#"><span class="id" title="library">LibTactics</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.SemaEq.html#"><span class="id" title="library">SemaEq</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.wwRFEq.html#"><span class="id" title="library">wwRFEq</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.Compositionality.html#"><span class="id" title="library">Compositionality</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.GlobSim.html#"><span class="id" title="library">GlobSim</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.NPBehavior.html#"><span class="id" title="library">NPBehavior</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="CompOptCert.wwRFPrsv.html#"><span class="id" title="library">wwRFPrsv</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab248"></a><h1 class="section">Framework Final Theorem</h1>

<div class="paragraph"> </div>

 This file defines the final theorem of our framework (Theorem 6.4). 
<div class="paragraph"> </div>

 The main result (theorem <span class="inlinecode"><a class="idref" href="CompOptCert.CorrectOpt.html#Verif_implies_Correctness"><span class="id" title="lemma">Verif_implies_Correctness</span></a></span> in this file) is that:
    a verified optimizer is a correct optimizer. 
<div class="paragraph"> </div>

<a id="lab249"></a><h1 class="section">Correctness of Optimizer</h1>

</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="Correct_Optimizer" class="idref" href="#Correct_Optimizer"><span class="id" title="section">Correct_Optimizer</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a id="Correct_Optimizer.lang" class="idref" href="#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a>: <a class="idref" href="CompOptCert.Language.html#language"><span class="id" title="definition">language</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab250"></a><h2 class="section">Type of optimizer</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="Optimizer" class="idref" href="#Optimizer"><span class="id" title="definition">Optimizer</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="lo:2" class="idref" href="#lo:2"><span class="id" title="binder">lo</span></a>: <a class="idref" href="CompOptCert.Event.html#Ordering.LocOrdMap"><span class="id" title="definition">Ordering.LocOrdMap</span></a>) (<a id="code:3" class="idref" href="#code:3"><span class="id" title="binder">code</span></a>: <a class="idref" href="CompOptCert.Language.html#Language.syntax"><span class="id" title="projection">Language.syntax</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a>), <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="CompOptCert.Language.html#Language.syntax"><span class="id" title="projection">Language.syntax</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab251"></a><h2 class="section">Correctness of optimizer (Definition 6.3 in paper)</h2>
 An optimizer is correct if,

<div class="paragraph"> </div>

      for any optimization,
      if the source program is write-write race freedom <span class="inlinecode"><a class="idref" href="CompOptCert.ww_RF.html#ww_rf"><span class="id" title="definition">ww_rf</span></a></span> and safe <span class="inlinecode"><span class="id" title="var">Configuration.safe</span></span>,
      we have the refinement between the target program optimized and the source program,
      and the write-write race freedom and safety properties are preserved during optimization 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="Correct" class="idref" href="#Correct"><span class="id" title="definition">Correct</span></a> (<a id="optimizer:4" class="idref" href="#optimizer:4"><span class="id" title="binder">optimizer</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Optimizer"><span class="id" title="definition">Optimizer</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="code_s:5" class="idref" href="#code_s:5"><span class="id" title="binder">code_s</span></a> <a id="code_t:6" class="idref" href="#code_t:6"><span class="id" title="binder">code_t</span></a>: <a class="idref" href="CompOptCert.Language.html#Language.syntax"><span class="id" title="projection">Language.syntax</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a>) <a id="fs:7" class="idref" href="#fs:7"><span class="id" title="binder">fs</span></a> <a id="lo:8" class="idref" href="#lo:8"><span class="id" title="binder">lo</span></a> <a id="ctid:9" class="idref" href="#ctid:9"><span class="id" title="binder">ctid</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="OPTIMIZE:10" class="idref" href="#OPTIMIZE:10"><span class="id" title="binder">OPTIMIZE</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer:4"><span class="id" title="variable">optimizer</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:8"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:5"><span class="id" title="variable">code_s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:6"><span class="id" title="variable">code_t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="WWRF_S:11" class="idref" href="#WWRF_S:11"><span class="id" title="binder">WWRF_S</span></a>: <a class="idref" href="CompOptCert.ww_RF.html#ww_rf"><span class="id" title="definition">ww_rf</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:8"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#fs:7"><span class="id" title="variable">fs</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:5"><span class="id" title="variable">code_s</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ctid:9"><span class="id" title="variable">ctid</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="SAFE_S:12" class="idref" href="#SAFE_S:12"><span class="id" title="binder">SAFE_S</span></a>: <a class="idref" href="CompOptCert.Configuration.html#Configuration.safe"><span class="id" title="inductive">Configuration.safe</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:8"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#fs:7"><span class="id" title="variable">fs</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:5"><span class="id" title="variable">code_s</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ctid:9"><span class="id" title="variable">ctid</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">&lt;&lt;</span></a><a id="REFINE:13" class="idref" href="#REFINE:13"><span class="id" title="binder">REFINE</span></a><a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">:</span></a> <a class="idref" href="CompOptCert.Behavior.html#evttr_refinement"><span class="id" title="definition">evttr_refinement</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#fs:7"><span class="id" title="variable">fs</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ctid:9"><span class="id" title="variable">ctid</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:8"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:6"><span class="id" title="variable">code_t</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:5"><span class="id" title="variable">code_s</span></a> <a class="idref" href="CompOptCert.Behavior.html#prog_behaviors"><span class="id" title="definition">prog_behaviors</span></a> <a class="idref" href="CompOptCert.Behavior.html#prog_behaviors"><span class="id" title="definition">prog_behaviors</span></a><a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">&gt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">&lt;&lt;</span></a><a id="WWRF_T:14" class="idref" href="#WWRF_T:14"><span class="id" title="binder">WWRF_T</span></a><a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">:</span></a> <a class="idref" href="CompOptCert.ww_RF.html#ww_rf"><span class="id" title="definition">ww_rf</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:8"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#fs:7"><span class="id" title="variable">fs</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:6"><span class="id" title="variable">code_t</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ctid:9"><span class="id" title="variable">ctid</span></a><a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">&gt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">&lt;&lt;</span></a><a id="SAFE_T:15" class="idref" href="#SAFE_T:15"><span class="id" title="binder">SAFE_T</span></a><a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">:</span></a> <a class="idref" href="CompOptCert.Configuration.html#Configuration.safe"><span class="id" title="inductive">Configuration.safe</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:8"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#fs:7"><span class="id" title="variable">fs</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:6"><span class="id" title="variable">code_t</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ctid:9"><span class="id" title="variable">ctid</span></a><a class="idref" href="CompOptCert.sflib.html#:::'&lt;&lt;'_x_':'_x_'&gt;&gt;'"><span class="id" title="notation">&gt;&gt;</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab252"></a><h2 class="section">Optimizers linking</h2>
 It contructs an optimizer with two optimization phases.  opt_link (optimizer1, optimizer) (code_s) =
       let code_m := optimizer2(code_s) in optimizer1(code_m)   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="opt_link" class="idref" href="#opt_link"><span class="id" title="definition">opt_link</span></a> (<a id="optimizer1:16" class="idref" href="#optimizer1:16"><span class="id" title="binder">optimizer1</span></a> <a id="optimizer2:17" class="idref" href="#optimizer2:17"><span class="id" title="binder">optimizer2</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Optimizer"><span class="id" title="definition">Optimizer</span></a>) : <a class="idref" href="CompOptCert.CorrectOpt.html#Optimizer"><span class="id" title="definition">Optimizer</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<a id="lo:18" class="idref" href="#lo:18"><span class="id" title="binder">lo</span></a>: <a class="idref" href="CompOptCert.Event.html#Ordering.LocOrdMap"><span class="id" title="definition">Ordering.LocOrdMap</span></a>) (<a id="code_s:19" class="idref" href="#code_s:19"><span class="id" title="binder">code_s</span></a>: <a class="idref" href="CompOptCert.Language.html#Language.syntax"><span class="id" title="projection">Language.syntax</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="CompOptCert.CorrectOpt.html#optimizer2:17"><span class="id" title="variable">optimizer2</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:18"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:19"><span class="id" title="variable">code_s</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">code_m</span> ⇒ <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer1:16"><span class="id" title="variable">optimizer1</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:18"><span class="id" title="variable">lo</span></a> <span class="id" title="var">code_m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab253"></a><h2 class="section">Correctness of optimizers linking</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="correct_optimizer_transitive" class="idref" href="#correct_optimizer_transitive"><span class="id" title="lemma">correct_optimizer_transitive</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="optimizer1:20" class="idref" href="#optimizer1:20"><span class="id" title="binder">optimizer1</span></a> <a id="optimizer2:21" class="idref" href="#optimizer2:21"><span class="id" title="binder">optimizer2</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Optimizer"><span class="id" title="definition">Optimizer</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CORRECT1:22" class="idref" href="#CORRECT1:22"><span class="id" title="binder">CORRECT1</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Correct"><span class="id" title="definition">Correct</span></a>(<a class="idref" href="CompOptCert.CorrectOpt.html#optimizer1:20"><span class="id" title="variable">optimizer1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="CORRECT2:23" class="idref" href="#CORRECT2:23"><span class="id" title="binder">CORRECT2</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Correct"><span class="id" title="definition">Correct</span></a>(<a class="idref" href="CompOptCert.CorrectOpt.html#optimizer2:21"><span class="id" title="variable">optimizer2</span></a>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.CorrectOpt.html#Correct"><span class="id" title="definition">Correct</span></a>(<a class="idref" href="CompOptCert.CorrectOpt.html#opt_link"><span class="id" title="definition">opt_link</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer1:20"><span class="id" title="variable">optimizer1</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer2:21"><span class="id" title="variable">optimizer2</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="var">unfolds</span> <span class="id" title="var">Correct</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CompOptCert.Behavior.html#evttr_refinement"><span class="id" title="definition">evttr_refinement</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CompOptCert.CorrectOpt.html#opt_link"><span class="id" title="definition">opt_link</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">OPTIMIZE</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">optimizer2</span> <span class="id" title="var">lo</span> <span class="id" title="var">code_s</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">H_OPTIMIZER2</span>; <span class="id" title="var">simpls</span>; <span class="id" title="var">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">CORRECT2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H_OPTIMIZER2</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H_OPTIMIZER2</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hrefine2</span> &amp; <span class="id" title="var">Hww_rf2</span> &amp; <span class="id" title="var">Hsafe2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">CORRECT1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">OPTIMIZE</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">OPTIMIZE</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hrefine1</span> &amp; <span class="id" title="var">Hww_rf1</span> &amp; <span class="id" title="var">Hsafe1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab254"></a><h2 class="section">Verified optimizer: Definition 5.1 in paper</h2>
 An optimizer is verified if we can establish the thread-local simulation <span class="inlinecode"><a class="idref" href="CompOptCert.LocalSim.html#local_sim"><span class="id" title="record">local_sim</span></a></span>
      between the target and source programs 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="Verif" class="idref" href="#Verif"><span class="id" title="definition">Verif</span></a> (<a id="optimizer:24" class="idref" href="#optimizer:24"><span class="id" title="binder">optimizer</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Optimizer"><span class="id" title="definition">Optimizer</span></a>): <span class="id" title="keyword">Prop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="code_s:25" class="idref" href="#code_s:25"><span class="id" title="binder">code_s</span></a> <a id="code_t:26" class="idref" href="#code_t:26"><span class="id" title="binder">code_t</span></a>: <a class="idref" href="CompOptCert.Language.html#Language.syntax"><span class="id" title="projection">Language.syntax</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a>) (<a id="lo:27" class="idref" href="#lo:27"><span class="id" title="binder">lo</span></a>: <a class="idref" href="CompOptCert.Event.html#Ordering.LocOrdMap"><span class="id" title="definition">Ordering.LocOrdMap</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.CorrectOpt.html#optimizer:24"><span class="id" title="variable">optimizer</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:27"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:25"><span class="id" title="variable">code_s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:26"><span class="id" title="variable">code_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.LibTactics.html#95db35c04a8fd28e69b3e455eacf5980"><span class="id" title="notation">∃</span></a> <a id="invariant:28" class="idref" href="#invariant:28"><span class="id" title="binder">invariant</span></a> <a id="index:29" class="idref" href="#index:29"><span class="id" title="binder">index</span></a> <a id="ord:30" class="idref" href="#ord:30"><span class="id" title="binder">ord</span></a><a class="idref" href="CompOptCert.LibTactics.html#95db35c04a8fd28e69b3e455eacf5980"><span class="id" title="notation">,</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="CompOptCert.LocalSim.html#local_sim"><span class="id" title="record">local_sim</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#index:29"><span class="id" title="variable">index</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ord:30"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#invariant:28"><span class="id" title="variable">invariant</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:27"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:26"><span class="id" title="variable">code_t</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:25"><span class="id" title="variable">code_s</span></a>.<br/>

<br/>
</div>

<div class="doc">
The following lemma <span class="inlinecode"><a class="idref" href="CompOptCert.CorrectOpt.html#Verif_opt_implies_localsim"><span class="id" title="lemma">Verif_opt_implies_localsim</span></a></span>
      shows that for a verified optimizer,
      the source program and the target program optimized
      are simulated by the thread-local simulation.

<div class="paragraph"> </div>

      Lemma <span class="inlinecode"><a class="idref" href="CompOptCert.CorrectOpt.html#Verif_opt_implies_localsim"><span class="id" title="lemma">Verif_opt_implies_localsim</span></a></span> corresponds to
      the step 2 in Figure 3 (Our proof path) in our paper 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="Verif_opt_implies_localsim" class="idref" href="#Verif_opt_implies_localsim"><span class="id" title="lemma">Verif_opt_implies_localsim</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="optimizer:31" class="idref" href="#optimizer:31"><span class="id" title="binder">optimizer</span></a> <a id="code_s:32" class="idref" href="#code_s:32"><span class="id" title="binder">code_s</span></a> <a id="code_t:33" class="idref" href="#code_t:33"><span class="id" title="binder">code_t</span></a> <a id="lo:34" class="idref" href="#lo:34"><span class="id" title="binder">lo</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="VERIF:35" class="idref" href="#VERIF:35"><span class="id" title="binder">VERIF</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Verif"><span class="id" title="definition">Verif</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer:31"><span class="id" title="variable">optimizer</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="OPT:36" class="idref" href="#OPT:36"><span class="id" title="binder">OPT</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer:31"><span class="id" title="variable">optimizer</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:34"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:32"><span class="id" title="variable">code_s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:33"><span class="id" title="variable">code_t</span></a>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.LibTactics.html#95db35c04a8fd28e69b3e455eacf5980"><span class="id" title="notation">∃</span></a> <a id="invariant:37" class="idref" href="#invariant:37"><span class="id" title="binder">invariant</span></a> <a id="index:38" class="idref" href="#index:38"><span class="id" title="binder">index</span></a> <a id="ord:39" class="idref" href="#ord:39"><span class="id" title="binder">ord</span></a><a class="idref" href="CompOptCert.LibTactics.html#95db35c04a8fd28e69b3e455eacf5980"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="CompOptCert.LocalSim.html#local_sim"><span class="id" title="record">local_sim</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#index:38"><span class="id" title="variable">index</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#ord:39"><span class="id" title="variable">ord</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer.lang"><span class="id" title="variable">lang</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#invariant:37"><span class="id" title="variable">invariant</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#lo:34"><span class="id" title="variable">lo</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_t:33"><span class="id" title="variable">code_t</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#code_s:32"><span class="id" title="variable">code_s</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab255"></a><h2 class="section">A verified optimizer is a correct optimizer (Theorem 6.4 in paper)</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a id="Verif_implies_Correctness" class="idref" href="#Verif_implies_Correctness"><span class="id" title="lemma">Verif_implies_Correctness</span></a>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="optimizer:40" class="idref" href="#optimizer:40"><span class="id" title="binder">optimizer</span></a>: <a class="idref" href="CompOptCert.CorrectOpt.html#Optimizer"><span class="id" title="definition">Optimizer</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CompOptCert.CorrectOpt.html#Verif"><span class="id" title="definition">Verif</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer:40"><span class="id" title="variable">optimizer</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.1/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct"><span class="id" title="definition">Correct</span></a> <a class="idref" href="CompOptCert.CorrectOpt.html#optimizer:40"><span class="id" title="variable">optimizer</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="var">renames</span> <span class="id" title="var">H</span> <span class="id" title="var">to</span> <span class="id" title="var">WF_OPT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.CorrectOpt.html#Verif_opt_implies_localsim"><span class="id" title="lemma">Verif_opt_implies_localsim</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">WF_OPT</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">renames</span> <span class="id" title="var">WF_OPT</span> <span class="id" title="var">to</span> <span class="id" title="var">LOCAL_SIM</span>. <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">GLOB_SIM</span>: <span class="id" title="var">LOCAL_SIM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.Compositionality.html#compositionality"><span class="id" title="lemma">compositionality</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">GLOB_SIM</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Focus</span> 2. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#config_safe_eq"><span class="id" title="lemma">config_safe_eq</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Focus</span> 2. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.wwRFEq.html#ww_RF_eq"><span class="id" title="lemma">ww_RF_eq</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ii</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#sema_eq_ps_nps"><span class="id" title="lemma">sema_eq_ps_nps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#sema_eq_ps_nps"><span class="id" title="lemma">sema_eq_ps_nps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.GlobSim.html#glob_sim_implies_refinement"><span class="id" title="lemma">glob_sim_implies_refinement</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">WW_RF</span>: <span class="id" title="var">LOCAL_SIM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.wwRFPrsv.html#ww_RF_preservation"><span class="id" title="lemma">ww_RF_preservation</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">WW_RF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.wwRFEq.html#ww_RF_eq"><span class="id" title="lemma">ww_RF_eq</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#config_safe_eq"><span class="id" title="lemma">config_safe_eq</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.wwRFEq.html#ww_RF_eq"><span class="id" title="lemma">ww_RF_eq</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">SAFE_S'</span>: <span class="id" title="var">SAFE_S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#safe_implies_not_abort_tr"><span class="id" title="lemma">safe_implies_not_abort_tr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">SAFE_S'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#not_abort_tr_implies_safe"><span class="id" title="lemma">not_abort_tr_implies_safe</span></a>. <span class="id" title="var">ii</span>; <span class="id" title="var">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span> <span class="id" title="var">SAFE_S'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#sema_eq_ps_nps"><span class="id" title="lemma">sema_eq_ps_nps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.GlobSim.html#glob_sim_implies_refinement"><span class="id" title="lemma">glob_sim_implies_refinement</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">GLOB_SIM</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="CompOptCert.SemaEq.html#sema_eq_ps_nps"><span class="id" title="lemma">sema_eq_ps_nps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">GLOB_SIM</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="CompOptCert.CorrectOpt.html#Correct_Optimizer"><span class="id" title="section">Correct_Optimizer</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>