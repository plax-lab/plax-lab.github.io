<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module RTLgenspec</title>
<meta name="description" content="Documentation of Coq module RTLgenspec" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module RTLgenspec</h1>
<div class="coq">
<br/>
<div class="doc">Abstract specification of RTL generation </div>
<br/>
<div class="doc">In this module, we define inductive predicates that specify the
  translations from Cminor to RTL performed by the functions in module
  <span class="bracket"><span class="id">RTLgen</span></span>.  We then show that these functions satisfy these relational
  specifications.  The relational specifications will then be used
  instead of the actual functions to show semantic equivalence between
  the source Cminor code and the the generated RTL code
  (see module <span class="bracket"><span class="id">RTLgenproof</span></span>). </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Maps.html">Maps</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Switch.html">Switch</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Op.html">Op</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Registers.html">Registers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CminorSel.html">CminorSel</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="RTL.html">RTL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RTLgen</span>.<br/>
<br/>
<h1> Reasoning about monadic computations </h1>
<br/>
<div class="doc">The tactics below simplify hypotheses of the form <span class="bracket"><span class="id">f</span> ... = <span class="id">OK</span> <span class="id">x</span> <span class="id">s</span> <span class="id">i</span></span>
  where <span class="bracket"><span class="id">f</span></span> is a monadic computation.  For instance, the hypothesis
  <span class="bracket">(<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id">a</span>; <span class="id">b</span>) <span class="id">s</span> = <span class="id">OK</span> <span class="id">y</span> <span class="id">s</span>' <span class="id">i</span></span> will generate the additional witnesses
  <span class="bracket"><span class="id">x</span></span>, <span class="bracket"><span class="id">s1</span></span>, <span class="bracket"><span class="id">i1</span></span>, <span class="bracket"><span class="id">i</span>'</span> and the additional hypotheses
  <span class="bracket"><span class="id">a</span> <span class="id">s</span> = <span class="id">OK</span> <span class="id">x</span> <span class="id">s1</span> <span class="id">i1</span></span> and <span class="bracket"><span class="id">b</span> <span class="id">x</span> <span class="id">s1</span> = <span class="id">OK</span> <span class="id">y</span> <span class="id">s</span>' <span class="id">i</span>'</span>, reflecting the fact that
  both monadic computations <span class="bracket"><span class="id">a</span></span> and <span class="bracket"><span class="id">b</span></span> succeeded.
</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bind_inversion">bind_inversion</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id">mon</span> <span class="id"><a href="RTLgenspec.html#A">A</a></span>) (<span class="id">g</span>: <span class="id"><a href="RTLgenspec.html#A">A</a></span> -&gt; <span class="id">mon</span> <span class="id"><a href="RTLgenspec.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span>: <span class="id"><a href="RTLgenspec.html#B">B</a></span>) (<span class="id">s1</span> <span class="id">s3</span>: <span class="id">state</span>) (<span class="id">i</span>: <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s3">s3</a></span>),<br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id"><a href="RTLgenspec.html#f">f</a></span> <span class="id"><a href="RTLgenspec.html#g">g</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#y">y</a></span> <span class="id"><a href="RTLgenspec.html#s3">s3</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>, <span class="id">exists</span> <span class="id">s2</span>, <span class="id">exists</span> <span class="id">i1</span>, <span class="id">exists</span> <span class="id">i2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#f">f</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#x">x</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i1">i1</a></span> /\ <span class="id"><a href="RTLgenspec.html#g">g</a></span> <span class="id"><a href="RTLgenspec.html#x">x</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#y">y</a></span> <span class="id"><a href="RTLgenspec.html#s3">s3</a></span> <span class="id"><a href="RTLgenspec.html#i2">i2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2457')">Proof.</div>
<div class="proofscript" id="proof2457">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">i</span>. <span class="tactic">unfold</span> <span class="id">bind</span>. <span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">s1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>; <span class="id">exists</span> <span class="id">s</span>'; <span class="id">exists</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">g</span> <span class="id">a</span> <span class="id">s</span>'); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bind2_inversion">bind2_inversion</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id">mon</span> (<span class="id"><a href="RTLgenspec.html#A">A</a></span>*<span class="id"><a href="RTLgenspec.html#B">B</a></span>)) (<span class="id">g</span>: <span class="id"><a href="RTLgenspec.html#A">A</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#B">B</a></span> -&gt; <span class="id">mon</span> <span class="id"><a href="RTLgenspec.html#C">C</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">z</span>: <span class="id"><a href="RTLgenspec.html#C">C</a></span>) (<span class="id">s1</span> <span class="id">s3</span>: <span class="id">state</span>) (<span class="id">i</span>: <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s3">s3</a></span>),<br/>
&nbsp;&nbsp;<span class="id">bind2</span> <span class="id"><a href="RTLgenspec.html#f">f</a></span> <span class="id"><a href="RTLgenspec.html#g">g</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#z">z</a></span> <span class="id"><a href="RTLgenspec.html#s3">s3</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>, <span class="id">exists</span> <span class="id">y</span>, <span class="id">exists</span> <span class="id">s2</span>, <span class="id">exists</span> <span class="id">i1</span>, <span class="id">exists</span> <span class="id">i2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#f">f</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#x">x</a></span>, <span class="id"><a href="RTLgenspec.html#y">y</a></span>) <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i1">i1</a></span> /\ <span class="id"><a href="RTLgenspec.html#g">g</a></span> <span class="id"><a href="RTLgenspec.html#x">x</a></span> <span class="id"><a href="RTLgenspec.html#y">y</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#z">z</a></span> <span class="id"><a href="RTLgenspec.html#s3">s3</a></span> <span class="id"><a href="RTLgenspec.html#i2">i2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2458')">Proof.</div>
<div class="proofscript" id="proof2458">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">bind2</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#bind_inversion">bind_inversion</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [[<span class="id">x</span> <span class="id">y</span>] [<span class="id">s2</span> [<span class="id">i1</span> [<span class="id">i2</span> [<span class="id">P</span> <span class="id">Q</span>]]]]]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Q</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>; <span class="id">exists</span> <span class="id">y</span>; <span class="id">exists</span> <span class="id">s2</span>; <span class="id">exists</span> <span class="id">i1</span>; <span class="id">exists</span> <span class="id">i2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">monadInv1</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| (<span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span><br/>
&nbsp;&nbsp;| (<span class="id">Error</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;| (<span class="id">ret</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span><br/>
&nbsp;&nbsp;| (<span class="id">error</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;| (<span class="id">bind</span> ?<span class="id">F</span> ?<span class="id">G</span> ?<span class="id">S</span> = <span class="id">OK</span> ?<span class="id">X</span> ?<span class="id">S</span>' ?<span class="id">I</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="tactic">fresh</span> "<span class="id">x</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> := <span class="tactic">fresh</span> "<span class="id">s</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i1</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i2</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">EQ1</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">EQ2</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="RTLgenspec.html#bind_inversion">bind_inversion</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span> <span class="id">G</span> <span class="id">X</span> <span class="id">S</span> <span class="id">S</span>' <span class="id">I</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">s</span> [<span class="id">i1</span> [<span class="id">i2</span> [<span class="id">EQ1</span> <span class="id">EQ2</span>]]]]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">monadInv1</span> <span class="id">EQ2</span>)))))))<br/>
&nbsp;&nbsp;| (<span class="id">bind2</span> ?<span class="id">F</span> ?<span class="id">G</span> ?<span class="id">S</span> = <span class="id">OK</span> ?<span class="id">X</span> ?<span class="id">S</span>' ?<span class="id">I</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x1</span> := <span class="tactic">fresh</span> "<span class="id">x</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x2</span> := <span class="tactic">fresh</span> "<span class="id">x</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> := <span class="tactic">fresh</span> "<span class="id">s</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i1</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i2</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">EQ1</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">EQ2</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="RTLgenspec.html#bind2_inversion">bind2_inversion</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span> <span class="id">G</span> <span class="id">X</span> <span class="id">S</span> <span class="id">S</span>' <span class="id">I</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">x1</span> [<span class="id">x2</span> [<span class="id">s</span> [<span class="id">i1</span> [<span class="id">i2</span> [<span class="id">EQ1</span> <span class="id">EQ2</span>]]]]]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">monadInv1</span> <span class="id">EQ2</span>))))))))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">monadInv</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| (<span class="id">ret</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt; <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (<span class="id">error</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt; <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (<span class="id">bind</span> ?<span class="id">F</span> ?<span class="id">G</span> ?<span class="id">S</span> = <span class="id">OK</span> ?<span class="id">X</span> ?<span class="id">S</span>' ?<span class="id">I</span>) =&gt; <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (<span class="id">bind2</span> ?<span class="id">F</span> ?<span class="id">G</span> ?<span class="id">S</span> = <span class="id">OK</span> ?<span class="id">X</span> ?<span class="id">S</span>' ?<span class="id">I</span>) =&gt; <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> = <span class="id">OK</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h1> Monotonicity properties of the state </h1>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">state_incr_refl</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="instr_at_incr">instr_at_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">n</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>)!<span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>)!<span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2459')">Proof.</div>
<div class="proofscript" id="proof2459">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H3</span> <span class="id">n</span>); <span class="tactic">congruence</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">instr_at_incr</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">The following tactic saturates the hypotheses with
  <span class="bracket"><span class="id">state_incr</span></span> properties that follow by transitivity from
  the known hypotheses. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">saturateTrans</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H1</span>: <span class="id">state_incr</span> ?<span class="id">x</span> ?<span class="id">y</span>, <span class="id">H2</span>: <span class="id">state_incr</span> ?<span class="id">y</span> ?<span class="id">z</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">state_incr</span> <span class="id">x</span> <span class="id">z</span> |- <span class="id">_</span>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">generalize</span> (<span class="id">state_incr_trans</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H1</span> <span class="id">H2</span>); <span class="tactic">intro</span> <span class="id">i</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">saturateTrans</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h1> Validity and freshness of registers </h1>
<br/>
<div class="doc">An RTL pseudo-register is valid in a given state if it was created
  earlier, that is, it is less than the next fresh register of the state.
  Otherwise, the pseudo-register is said to be fresh. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="reg_valid">reg_valid</a></span> (<span class="id">r</span>: <span class="id"><a href="Registers.html#reg">reg</a></span>) (<span class="id">s</span>: <span class="id">state</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.(<span class="id">st_nextreg</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="reg_fresh">reg_fresh</a></span> (<span class="id">r</span>: <span class="id"><a href="Registers.html#reg">reg</a></span>) (<span class="id">s</span>: <span class="id">state</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;~(<span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.(<span class="id">st_nextreg</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="valid_fresh_absurd">valid_fresh_absurd</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>, <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2460')">Proof.</div>
<div class="proofscript" id="proof2460">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span> <span class="id">s</span>. <span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span>, <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span>; <span class="tactic">case</span> <span class="id">r</span>; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_fresh_absurd</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="valid_fresh_different">valid_fresh_different</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r1</span> <span class="id">r2</span> <span class="id">s</span>, <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r1">r1</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r2">r2</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#r1">r1</a></span> &lt;&gt; <span class="id"><a href="RTLgenspec.html#r2">r2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2461')">Proof.</div>
<div class="proofscript" id="proof2461">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span>; <span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">r2</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_fresh_different</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reg_valid_incr">reg_valid_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2462')">Proof.</div>
<div class="proofscript" id="proof2462">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">INCR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INCR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span>. <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Plt_Ple_trans">Plt_Ple_trans</a></span> <span class="kwd">with</span> (<span class="id">st_nextreg</span> <span class="id">s1</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reg_valid_incr</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reg_fresh_decr">reg_fresh_decr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2463')">Proof.</div>
<div class="proofscript" id="proof2463">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">INCR</span>. <span class="tactic">inversion</span> <span class="id">INCR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Plt_Ple_trans">Plt_Ple_trans</a></span> <span class="kwd">with</span> (<span class="id">st_nextreg</span> <span class="id">s1</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reg_fresh_decr</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">Validity of a list of registers. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="regs_valid">regs_valid</a></span> (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span>) (<span class="id">s</span>: <span class="id">state</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="regs_valid_nil">regs_valid_nil</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2464')">Proof.</div>
<div class="proofscript" id="proof2464">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">H</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">regs_valid_nil</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="regs_valid_cons">regs_valid_cons</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r1</span> <span class="id">rl</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r1">r1</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> (<span class="id"><a href="RTLgenspec.html#r1">r1</a></span> :: <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>) <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2465')">Proof.</div>
<div class="proofscript" id="proof2465">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">r1</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="regs_valid_app">regs_valid_app</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rl1</span> <span class="id">rl2</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl1">rl1</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl2">rl2</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> (<span class="id"><a href="RTLgenspec.html#rl1">rl1</a></span> ++ <span class="id"><a href="RTLgenspec.html#rl2">rl2</a></span>) <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2466')">Proof.</div>
<div class="proofscript" id="proof2466">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="regs_valid_incr">regs_valid_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">rl</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2467')">Proof.</div>
<div class="proofscript" id="proof2467">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">regs_valid_incr</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">A register is ``in'' a mapping if it is associated with a Cminor
  local or let-bound variable. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="reg_in_map">reg_in_map</a></span> (<span class="id">m</span>: <span class="id">mapping</span>) (<span class="id">r</span>: <span class="id"><a href="Registers.html#reg">reg</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">id</span>, <span class="id"><a href="RTLgenspec.html#m">m</a></span>.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#m">m</a></span>.(<span class="id">map_letvars</span>).<br/>
<br/>
<div class="doc">A compilation environment (mapping) is valid in a given state if
  the registers associated with Cminor local variables and let-bound variables
  are valid in the state. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="map_valid">map_valid</a></span> (<span class="id">m</span>: <span class="id">mapping</span>) (<span class="id">s</span>: <span class="id">state</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#m">m</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="map_valid_incr">map_valid_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;<span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#m">m</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#m">m</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2468')">Proof.</div>
<div class="proofscript" id="proof2468">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">map_valid_incr</span>: <span class="id">rtlg</span>.<br/>
<br/>
<h1> Properties of basic operations over the state </h1>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">add_instr</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_instr_at">add_instr_at</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">incr</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">add_instr</span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#incr">incr</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>)!<span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2469')">Proof.</div>
<div class="proofscript" id="proof2469">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">add_instr_at</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">update_instr</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="update_instr_at">update_instr_at</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">incr</span> <span class="id">u</span>,<br/>
&nbsp;&nbsp;<span class="id">update_instr</span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#u">u</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#incr">incr</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>)!<span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2470')">Proof.</div>
<div class="proofscript" id="proof2470">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">update_instr</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#plt">plt</a></span> <span class="id">n</span> (<span class="id">st_nextnode</span> <span class="id">s1</span>)); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">check_empty_node</span> <span class="id">s1</span> <span class="id">n</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">update_instr_at</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">new_reg</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="new_reg_valid">new_reg_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">new_reg</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2471')">Proof.</div>
<div class="proofscript" id="proof2471">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Plt_succ">Plt_succ</a></span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">new_reg_valid</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="new_reg_fresh">new_reg_fresh</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">new_reg</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2472')">Proof.</div>
<div class="proofscript" id="proof2472">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="Coqlib.html#Plt_strict">Plt_strict</a></span> <span class="id">_</span>).<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">new_reg_fresh</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="new_reg_not_in_map">new_reg_not_in_map</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">m</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">new_reg</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#m">m</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt; ~(<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#m">m</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2473')">Proof.</div>
<div class="proofscript" id="proof2473">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">new_reg_not_in_map</span>: <span class="id">rtlg</span>.<br/>
<br/>
<h1> Properties of operations over compilation environments </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="init_mapping_valid">init_mapping_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id">init_mapping</span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2474')">Proof.</div>
<div class="proofscript" id="proof2474">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span>, <span class="id">init_mapping</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">r</span> [[<span class="id">id</span> <span class="id">A</span>] | <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gempty">PTree.gempty</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">find_var</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_var_in_map">find_var_in_map</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">name</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">find_var</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#name">name</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2475')">Proof.</div>
<div class="proofscript" id="proof2475">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">r</span>. <span class="tactic">unfold</span> <span class="id">find_var</span>; <span class="id">caseEq</span> (<span class="id">map</span>.(<span class="id">map_vars</span>)!<span class="id">name</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">left</span>; <span class="id">exists</span> <span class="id">name</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_var_in_map</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_var_valid">find_var_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">name</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">find_var</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#name">name</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2476')">Proof.</div>
<div class="proofscript" id="proof2476">
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_var_valid</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">find_letvar</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_letvar_in_map">find_letvar_in_map</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">idx</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">find_letvar</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#idx">idx</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2477')">Proof.</div>
<div class="proofscript" id="proof2477">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">r</span>. <span class="tactic">unfold</span> <span class="id">find_letvar</span>.<br/>
&nbsp;&nbsp;<span class="id">caseEq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id">map_letvars</span> <span class="id">map</span>) <span class="id">idx</span>); <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#nth_error_in">nth_error_in</a></span> <span class="kwd">with</span> <span class="id">idx</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_letvar_in_map</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_letvar_valid">find_letvar_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">idx</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">find_letvar</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#idx">idx</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2478')">Proof.</div>
<div class="proofscript" id="proof2478">
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">find_letvar_valid</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">add_var</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_var_valid">add_var_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map1</span> <span class="id">map2</span> <span class="id">name</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">add_var</span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#name">name</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#r">r</a></span>, <span class="id"><a href="RTLgenspec.html#map2">map2</a></span>) <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> /\ <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map2">map2</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2479')">Proof.</div>
<div class="proofscript" id="proof2479">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ</span>. <span class="tactic">subst</span>. <span class="tactic">red</span>. <span class="tactic">intros</span> <span class="id">r</span>' [[<span class="id">id</span> <span class="id">A</span>] | <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gsspec">PTree.gsspec</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">id</span> <span class="id">name</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">A</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#reg_valid_incr">reg_valid_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="id">left</span>; <span class="id">exists</span> <span class="id">id</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#reg_valid_incr">reg_valid_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="id">right</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_var_find">add_var_find</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">name</span> <span class="id">r</span> <span class="id">map</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">add_var</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#name">name</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#r">r</a></span>,<span class="id">map</span>') <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id">map</span>'.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#name">name</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2480')">Proof.</div>
<div class="proofscript" id="proof2480">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_vars_valid">add_vars_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">namel</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map1</span> <span class="id">map2</span> <span class="id">rl</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">add_vars</span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#namel">namel</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#rl">rl</a></span>, <span class="id"><a href="RTLgenspec.html#map2">map2</a></span>) <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> /\ <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map2">map2</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2481')">Proof.</div>
<div class="proofscript" id="proof2481">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">namel</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">tauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHnamel</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#add_var_valid">add_var_valid</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_var_letenv">add_var_letenv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map1</span> <span class="id">id</span> <span class="id">s1</span> <span class="id">r</span> <span class="id">map2</span> <span class="id">s2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">add_var</span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#r">r</a></span>, <span class="id"><a href="RTLgenspec.html#map2">map2</a></span>) <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map2">map2</a></span>.(<span class="id">map_letvars</span>) = <span class="id"><a href="RTLgenspec.html#map1">map1</a></span>.(<span class="id">map_letvars</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2482')">Proof.</div>
<div class="proofscript" id="proof2482">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_vars_letenv">add_vars_letenv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">il</span> <span class="id">map1</span> <span class="id">s1</span> <span class="id">rl</span> <span class="id">map2</span> <span class="id">s2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">add_vars</span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#il">il</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#rl">rl</a></span>, <span class="id"><a href="RTLgenspec.html#map2">map2</a></span>) <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map2">map2</a></span>.(<span class="id">map_letvars</span>) = <span class="id"><a href="RTLgenspec.html#map1">map1</a></span>.(<span class="id">map_letvars</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2483')">Proof.</div>
<div class="proofscript" id="proof2483">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">il</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">map_letvars</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#add_var_letenv">add_var_letenv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">add_letvar</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_letvar_valid">add_letvar_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">s</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> (<span class="id">add_letvar</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2484')">Proof.</div>
<div class="proofscript" id="proof2484">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [[<span class="id">id</span> <span class="id">A</span>]|<span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="id">left</span>; <span class="id">exists</span> <span class="id">id</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">elim</span> <span class="id">B</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">r0</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="id">right</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Properties of <span class="bracket"><span class="id">alloc_reg</span></span> and <span class="bracket"><span class="id">alloc_regs</span></span> </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_reg_valid">alloc_reg_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_reg</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2485')">Proof.</div>
<div class="proofscript" id="proof2485">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">r</span>.  <span class="tactic">unfold</span> <span class="id">alloc_reg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">case</span> <span class="id">a</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">alloc_reg_valid</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_reg_fresh_or_in_map">alloc_reg_fresh_or_in_map</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">a</span> <span class="id">s</span> <span class="id">r</span> <span class="id">s</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_reg</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> \/ <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2486')">Proof.</div>
<div class="proofscript" id="proof2486">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">s</span>'. <span class="tactic">unfold</span> <span class="id">alloc_reg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> (<span class="id">right</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_regs_valid">alloc_regs_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">rl</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_regs</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2487')">Proof.</div>
<div class="proofscript" id="proof2487">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">al</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_nil">regs_valid_nil</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">alloc_regs_valid</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_regs_fresh_or_in_map">alloc_regs_fresh_or_in_map</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">al</span> <span class="id">s</span> <span class="id">rl</span> <span class="id">s</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_regs</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> \/ <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2488')">Proof.</div>
<div class="proofscript" id="proof2488">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">al</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#alloc_reg_fresh_or_in_map">alloc_reg_fresh_or_in_map</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHal</span>. 2: <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#map_valid_incr">map_valid_incr</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">B</span>]. <span class="tactic">auto</span>. <span class="id">right</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_optreg_valid">alloc_optreg_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="kwd">dest</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">r</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_optreg</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="kwd">dest</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2489')">Proof.</div>
<div class="proofscript" id="proof2489">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">r</span>.  <span class="tactic">unfold</span> <span class="id">alloc_reg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">case</span> <span class="kwd">dest</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">alloc_optreg_valid</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_optreg_fresh_or_in_map">alloc_optreg_fresh_or_in_map</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="kwd">dest</span> <span class="id">s</span> <span class="id">r</span> <span class="id">s</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_optreg</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="kwd">dest</span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> \/ <span class="id"><a href="RTLgenspec.html#reg_fresh">reg_fresh</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2490')">Proof.</div>
<div class="proofscript" id="proof2490">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">s</span>'. <span class="tactic">unfold</span> <span class="id">alloc_optreg</span>. <span class="tactic">destruct</span> <span class="kwd">dest</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<div class="doc">A register is an adequate target for holding the value of an
  expression if
<ul>
<li>
 either the register is associated with a Cminor let-bound variable
  or a Cminor local variable;
</li>
<li>
 or the register is not associated with any Cminor variable
  and does not belong to the preserved set <span class="bracket"><span class="id">pr</span></span>. </li>
</ul>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="target_reg_ok">target_reg_ok</a></span> (<span class="id">map</span>: <span class="id">mapping</span>) (<span class="id">pr</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span>): <span class="id"><a href="CminorSel.html#expr">expr</a></span> -&gt; <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="target_reg_var">target_reg_var</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span>.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id">map</span> <span class="id">pr</span> (<span class="id"><a href="CminorSel.html#Evar">Evar</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#r">r</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="target_reg_letvar">target_reg_letvar</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">idx</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">map</span>.(<span class="id">map_letvars</span>) <span class="id"><a href="RTLgenspec.html#idx">idx</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id">map</span> <span class="id">pr</span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="RTLgenspec.html#idx">idx</a></span>) <span class="id"><a href="RTLgenspec.html#r">r</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="target_reg_other">target_reg_other</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~(<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id">pr</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id">map</span> <span class="id">pr</span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="target_regs_ok">target_regs_ok</a></span> (<span class="id">map</span>: <span class="id">mapping</span>) (<span class="id">pr</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span>): <span class="id"><a href="CminorSel.html#exprlist">exprlist</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="target_regs_nil">target_regs_nil</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_regs_ok">target_regs_ok</a></span> <span class="id">map</span> <span class="id">pr</span> <span class="id"><a href="CminorSel.html#Enil">Enil</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="target_regs_cons">target_regs_cons</a></span>: <span class="kwd">forall</span> <span class="id">a1</span> <span class="id">al</span> <span class="id">r1</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id">map</span> <span class="id">pr</span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#r1">r1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_regs_ok">target_regs_ok</a></span> <span class="id">map</span> (<span class="id"><a href="RTLgenspec.html#r1">r1</a></span> :: <span class="id">pr</span>) <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_regs_ok">target_regs_ok</a></span> <span class="id">map</span> <span class="id">pr</span> (<span class="id"><a href="CminorSel.html#Econs">Econs</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span>) (<span class="id"><a href="RTLgenspec.html#r1">r1</a></span> :: <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="target_reg_ok_append">target_reg_ok_append</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pr</span>',<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">r</span>' <span class="id">pr</span>' -&gt; <span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id">r</span>' \/ <span class="id">r</span>' &lt;&gt; <span class="id"><a href="RTLgenspec.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id">pr</span>' ++ <span class="id"><a href="RTLgenspec.html#pr">pr</a></span>) <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2491')">Proof.</div>
<div class="proofscript" id="proof2491">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_or">in_app_or</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">H3</span>). <span class="tactic">tauto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="target_reg_ok_cons">target_reg_ok_cons</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id">r</span>' \/ <span class="id">r</span>' &lt;&gt; <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id">r</span>' :: <span class="id"><a href="RTLgenspec.html#pr">pr</a></span>) <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2492')">Proof.</div>
<div class="proofscript" id="proof2492">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> (<span class="id">r</span>' :: <span class="id">pr</span>) <span class="kwd">with</span> ((<span class="id">r</span>' :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) ++ <span class="id">pr</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#target_reg_ok_append">target_reg_ok_append</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">r</span>'' [<span class="id">A</span>|<span class="id">B</span>]. <span class="tactic">subst</span> <span class="id">r</span>''; <span class="tactic">auto</span>. <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="new_reg_target_ok">new_reg_target_ok</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">s1</span> <span class="id">a</span> <span class="id">r</span> <span class="id">s2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">new_reg</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2493')">Proof.</div>
<div class="proofscript" id="proof2493">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#valid_fresh_absurd">valid_fresh_absurd</a></span> <span class="kwd">with</span> <span class="id">r</span> <span class="id">s1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#valid_fresh_absurd">valid_fresh_absurd</a></span> <span class="kwd">with</span> <span class="id">r</span> <span class="id">s1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_reg_target_ok">alloc_reg_target_ok</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">s1</span> <span class="id">a</span> <span class="id">r</span> <span class="id">s2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_reg</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2494')">Proof.</div>
<div class="proofscript" id="proof2494">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">alloc_reg</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">a</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#new_reg_target_ok">new_reg_target_ok</a></span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;Evar&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H1</span>; <span class="tactic">unfold</span> <span class="id">find_var</span>. <span class="id">caseEq</span> (<span class="id">map_vars</span> <span class="id">map</span>)!<span class="id">i0</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;Elet&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H1</span>; <span class="tactic">unfold</span> <span class="id">find_letvar</span>. <span class="id">caseEq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id">map_letvars</span> <span class="id">map</span>) <span class="id">n</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_regs_target_ok">alloc_regs_target_ok</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">al</span> <span class="id">pr</span> <span class="id">s1</span> <span class="id">rl</span> <span class="id">s2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_regs</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#target_regs_ok">target_regs_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2495')">Proof.</div>
<div class="proofscript" id="proof2495">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">al</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#alloc_reg_target_ok">alloc_reg_target_ok</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHal</span> <span class="kwd">with</span> <span class="id">s</span> <span class="id">s2</span> <span class="id">INCR1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">new_reg_target_ok</span> <span class="id">alloc_reg_target_ok</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">alloc_regs_target_ok</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc">The following predicate is a variant of <span class="bracket"><span class="id">target_reg_ok</span></span> used
  to characterize registers that are adequate for holding the return
  value of a function. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="return_reg_ok">return_reg_ok</a></span>: <span class="id">state</span> -&gt; <span class="id">mapping</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="return_reg_ok_none">return_reg_ok_none</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">map</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#return_reg_ok">return_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="return_reg_ok_some">return_reg_ok_some</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">map</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~(<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) -&gt; <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#return_reg_ok">return_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="return_reg_ok_incr">return_reg_ok_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">map</span> <span class="id">rret</span>, <span class="id"><a href="RTLgenspec.html#return_reg_ok">return_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>', <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="RTLgenspec.html#return_reg_ok">return_reg_ok</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2496')">Proof.</div>
<div class="proofscript" id="proof2496">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">return_reg_ok_incr</span>: <span class="id">rtlg</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="new_reg_return_ok">new_reg_return_ok</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">r</span> <span class="id">s2</span> <span class="id">map</span> <span class="id">sig</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">new_reg</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#return_reg_ok">return_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id">ret_reg</span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2497')">Proof.</div>
<div class="proofscript" id="proof2497">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">ret_reg</span>. <span class="tactic">destruct</span> (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sig</span>); <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<h1> Relational specification of the translation </h1>
<br/>
<div class="doc">We now define inductive predicates that characterize the fact that
  the control-flow graph produced by compilation of a Cminor function
  contains sub-graphs that correspond to the translation of each
  Cminor expression or statement in the original code. </div>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_move</span> <span class="id">c</span> <span class="id">ns</span> <span class="id">rs</span> <span class="id">nd</span> <span class="id">rd</span></span> holds if the graph <span class="bracket"><span class="id">c</span></span>, between nodes <span class="bracket"><span class="id">ns</span></span>
  and <span class="bracket"><span class="id">nd</span></span>, contains instructions that move the value of register <span class="bracket"><span class="id">rs</span></span>
  to register <span class="bracket"><span class="id">rd</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_move">tr_move</a></span> (<span class="id">c</span>: <span class="id"><a href="RTL.html#code">code</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_move_0">tr_move_0</a></span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_move_1">tr_move_1</a></span>: <span class="kwd">forall</span> <span class="id">ns</span> <span class="id">rs</span> <span class="id">nd</span> <span class="id">rd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#ns">ns</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Iop">Iop</a></span> <span class="id"><a href="Op.html#Omove">Omove</a></span> (<span class="id"><a href="RTLgenspec.html#rs">rs</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#rs">rs</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">reg_map_ok</span> <span class="id">map</span> <span class="id">r</span> <span class="id">optid</span></span> characterizes the destination register
  for an expression: if <span class="bracket"><span class="id">optid</span></span> is <span class="bracket"><span class="id">None</span></span>, the destination is
  a fresh register (not associated with any variable);
  if <span class="bracket"><span class="id">optid</span></span> is <span class="bracket"><span class="id">Some</span> <span class="id">id</span></span>, the destination is the register
  associated with local variable <span class="bracket"><span class="id">id</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="reg_map_ok">reg_map_ok</a></span>: <span class="id">mapping</span> -&gt; <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="AST.html#ident">ident</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="reg_map_ok_novar">reg_map_ok_novar</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">rd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="reg_map_ok_somevar">reg_map_ok_somevar</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">rd</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map">map</a></span>.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>).<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">reg_map_ok_novar</span>: <span class="id">rtlg</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_expr</span> <span class="id">c</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">expr</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">optid</span></span> holds if the graph <span class="bracket"><span class="id">c</span></span>,
  between nodes <span class="bracket"><span class="id">ns</span></span> and <span class="bracket"><span class="id">nd</span></span>, contains instructions that compute the
  value of the CminorSel expression <span class="bracket"><span class="id">expr</span></span> and deposit this value in
  register <span class="bracket"><span class="id">rd</span></span>.  <span class="bracket"><span class="id">map</span></span> is a mapping from Cminor variables to the
  corresponding RTL registers.  <span class="bracket"><span class="id">pr</span></span> is a list of RTL registers whose
  values must be preserved during this computation.  All registers
  mentioned in <span class="bracket"><span class="id">map</span></span> must also be preserved during this computation.
  (Exception: if <span class="bracket"><span class="id">optid</span> = <span class="id">Some</span> <span class="id">id</span></span>, the register associated with
  local variable <span class="bracket"><span class="id">id</span></span> can be assigned, but only at the end of the
  expression evaluation.)
  To ensure this property, we demand that the result registers of the
  instructions appearing on the path from <span class="bracket"><span class="id">ns</span></span> to <span class="bracket"><span class="id">nd</span></span> are not in <span class="bracket"><span class="id">pr</span></span>,
  and moreover that they satisfy the <span class="bracket"><span class="id">reg_map_ok</span></span> predicate.
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_expr">tr_expr</a></span> (<span class="id">c</span>: <span class="id"><a href="RTL.html#code">code</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mapping</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="CminorSel.html#expr">expr</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="AST.html#ident">ident</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Evar">tr_Evar</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">id</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">r</span> <span class="id">rd</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map">map</a></span>.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="RTLgenspec.html#rd">rd</a></span> = <span class="id"><a href="RTLgenspec.html#r">r</a></span> /\ <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) \/ (<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> /\ ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Evar">Evar</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Eop">tr_Eop</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">op</span> <span class="id">al</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">n1</span> <span class="id">rl</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Iop">Iop</a></span> <span class="id"><a href="RTLgenspec.html#op">op</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Eop">Eop</a></span> <span class="id"><a href="RTLgenspec.html#op">op</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Eload">tr_Eload</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">al</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">n1</span> <span class="id">rl</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Iload">Iload</a></span> <span class="id"><a href="RTLgenspec.html#chunk">chunk</a></span> <span class="id"><a href="RTLgenspec.html#addr">addr</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Eload">Eload</a></span> <span class="id"><a href="RTLgenspec.html#chunk">chunk</a></span> <span class="id"><a href="RTLgenspec.html#addr">addr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Econdition">tr_Econdition</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">ifso</span> <span class="id">ifnot</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">ntrue</span> <span class="id">nfalse</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#ifso">ifso</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#ifnot">ifnot</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Econdition">Econdition</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ifso">ifso</a></span> <span class="id"><a href="RTLgenspec.html#ifnot">ifnot</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Elet">tr_Elet</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">n1</span> <span class="id">r</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#b1">b1</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> (<span class="id">add_letvar</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#b2">b2</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Elet">Elet</a></span> <span class="id"><a href="RTLgenspec.html#b1">b1</a></span> <span class="id"><a href="RTLgenspec.html#b2">b2</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Eletvar">tr_Eletvar</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">n</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">r</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">List.nth_error</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span>.(<span class="id">map_letvars</span>) <span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="RTLgenspec.html#rd">rd</a></span> = <span class="id"><a href="RTLgenspec.html#r">r</a></span> /\ <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) \/ (<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> /\ ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Ebuiltin">tr_Ebuiltin</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">ef</span> <span class="id">al</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">dst</span> <span class="id">n1</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Ibuiltin">Ibuiltin</a></span> <span class="id"><a href="RTLgenspec.html#ef">ef</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="AST.html#BA">BA</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span>) <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>) (<span class="id"><a href="AST.html#BR">BR</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span>) <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Ebuiltin">Ebuiltin</a></span> <span class="id"><a href="RTLgenspec.html#ef">ef</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Eexternal">tr_Eexternal</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">id</span> <span class="id">sg</span> <span class="id">al</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">dst</span> <span class="id">n1</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Icall">Icall</a></span> <span class="id"><a href="RTLgenspec.html#sg">sg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt; ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Eexternal">Eexternal</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span> <span class="id"><a href="RTLgenspec.html#sg">sg</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_condition</span> <span class="id">c</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">ntrue</span> <span class="id">nfalse</span></span> holds if the graph <span class="bracket"><span class="id">c</span></span>,
  starting at node <span class="bracket"><span class="id">ns</span></span>, contains instructions that compute the truth
  value of the CminorSel conditional expression <span class="bracket"><span class="id">a</span></span> and terminate
  on node <span class="bracket"><span class="id">ntrue</span></span> if the condition holds and on node <span class="bracket"><span class="id">nfalse</span></span> otherwise. </div>
<br/>
<span class="kwd">with</span> <span class="id"><a name="tr_condition">tr_condition</a></span> (<span class="id">c</span>: <span class="id">code</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mapping</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="CminorSel.html#condexpr">condexpr</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_CEcond">tr_CEcond</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">cond</span> <span class="id">bl</span> <span class="id">ns</span> <span class="id">ntrue</span> <span class="id">nfalse</span> <span class="id">n1</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#bl">bl</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Icond">Icond</a></span> <span class="id"><a href="RTLgenspec.html#cond">cond</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#CEcond">CEcond</a></span> <span class="id"><a href="RTLgenspec.html#cond">cond</a></span> <span class="id"><a href="RTLgenspec.html#bl">bl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_CEcondition">tr_CEcondition</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">a3</span> <span class="id">ns</span> <span class="id">ntrue</span> <span class="id">nfalse</span> <span class="id">n2</span> <span class="id">n3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#n3">n3</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a2">a2</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a3">a3</a></span> <span class="id"><a href="RTLgenspec.html#n3">n3</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#CEcondition">CEcondition</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#a2">a2</a></span> <span class="id"><a href="RTLgenspec.html#a3">a3</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_CElet">tr_CElet</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ns</span> <span class="id">ntrue</span> <span class="id">nfalse</span> <span class="id">r</span> <span class="id">n1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> (<span class="id">add_letvar</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#CElet">CElet</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span><br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_exprlist</span> <span class="id">c</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">exprs</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rds</span></span> holds if the graph <span class="bracket"><span class="id">c</span></span>,
  between nodes <span class="bracket"><span class="id">ns</span></span> and <span class="bracket"><span class="id">nd</span></span>, contains instructions that compute the values
  of the list of CminorSel expression <span class="bracket"><span class="id">exprlist</span></span> and deposit these values
  in registers <span class="bracket"><span class="id">rds</span></span>. </div>
<br/>
<span class="kwd">with</span> <span class="id"><a name="tr_exprlist">tr_exprlist</a></span> (<span class="id">c</span>: <span class="id">code</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mapping</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="CminorSel.html#exprlist">exprlist</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Enil">tr_Enil</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="CminorSel.html#Enil">Enil</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Econs">tr_Econs</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a1</span> <span class="id">al</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">r1</span> <span class="id">rl</span> <span class="id">n1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#r1">r1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="RTLgenspec.html#r1">r1</a></span> :: <span class="id"><a href="RTLgenspec.html#pr">pr</a></span>) <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> (<span class="id"><a href="CminorSel.html#Econs">Econs</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> (<span class="id"><a href="RTLgenspec.html#r1">r1</a></span> :: <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>).<br/>
<br/>
<div class="doc">Auxiliary for the compilation of <span class="bracket"><span class="id">switch</span></span> statements. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tr_jumptable">tr_jumptable</a></span> (<span class="id">nexits</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="RTL.html#node">node</a></span>) (<span class="id">tbl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ttbl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="RTL.html#node">node</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">act</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_nth_z">list_nth_z</a></span> <span class="id"><a href="RTLgenspec.html#tbl">tbl</a></span> <span class="id"><a href="RTLgenspec.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#act">act</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Coqlib.html#list_nth_z">list_nth_z</a></span> <span class="id"><a href="RTLgenspec.html#ttbl">ttbl</a></span> <span class="id"><a href="RTLgenspec.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#act">act</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_exitexpr</span> <span class="id">c</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">nexits</span></span> holds if the graph <span class="bracket"><span class="id">c</span></span>,
  starting at node <span class="bracket"><span class="id">ns</span></span>, contains instructions that compute the exit
  number of the CminorSel exit expression <span class="bracket"><span class="id">a</span></span> and terminate
  on the node corresponding to this exit number according to the
  mapping <span class="bracket"><span class="id">nexits</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_exitexpr">tr_exitexpr</a></span> (<span class="id">c</span>: <span class="id"><a href="RTL.html#code">code</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mapping</span> -&gt; <span class="id"><a href="CminorSel.html#exitexpr">exitexpr</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_XEcond">tr_XEcond</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">x</span> <span class="id">n</span> <span class="id">nexits</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="CminorSel.html#XEexit">XEexit</a></span> <span class="id"><a href="RTLgenspec.html#x">x</a></span>) <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_XEjumptable">tr_XEjumptable</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">a</span> <span class="id">tbl</span> <span class="id">ns</span> <span class="id">nexits</span> <span class="id">n1</span> <span class="id">r</span> <span class="id">tbl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_jumptable">tr_jumptable</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#tbl">tbl</a></span> <span class="id">tbl</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Ijumptable">Ijumptable</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id">tbl</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="CminorSel.html#XEjumptable">XEjumptable</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#tbl">tbl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_XEcondition">tr_XEcondition</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">a3</span> <span class="id">ns</span> <span class="id">nexits</span> <span class="id">n2</span> <span class="id">n3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#n3">n3</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a2">a2</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a3">a3</a></span> <span class="id"><a href="RTLgenspec.html#n3">n3</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="CminorSel.html#XEcondition">XEcondition</a></span> <span class="id"><a href="RTLgenspec.html#a1">a1</a></span> <span class="id"><a href="RTLgenspec.html#a2">a2</a></span> <span class="id"><a href="RTLgenspec.html#a3">a3</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_XElet">tr_XElet</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ns</span> <span class="id">nexits</span> <span class="id">r</span> <span class="id">n1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> (<span class="id">add_letvar</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>) <span class="id"><a href="RTLgenspec.html#b">b</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span>.<br/>
<br/>
<div class="doc">Auxiliary for the compilation of <span class="bracket"><span class="id">builtin</span></span> statements. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_builtin_res">tr_builtin_res</a></span>: <span class="id">mapping</span> -&gt; <span class="id"><a href="AST.html#builtin_res">builtin_res</a></span> <span class="id"><a href="AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="AST.html#builtin_res">builtin_res</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_builtin_res_var">tr_builtin_res_var</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">id</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map">map</a></span>.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_builtin_res">tr_builtin_res</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> (<span class="id"><a href="AST.html#BR">BR</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) (<span class="id"><a href="AST.html#BR">BR</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_builtin_res_none">tr_builtin_res_none</a></span>: <span class="kwd">forall</span> <span class="id">map</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_builtin_res">tr_builtin_res</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="AST.html#BR_none">BR_none</a></span> <span class="id"><a href="AST.html#BR_none">BR_none</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_builtin_res_fresh">tr_builtin_res_fresh</a></span>: <span class="kwd">forall</span> <span class="id">map</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_builtin_res">tr_builtin_res</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="AST.html#BR_none">BR_none</a></span> (<span class="id"><a href="AST.html#BR">BR</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span>).<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_stmt</span> <span class="id">c</span> <span class="id">map</span> <span class="id">stmt</span> <span class="id">ns</span> <span class="id">ncont</span> <span class="id">nexits</span> <span class="id">nret</span> <span class="id">rret</span></span> holds if the graph <span class="bracket"><span class="id">c</span></span>,
  starting at node <span class="bracket"><span class="id">ns</span></span>, contains instructions that perform the Cminor
  statement <span class="bracket"><span class="id">stmt</span></span>.   These instructions branch to node <span class="bracket"><span class="id">ncont</span></span> if
  the statement terminates normally, to the <span class="bracket"><span class="id">n</span></span>-th node in <span class="bracket"><span class="id">nexits</span></span>
  if the statement terminates prematurely on a <span class="bracket"><span class="id">exit</span> <span class="id">n</span></span> statement,
  and to <span class="bracket"><span class="id">nret</span></span> if the statement terminates prematurely on a <span class="bracket"><span class="kwd">return</span></span>
  statement.  Moreover, if the <span class="bracket"><span class="kwd">return</span></span> statement has an argument,
  its value is deposited in register <span class="bracket"><span class="id">rret</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_stmt">tr_stmt</a></span> (<span class="id">c</span>: <span class="id"><a href="RTL.html#code">code</a></span>) (<span class="id">map</span>: <span class="id">mapping</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#stmt">stmt</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id">labelmap</span> -&gt; <span class="id"><a href="RTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Registers.html#reg">reg</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sskip">tr_Sskip</a></span>: <span class="kwd">forall</span> <span class="id">ns</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="CminorSel.html#Sskip">Sskip</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sassign">tr_Sassign</a></span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span>.(<span class="id">map_vars</span>)!<span class="id"><a href="RTLgenspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sassign">Sassign</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sstore">tr_Sstore</a></span>: <span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">al</span> <span class="id">b</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">rd</span> <span class="id">n1</span> <span class="id">rl</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Istore">Istore</a></span> <span class="id"><a href="RTLgenspec.html#chunk">chunk</a></span> <span class="id"><a href="RTLgenspec.html#addr">addr</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sstore">Sstore</a></span> <span class="id"><a href="RTLgenspec.html#chunk">chunk</a></span> <span class="id"><a href="RTLgenspec.html#addr">addr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Scall">tr_Scall</a></span>: <span class="kwd">forall</span> <span class="id">optid</span> <span class="id">sig</span> <span class="id">b</span> <span class="id">cl</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">rd</span> <span class="id">n1</span> <span class="id">rf</span> <span class="id">n2</span> <span class="id">rargs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rf">rf</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="RTLgenspec.html#rf">rf</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="RTLgenspec.html#cl">cl</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Icall">Icall</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#rf">rf</a></span>) <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#optid">optid</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Scall">Scall</a></span> <span class="id"><a href="RTLgenspec.html#optid">optid</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#b">b</a></span>) <span class="id"><a href="RTLgenspec.html#cl">cl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Scall_imm">tr_Scall_imm</a></span>: <span class="kwd">forall</span> <span class="id">optid</span> <span class="id">sig</span> <span class="id">id</span> <span class="id">cl</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">rd</span> <span class="id">n2</span> <span class="id">rargs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#cl">cl</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Icall">Icall</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#optid">optid</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Scall">Scall</a></span> <span class="id"><a href="RTLgenspec.html#optid">optid</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#cl">cl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Stailcall">tr_Stailcall</a></span>: <span class="kwd">forall</span> <span class="id">sig</span> <span class="id">b</span> <span class="id">cl</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">n1</span> <span class="id">rf</span> <span class="id">n2</span> <span class="id">rargs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#b">b</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rf">rf</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="RTLgenspec.html#rf">rf</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="RTLgenspec.html#cl">cl</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Itailcall">Itailcall</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#rf">rf</a></span>) <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Stailcall">Stailcall</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#b">b</a></span>) <span class="id"><a href="RTLgenspec.html#cl">cl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Stailcall_imm">tr_Stailcall_imm</a></span>: <span class="kwd">forall</span> <span class="id">sig</span> <span class="id">id</span> <span class="id">cl</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">n2</span> <span class="id">rargs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#cl">cl</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n2">n2</a></span> <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Itailcall">Itailcall</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Stailcall">Stailcall</a></span> <span class="id"><a href="RTLgenspec.html#sig">sig</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>) <span class="id"><a href="RTLgenspec.html#cl">cl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sbuiltin">tr_Sbuiltin</a></span>: <span class="kwd">forall</span> <span class="id">res</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">res</span>' <span class="id">n1</span> <span class="id">rargs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id">exprlist_of_expr_list</span> (<span class="id"><a href="AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="RTLgenspec.html#args">args</a></span>)) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n1">n1</a></span> <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Ibuiltin">Ibuiltin</a></span> <span class="id"><a href="RTLgenspec.html#ef">ef</a></span> (<span class="id">convert_builtin_args</span> <span class="id"><a href="RTLgenspec.html#args">args</a></span> <span class="id"><a href="RTLgenspec.html#rargs">rargs</a></span>) <span class="id">res</span>' <span class="id"><a href="RTLgenspec.html#nd">nd</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_builtin_res">tr_builtin_res</a></span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#res">res</a></span> <span class="id">res</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sbuiltin">Sbuiltin</a></span> <span class="id"><a href="RTLgenspec.html#res">res</a></span> <span class="id"><a href="RTLgenspec.html#ef">ef</a></span> <span class="id"><a href="RTLgenspec.html#args">args</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sseq">tr_Sseq</a></span>: <span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sseq">Sseq</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sifthenelse">tr_Sifthenelse</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">strue</span> <span class="id">sfalse</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">ntrue</span> <span class="id">nfalse</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#strue">strue</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#sfalse">sfalse</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sifthenelse">Sifthenelse</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#strue">strue</a></span> <span class="id"><a href="RTLgenspec.html#sfalse">sfalse</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sloop">tr_Sloop</a></span>: <span class="kwd">forall</span> <span class="id">sbody</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">nloop</span> <span class="id">nend</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#sbody">sbody</a></span> <span class="id"><a href="RTLgenspec.html#nloop">nloop</a></span> <span class="id"><a href="RTLgenspec.html#nend">nend</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#ns">ns</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="RTL.html#Inop">Inop</a></span> <span class="id"><a href="RTLgenspec.html#nloop">nloop</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#nend">nend</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="RTL.html#Inop">Inop</a></span> <span class="id"><a href="RTLgenspec.html#nloop">nloop</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sloop">Sloop</a></span> <span class="id"><a href="RTLgenspec.html#sbody">sbody</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sblock">tr_Sblock</a></span>: <span class="kwd">forall</span> <span class="id">sbody</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#sbody">sbody</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> (<span class="id"><a href="RTLgenspec.html#nd">nd</a></span> :: <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span>) <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sblock">Sblock</a></span> <span class="id"><a href="RTLgenspec.html#sbody">sbody</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sexit">tr_Sexit</a></span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sexit">Sexit</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sswitch">tr_Sswitch</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sswitch">Sswitch</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sreturn_none">tr_Sreturn_none</a></span>: <span class="kwd">forall</span> <span class="id">nret</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sreturn">Sreturn</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sreturn_some">tr_Sreturn_some</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sreturn">Sreturn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span>)) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Slabel">tr_Slabel</a></span>: <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span>!<span class="id"><a href="RTLgenspec.html#lbl">lbl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">c</span>!<span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="RTL.html#Inop">Inop</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Slabel">Slabel</a></span> <span class="id"><a href="RTLgenspec.html#lbl">lbl</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_Sgoto">tr_Sgoto</a></span>: <span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span>!<span class="id"><a href="RTLgenspec.html#lbl">lbl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">c</span> <span class="id">map</span> (<span class="id"><a href="CminorSel.html#Sgoto">Sgoto</a></span> <span class="id"><a href="RTLgenspec.html#lbl">lbl</a></span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tr_function</span> <span class="id">f</span> <span class="id">tf</span></span> specifies the RTL function <span class="bracket"><span class="id">tf</span></span> that
  <span class="bracket"><span class="id">RTLgen.transl_function</span></span> returns.  </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_function">tr_function</a></span>: <span class="id"><a href="CminorSel.html#function">CminorSel.function</a></span> -&gt; <span class="id"><a href="RTL.html#function">RTL.function</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_function_intro">tr_function_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">code</span> <span class="id">rparams</span> <span class="id">map1</span> <span class="id">s0</span> <span class="id">s1</span> <span class="id">i1</span> <span class="id">rvars</span> <span class="id">map2</span> <span class="id">s2</span> <span class="id">i2</span> <span class="id">nentry</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">orret</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">add_vars</span> <span class="id">init_mapping</span> <span class="id"><a href="RTLgenspec.html#f">f</a></span>.(<span class="id"><a href="CminorSel.html#fn_params">CminorSel.fn_params</a></span>) <span class="id"><a href="RTLgenspec.html#s0">s0</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#rparams">rparams</a></span>, <span class="id"><a href="RTLgenspec.html#map1">map1</a></span>) <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#i1">i1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">add_vars</span> <span class="id"><a href="RTLgenspec.html#map1">map1</a></span> <span class="id"><a href="RTLgenspec.html#f">f</a></span>.(<span class="id"><a href="CminorSel.html#fn_vars">CminorSel.fn_vars</a></span>) <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> (<span class="id"><a href="RTLgenspec.html#rvars">rvars</a></span>, <span class="id"><a href="RTLgenspec.html#map2">map2</a></span>) <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i2">i2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#orret">orret</a></span> = <span class="id">ret_reg</span> <span class="id"><a href="RTLgenspec.html#f">f</a></span>.(<span class="id"><a href="CminorSel.html#fn_sig">CminorSel.fn_sig</a></span>) <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id"><a href="RTLgenspec.html#code">code</a></span> <span class="id"><a href="RTLgenspec.html#map2">map2</a></span> <span class="id"><a href="RTLgenspec.html#f">f</a></span>.(<span class="id"><a href="CminorSel.html#fn_body">CminorSel.fn_body</a></span>) <span class="id"><a href="RTLgenspec.html#nentry">nentry</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#orret">orret</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#code">code</a></span>!<span class="id"><a href="RTLgenspec.html#nret">nret</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="RTL.html#Ireturn">Ireturn</a></span> <span class="id"><a href="RTLgenspec.html#orret">orret</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_function">tr_function</a></span> <span class="id"><a href="RTLgenspec.html#f">f</a></span> (<span class="id"><a href="RTL.html#mkfunction">RTL.mkfunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#f">f</a></span>.(<span class="id"><a href="CminorSel.html#fn_sig">CminorSel.fn_sig</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#rparams">rparams</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#f">f</a></span>.(<span class="id"><a href="CminorSel.html#fn_stackspace">CminorSel.fn_stackspace</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#code">code</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#nentry">nentry</a></span>).<br/>
<br/>
<h1> Correctness proof of the translation functions </h1>
<br/>
<div class="doc">We now show that the translation functions in module <span class="bracket"><span class="id">RTLgen</span></span>
  satisfy the specifications given above as inductive predicates. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_move_incr">tr_move_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ns</span> <span class="id">rs</span> <span class="id">nd</span> <span class="id">rd</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#rs">rs</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#rs">rs</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2498')">Proof.</div>
<div class="proofscript" id="proof2498">
&nbsp;&nbsp;<span class="tactic">induction</span> 2; <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_expr_incr">tr_expr_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">dst</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#dst">dst</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="tr_condition_incr">tr_condition_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">ntrue</span> <span class="id">nfalse</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="tr_exprlist_incr">tr_exprlist_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">pr</span> <span class="id">al</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2499')">Proof.</div>
<div class="proofscript" id="proof2499">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">EXT</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">AT</span> := <span class="kwd">fun</span> <span class="id">pc</span> <span class="id">i</span> =&gt; <span class="id"><a href="RTLgenspec.html#instr_at_incr">instr_at_incr</a></span> <span class="id">s1</span> <span class="id">s2</span> <span class="id"><a href="RTLgenspec.html#pc">pc</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> <span class="id">EXT</span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#tr_move_incr">tr_move_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#tr_move_incr">tr_move_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">EXT</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">AT</span> := <span class="kwd">fun</span> <span class="id">pc</span> <span class="id">i</span> =&gt; <span class="id"><a href="RTLgenspec.html#instr_at_incr">instr_at_incr</a></span> <span class="id">s1</span> <span class="id">s2</span> <span class="id"><a href="RTLgenspec.html#pc">pc</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> <span class="id">EXT</span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">EXT</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">AT</span> := <span class="kwd">fun</span> <span class="id">pc</span> <span class="id">i</span> =&gt; <span class="id"><a href="RTLgenspec.html#instr_at_incr">instr_at_incr</a></span> <span class="id">s1</span> <span class="id">s2</span> <span class="id"><a href="RTLgenspec.html#pc">pc</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> <span class="id">EXT</span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_move_charact">add_move_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">rs</span> <span class="id">nd</span> <span class="id">rd</span> <span class="id">s</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id">add_move</span> <span class="id"><a href="RTLgenspec.html#rs">rs</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_move">tr_move</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#rs">rs</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2500')">Proof.</div>
<div class="proofscript" id="proof2500">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">add_move</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Registers.html#Reg.eq">Reg.eq</a></span> <span class="id">rs</span> <span class="id">rd</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_expr_charact">transl_expr_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">map</span> <span class="id">rd</span> <span class="id">nd</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">s</span>' <span class="id">pr</span> <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">transl_expr</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OK</span>: <span class="id"><a href="RTLgenspec.html#target_reg_ok">target_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID</span>: <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID2</span>: <span class="id"><a href="RTLgenspec.html#reg_valid">reg_valid</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="transl_exprlist_charact">transl_exprlist_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">map</span> <span class="id">rl</span> <span class="id">nd</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">s</span>' <span class="id">pr</span> <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">transl_exprlist</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OK</span>: <span class="id"><a href="RTLgenspec.html#target_regs_ok">target_regs_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID1</span>: <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID2</span>: <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exprlist">tr_exprlist</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#al">al</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rl">rl</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="transl_condexpr_charact">transl_condexpr_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">map</span> <span class="id">ntrue</span> <span class="id">nfalse</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">s</span>' <span class="id">pr</span> <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">transl_condexpr</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID</span>: <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_condition">tr_condition</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#pr">pr</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#ntrue">ntrue</a></span> <span class="id"><a href="RTLgenspec.html#nfalse">nfalse</a></span>.<br/>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2501')">Proof.</div>
<div class="proofscript" id="proof2501">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">TR</span>); <span class="id">saturateTrans</span>.<br/>
&nbsp;Evar&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ</span>; <span class="tactic">unfold</span> <span class="id">find_var</span>. <span class="id">caseEq</span> (<span class="id">map_vars</span> <span class="id">map</span>)!<span class="id">i</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">congruence</span>. <span class="id">right</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#add_move_charact">add_move_charact</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;Eop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_exprlist_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Eload&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_exprlist_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Econdition&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_expr_charact</span>; <span class="tactic">eauto</span> 2 <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_expr_charact</span>; <span class="tactic">eauto</span> 2 <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;Elet&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#new_reg_not_in_map">new_reg_not_in_map</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_expr_charact</span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_expr_charact</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#add_letvar_valid">add_letvar_valid</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id"><a href="RTLgenspec.html#reg_in_map">reg_in_map</a></span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> [[<span class="id">id</span> <span class="id">A</span>] | [<span class="id">B</span> | <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>. <span class="id">left</span>; <span class="id">exists</span> <span class="id">id</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">x</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#valid_fresh_absurd">valid_fresh_absurd</a></span> <span class="kwd">with</span> <span class="id">rd</span> <span class="id">s</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>. <span class="id">right</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Eletvar&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ</span>; <span class="tactic">unfold</span> <span class="id">find_letvar</span>. <span class="id">caseEq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id">map_letvars</span> <span class="id">map</span>) <span class="id">n</span>); <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">EQ0</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">congruence</span>. <span class="id">right</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#add_move_charact">add_move_charact</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ1</span>.<br/>
&nbsp;Ebuiltin&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_exprlist_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Eexternal&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_exprlist_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
<br/>
&nbsp;Lists&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">al</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">TR</span>); <span class="id">saturateTrans</span>.<br/>
<br/>
&nbsp;Enil&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">rl</span>; <span class="id">inv</span> <span class="id">TR</span>. <span class="id">constructor</span>.<br/>
&nbsp;Econs&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">rl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">TR</span>; <span class="id">monadInv</span> <span class="id">TR</span>. <span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_expr_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">VALID2</span> <span class="id">r</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_eq">in_eq</a></span> <span class="id">_</span> <span class="id">_</span>)). <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_exprlist_incr">tr_exprlist_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_exprlist_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>. <span class="tactic">apply</span> <span class="id">VALID2</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">VALID2</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
<br/>
&nbsp;Conditional&nbsp;expressions&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">TR</span>); <span class="id">saturateTrans</span>.<br/>
<br/>
&nbsp;CEcond&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eapply</span> <span class="id">transl_exprlist_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;CEcondition&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_condition_incr">tr_condition_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_condition_incr">tr_condition_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;CElet&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_expr_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_condition_incr">tr_condition_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">transl_condexpr_charact</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#add_letvar_valid">add_letvar_valid</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<div class="doc">A variant of <span class="bracket"><span class="id">transl_expr_charact</span></span>, for use when the destination
  register is the one associated with a variable. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_expr_assign_charact">transl_expr_assign_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">a</span> <span class="id">map</span> <span class="id">rd</span> <span class="id">nd</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">s</span>' <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">transl_expr</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OK</span>: <span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_expr">tr_expr</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#rd">rd</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#id">id</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2502')">Proof.</div>
<div class="proofscript" id="proof2502">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">TR</span>; <span class="id">saturateTrans</span>.<br/>
&nbsp;Evar&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ</span>; <span class="tactic">unfold</span> <span class="id">find_var</span>. <span class="id">caseEq</span> (<span class="id">map_vars</span> <span class="id">map</span>)!<span class="id">i</span>; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#add_move_charact">add_move_charact</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;Eop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Eload&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Econdition&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_condexpr_charact">transl_condexpr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHa1</span>; <span class="tactic">eauto</span> 2 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHa2</span>; <span class="tactic">eauto</span> 2 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Elet&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#new_reg_not_in_map">new_reg_not_in_map</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHa2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#add_letvar_valid">add_letvar_valid</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">OK</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;Eletvar&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ</span>; <span class="tactic">unfold</span> <span class="id">find_letvar</span>. <span class="id">caseEq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id">map_letvars</span> <span class="id">map</span>) <span class="id">n</span>); <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">EQ0</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#add_move_charact">add_move_charact</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ1</span>.<br/>
&nbsp;Ebuiltin&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Eexternal&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_optreg_map_ok">alloc_optreg_map_ok</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">optid</span> <span class="id">s1</span> <span class="id">r</span> <span class="id">s2</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_optreg</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#optid">optid</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#reg_map_ok">reg_map_ok</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#r">r</a></span> <span class="id"><a href="RTLgenspec.html#optid">optid</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2503')">Proof.</div>
<div class="proofscript" id="proof2503">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">alloc_optreg</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">optid</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">unfold</span> <span class="id">find_var</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> (<span class="id">map_vars</span> <span class="id">map</span>)!<span class="id">i0</span>; <span class="id">monadInv</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#new_reg_not_in_map">new_reg_not_in_map</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_exitexpr_incr">tr_exitexpr_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">a</span> <span class="id">ns</span> <span class="id">nexits</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2504')">Proof.</div>
<div class="proofscript" id="proof2504">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">EXT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="id"><a href="RTLgenspec.html#tr_condition_incr">tr_condition_incr</a></span>; <span class="tactic">intros</span> <span class="id">I1</span> <span class="id">I2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_stmt_incr">tr_stmt_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">state_incr</span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id"><a href="RTLgenspec.html#s1">s1</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id"><a href="RTLgenspec.html#s2">s2</a></span>.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2505')">Proof.</div>
<div class="proofscript" id="proof2505">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">EXT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="id"><a href="RTLgenspec.html#tr_condition_incr">tr_condition_incr</a></span> <span class="id"><a href="RTLgenspec.html#tr_exprlist_incr">tr_exprlist_incr</a></span> <span class="id"><a href="RTLgenspec.html#tr_exitexpr_incr">tr_exitexpr_incr</a></span>; <span class="tactic">intros</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">AT</span> := <span class="kwd">fun</span> <span class="id">pc</span> <span class="id">i</span> =&gt; <span class="id"><a href="RTLgenspec.html#instr_at_incr">instr_at_incr</a></span> <span class="id">s1</span> <span class="id">s2</span> <span class="id"><a href="RTLgenspec.html#pc">pc</a></span> <span class="id"><a href="RTLgenspec.html#i">i</a></span> <span class="id">EXT</span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_exit_charact">transl_exit_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nexits</span> <span class="id">n</span> <span class="id">s</span> <span class="id">ne</span> <span class="id">s</span>' <span class="id">incr</span>,<br/>
&nbsp;&nbsp;<span class="id">transl_exit</span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ne">ne</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#incr">incr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="RTLgenspec.html#ne">ne</a></span> /\ <span class="id">s</span>' = <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2506')">Proof.</div>
<div class="proofscript" id="proof2506">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">incr</span>. <span class="tactic">unfold</span> <span class="id">transl_exit</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">nexits</span> <span class="id">n</span>); <span class="tactic">intro</span>; <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_jumptable_charact">transl_jumptable_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nexits</span> <span class="id">tbl</span> <span class="id">s</span> <span class="id">nl</span> <span class="id">s</span>' <span class="id">incr</span>,<br/>
&nbsp;&nbsp;<span class="id">transl_jumptable</span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#tbl">tbl</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#nl">nl</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#incr">incr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_jumptable">tr_jumptable</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#tbl">tbl</a></span> <span class="id"><a href="RTLgenspec.html#nl">nl</a></span> /\ <span class="id">s</span>' = <span class="id"><a href="RTLgenspec.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2507')">Proof.</div>
<div class="proofscript" id="proof2507">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tbl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">split</span>. <span class="tactic">red</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span>. <span class="tactic">discriminate</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#transl_exit_charact">transl_exit_charact</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtbl</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">v</span> 0). <span class="id">inv</span> <span class="id">H</span>. <span class="id">exists</span> <span class="id">x</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_exitexpr_charact">transl_exitexpr_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nexits</span> <span class="id">a</span> <span class="id">map</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">s</span>' <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">transl_exitexpr</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_exitexpr">tr_exitexpr</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#a">a</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2508')">Proof.</div>
<div class="proofscript" id="proof2508">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">TR</span>); <span class="id">saturateTrans</span>.<br/>
- <span class="comment">(*&nbsp;XEexit&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#transl_exit_charact">transl_exit_charact</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;XEjumptable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#transl_jumptable_charact">transl_jumptable_charact</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
- <span class="comment">(*&nbsp;XEcondition&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_condexpr_charact">transl_condexpr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_exitexpr_incr">tr_exitexpr_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_exitexpr_incr">tr_exitexpr_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
- <span class="comment">(*&nbsp;XElet&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_exitexpr_incr">tr_exitexpr_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">IHa</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#add_letvar_valid">add_letvar_valid</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="convert_builtin_res_charact">convert_builtin_res_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">oty</span> <span class="id">res</span> <span class="id">s</span> <span class="id">res</span>' <span class="id">s</span>' <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">convert_builtin_res</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#oty">oty</a></span> <span class="id"><a href="RTLgenspec.html#res">res</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id">res</span>' <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_builtin_res">tr_builtin_res</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#res">res</a></span> <span class="id">res</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2509')">Proof.</div>
<div class="proofscript" id="proof2509">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">monadInv</span> <span class="id">TR</span>. <span class="id">constructor</span>.  <span class="tactic">unfold</span> <span class="id">find_var</span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="tactic">destruct</span> (<span class="id">map_vars</span> <span class="id">map</span>)!<span class="id">x</span>; <span class="id">inv</span> <span class="id">EQ</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">oty</span>; <span class="id">monadInv</span> <span class="id">TR</span>.<br/>
+ <span class="id">constructor</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
+ <span class="id">constructor</span>.<br/>
- <span class="id">monadInv</span> <span class="id">TR</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_stmt_charact">transl_stmt_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">map</span> <span class="id">stmt</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">ngoto</span> <span class="id">nret</span> <span class="id">rret</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">s</span>' <span class="id">INCR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">transl_stmt</span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#stmt">stmt</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> = <span class="id">OK</span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id">s</span>' <span class="id"><a href="RTLgenspec.html#INCR">INCR</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WF</span>: <span class="id"><a href="RTLgenspec.html#map_valid">map_valid</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">OK</span>: <span class="id"><a href="RTLgenspec.html#return_reg_ok">return_reg_ok</a></span> <span class="id"><a href="RTLgenspec.html#s">s</a></span> <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_stmt">tr_stmt</a></span> <span class="id">s</span>'.(<span class="id">st_code</span>) <span class="id"><a href="RTLgenspec.html#map">map</a></span> <span class="id"><a href="RTLgenspec.html#stmt">stmt</a></span> <span class="id"><a href="RTLgenspec.html#ns">ns</a></span> <span class="id"><a href="RTLgenspec.html#nd">nd</a></span> <span class="id"><a href="RTLgenspec.html#nexits">nexits</a></span> <span class="id"><a href="RTLgenspec.html#ngoto">ngoto</a></span> <span class="id"><a href="RTLgenspec.html#nret">nret</a></span> <span class="id"><a href="RTLgenspec.html#rret">rret</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2510')">Proof.</div>
<div class="proofscript" id="proof2510">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">stmt</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">TR</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">TR</span>); <span class="id">saturateTrans</span>.<br/>
&nbsp;Sskip&nbsp;*)</span>&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;Sassign&nbsp;*)</span>&nbsp;&nbsp;<span class="id">revert</span> <span class="id">EQ</span>. <span class="tactic">unfold</span> <span class="id">find_var</span>. <span class="id">case_eq</span> (<span class="id">map_vars</span> <span class="id">map</span>)!<span class="id">i</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#tr_Sassign">tr_Sassign</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_assign_charact">transl_expr_assign_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;Sstore&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_expr_incr">tr_expr_incr</a></span> <span class="kwd">with</span> <span class="id">s3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> 4 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Scall&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s0</span> <span class="kwd">as</span> [<span class="id">b</span> | <span class="id">id</span>]; <span class="id">monadInv</span> <span class="id">TR</span>; <span class="id">saturateTrans</span>.<br/>
&nbsp;indirect&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> 4 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_exprlist_incr">tr_exprlist_incr</a></span> <span class="kwd">with</span> <span class="id">s5</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#alloc_regs_target_ok">alloc_regs_target_ok</a></span> <span class="kwd">with</span> (<span class="id">s1</span> := <span class="id">s0</span>); <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_incr">regs_valid_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_incr">regs_valid_incr</a></span> <span class="kwd">with</span> <span class="id">s2</span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#alloc_optreg_map_ok">alloc_optreg_map_ok</a></span> <span class="kwd">with</span> (<span class="id">s1</span> := <span class="id">s2</span>); <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;direct&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> 4 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#alloc_optreg_map_ok">alloc_optreg_map_ok</a></span> <span class="kwd">with</span> (<span class="id">s1</span> := <span class="id">s0</span>); <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Stailcall&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s0</span> <span class="kwd">as</span> [<span class="id">b</span> | <span class="id">id</span>]; <span class="id">monadInv</span> <span class="id">TR</span>; <span class="id">saturateTrans</span>.<br/>
&nbsp;indirect&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">RV</span>: <span class="id"><a href="RTLgenspec.html#regs_valid">regs_valid</a></span> (<span class="id">x</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">s0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#regs_valid_cons">regs_valid_cons</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_exprlist_incr">tr_exprlist_incr</a></span> <span class="kwd">with</span> <span class="id">s4</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> 4 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;direct&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> 4 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sbuiltin&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> 4 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exprlist_charact">transl_exprlist_charact</a></span>; <span class="tactic">eauto</span> 3 <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#convert_builtin_res_charact">convert_builtin_res_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sseq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sifthenelse&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">more_likely</span> <span class="id">c</span> <span class="id">stmt1</span> <span class="id">stmt2</span>); <span class="id">monadInv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_condexpr_charact">transl_condexpr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt1</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_condexpr_charact">transl_condexpr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sloop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sblock&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHstmt</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sexit&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#transl_exit_charact">transl_exit_charact</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;Sswitch&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_exitexpr_charact">transl_exitexpr_charact</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;Sreturn&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">o</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">rret</span>; <span class="id">inv</span> <span class="id">TR</span>. <span class="id">inv</span> <span class="id">OK</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_expr_charact">transl_expr_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">TR</span>. <span class="id">constructor</span>.<br/>
&nbsp;Slabel&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ0</span>; <span class="tactic">clear</span> <span class="id">EQ0</span>. <span class="id">case_eq</span> (<span class="id">ngoto</span>!<span class="id">l</span>); <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">EQ0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ1</span>; <span class="tactic">clear</span> <span class="id">EQ1</span>. <span class="tactic">unfold</span> <span class="id">handle_error</span>.<br/>
&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">update_instr</span> <span class="id">n</span> (<span class="id"><a href="RTL.html#Inop">Inop</a></span> <span class="id">ns</span>) <span class="id">s0</span>); <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#tr_stmt_incr">tr_stmt_incr</a></span> <span class="kwd">with</span> <span class="id">s0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;Sgoto&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">TR</span>; <span class="tactic">clear</span> <span class="id">TR</span>. <span class="id">case_eq</span> (<span class="id">ngoto</span>!<span class="id">l</span>); <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_function_charact">transl_function_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id">transl_function</span> <span class="id"><a href="RTLgenspec.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">Errors.OK</a></span> <span class="id"><a href="RTLgenspec.html#tf">tf</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="RTLgenspec.html#tr_function">tr_function</a></span> <span class="id"><a href="RTLgenspec.html#f">f</a></span> <span class="id"><a href="RTLgenspec.html#tf">tf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2511')">Proof.</div>
<div class="proofscript" id="proof2511">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">tf</span>. <span class="tactic">unfold</span> <span class="id">transl_function</span>.<br/>
&nbsp;&nbsp;<span class="id">caseEq</span> (<span class="id">reserve_labels</span> (<span class="id"><a href="CminorSel.html#fn_body">fn_body</a></span> <span class="id">f</span>) (<span class="id"><a href="Maps.html#PTree.empty">PTree.empty</a></span> <span class="id"><a href="RTL.html#node">node</a></span>, <span class="id">init_state</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ngoto</span> <span class="id">s0</span> <span class="id">RESERVE</span>.<br/>
&nbsp;&nbsp;<span class="id">caseEq</span> (<span class="id">transl_fun</span> <span class="id">f</span> <span class="id">ngoto</span> <span class="id">s0</span>). <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">nentry</span> <span class="id">rparams</span>] <span class="id">sfinal</span> <span class="id">INCR</span> <span class="id">TR</span> <span class="id">E</span>. <span class="id">inv</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#add_vars_valid">add_vars_valid</a></span>. <span class="id">eexact</span> <span class="id">EQ</span>. <span class="tactic">apply</span> <span class="id"><a href="RTLgenspec.html#init_mapping_valid">init_mapping_valid</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="RTLgenspec.html#add_vars_valid">add_vars_valid</a></span>. <span class="id">eexact</span> <span class="id">EQ1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">C</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#tr_function_intro">tr_function_intro</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RTLgenspec.html#transl_stmt_charact">transl_stmt_charact</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ret_reg</span>. <span class="tactic">destruct</span> (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> (<span class="id"><a href="CminorSel.html#fn_sig">CminorSel.fn_sig</a></span> <span class="id">f</span>)).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">rtlg</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
