<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module TSOGlobSem</title>
<meta name="description" content="Documentation of Coq module TSOGlobSem" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module TSOGlobSem</h1>
<div class="coq">
<span class="id">From</span> <span class="id">mathcomp.ssreflect</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">fintype</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Maps.html">Maps</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span> <span class="id"><a href="Integers.html">Integers</a></span> <span class="id"><a href="Floats.html">Floats</a></span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Events.html">Events</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="Smallstep.html">Smallstep</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Asm.html">Asm</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CUAST.html">CUAST</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="GMemory.html">GMemory</a></span> <span class="id"><a href="FMemory.html">FMemory</a></span> <span class="id"><a href="TSOMem.html">TSOMem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="GAST.html">GAST</a></span> <span class="id"><a href="GlobDefs.html">GlobDefs</a></span> <span class="id"><a href="ETrace.html">ETrace</a></span> <span class="id"><a href="Blockset.html">Blockset</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="loadframe.html">loadframe</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="ASM_local.html">ASM_local</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AsmLang.html">AsmLang</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AsmTSO.html">AsmTSO</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="footprint">footprint</a></span> := <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="empfp">empfp</a></span> := <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Coq.Lists.Streams</a></span>.<br/>
<br/>
<br/>
<h1> x86 TSO program </h1>
<span class="kwd">Definition</span> <span class="id"><a name="tsoprog">tsoprog</a></span> : <span class="kwd">Type</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="AsmTSO.html#comp_unit">comp_unit</a></span>) * <span class="id"><a href="GAST.html#entries">entries</a></span>.<br/>
<br/>
<h1> x86 TSO Global Semantics </h1>
<span class="kwd">Inductive</span> <span class="id"><a name="tsoglabel">tsoglabel</a></span> : <span class="kwd">Type</span> :=<br/>
| <span class="id"><a name="tau">tau</a></span><br/>
| <span class="id"><a name="sw">sw</a></span><br/>
| <span class="id"><a name="ub">ub</a></span> (<span class="id">t</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>)<br/>
| <span class="id"><a name="evt">evt</a></span> (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>).<br/>
<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="TSOGlobEnv">TSOGlobEnv</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="TSOGlobEnv.t">t</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.M">M</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.modules">modules</a></span> : '<span class="id">I_M</span> -&gt; <span class="id"><a href="ASM_local.html#genv">genv</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.get_mod">get_mod</a></span> : <span class="id"><a href="AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id">fintype.ordinal</span> <span class="id"><a href="TSOGlobSem.html#M">M</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.ge_bound">ge_bound</a></span> : <span class="id"><a href="Values.html#block">block</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.freelists">freelists</a></span> : <span class="id"><a href="GlobDefs.html#FLists.t">FLists.t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
<div class="doc">The <span class="bracket"><span class="id">GE</span></span> is properly initialized from <span class="bracket"><span class="id">cus</span></span> if <span class="bracket"><span class="id">init</span> <span class="id">cus</span> <span class="id">GE</span></span> </div>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="TSOGlobEnv.init">init</a></span> (<span class="id">cus</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="AsmTSO.html#comp_unit">comp_unit</a></span>) (<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">t</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
<div class="doc">Amount of runtime semantic modules is equal to amount of compilation units </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.mod_num">mod_num</a></span>: (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.M">M</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="TSOGlobSem.html#cus">cus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br/>
<div class="doc">All ges are properly initialized w.r.t. the comp unit </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.ge_init">ge_init</a></span>: <span class="kwd">forall</span> (<span class="id">i</span>: '<span class="id">I_</span>(<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.M">M</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">cui</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="TSOGlobSem.html#cus">cus</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#cui">cui</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#init_genv">AsmTSO.init_genv</a></span> <span class="id"><a href="TSOGlobSem.html#cui">cui</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.modules">modules</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br/>
<div class="doc">Domain of <span class="bracket"><span class="id">get_mod</span></span> contains all internal functions </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.get_mod_init">get_mod_init</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">mid</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.get_mod">get_mod</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#mid">mid</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)) <span class="id"><a href="AsmTSO.html#comp_unit">comp_unit</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ir</span> <span class="id">cui</span> =&gt; <span class="kwd">let</span> (<span class="id">i</span>, <span class="id">res</span>) := <span class="id"><a href="TSOGlobSem.html#ir">ir</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="TSOGlobSem.html#res">res</a></span> <span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>, <span class="id"><a href="TSOGlobSem.html#res">res</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="AsmTSO.html#internal_fn">internal_fn</a></span> <span class="id"><a href="TSOGlobSem.html#cui">cui</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>, <span class="id"><a href="TSOGlobSem.html#res">res</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#cus">cus</a></span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">nat_of_ord</span> <span class="id"><a href="TSOGlobSem.html#mid">mid</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="TSOGlobEnv.init_mem">init_mem</a></span> : <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">t</a></span> -&gt; <span class="id"><a href="GMemory.html#gmem">gmem</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOGlobEnv.Init_mem">Init_mem</a></span> : <span class="kwd">forall</span> <span class="id">GE</span> <span class="id">gm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> : '<span class="id">I_</span>(<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.M">M</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>), <span class="id"><a href="AsmTSO.html#init_gmem">AsmTSO.init_gmem</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.modules">modules</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>) <span class="id"><a href="TSOGlobSem.html#gm">gm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">fi</span> : <span class="id"><a href="GlobDefs.html#fid">fid</a></span>, <span class="id"><a href="MemAux.html#no_overlap">MemAux.no_overlap</a></span> (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">freelists</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) <span class="id"><a href="TSOGlobSem.html#fi">fi</a></span>) (<span class="id"><a href="MemAux.html#valid_block_bset">MemAux.valid_block_bset</a></span> <span class="id"><a href="TSOGlobSem.html#gm">gm</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#init_mem">init_mem</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#gm">gm</a></span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv">TSOGlobEnv</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="TSOCore">TSOCore</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="TSOCore.t">t</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOCore.i">i</a></span> : '<span class="id">I_</span>(<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.M">TSOGlobEnv.M</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOCore.c">c</a></span> : <span class="id"><a href="AsmTSO.html#core">core</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOCore.sg">sg</a></span> : <span class="id"><a href="AST.html#signature">signature</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOCore.F">F</a></span>: <span class="id"><a href="GlobDefs.html#fid">fid</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="TSOCore.update">update</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} (<span class="id">x</span>: <span class="id"><a href="TSOGlobSem.html#TSOCore.t">t</a></span>) (<span class="id">cc</span>: <span class="id"><a href="AsmTSO.html#core">core</a></span>) : @<span class="id"><a href="TSOGlobSem.html#TSOCore.t">t</a></span> <span class="id">GE</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOCore.Update">Update</a></span>: <span class="kwd">forall</span> <span class="id">x</span>', <span class="id">x</span>' = {| <span class="id"><a href="TSOGlobSem.html#TSOCore.Build_t">i</a></span> := <span class="id"><a href="TSOGlobSem.html#TSOCore.i">i</a></span> <span class="id">x</span>; <span class="id">c</span> := <span class="id">cc</span>; <span class="id">sg</span> := <span class="id"><a href="TSOGlobSem.html#TSOCore.sg">sg</a></span> <span class="id">x</span>; <span class="id">F</span> := <span class="id"><a href="TSOGlobSem.html#TSOCore.F">F</a></span> <span class="id">x</span> |} -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#update">update</a></span> <span class="id">x</span> <span class="id">cc</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="TSOGlobSem.html#TSOCore">TSOCore</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Module</span> <span class="id"><a name="TSOThrdPool">TSOThrdPool</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="TSOThrdPool.t">t</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOThrdPool.content">content</a></span> : <span class="id"><a href="Maps.html#PMap.t">PMap.t</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (@<span class="id"><a href="TSOGlobSem.html#TSOCore.t">TSOCore.t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOThrdPool.next_tid">next_tid</a></span> : <span class="id"><a href="GlobDefs.html#tid">tid</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOThrdPool.next_fmap">next_fmap</a></span> : <span class="id"><a href="GlobDefs.html#tid">tid</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="TSOThrdPool.update">update</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} (<span class="id">thdp</span>: <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span>) (<span class="id">i</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) (<span class="id">c</span>': <span class="id"><a href="TSOGlobSem.html#TSOCore.t">TSOCore.t</a></span>) : <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="TSOThrdPool.Update">Update</a></span>: <span class="kwd">forall</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">thdp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id">i</span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id">thdp</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span> :: <span class="id"><a href="TSOGlobSem.html#cs">cs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">thdp</span>' = <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.Build_t">Build_t</a></span> <span class="id">GE</span> (<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id">i</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span>' :: <span class="id"><a href="TSOGlobSem.html#cs">cs</a></span>)) (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id">thdp</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span> <span class="id">thdp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span> <span class="id">thdp</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#update">update</a></span> <span class="id">thdp</span> <span class="id">i</span> <span class="id">c</span>' <span class="id">thdp</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="TSOThrdPool.push">push</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} (<span class="id">thdp</span>: <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span>) (<span class="id">i</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mid</span>: '<span class="id">I_</span>(<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.M">TSOGlobEnv.M</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cc</span>: <span class="id"><a href="AsmTSO.html#core">core</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sg</span>: <span class="id"><a href="AST.html#signature">signature</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) !! <span class="id"><a href="TSOGlobSem.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.Build_t">Build_t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#GE">GE</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOCore.Build_t">TSOCore.Build_t</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#mid">mid</a></span> <span class="id"><a href="TSOGlobSem.html#cc">cc</a></span> <span class="id"><a href="TSOGlobSem.html#sg">sg</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#FLists.get_tfid">FLists.get_tfid</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) <span class="id"><a href="TSOGlobSem.html#i">i</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id">cs</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span>' =&gt; <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> <span class="id">i</span>' <span class="kwd">then</span> ((<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span>) + 1)%<span class="id">nat</span> <span class="kwd">else</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id">i</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="TSOThrdPool.pop">pop</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} (<span class="id">thdp</span>: @<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) (<span class="id">i</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) !! <span class="id"><a href="TSOGlobSem.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">c</span> :: <span class="id">cs</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> {| <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.Build_t">content</a></span> := <span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cs</span>) (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">next_tid</span> := <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">next_fmap</span> := <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="TSOThrdPool.emp">emp</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} : <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> := <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.Build_t">Build_t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> (<span class="id"><a href="Maps.html#PMap.init">PMap.init</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) 1%<span class="id">positive</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0%<span class="id">nat</span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="TSOThrdPool.spawn">spawn</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">thdp</span>: <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mid</span>: '<span class="id">I_</span>(<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.M">TSOGlobEnv.M</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">c</span>: <span class="id"><a href="AsmTSO.html#core">AsmTSO.core</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sg</span>: <span class="id"><a href="AST.html#signature">signature</a></span>) : <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">nf</span> := (<span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span>) <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">f</span> := <span class="id"><a href="GlobDefs.html#FLists.get_tfid">FLists.get_tfid</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) (<span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span>)) <span class="id">nf</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c</span> := <span class="id"><a href="TSOGlobSem.html#TSOCore.Build_t">TSOCore.Build_t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#mid">mid</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="id"><a href="TSOGlobSem.html#sg">sg</a></span> <span class="id">f</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.Build_t">Build_t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span> (<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Psucc">Psucc</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span>) <span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span>) <span class="id"><a href="TSOGlobSem.html#i">i</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>.(<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_fmap">next_fmap</a></span>) <span class="id"><a href="TSOGlobSem.html#i">i</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="TSOThrdPool.init">init</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} : <span class="id"><a href="GAST.html#entries">entries</a></span> -&gt; <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="TSOThrdPool.init_nil">init_nil</a></span> : <span class="id"><a href="TSOGlobSem.html#init">init</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.emp">emp</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="TSOThrdPool.init_cons">init_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">funid</span> <span class="id">m_id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.get_mod">TSOGlobEnv.get_mod</a></span> <span class="id">GE</span> <span class="id"><a href="TSOGlobSem.html#funid">funid</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#m_id">m_id</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">thdp</span> <span class="id">cc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#init">init</a></span> <span class="id"><a href="TSOGlobSem.html#e">e</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span> := <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.modules">TSOGlobEnv.modules</a></span> <span class="id">GE</span> <span class="id"><a href="TSOGlobSem.html#m_id">m_id</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#init_core">AsmTSO.init_core</a></span> <span class="id">ge</span> <span class="id"><a href="TSOGlobSem.html#funid">funid</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#cc">cc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">thdp</span>':= <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.spawn">spawn</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#m_id">m_id</a></span> <span class="id"><a href="TSOGlobSem.html#cc">cc</a></span> <span class="id"><a href="AST.html#signature_main">signature_main</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#init">init</a></span> (<span class="id"><a href="TSOGlobSem.html#funid">funid</a></span> :: <span class="id"><a href="TSOGlobSem.html#e">e</a></span>) <span class="id">thdp</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="TSOThrdPool.halted">halted</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} (<span class="id">thdp</span>: @<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) (<span class="id">i</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="TSOThrdPool.Halted">Halted</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id">i</span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">content</a></span> <span class="id">thdp</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#halted">halted</a></span> <span class="id">thdp</span> <span class="id">i</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="TSOThrdPool.valid_tid">valid_tid</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>} (<span class="id">thdp</span>: @<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.t">t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) (<span class="id">i</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.next_tid">next_tid</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>).<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool">TSOThrdPool</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="TSOProgConfig">TSOProgConfig</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>} : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="thrdpool">thrdpool</a></span>: @<span class="id"><a href="TSOGlobSem.html#t">TSOThrdPool.t</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="cid">cid</a></span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="tm">tm</a></span>: <span class="id"><a href="TSOMem.html#tsomem">tsomem</a></span>;<br/>
&nbsp;&nbsp;}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Section</span> <span class="id"><a name="TSOGlobSem">TSOGlobSem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>}.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="tso_globstep">tso_globstep</a></span> : <span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> -&gt; <span class="id"><a href="TSOGlobSem.html#tsoglabel">tsoglabel</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt; <span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Corestep">Corestep</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">fp</span> <span class="id">cc</span>' <span class="id">c</span>' <span class="id">thdp</span>' <span class="id">buf</span>' <span class="id">gm</span>' <span class="id">tm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">cc</span> := <span class="id"><a href="TSOGlobSem.html#c">TSOCore.c</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_ix</span> := <span class="id"><a href="TSOGlobSem.html#i">TSOCore.i</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_f</span> := <span class="id"><a href="TSOGlobSem.html#F">TSOCore.F</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_fl</span> := <span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="TSOGlobSem.html#freelists">TSOGlobEnv.freelists</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span>) <span class="id">c_f</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span> := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">c_ix</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">gm</span> := <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">buf</span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_core</span>: <span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> (<span class="id"><a href="TSOGlobSem.html#content">TSOThrdPool.content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span> :: <span class="id"><a href="TSOGlobSem.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_step</span>: <span class="id"><a href="AsmTSO.html#tsostep">tsostep</a></span> <span class="id">ge</span> <span class="id">c_fl</span> <span class="id">cc</span> (<span class="id">buf</span>, <span class="id">gm</span>) <span class="id"><a href="TSOGlobSem.html#fp">fp</a></span> <span class="id">cc</span>' (<span class="id">buf</span>', <span class="id">gm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_upd</span>: <span class="id"><a href="TSOGlobSem.html#update">TSOCore.update</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="id">cc</span>' <span class="id">c</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_upd</span>: <span class="id"><a href="TSOGlobSem.html#update">TSOThrdPool.update</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id">c</span>' <span class="id">thdp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tm_upd</span>: <span class="id">tm</span>' = <span class="id"><a href="TSOMem.html#tsoupd">tsoupd</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id">buf</span>' <span class="id">gm</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_unbuf_safe</span>: <span class="id"><a href="TSOMem.html#unbuffer_safe">unbuffer_safe</a></span> <span class="id">tm</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) <span class="id"><a href="TSOGlobSem.html#tau">tau</a></span> <span class="id"><a href="TSOGlobSem.html#fp">fp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">thdp</span>' <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id">tm</span>')<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="Unbuffer">Unbuffer</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">tm</span>' <span class="id">t</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">H_tid_valid</span>: <span class="id"><a href="TSOGlobSem.html#valid_tid">TSOThrdPool.valid_tid</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id">t</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_unbuf</span>: <span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tm</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) (<span class="id"><a href="TSOGlobSem.html#ub">ub</a></span> <span class="id">t</span>') <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id">tm</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id"><a name="Call">Call</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">funid</span> <span class="id">sg</span> <span class="id">args</span> <span class="id">new_ix</span> <span class="id">cc</span>' <span class="id">thdp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">cc</span> := <span class="id"><a href="TSOGlobSem.html#c">TSOCore.c</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_ix</span> := <span class="id"><a href="TSOGlobSem.html#i">TSOCore.i</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span> := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">c_ix</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_core</span>: <span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> (<span class="id"><a href="TSOGlobSem.html#content">TSOThrdPool.content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span> :: <span class="id"><a href="TSOGlobSem.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_atext</span>: <span class="id"><a href="AsmTSO.html#at_external">at_external</a></span> <span class="id">ge</span> <span class="id">cc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#funid">funid</a></span>, <span class="id"><a href="TSOGlobSem.html#sg">sg</a></span>, <span class="id"><a href="TSOGlobSem.html#args">args</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_not_prim</span>: <span class="id"><a href="GAST.html#not_primitive">not_primitive</a></span> <span class="id"><a href="TSOGlobSem.html#funid">funid</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_mod_id</span>: <span class="id"><a href="TSOGlobSem.html#get_mod">TSOGlobEnv.get_mod</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#funid">funid</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#new_ix">new_ix</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">new_ge</span> := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#new_ix">new_ix</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_new_core</span>: <span class="id"><a href="AsmTSO.html#init_core">init_core</a></span> <span class="id">new_ge</span> <span class="id"><a href="TSOGlobSem.html#funid">funid</a></span> <span class="id"><a href="TSOGlobSem.html#args">args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cc</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_push</span>: <span class="id"><a href="TSOGlobSem.html#push">TSOThrdPool.push</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#new_ix">new_ix</a></span> <span class="id">cc</span>' <span class="id"><a href="TSOGlobSem.html#sg">sg</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">thdp</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) <span class="id"><a href="TSOGlobSem.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">thdp</span>' <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="Return">Return</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">res</span> <span class="id">thdp</span>' <span class="id">c</span>' <span class="id">cc</span>'' <span class="id">c</span>'' <span class="id">thdp</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">cc</span> := <span class="id"><a href="TSOGlobSem.html#c">TSOCore.c</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_ix</span> := <span class="id"><a href="TSOGlobSem.html#i">TSOCore.i</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_sg</span> := <span class="id"><a href="TSOGlobSem.html#sg">TSOCore.sg</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span> := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">c_ix</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_core</span>: <span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> (<span class="id"><a href="TSOGlobSem.html#content">TSOThrdPool.content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span> :: <span class="id">c</span>' :: <span class="id"><a href="TSOGlobSem.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_halt</span>: <span class="id"><a href="AsmTSO.html#halt">halt</a></span> <span class="id">cc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#res">res</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_pop</span>: <span class="id"><a href="TSOGlobSem.html#pop">TSOThrdPool.pop</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">thdp</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">cc</span>' := <span class="id"><a href="TSOGlobSem.html#c">TSOCore.c</a></span> <span class="id">c</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c</span>'<span class="id">_ix</span> := <span class="id"><a href="TSOGlobSem.html#i">TSOCore.i</a></span> <span class="id">c</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span>' := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">c</span>'<span class="id">_ix</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_aftext</span>: <span class="id"><a href="AsmTSO.html#after_external">after_external</a></span> <span class="id">cc</span>' (<span class="id"><a href="GlobDefs.html#res_sg">res_sg</a></span> <span class="id">c_sg</span> <span class="id"><a href="TSOGlobSem.html#res">res</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cc</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_upd</span>: <span class="id"><a href="TSOGlobSem.html#update">TSOCore.update</a></span> <span class="id">c</span>' <span class="id">cc</span>'' <span class="id">c</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_upd</span>: <span class="id"><a href="TSOGlobSem.html#update">TSOThrdPool.update</a></span> <span class="id">thdp</span>' <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id">c</span>'' <span class="id">thdp</span>''),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) <span class="id"><a href="TSOGlobSem.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">thdp</span>'' <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id"><a name="Halt">Halt</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">c</span> <span class="id">res</span> <span class="id">thdp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">cc</span> := <span class="id"><a href="TSOGlobSem.html#c">TSOCore.c</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_ix</span> := <span class="id"><a href="TSOGlobSem.html#i">TSOCore.i</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_sg</span> := <span class="id"><a href="TSOGlobSem.html#sg">TSOCore.sg</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span> := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">c_ix</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_core</span>: <span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> (<span class="id"><a href="TSOGlobSem.html#content">TSOThrdPool.content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_halt</span>: <span class="id"><a href="AsmTSO.html#halt">halt</a></span> <span class="id">cc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#res">res</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_pop</span>: <span class="id"><a href="TSOGlobSem.html#pop">TSOThrdPool.pop</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">thdp</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) <span class="id"><a href="TSOGlobSem.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">thdp</span>' <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id"><a name="EF_Print">EF_Print</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">v</span> <span class="id">cc</span>' <span class="id">c</span>' <span class="id">thdp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">cc</span> := <span class="id"><a href="TSOGlobSem.html#c">TSOCore.c</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">c_ix</span> := <span class="id"><a href="TSOGlobSem.html#i">TSOCore.i</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id">ge</span> := <span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">c_ix</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_core</span>: <span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> (<span class="id"><a href="TSOGlobSem.html#content">TSOThrdPool.content</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOGlobSem.html#c">c</a></span> :: <span class="id"><a href="TSOGlobSem.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_atext</span>: <span class="id"><a href="AsmTSO.html#at_external">at_external</a></span> <span class="id">ge</span> <span class="id">cc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="GAST.html#print">print</a></span>, <span class="id"><a href="GAST.html#print_sg">print_sg</a></span>, <span class="id"><a href="TSOGlobSem.html#v">v</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_v</span>: <span class="id"><a href="GlobDefs.html#not_pointer">not_pointer</a></span> <span class="id"><a href="TSOGlobSem.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_aftext</span>: <span class="id"><a href="AsmTSO.html#after_external">after_external</a></span> <span class="id">cc</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cc</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_core_update</span>: <span class="id"><a href="TSOGlobSem.html#update">TSOCore.update</a></span> <span class="id"><a href="TSOGlobSem.html#c">c</a></span> <span class="id">cc</span>' <span class="id">c</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_tp_upd</span>: <span class="id"><a href="TSOGlobSem.html#update">TSOThrdPool.update</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id">c</span>' <span class="id">thdp</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) (<span class="id"><a href="TSOGlobSem.html#evt">evt</a></span> <span class="id"><a href="TSOGlobSem.html#v">v</a></span>) <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id">thdp</span>' <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id"><a name="Switch">Switch</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">tm</span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_thread_valid</span>: <span class="id"><a href="TSOGlobSem.html#valid_tid">TSOThrdPool.valid_tid</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id">t</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_not_halted</span>: ~ <span class="id"><a href="TSOGlobSem.html#halted">TSOThrdPool.halted</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id">t</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> (<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) <span class="id"><a href="TSOGlobSem.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#Build_TSOProgConfig">Build_TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id">t</span>' <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="abort">abort</a></span> (<span class="id">pc</span>: @<span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem.GE">GE</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(~ <span class="id"><a href="TSOGlobSem.html#halted">TSOThrdPool.halted</a></span> (<span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.(<span class="id"><a href="TSOGlobSem.html#thrdpool">thrdpool</a></span>)) (<span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.(<span class="id"><a href="TSOGlobSem.html#cid">cid</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.(<span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>) <span class="id"><a href="TSOGlobSem.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">gl</span> <span class="id">fp</span> <span class="id">pc</span>', <span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> <span class="id"><a href="TSOGlobSem.html#pc">pc</a></span> <span class="id"><a href="TSOGlobSem.html#gl">gl</a></span> <span class="id"><a href="TSOGlobSem.html#fp">fp</a></span> <span class="id">pc</span>' -&gt; <span class="id"><a href="TSOGlobSem.html#gl">gl</a></span> = <span class="id"><a href="TSOGlobSem.html#sw">sw</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> (<span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.(<span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)) <span class="id"><a href="TSOGlobSem.html#t">t</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> /\ <span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span> (<span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.(<span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)) <span class="id"><a href="TSOGlobSem.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="final_state">final_state</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>} : @<span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> <span class="id">GE</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Final_state">Final_state</a></span> : <span class="kwd">forall</span> <span class="id">pc</span> <span class="id">thdp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#thrdpool">thrdpool</a></span> <span class="id"><a href="TSOGlobSem.html#pc">pc</a></span> = <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="TSOGlobSem.html#valid_tid">TSOThrdPool.valid_tid</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#halted">TSOThrdPool.halted</a></span> <span class="id"><a href="TSOGlobSem.html#thdp">thdp</a></span> <span class="id"><a href="TSOGlobSem.html#i">i</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> (<span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.(<span class="id"><a href="TSOGlobSem.html#tm">tm</a></span>)) <span class="id"><a href="TSOGlobSem.html#i">i</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#final_state">final_state</a></span> <span class="id"><a href="TSOGlobSem.html#pc">pc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="TSOGlobSem.html#TSOGlobSem">TSOGlobSem</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tsoglabel_to_glabel">tsoglabel_to_glabel</a></span> (<span class="id">l</span>: <span class="id"><a href="TSOGlobSem.html#tsoglabel">tsoglabel</a></span>) : <span class="id"><a href="ETrace.html#glabel">glabel</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="TSOGlobSem.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="TSOGlobSem.html#ub">ub</a></span> <span class="id">_</span> | <span class="id"><a href="TSOGlobSem.html#tau">tau</a></span> =&gt; <span class="id"><a href="ETrace.html#tau">ETrace.tau</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="TSOGlobSem.html#sw">sw</a></span> =&gt; <span class="id"><a href="ETrace.html#sw">ETrace.sw</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="TSOGlobSem.html#evt">evt</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="ETrace.html#evt">ETrace.evt</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tso_etrstep">tso_etrstep</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>} :<br/>
&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> -&gt; <span class="id"><a href="ETrace.html#glabel">glabel</a></span> -&gt; <span class="id"><a href="TSOGlobSem.html#footprint">footprint</a></span> -&gt; <span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="TSO_Etrstep">TSO_Etrstep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TSOGlobSem.html#tso_globstep">tso_globstep</a></span> <span class="id">GE</span> <span class="id"><a href="TSOGlobSem.html#pc">pc</a></span> <span class="id"><a href="TSOGlobSem.html#l">l</a></span> <span class="id"><a href="TSOGlobSem.html#fp">fp</a></span> <span class="id">pc</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_etrstep">tso_etrstep</a></span> <span class="id"><a href="TSOGlobSem.html#pc">pc</a></span> (<span class="id"><a href="TSOGlobSem.html#tsoglabel_to_glabel">tsoglabel_to_glabel</a></span> <span class="id"><a href="TSOGlobSem.html#l">l</a></span>) <span class="id"><a href="TSOGlobSem.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tsoEtr">tsoEtr</a></span> {<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>} (<span class="id">s</span>: <span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span>) : <span class="id"><a href="ETrace.html#behav">behav</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="TSOEtr">TSOEtr</a></span> : <span class="kwd">forall</span> <span class="id">B</span>, <span class="id"><a href="ETrace.html#Etr">Etr</a></span> (@<span class="id"><a href="TSOGlobSem.html#tso_etrstep">tso_etrstep</a></span> <span class="id">GE</span>) <span class="id"><a href="TSOGlobSem.html#abort">abort</a></span> <span class="id"><a href="TSOGlobSem.html#final_state">final_state</a></span> <span class="id">s</span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tsoEtr">tsoEtr</a></span> <span class="id">s</span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tso_initconfig">tso_initconfig</a></span> (<span class="id">p</span>: <span class="id"><a href="TSOGlobSem.html#tsoprog">tsoprog</a></span>) (<span class="id">gm</span>: <span class="id"><a href="GMemory.html#gmem">gmem</a></span>) (<span class="id">GE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>) (<span class="id">pc</span>: @<span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> <span class="id"><a href="TSOGlobSem.html#GE">GE</a></span>) (<span class="id">t</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="TSO_initconfig">TSO_initconfig</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#init">TSOGlobEnv.init</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">p</span>) <span class="id">GE</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#init_mem">TSOGlobEnv.init_mem</a></span> <span class="id">GE</span> <span class="id">gm</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#init">TSOThrdPool.init</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">p</span>) (<span class="id"><a href="TSOGlobSem.html#thrdpool">thrdpool</a></span> <span class="id">pc</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#FLists.wd">FLists.wd</a></span> (<span class="id"><a href="TSOGlobSem.html#freelists">TSOGlobEnv.freelists</a></span> <span class="id">GE</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">fi</span>, <span class="id"><a href="MemAux.html#no_overlap">MemAux.no_overlap</a></span> (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="TSOGlobSem.html#freelists">TSOGlobEnv.freelists</a></span> <span class="id">GE</span>) <span class="id"><a href="TSOGlobSem.html#fi">fi</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="MemAux.html#valid_block_bset">MemAux.valid_block_bset</a></span> <span class="id">gm</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemClosures.html#reach_closed">MemClosures.reach_closed</a></span> <span class="id">gm</span> (<span class="id"><a href="MemAux.html#valid_block_bset">MemAux.valid_block_bset</a></span> <span class="id">gm</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#cid">cid</a></span> <span class="id">pc</span> = <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id">t</span> (<span class="id"><a href="TSOGlobSem.html#next_tid">TSOThrdPool.next_tid</a></span> (<span class="id"><a href="TSOGlobSem.html#thrdpool">thrdpool</a></span> <span class="id">pc</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="id">pc</span> = <span class="id"><a href="TSOMem.html#tsomem_init">tsomem_init</a></span> <span class="id">gm</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_initconfig">tso_initconfig</a></span> <span class="id">p</span> <span class="id">gm</span> <span class="id">GE</span> <span class="id">pc</span> <span class="id">t</span>.<br/>
<br/>
<br/>
<div class="doc">relation between client src/tgt genvs, require eq on gvars </div>
<span class="kwd">Record</span> <span class="id"><a name="genv_match">genv_match</a></span> <span class="id">F</span> <span class="id">V</span> (<span class="id">sge</span>: <span class="id"><a href="Globalenvs.html#Genv.t">Genv.t</a></span> <span class="id"><a href="TSOGlobSem.html#F">F</a></span> <span class="id"><a href="TSOGlobSem.html#V">V</a></span>) (<span class="id">tge</span>: <span class="id"><a href="ASM_local.html#genv">genv</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="genv_public_eq">genv_public_eq</a></span>: <span class="kwd">forall</span> <span class="id">id</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_public">Genv.genv_public</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_public">Genv.genv_public</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="genv_symb_eq">genv_symb_eq</a></span>: <span class="kwd">forall</span> <span class="id">id</span>, <span class="id"><a href="Maps.html#PTree.get">PTree.get</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_symb">Genv.genv_symb</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span>) = <span class="id"><a href="Maps.html#PTree.get">PTree.get</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_symb">Genv.genv_symb</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="genv_defs_match">genv_defs_match</a></span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">b</span> <span class="id">b</span>', <span class="id"><a href="Maps.html#PTree.get">PTree.get</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_symb">Genv.genv_symb</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOGlobSem.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Maps.html#PTree.get">PTree.get</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_symb">Genv.genv_symb</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#option_rel">option_rel</a></span> (<span class="id"><a href="LDSimDefs.html#globdef_match">LDSimDefs.globdef_match</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PTree.get">PTree.get</a></span> <span class="id"><a href="TSOGlobSem.html#b">b</a></span> (<span class="id"><a href="Globalenvs.html#Genv.genv_defs">Genv.genv_defs</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PTree.get">PTree.get</a></span> <span class="id">b</span>' (<span class="id"><a href="Globalenvs.html#Genv.genv_defs">Genv.genv_defs</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="genv_next_eq">genv_next_eq</a></span>: <span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span> = <span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span>;<br/>
&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="RGRels.html">RGRels</a></span>.<br/>
<span class="kwd">Record</span> <span class="id"><a name="tso_sc_initRel">tso_sc_initRel</a></span> (<span class="id">SGE</span>: <span class="id"><a href="GlobDefs.html#GlobEnv.t">GlobEnv.t</a></span>) (<span class="id">TGE</span>: <span class="id"><a href="TSOGlobSem.html#t">TSOGlobEnv.t</a></span>) (<span class="id">sgm</span> <span class="id">tgm</span>: <span class="id"><a href="GMemory.html#gmem">gmem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="init_rel_gm_eq">init_rel_gm_eq</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id"><a href="TSOGlobSem.html#sgm">sgm</a></span> <span class="id"><a href="TSOGlobSem.html#b">b</a></span> <span class="id"><a href="TSOGlobSem.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id"><a href="TSOGlobSem.html#b">b</a></span> <span class="id"><a href="TSOGlobSem.html#ofs">ofs</a></span> <span class="id"><a href="TSOGlobSem.html#sgm">sgm</a></span> <span class="id"><a href="TSOGlobSem.html#tgm">tgm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="init_rel_sgm_sep">init_rel_sgm_sep</a></span>: <span class="id"><a href="RGRels.html#sep_obj_client_block">sep_obj_client_block</a></span> <span class="id"><a href="TSOGlobSem.html#sgm">sgm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="init_rel_ge_bound">init_rel_ge_bound</a></span>: <span class="id"><a href="GlobDefs.html#GlobEnv.ge_bound">GlobEnv.ge_bound</a></span> <span class="id"><a href="TSOGlobSem.html#SGE">SGE</a></span> = <span class="id"><a href="TSOGlobSem.html#ge_bound">TSOGlobEnv.ge_bound</a></span> <span class="id"><a href="TSOGlobSem.html#TGE">TGE</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="init_rel_freelists">init_rel_freelists</a></span>: <span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="TSOGlobSem.html#SGE">SGE</a></span> = <span class="id"><a href="TSOGlobSem.html#freelists">TSOGlobEnv.freelists</a></span> <span class="id"><a href="TSOGlobSem.html#TGE">TGE</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="init_rel_get_mod">init_rel_get_mod</a></span>: <span class="kwd">forall</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#option_rel">option_rel</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">nat_of_ord</span> <span class="id"><a href="TSOGlobSem.html#x">x</a></span> = <span class="id">nat_of_ord</span> <span class="id"><a href="TSOGlobSem.html#y">y</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id"><a href="TSOGlobSem.html#SGE">SGE</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span>) (<span class="id"><a href="TSOGlobSem.html#get_mod">TSOGlobEnv.get_mod</a></span> <span class="id"><a href="TSOGlobSem.html#TGE">TGE</a></span> <span class="id"><a href="TSOGlobSem.html#id">id</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="init_rel_ge_match">init_rel_ge_match</a></span>: <span class="kwd">forall</span> <span class="id">ix</span> <span class="id">ix</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nat_of_ord</span> <span class="id"><a href="TSOGlobSem.html#ix">ix</a></span> = <span class="id">nat_of_ord</span> <span class="id">ix</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#genv_match">genv_match</a></span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#ModSem.ge">InteractionSemantics.ModSem.ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#SGE">SGE</a></span> <span class="id"><a href="TSOGlobSem.html#ix">ix</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOGlobSem.html#modules">TSOGlobEnv.modules</a></span> <span class="id"><a href="TSOGlobSem.html#TGE">TGE</a></span> <span class="id">ix</span>');<br/>
<br/>
&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">Require</span> <span class="id"><a href="GlobSemantics.html">GlobSemantics</a></span>.<br/>
<br/>
<br/>
<div class="doc">refinement holds for executions that do not silently diverge </div>
<span class="kwd">CoInductive</span> <span class="id"><a name="notsd">notsd</a></span> : <span class="id"><a href="ETrace.html#behav">behav</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="nsd_done">nsd_done</a></span> : <span class="id"><a href="TSOGlobSem.html#notsd">notsd</a></span> <span class="id"><a href="ETrace.html#Behav_done">Behav_done</a></span><br/>
| <span class="id"><a name="nsd_abort">nsd_abort</a></span> : <span class="id"><a href="TSOGlobSem.html#notsd">notsd</a></span> <span class="id"><a href="ETrace.html#Behav_abort">Behav_abort</a></span><br/>
| <span class="id"><a name="nsd_cons">nsd_cons</a></span> : <span class="kwd">forall</span> <span class="id">v</span> <span class="id">B</span>, <span class="id"><a href="TSOGlobSem.html#notsd">notsd</a></span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span> -&gt; <span class="id"><a href="TSOGlobSem.html#notsd">notsd</a></span> (<span class="id"><a href="ETrace.html#Behav_cons">Behav_cons</a></span> <span class="id"><a href="TSOGlobSem.html#v">v</a></span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tso_refine_sc">tso_refine_sc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">L</span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="TSOGlobSem.html#NL">NL</a></span>} : @<span class="id"><a href="GAST.html#prog">prog</a></span> <span class="id">NL</span> <span class="id">L</span> -&gt; <span class="id"><a href="TSOGlobSem.html#tsoprog">tsoprog</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="TSOProg_Refine_SC">TSOProg_Refine_SC</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pSC</span> <span class="id">pTSO</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sgm</span> <span class="id">sge</span> <span class="id">spc</span> <span class="id">t</span> <span class="id">tgm</span> <span class="id">tge</span> <span class="id">tpc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_sc_initRel">tso_sc_initRel</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span> <span class="id"><a href="TSOGlobSem.html#sgm">sgm</a></span> <span class="id"><a href="TSOGlobSem.html#tgm">tgm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#init_config">init_config</a></span> <span class="id"><a href="TSOGlobSem.html#pSC">pSC</a></span> <span class="id"><a href="TSOGlobSem.html#sgm">sgm</a></span> <span class="id"><a href="TSOGlobSem.html#sge">sge</a></span> <span class="id"><a href="TSOGlobSem.html#spc">spc</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="DRF.html#star_race_config">DRF.star_race_config</a></span> <span class="id"><a href="TSOGlobSem.html#spc">spc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">GlobSemantics.glob_step</a></span> <span class="id"><a href="GlobSemantics.html#abort">GlobSemantics.abort</a></span> <span class="id"><a href="TSOGlobSem.html#spc">spc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_initconfig">tso_initconfig</a></span> <span class="id"><a href="TSOGlobSem.html#pTSO">pTSO</a></span> <span class="id"><a href="TSOGlobSem.html#tgm">tgm</a></span> <span class="id"><a href="TSOGlobSem.html#tge">tge</a></span> <span class="id"><a href="TSOGlobSem.html#tpc">tpc</a></span> <span class="id"><a href="TSOGlobSem.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">B</span>, <span class="id"><a href="TSOGlobSem.html#tsoEtr">tsoEtr</a></span> <span class="id"><a href="TSOGlobSem.html#tpc">tpc</a></span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#notsd">notsd</a></span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#Etr">Etr</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">GlobSemantics.glob_step</a></span> <span class="id"><a href="GlobSemantics.html#abort">GlobSemantics.abort</a></span> <span class="id"><a href="GlobDefs.html#final_state">GlobDefs.final_state</a></span> <span class="id"><a href="TSOGlobSem.html#spc">spc</a></span> <span class="id"><a href="TSOGlobSem.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#tso_refine_sc">tso_refine_sc</a></span> <span class="id"><a href="TSOGlobSem.html#pSC">pSC</a></span> <span class="id"><a href="TSOGlobSem.html#pTSO">pTSO</a></span>.<br/>
<br/>
<br/>
<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
