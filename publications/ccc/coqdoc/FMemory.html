<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module FMemory</title>
<meta name="description" content="Documentation of Coq module FMemory" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module FMemory</h1>
<div class="coq">
<br/>
<div class="doc">This file is adapted from the CompCert compiler,
    where the memory is instrumented with a freelist.
    Allocation takes block from freelist, 
    instead of <span class="bracket"><span class="id">nextblock</span></span> as in original CompCert.
 </div>
<br/>
<div class="doc">This file develops the memory model that is used in the dynamic
  semantics of all the languages used in the compiler.
  It defines a type <span class="bracket"><span class="id">mem</span></span> of memory states, the following 4 basic
  operations over memory states, and their properties:
<ul>
<li>
 <span class="bracket"><span class="id">load</span></span>: read a memory chunk at a given address;
</li>
<li>
 <span class="bracket"><span class="id">store</span></span>: store a memory chunk at a given address;
</li>
<li>
 <span class="bracket"><span class="id">alloc</span></span>: allocate a fresh memory block;
</li>
<li>
 <span class="bracket"><span class="id">free</span></span>: invalidate a memory block.
</li>
</ul>
</div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zwf.html">Zwf</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Axioms.html">Axioms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="Intv.html">Intv</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Maps.html">Maps</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="Archi.html">Archi</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Floats.html">Floats</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Values.html">Values</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="Memdata.html">Memdata</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Memperm.html">Memperm</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="FMemtype.html">FMemtype</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="MemAux.html">MemAux</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Streams</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Unset</span> <span class="id">Elimination</span> <span class="id">Schemes</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Unset</span> <span class="id">Case</span> <span class="id">Analysis</span> <span class="id">Schemes</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> "<span class="id">a</span> # <span class="id">b</span>" := (<span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id">b</span> <span class="id">a</span>) (<span class="tactic">at</span> <span class="id">level</span> 1).<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Mem">Mem</a></span> &lt;: <span class="id"><a href="FMemtype.html#MEM">MEM</a></span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id">perm_order</span>' (<span class="id">po</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Memperm.html#permission">permission</a></span>) (<span class="id">p</span>: <span class="id"><a href="Memperm.html#permission">permission</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#po">po</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">p</span>' =&gt; <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id">p</span>' <span class="id"><a href="FMemory.html#p">p</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">perm_order</span>'' (<span class="id">po1</span> <span class="id">po2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Memperm.html#permission">permission</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#po1">po1</a></span>, <span class="id"><a href="FMemory.html#po2">po2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">p1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">p2</span> =&gt; <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id">p1</span> <span class="id">p2</span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id">mem</span>' : <span class="kwd">Type</span> := <span class="id"><a name="Mem.mkmem">mkmem</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.mem_contents">mem_contents</a></span>: <span class="id"><a href="Maps.html#PMap.t">PMap.t</a></span> (<span class="id"><a href="Maps.html#ZMap.t">ZMap.t</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>);  <span class="docright">(* <span class="bracket"><span class="id">block</span> -&gt; <span class="id">offset</span> -&gt; <span class="id">memval</span></span>  *)</span><br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.mem_access">mem_access</a></span>: <span class="id"><a href="Maps.html#PMap.t">PMap.t</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="Memperm.html#perm_kind">perm_kind</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Memperm.html#permission">permission</a></span>);<br/>
&nbsp;&nbsp;<br/>
<div class="doc">original CompCert use <span class="bracket"><span class="id">nextblock</span></span> in defining <span class="bracket"><span class="id">alloc</span></span> and <span class="bracket"><span class="id">valid</span></span>. 
      Here we replace <span class="bracket"><span class="id">nextblock</span></span> with <span class="bracket"><span class="id">freelist</span></span> and <span class="bracket"><span class="id">nextblockid</span></span> for local allocation, 
      and <span class="bracket"><span class="id">validblocks</span></span> recording valid blocks globally. 
      <span class="bracket"><span class="id">validblocks</span></span> is defined as a list, to make it finite </div>
&nbsp;&nbsp;<span class="id"><a name="Mem.validblocks">validblocks</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Values.html#block">block</a></span>;<br/>
<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.freelist">freelist</a></span>: <span class="id"><a href="MemAux.html#freelist">MemAux.freelist</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.nextblockid">nextblockid</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>;<br/>
&nbsp;&nbsp;<br/>
<div class="doc">well defined conditions </div>
<div class="doc">- <span class="bracket"><span class="id">freelist_wd</span></span> : freelist has no duplicated blocks </div>
&nbsp;&nbsp;<span class="id"><a name="Mem.freelist_wd">freelist_wd</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">n</span>', <span class="id"><a href="FMemory.html#n">n</a></span> &lt;&gt; <span class="id">n</span>' -&gt; <span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="FMemory.html#freelist">freelist</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> &lt;&gt; <span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="FMemory.html#freelist">freelist</a></span> <span class="id">n</span>';<br/>
<div class="doc">- <span class="bracket"><span class="id">valid_wd</span></span> : <span class="bracket"><span class="id">freelist</span></span> and <span class="bracket"><span class="id">validblocks</span></span> are consistent</div>
&nbsp;&nbsp;<span class="id"><a name="Mem.valid_wd">valid_wd</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="FMemory.html#freelist">freelist</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#validblocks">validblocks</a></span> &lt;-&gt; (<span class="id"><a href="FMemory.html#n">n</a></span> &lt; <span class="id"><a href="FMemory.html#nextblockid">nextblockid</a></span>)%<span class="id">nat</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<div class="doc">Original CompCert memory constraints:
      - permissions are well formed
      - invalid block has no permission
      - default contents </div>
&nbsp;&nbsp;<span class="id"><a name="Mem.access_max">access_max</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id">perm_order</span>'' (<span class="id"><a href="FMemory.html#mem_access">mem_access</a></span>#<span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span>) (<span class="id"><a href="FMemory.html#mem_access">mem_access</a></span>#<span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span>);<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.invalid_noaccess">invalid_noaccess</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span>, ~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#validblocks">validblocks</a></span> -&gt; <span class="id"><a href="FMemory.html#mem_access">mem_access</a></span>#<span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.contents_default">contents_default</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="FMemory.html#mem_contents">mem_contents</a></span>#<span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="Memdata.html#Undef">Undef</a></span><br/>
}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.mem">mem</a></span> := <span class="id">mem</span>'. <br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.mkmem_ext">mkmem_ext</a></span>:<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">cont1</span> <span class="id">cont2</span> <span class="id">acc1</span> <span class="id">acc2</span> <span class="id">valid1</span> <span class="id">valid2</span> <span class="id">fl1</span> <span class="id">fl2</span> <span class="id">next1</span> <span class="id">next2</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">d1</span> <span class="id">d2</span> <span class="id">e1</span> <span class="id">e2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#cont1">cont1</a></span>=<span class="id"><a href="FMemory.html#cont2">cont2</a></span> -&gt; <span class="id"><a href="FMemory.html#acc1">acc1</a></span>=<span class="id"><a href="FMemory.html#acc2">acc2</a></span> -&gt; <span class="id"><a href="FMemory.html#valid1">valid1</a></span> = <span class="id"><a href="FMemory.html#valid2">valid2</a></span> -&gt; <span class="id"><a href="FMemory.html#fl1">fl1</a></span> = <span class="id"><a href="FMemory.html#fl2">fl2</a></span> -&gt; <span class="id"><a href="FMemory.html#next1">next1</a></span>=<span class="id"><a href="FMemory.html#next2">next2</a></span> -&gt;  <br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span> <span class="id"><a href="FMemory.html#cont1">cont1</a></span> <span class="id"><a href="FMemory.html#acc1">acc1</a></span> <span class="id"><a href="FMemory.html#valid1">valid1</a></span> <span class="id"><a href="FMemory.html#fl1">fl1</a></span> <span class="id"><a href="FMemory.html#next1">next1</a></span> <span class="id"><a href="FMemory.html#a1">a1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#c1">c1</a></span> <span class="id"><a href="FMemory.html#d1">d1</a></span> <span class="id"><a href="FMemory.html#e1">e1</a></span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span> <span class="id"><a href="FMemory.html#cont2">cont2</a></span> <span class="id"><a href="FMemory.html#acc2">acc2</a></span> <span class="id"><a href="FMemory.html#valid1">valid1</a></span> <span class="id"><a href="FMemory.html#fl1">fl1</a></span> <span class="id"><a href="FMemory.html#next2">next2</a></span> <span class="id"><a href="FMemory.html#a2">a2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#c2">c2</a></span> <span class="id"><a href="FMemory.html#d2">d2</a></span> <span class="id"><a href="FMemory.html#e2">e2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5993')">Proof.</div>
<div class="proofscript" id="proof5993">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#proof_irr">proof_irr</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">trivial facts about additional properties </div>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_in">valid_in</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>) <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#n">n</a></span> &lt; <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>))%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5994')">Proof.</div>
<div class="proofscript" id="proof5994">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.invalid_out">invalid_out</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">n</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>) = <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id"><a href="FMemory.html#n">n</a></span> &lt; <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>))%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5995')">Proof.</div>
<div class="proofscript" id="proof5995">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.freelist_unique">freelist_unique</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Str_nth">Str_nth</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#n1">n1</a></span> = <span class="id"><a href="FMemory.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5996')">Proof.</div>
<div class="proofscript" id="proof5996">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>; [|<span class="tactic">subst</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">n1</span> <span class="id">n2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span> (<span class="id"><a href="FMemory.html#Mem.freelist_wd">freelist_wd</a></span> <span class="id">m</span> <span class="id">_</span> <span class="id">_</span> <span class="id">n</span>).<br/>
Qed.</div>
<br/>
<h1> The freelist and nextblock interface </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.in_freelist">in_freelist</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) : <span class="kwd">Prop</span> := <span class="id"><a href="MemAux.html#in_fl">in_fl</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>) <span class="id"><a href="FMemory.html#b">b</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.nextblock">nextblock</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) : <span class="id"><a href="Values.html#block">block</a></span> := <span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>) <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.nextblock_in_freelist">nextblock_in_freelist</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5997')">Proof.</div>
<div class="proofscript" id="proof5997">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>, <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>; <span class="id">unfold_fl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h1> Validity of blocks and accesses </h1>
<br/>
<div class="doc">A block address is valid if it was previously allocated. It remains valid
  even after being freed. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.valid_block">valid_block</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.valid_block_list">valid_block_list</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) := <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_dec">valid_block_dec</a></span>: <span class="kwd">forall</span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>), {<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>} + {~<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5998')">Proof.</div>
<div class="proofscript" id="proof5998">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span>. <span class="tactic">exact</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.nextblock_invalid">nextblock_invalid</a></span>: <span class="kwd">forall</span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>), ~ <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5999')">Proof.</div>
<div class="proofscript" id="proof5999">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">Contra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>, <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="kwd">in</span> <span class="id">Contra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.invalid_out">invalid_out</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.valid_block_bool">valid_block_bool</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="FMemory.html#Mem.valid_block_dec">valid_block_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>) <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_not_valid_diff">valid_not_valid_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt; ~(<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">b</span>') -&gt; <span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6000')">Proof.</div>
<div class="proofscript" id="proof6000">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">b</span>'. <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">freelist_unique</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nextblock_in_freelist</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nextblock_invalid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">valid_not_valid_diff</span>: <span class="id">mem</span>.<br/>
<br/>
<div class="doc">Permissions </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.perm">perm</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">k</span>: <span class="id"><a href="Memperm.html#perm_kind">perm_kind</a></span>) (<span class="id">p</span>: <span class="id"><a href="Memperm.html#permission">permission</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id">perm_order</span>' (<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span>) <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_implies">perm_implies</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p1</span> <span class="id">p2</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> -&gt; <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6001')">Proof.</div>
<div class="proofscript" id="proof6001">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>, <span class="id">perm_order</span>'; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">m</span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>)#<span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memperm.html#perm_order_trans">perm_order_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_implies</span>: <span class="id">mem</span>. <br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_cur_max">perm_cur_max</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6002')">Proof.</div>
<div class="proofscript" id="proof6002">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">po1</span> <span class="id">po2</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">perm_order</span>' <span class="id"><a href="FMemory.html#po2">po2</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id">perm_order</span>'' <span class="id"><a href="FMemory.html#po1">po1</a></span> <span class="id"><a href="FMemory.html#po2">po2</a></span> -&gt; <span class="id">perm_order</span>' <span class="id"><a href="FMemory.html#po1">po1</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">perm_order</span>', <span class="id">perm_order</span>''. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">po2</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">po1</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memperm.html#perm_order_trans">perm_order_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>). <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_cur">perm_cur</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6003')">Proof.</div>
<div class="proofscript" id="proof6003">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_max">perm_max</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6004')">Proof.</div>
<div class="proofscript" id="proof6004">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">k</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_cur</span> <span class="id">perm_max</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_valid_block">perm_valid_block</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6005')">Proof.</div>
<div class="proofscript" id="proof6005">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_block_dec">valid_block_dec</a></span> <span class="id">m</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m</span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>)#<span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="kwd">in</span> <span class="id">n</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_valid_block</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.perm_order_dec">perm_order_dec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p1</span> <span class="id">p2</span>, {<span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span>} + {~<span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6006')">Proof.</div>
<div class="proofscript" id="proof6006">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p1</span>; <span class="tactic">destruct</span> <span class="id">p2</span>; (<span class="id">left</span>; <span class="id">constructor</span>) || (<span class="id">right</span>; <span class="tactic">intro</span> <span class="id">PO</span>; <span class="tactic">inversion</span> <span class="id">PO</span>).<br/>
Defined.</div>
<br/>
<span class="kwd">Remark</span> <span class="id">perm_order</span>'<span class="id">_dec</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">p</span>, {<span class="id">perm_order</span>' <span class="id"><a href="FMemory.html#op">op</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>} + {~<span class="id">perm_order</span>' <span class="id"><a href="FMemory.html#op">op</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6007')">Proof.</div>
<div class="proofscript" id="proof6007">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">unfold</span> <span class="id">perm_order</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_order_dec">perm_order_dec</a></span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">tauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_dec">perm_dec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, {<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>} + {~ <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6008')">Proof.</div>
<div class="proofscript" id="proof6008">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">perm_order</span>'<span class="id">_dec</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.range_perm">range_perm</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">k</span>: <span class="id"><a href="Memperm.html#perm_kind">perm_kind</a></span>) (<span class="id">p</span>: <span class="id"><a href="Memperm.html#permission">permission</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_implies">range_perm_implies</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">k</span> <span class="id">p1</span> <span class="id">p2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> -&gt; <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6009')">Proof.</div>
<div class="proofscript" id="proof6009">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_cur">range_perm_cur</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6010')">Proof.</div>
<div class="proofscript" id="proof6010">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_max">range_perm_max</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6011')">Proof.</div>
<div class="proofscript" id="proof6011">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">range_perm_implies</span> <span class="id">range_perm_cur</span> <span class="id">range_perm_max</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.range_perm_dec">range_perm_dec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">k</span> <span class="id">p</span>, {<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>} + {~ <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6012')">Proof.</div>
<div class="proofscript" id="proof6012">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">lo</span> <span class="kwd">using</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_induction_type">well_founded_induction_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zwf.html#Zwf_up_well_founded">Zwf_up_well_founded</a></span> <span class="id">hi</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">lo</span> <span class="id">hi</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.perm_dec">perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">k</span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> (<span class="id">lo</span> + 1)). <span class="tactic">red</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">lo</span> <span class="id">ofs</span>). <span class="tactic">congruence</span>. <span class="tactic">apply</span> <span class="id">r</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">omegaContradiction</span>.<br/>
Defined.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">valid_access</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span></span> holds if a memory access
    of the given chunk is possible in <span class="bracket"><span class="id">m</span></span> at address <span class="bracket"><span class="id">b</span>, <span class="id">ofs</span></span>
    with current permissions <span class="bracket"><span class="id">p</span></span>.
    This means:
<ul>
<li>
 The range of bytes accessed all have current permission <span class="bracket"><span class="id">p</span></span>.
</li>
<li>
 The offset <span class="bracket"><span class="id">ofs</span></span> is aligned.
</li>
</ul>
</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.valid_access">valid_access</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">p</span>: <span class="id"><a href="Memperm.html#permission">permission</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="FMemory.html#p">p</a></span><br/>
&nbsp;&nbsp;/\ (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_implies">valid_access_implies</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p1</span> <span class="id">p2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> -&gt; <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#p1">p1</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p2">p2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6013')">Proof.</div>
<div class="proofscript" id="proof6013">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_freeable_any">valid_access_freeable_any</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6014')">Proof.</div>
<div class="proofscript" id="proof6014">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_implies">valid_access_implies</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_access_implies</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_valid_block">valid_access_valid_block</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6015')">Proof.</div>
<div class="proofscript" id="proof6015">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_access_valid_block</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_access_perm">valid_access_perm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6016')">Proof.</div>
<div class="proofscript" id="proof6016">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur">perm_cur</a></span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_access_compat">valid_access_compat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk1</span> <span class="id">chunk2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> &lt;= <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>-&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6017')">Proof.</div>
<div class="proofscript" id="proof6017">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_trans">Zdivide_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memdata.html#align_le_divides">align_le_divides</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_access_dec">valid_access_dec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;{<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>} + {~ <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6018')">Proof.</div>
<div class="proofscript" id="proof6018">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#Zdivide_dec">Zdivide_dec</a></span> (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id">chunk</span>) <span class="id">ofs</span> (<span class="id"><a href="Memdata.html#align_chunk_pos">align_chunk_pos</a></span> <span class="id">chunk</span>)).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intro</span> <span class="id">V</span>; <span class="id">inv</span> <span class="id">V</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intro</span> <span class="id">V</span>; <span class="id">inv</span> <span class="id">V</span>; <span class="id">contradiction</span>.<br/>
Defined.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">valid_pointer</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span></span> returns <span class="bracket"><span class="id">true</span></span> if the address <span class="bracket"><span class="id">b</span>, <span class="id">ofs</span></span>
  is nonempty in <span class="bracket"><span class="id">m</span></span> and <span class="bracket"><span class="id">false</span></span> if it is empty. </div>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.valid_pointer">valid_pointer</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm_dec">perm_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_pointer_nonempty_perm">valid_pointer_nonempty_perm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6019')">Proof.</div>
<div class="proofscript" id="proof6019">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.perm_dec">perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>); <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6020')">Proof.</div>
<div class="proofscript" id="proof6020">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_nonempty_perm">valid_pointer_nonempty_perm</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">replace</span> <span class="id">ofs0</span> <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zone_divide">Zone_divide</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">C allows pointers one past the last element of an array.  These are not
  valid according to the previously defined <span class="bracket"><span class="id">valid_pointer</span></span>. The property
  <span class="bracket"><span class="id">weak_valid_pointer</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span></span> holds if address <span class="bracket"><span class="id">b</span>, <span class="id">ofs</span></span> is a valid pointer
  in <span class="bracket"><span class="id">m</span></span>, or a pointer one past a valid block in <span class="bracket"><span class="id">m</span></span>.  </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.weak_valid_pointer">weak_valid_pointer</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> || <span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> - 1).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.weak_valid_pointer_spec">weak_valid_pointer_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> \/ <span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> - 1) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6021')">Proof.</div>
<div class="proofscript" id="proof6021">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span>. <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_iff">orb_true_iff</a></span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_pointer_implies">valid_pointer_implies</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6022')">Proof.</div>
<div class="proofscript" id="proof6022">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer_spec">weak_valid_pointer_spec</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Operations over memory stores </h1>
<br/>
<div class="doc">The initial store </div>
<br/>
<br/>
<div class="doc">Allocation of a fresh block with the given bounds.  Return an updated
  memory state and the address of the fresh block, which initially contains
  undefined cells.  Note that allocation never fails: we model an
  infinite memory. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="Mem.alloc">alloc</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span> (<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#ZMap.init">ZMap.init</a></span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ofs</span> <span class="id">k</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>) :: <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>)+1)%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6023')">Next Obligation.</div>
<div class="proofscript" id="proof6023">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.freelist_wd">freelist_wd</a></span>. <span class="tactic">assumption</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6024')">Next Obligation.</div>
<div class="proofscript" id="proof6024">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>; <span class="id">unfold_fl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.freelist_unique">freelist_unique</a></span>, <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>; <span class="id">unfold_fl</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6025')">Next Obligation.</div>
<div class="proofscript" id="proof6025">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">lo</span> <span class="id">ofs</span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">hi</span>); <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6026')">Next Obligation.</div>
<div class="proofscript" id="proof6026">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6027')">Next Obligation.</div>
<div class="proofscript" id="proof6027">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id">m</span>)). <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Freeing a block between the given bounds.
  Return the updated memory state where the given range of the given block
  has been invalidated: future reads and writes to this
  range will fail.  Requires freeable permission on the given range. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="Mem.unchecked_free">unchecked_free</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#b">b</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ofs</span> <span class="id">k</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>)) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6028')">Next Obligation.</div>
<div class="proofscript" id="proof6028">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.freelist_wd">freelist_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6029')">Next Obligation.</div>
<div class="proofscript" id="proof6029">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6030')">Next Obligation.</div>
<div class="proofscript" id="proof6030">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">lo</span> <span class="id">ofs</span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">hi</span>). <span class="tactic">red</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6031')">Next Obligation.</div>
<div class="proofscript" id="proof6031">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>). <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">lo</span> <span class="id">ofs</span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">hi</span>). <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6032')">Next Obligation.</div>
<div class="proofscript" id="proof6032">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.free">free</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Mem.free_list">free_list</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Values.html#block">block</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)) {<span class="kwd">struct</span> <span class="id">l</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m">m</a></span><br/>
&nbsp;&nbsp;| (<span class="id">b</span>, <span class="id">lo</span>, <span class="id">hi</span>) :: <span class="id">l</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' =&gt; <span class="id"><a href="FMemory.html#free_list">free_list</a></span> <span class="id">m</span>' <span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Memory reads. </div>
<br/>
<div class="doc">Reading N adjacent bytes in a block content. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Mem.getN">getN</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">p</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">c</span>: <span class="id"><a href="Maps.html#ZMap.t">ZMap.t</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) {<span class="kwd">struct</span> <span class="id">n</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>' =&gt; <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span> :: <span class="id"><a href="FMemory.html#getN">getN</a></span> <span class="id">n</span>' (<span class="id"><a href="FMemory.html#p">p</a></span> + 1) <span class="id"><a href="FMemory.html#c">c</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">load</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span></span> perform a read in memory state <span class="bracket"><span class="id">m</span></span>, at address
  <span class="bracket"><span class="id">b</span></span> and offset <span class="bracket"><span class="id">ofs</span></span>.  It returns the value of the memory chunk
  at that address.  <span class="bracket"><span class="id">None</span></span> is returned if the accessed bytes
  are not readable. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.load">load</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>) <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span>)))<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">loadv</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">addr</span></span> is similar, but the address and offset are given
  as a single value <span class="bracket"><span class="id">addr</span></span>, which must be a pointer value. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.loadv">loadv</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">addr</span>: <span class="id"><a href="Values.html#val">val</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#addr">addr</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span> =&gt; <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">b</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">loadbytes</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span></span> reads <span class="bracket"><span class="id">n</span></span> consecutive bytes starting at
  location <span class="bracket">(<span class="id">b</span>, <span class="id">ofs</span>)</span>.  Returns <span class="bracket"><span class="id">None</span></span> if the accessed locations are
  not readable. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.loadbytes">loadbytes</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span> <span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n">n</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Coqlib.html#nat_of_Z">nat_of_Z</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>) <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span>))<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<div class="doc">Memory stores. </div>
<br/>
<div class="doc">Writing N adjacent bytes in a block content. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="Mem.setN">setN</a></span> (<span class="id">vl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) (<span class="id">p</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">c</span>: <span class="id"><a href="Maps.html#ZMap.t">ZMap.t</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) {<span class="kwd">struct</span> <span class="id">vl</span>}: <span class="id"><a href="Maps.html#ZMap.t">ZMap.t</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="FMemory.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id">v</span> :: <span class="id">vl</span>' =&gt; <span class="id"><a href="FMemory.html#setN">setN</a></span> <span class="id">vl</span>' (<span class="id"><a href="FMemory.html#p">p</a></span> + 1) (<span class="id"><a href="Maps.html#ZMap.set">ZMap.set</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id">v</span> <span class="id"><a href="FMemory.html#c">c</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.setN_other">setN_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">c</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="FMemory.html#p">p</a></span> &lt;= <span class="id"><a href="FMemory.html#r">r</a></span> &lt; <span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span>) -&gt; <span class="id"><a href="FMemory.html#r">r</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#q">q</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6033')">Proof.</div>
<div class="proofscript" id="proof6033">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">length</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id">q</span> (<span class="id"><a href="Maps.html#ZMap.set">ZMap.set</a></span> <span class="id">p</span> <span class="id">a</span> <span class="id">c</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHvl</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Maps.html#ZMap.gso">ZMap.gso</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.setN_outside">setN_outside</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">c</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#q">q</a></span> &lt; <span class="id"><a href="FMemory.html#p">p</a></span> \/ <span class="id"><a href="FMemory.html#q">q</a></span> &gt;= <span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6034')">Proof.</div>
<div class="proofscript" id="proof6034">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_other">setN_other</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.getN_setN_same">getN_setN_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">p</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span>) <span class="id"><a href="FMemory.html#p">p</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="FMemory.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6035')">Proof.</div>
<div class="proofscript" id="proof6035">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#ZMap.gss">ZMap.gss</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHvl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.getN_exten">getN_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#p">p</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> -&gt; <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#i">i</a></span> <span class="id"><a href="FMemory.html#c1">c1</a></span> = <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#i">i</a></span> <span class="id"><a href="FMemory.html#c2">c2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c1">c1</a></span> = <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c2">c2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6036')">Proof.</div>
<div class="proofscript" id="proof6036">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">IHn</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.getN_setN_disjoint">getN_setN_disjoint</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">q</span> <span class="id">c</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Intv.html#disjoint">Intv.disjoint</a></span> (<span class="id"><a href="FMemory.html#p">p</a></span>, <span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>) (<span class="id"><a href="FMemory.html#q">q</a></span>, <span class="id"><a href="FMemory.html#q">q</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6037')">Proof.</div>
<div class="proofscript" id="proof6037">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_exten">getN_exten</a></span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_other">setN_other</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">r</span>. <span class="id">eelim</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.getN_setN_outside">getN_setN_outside</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">q</span> <span class="id">c</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> &lt;= <span class="id"><a href="FMemory.html#q">q</a></span> \/ <span class="id"><a href="FMemory.html#q">q</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span>) &lt;= <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6038')">Proof.</div>
<div class="proofscript" id="proof6038">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_disjoint">getN_setN_disjoint</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Intv.html#disjoint_range">Intv.disjoint_range</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.setN_default">setN_default</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">q</span> <span class="id">c</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6039')">Proof.</div>
<div class="proofscript" id="proof6039">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHvl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">store</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span></span> perform a write in memory state <span class="bracket"><span class="id">m</span></span>.
  Value <span class="bracket"><span class="id">v</span></span> is stored at address <span class="bracket"><span class="id">b</span></span> and offset <span class="bracket"><span class="id">ofs</span></span>.
  Return the updated memory store, or <span class="bracket"><span class="id">None</span></span> if the accessed bytes
  are not writable. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="Mem.store">store</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span> (<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#b">b</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6040')">Next Obligation.</div>
<div class="proofscript" id="proof6040">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.freelist_wd">freelist_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6041')">Next Obligation.</div>
<div class="proofscript" id="proof6041">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6042')">Next Obligation.</div>
<div class="proofscript" id="proof6042">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6043')">Next Obligation.</div>
<div class="proofscript" id="proof6043">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span>; <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6044')">Next Obligation.</div>
<div class="proofscript" id="proof6044">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_default">setN_default</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">storev</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">addr</span> <span class="id">v</span></span> is similar, but the address and offset are given
  as a single value <span class="bracket"><span class="id">addr</span></span>, which must be a pointer value. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.storev">storev</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">addr</span> <span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#addr">addr</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span> =&gt; <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">b</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>) <span class="id"><a href="FMemory.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">storebytes</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes</span></span> stores the given list of bytes <span class="bracket"><span class="id">bytes</span></span>
  starting at location <span class="bracket">(<span class="id">b</span>, <span class="id">ofs</span>)</span>.  Returns updated memory state
  or <span class="bracket"><span class="id">None</span></span> if the accessed locations are not writable. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="Mem.storebytes">storebytes</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">bytes</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span>)) <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6045')">Next Obligation.</div>
<div class="proofscript" id="proof6045">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.freelist_wd">freelist_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6046')">Next Obligation.</div>
<div class="proofscript" id="proof6046">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6047')">Next Obligation.</div>
<div class="proofscript" id="proof6047">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6048')">Next Obligation.</div>
<div class="proofscript" id="proof6048">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span>; <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6049')">Next Obligation.</div>
<div class="proofscript" id="proof6049">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_default">setN_default</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">drop_perm</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span></span> sets the max permissions of the byte range
    <span class="bracket">(<span class="id">b</span>, <span class="id">lo</span>) ... (<span class="id">b</span>, <span class="id">hi</span> - 1)</span> to <span class="bracket"><span class="id">p</span></span>.  These bytes must have current permissions
    <span class="bracket"><span class="id">Freeable</span></span> in the initial memory state <span class="bracket"><span class="id">m</span></span>.
    Returns updated memory state, or <span class="bracket"><span class="id">None</span></span> if insufficient permissions. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="Mem.drop_perm">drop_perm</a></span> (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">p</span>: <span class="id"><a href="Memperm.html#permission">permission</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#Mem.mkmem">mkmem</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#b">b</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">ofs</span> <span class="id">k</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6050')">Next Obligation.</div>
<div class="proofscript" id="proof6050">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.freelist_wd">freelist_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6051')">Next Obligation.</div>
<div class="proofscript" id="proof6051">
 <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_wd">valid_wd</a></span>. <span class="tactic">auto</span>. Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6052')">Next Obligation.</div>
<div class="proofscript" id="proof6052">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>). <span class="tactic">subst</span> <span class="id">b0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">lo</span> <span class="id">ofs</span> &amp;&amp; <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">hi</span>). <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.access_max">access_max</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6053')">Next Obligation.</div>
<div class="proofscript" id="proof6053">
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span> <span class="id">m</span> <span class="id">b0</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">H0</span>). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>). <span class="tactic">subst</span> <span class="id">b0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">lo</span> <span class="id">ofs</span>). <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">hi</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>). <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur">perm_cur</a></span>. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof6054')">Next Obligation.</div>
<div class="proofscript" id="proof6054">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.contents_default">contents_default</a></span>.<br/>
Qed.</div>
<br/>
<h1> Properties of the memory operations </h1>
<br/>
<div class="doc">Properties of the empty store. </div>
<h2> Properties related to <span class="bracket"><span class="id">load</span></span> </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_load">valid_access_load</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6055')">Proof.</div>
<div class="proofscript" id="proof6055">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">econstructor</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_valid_access">load_valid_access</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6056')">Proof.</div>
<div class="proofscript" id="proof6056">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">v</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.load_result">load_result</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>) <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#m">m</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6057')">Proof.</div>
<div class="proofscript" id="proof6057">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">v</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">load_valid_access</span> <span class="id">valid_access_load</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_type">load_type</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> (<span class="id"><a href="AST.html#type_of_chunk">type_of_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6058')">Proof.</div>
<div class="proofscript" id="proof6058">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_type">decode_val_type</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_cast">load_cast</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span> 8 <span class="id"><a href="FMemory.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.zero_ext">Val.zero_ext</a></span> 8 <span class="id"><a href="FMemory.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span> 16 <span class="id"><a href="FMemory.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.zero_ext">Val.zero_ext</a></span> 16 <span class="id"><a href="FMemory.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6059')">Proof.</div>
<div class="proofscript" id="proof6059">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">l</span> := <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>) <span class="id">ofs</span> <span class="id">m</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">v</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_cast">decode_val_cast</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_int8_signed_unsigned">load_int8_signed_unsigned</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="Coqlib.html#option_map">option_map</a></span> (<span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span> 8) (<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6060')">Proof.</div>
<div class="proofscript" id="proof6060">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span>) <span class="kwd">with</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">cl</span> := <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>) <span class="id">ofs</span> <span class="id">m</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">cl</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="id">decEq</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.sign_ext_zero_ext">Int.sign_ext_zero_ext</a></span>. <span class="tactic">auto</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_int16_signed_unsigned">load_int16_signed_unsigned</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="Coqlib.html#option_map">option_map</a></span> (<span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span> 16) (<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6061')">Proof.</div>
<div class="proofscript" id="proof6061">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span>) <span class="kwd">with</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">cl</span> := <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>) <span class="id">ofs</span> <span class="id">m</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">cl</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="id">decEq</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.sign_ext_zero_ext">Int.sign_ext_zero_ext</a></span>. <span class="tactic">auto</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties related to <span class="bracket"><span class="id">loadbytes</span></span> </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_loadbytes">range_perm_loadbytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">len</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#len">len</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bytes</span>, <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6062')">Proof.</div>
<div class="proofscript" id="proof6062">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">econstructor</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_range_perm">loadbytes_range_perm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">len</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#len">len</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6063')">Proof.</div>
<div class="proofscript" id="proof6063">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">bytes</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">len</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>). <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_load">loadbytes_load</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6064')">Proof.</div>
<div class="proofscript" id="proof6064">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>, <span class="id"><a href="FMemory.html#Mem.load">load</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_loadbytes">load_loadbytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bytes</span>, <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6065')">Proof.</div>
<div class="proofscript" id="proof6065">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_valid_access">load_valid_access</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>) <span class="id">ofs</span> <span class="id">m</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.getN_length">getN_length</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">n</span> <span class="id">p</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) = <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6066')">Proof.</div>
<div class="proofscript" id="proof6066">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="id">decEq</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_length">loadbytes_length</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> = <span class="id"><a href="Coqlib.html#nat_of_Z">nat_of_Z</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6067')">Proof.</div>
<div class="proofscript" id="proof6067">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_length">getN_length</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_empty">loadbytes_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#n">n</a></span> &lt;= 0 -&gt; <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6068')">Proof.</div>
<div class="proofscript" id="proof6068">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_neg">nat_of_Z_neg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">omegaContradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.getN_concat">getN_concat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="FMemory.html#n1">n1</a></span> + <span class="id"><a href="FMemory.html#n2">n2</a></span>)%<span class="id">nat</span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span> = <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span> ++ <span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span> (<span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span>) <span class="id"><a href="FMemory.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6069')">Proof.</div>
<div class="proofscript" id="proof6069">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>. <span class="tactic">simpl</span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">p</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zsucc">Zsucc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id">n1</span>)) <span class="kwd">with</span> ((<span class="id">p</span> + 1) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id">n1</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_concat">loadbytes_concat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">bytes1</span> <span class="id">bytes2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n1">n1</a></span>) <span class="id"><a href="FMemory.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#n1">n1</a></span> &gt;= 0 -&gt; <span class="id"><a href="FMemory.html#n2">n2</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#n1">n1</a></span> + <span class="id"><a href="FMemory.html#n2">n2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> ++ <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6070')">Proof.</div>
<div class="proofscript" id="proof6070">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n1</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> (<span class="id">ofs</span> + <span class="id">n1</span>) (<span class="id">ofs</span> + <span class="id">n1</span> + <span class="id">n2</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_plus">nat_of_Z_plus</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.getN_concat">getN_concat</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_eq">nat_of_Z_eq</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ofs0</span> &lt; <span class="id">ofs</span> + <span class="id">n1</span> \/ <span class="id">ofs0</span> &gt;= <span class="id">ofs</span> + <span class="id">n1</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>. <span class="tactic">apply</span> <span class="id">r</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">r0</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_split">loadbytes_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#n1">n1</a></span> + <span class="id"><a href="FMemory.html#n2">n2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#n1">n1</a></span> &gt;= 0 -&gt; <span class="id"><a href="FMemory.html#n2">n2</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bytes1</span>, <span class="id">exists</span> <span class="id">bytes2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n1">n1</a></span>) <span class="id"><a href="FMemory.html#n2">n2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#bytes">bytes</a></span> = <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> ++ <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6071')">Proof.</div>
<div class="proofscript" id="proof6071">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + (<span class="id">n1</span> + <span class="id">n2</span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_plus">nat_of_Z_plus</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.getN_concat">getN_concat</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_eq">nat_of_Z_eq</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">reflexivity</span>. <span class="tactic">split</span>. <span class="tactic">reflexivity</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">r</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">r</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_rep">load_rep</a></span>:<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">ch</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">z</span>, 0 &lt;= <span class="id"><a href="FMemory.html#z">z</a></span> &lt; <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#ch">ch</a></span> -&gt; <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#z">z</a></span>) <span class="id"><a href="FMemory.html#m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#z">z</a></span>) <span class="id"><a href="FMemory.html#m2">m2</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#ch">ch</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#ch">ch</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6072')">Proof.</div>
<div class="proofscript" id="proof6072">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">ch</span>) <span class="kwd">as</span> <span class="id">n</span>; <span class="tactic">clear</span> <span class="id">Heqn</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">ofs</span> <span class="id">H</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span>+0) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_int64_split">load_int64_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt; <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#v2">v2</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + 4) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="FMemory.html#v2">v2</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#v1">v1</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> (<span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6073')">Proof.</div>
<div class="proofscript" id="proof6073">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_valid_access">load_valid_access</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_loadbytes">load_loadbytes</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> [<span class="id">bytes</span> [<span class="id">LB</span> <span class="id">EQ</span>]].<br/>
&nbsp;&nbsp;<span class="id">change</span> 8 <span class="kwd">with</span> (4 + 4) <span class="kwd">in</span> <span class="id">LB</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_split">loadbytes_split</a></span>. <span class="id">eexact</span> <span class="id">LB</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">bytes1</span> &amp; <span class="id">bytes2</span> &amp; <span class="id">LB1</span> &amp; <span class="id">LB2</span> &amp; <span class="id">APP</span>).<br/>
&nbsp;&nbsp;<span class="id">change</span> 4 <span class="kwd">with</span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span>) <span class="kwd">in</span> <span class="id">LB1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_load">loadbytes_load</a></span>. <span class="id">eexact</span> <span class="id">LB1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> 4 <span class="kwd">with</span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span>) <span class="kwd">in</span> <span class="id">LB2</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_load">loadbytes_load</a></span>. <span class="id">eexact</span> <span class="id">LB2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_plus_r">Zdivide_plus_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>. <span class="id">exists</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">L2</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id">bytes1</span> <span class="kwd">else</span> <span class="id">bytes2</span>));<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id">bytes2</span> <span class="kwd">else</span> <span class="id">bytes1</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">APP</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_int64">decode_val_int64</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_length">loadbytes_length</a></span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_length">loadbytes_length</a></span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.addressing_int64_split">addressing_int64_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;(8 | <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="FMemory.html#i">i</a></span> (<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4))) = <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#i">i</a></span> + 4.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6074')">Proof.</div>
<div class="proofscript" id="proof6074">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_unsigned">Ptrofs.add_unsigned</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4))) <span class="kwd">with</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Ptrofs.agree32_of_int">Ptrofs.agree32_of_int</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4)) <span class="kwd">with</span> 4. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="Coqlib.html#Zdivide_interval">Zdivide_interval</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">i</span>) <span class="id"><a href="Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span> 8).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="Integers.html#Ptrofs.zwordsize">Ptrofs.zwordsize</a></span> - 3)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span>, <span class="id"><a href="Integers.html#Ptrofs.zwordsize">Ptrofs.zwordsize</a></span>, <span class="id"><a href="Integers.html#Ptrofs.wordsize">Ptrofs.wordsize</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Wordsize_Ptrofs.wordsize">Wordsize_Ptrofs.wordsize</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadv_int64_split">loadv_int64_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt; <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#v2">v2</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> (<span class="id"><a href="Values.html#Val.add">Val.add</a></span> <span class="id"><a href="FMemory.html#a">a</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4))) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="FMemory.html#v2">v2</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#v1">v1</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> (<span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6075')">Proof.</div>
<div class="proofscript" id="proof6075">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_int64_split">load_int64_split</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">v2</span> &amp; <span class="id">L1</span> &amp; <span class="id">L2</span> &amp; <span class="id">EQ</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.add">Val.add</a></span>; <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">NV</span>: <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">i</span> (<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4))) = <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">i</span> + 4).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.addressing_int64_split">addressing_int64_split</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_valid_access">load_valid_access</a></span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>]. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v1</span>, <span class="id">v2</span>.<br/>
<span class="id">Opaque</span> <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">NV</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties related to <span class="bracket"><span class="id">store</span></span> </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_store">valid_access_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span> -&gt;<br/>
&nbsp;&nbsp;{ <span class="id">m2</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> | <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span> }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6076')">Proof.</div>
<div class="proofscript" id="proof6076">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m1</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_access_store</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Mem.STORE">STORE</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STORE.chunk">chunk</a></span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STORE.m1">m1</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STORE.b">b</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STORE.ofs">ofs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STORE.v">v</a></span>: <span class="id"><a href="Values.html#val">val</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STORE.m2">m2</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Mem.STORE.STORE">STORE</a></span>: <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_validblocks">store_validblocks</a></span>: <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6077')">Proof.</div>
<div class="proofscript" id="proof6077">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STORE.STORE">STORE</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_freelist">store_freelist</a></span>: <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6078')">Proof.</div>
<div class="proofscript" id="proof6078">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STORE.STORE">STORE</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.in_freelist_store">in_freelist_store</a></span>: <span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6079')">Proof.</div>
<div class="proofscript" id="proof6079">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span>. <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_nextblockid">store_nextblockid</a></span>: <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6080')">Proof.</div>
<div class="proofscript" id="proof6080">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STORE.STORE">STORE</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_access">store_access</a></span>: <span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6081')">Proof.</div>
<div class="proofscript" id="proof6081">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> ( <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STORE.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_mem_contents">store_mem_contents</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> = <span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span>) <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span>) <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6082')">Proof.</div>
<div class="proofscript" id="proof6082">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STORE.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_store_1">perm_store_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6083')">Proof.</div>
<div class="proofscript" id="proof6083">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_access">store_access</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_store_2">perm_store_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6084')">Proof.</div>
<div class="proofscript" id="proof6084">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="kwd">in</span> *.  <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_access">store_access</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_store_1</span> <span class="id">perm_store_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.nextblock_store">nextblock_store</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6085')">Proof.</div>
<div class="proofscript" id="proof6085">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> ( <span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STORE.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_valid_block_1">store_valid_block_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6086')">Proof.</div>
<div class="proofscript" id="proof6086">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_validblocks">store_validblocks</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_valid_block_2">store_valid_block_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6087')">Proof.</div>
<div class="proofscript" id="proof6087">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_validblocks">store_validblocks</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">store_valid_block_1</span> <span class="id">store_valid_block_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_valid_access_1">store_valid_access_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6088')">Proof.</div>
<div class="proofscript" id="proof6088">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_valid_access_2">store_valid_access_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6089')">Proof.</div>
<div class="proofscript" id="proof6089">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_valid_access_3">store_valid_access_3</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6090')">Proof.</div>
<div class="proofscript" id="proof6090">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">store_valid_access_1</span> <span class="id">store_valid_access_2</span> <span class="id">store_valid_access_3</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_store_similar">load_store_similar</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id">chunk</span>' &lt;= <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id"><a href="Memdata.html#decode_encode_val">decode_encode_val</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id">chunk</span>' <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6091')">Proof.</div>
<div class="proofscript" id="proof6091">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_load">valid_access_load</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">chunk</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_compat">valid_access_compat</a></span>. <span class="tactic">symmetry</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v</span>' <span class="id">LOAD</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>') <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_same">getN_setN_same</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_encode_val_general">decode_encode_val_general</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_eq_rev">inj_eq_rev</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_store_similar_2">load_store_similar_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id">chunk</span>' &lt;= <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="AST.html#type_of_chunk">type_of_chunk</a></span> <span class="id">chunk</span>' = <span class="id"><a href="AST.html#type_of_chunk">type_of_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6092')">Proof.</div>
<div class="proofscript" id="proof6092">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.load_store_similar">load_store_similar</a></span> <span class="id">chunk</span>') <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">decEq</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memdata.html#decode_encode_val_similar">decode_encode_val_similar</a></span> <span class="kwd">with</span> (<span class="id">chunk1</span> := <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span>); <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_store_same">load_store_same</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6093')">Proof.</div>
<div class="proofscript" id="proof6093">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.load_store_similar_2">load_store_similar_2</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_store_other">load_store_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span><br/>
&nbsp;&nbsp;\/ <span class="id">ofs</span>' + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' &lt;= <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span><br/>
&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> &lt;= <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' = <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6094')">Proof.</div>
<div class="proofscript" id="proof6094">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="id">decEq</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_outside">getN_setN_outside</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_store_same">loadbytes_store_same</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6095')">Proof.</div>
<div class="proofscript" id="proof6095">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>) <span class="tactic">by</span> <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Coqlib.html#nat_of_Z">nat_of_Z</a></span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.v">v</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_same">getN_setN_same</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_store_other">loadbytes_store_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span><br/>
&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#n">n</a></span> &lt;= 0<br/>
&nbsp;&nbsp;\/ <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#n">n</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span><br/>
&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#Mem.STORE.ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.chunk">chunk</a></span> &lt;= <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6096')">Proof.</div>
<div class="proofscript" id="proof6096">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STORE.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' (<span class="id">ofs</span>' + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.STORE.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">n</span> 0) <span class="kwd">as</span> [<span class="id">z</span> | <span class="id">n0</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Coqlib.html#nat_of_Z_neg">nat_of_Z_neg</a></span> <span class="id">_</span> <span class="id">z</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_outside">getN_setN_outside</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_eq">nat_of_Z_eq</a></span>. <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">elim</span> <span class="id">n0</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.setN_in">setN_in</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span> <span class="id">p</span> <span class="id">q</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#p">p</a></span> &lt;= <span class="id"><a href="FMemory.html#q">q</a></span> &lt; <span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl">vl</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>)) <span class="id"><a href="FMemory.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6097')">Proof.</div>
<div class="proofscript" id="proof6097">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">length</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">p</span> <span class="id">q</span>). <span class="tactic">subst</span> <span class="id">q</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gss">ZMap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">apply</span> <span class="id">IHvl</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.getN_in">getN_in</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">q</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#p">p</a></span> &lt;= <span class="id"><a href="FMemory.html#q">q</a></span> &lt; <span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>) (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6098')">Proof.</div>
<div class="proofscript" id="proof6098">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">p</span> <span class="id">q</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">q</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">apply</span> <span class="id">IHn</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem.STORE">STORE</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_store_1</span> <span class="id">perm_store_2</span>: <span class="id">mem</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">store_valid_block_1</span> <span class="id">store_valid_block_2</span>: <span class="id">mem</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">store_valid_access_1</span> <span class="id">store_valid_access_2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">store_valid_access_3</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.load_store_overlap">load_store_overlap</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m2</span> <span class="id">chunk</span>' <span class="id">ofs</span>' <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id">ofs</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">ofs</span>' + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' &gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &gt; <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">mv1</span> <span class="id">mvl</span> <span class="id">mv1</span>' <span class="id">mvl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> (<span class="id"><a href="FMemory.html#mv1">mv1</a></span> :: <span class="id"><a href="FMemory.html#mvl">mvl</a></span>)<br/>
&nbsp;&nbsp;/\  <span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id">chunk</span>' (<span class="id">mv1</span>' :: <span class="id">mvl</span>') <span class="id">v</span>'<br/>
&nbsp;&nbsp;/\  (   (<span class="id">ofs</span>' = <span class="id"><a href="FMemory.html#ofs">ofs</a></span> /\ <span class="id">mv1</span>' = <span class="id"><a href="FMemory.html#mv1">mv1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id">ofs</span>' &gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">mv1</span>' <span class="id"><a href="FMemory.html#mvl">mvl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id">ofs</span>' &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#mv1">mv1</a></span> <span class="id">mvl</span>')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6099')">Proof.</div>
<div class="proofscript" id="proof6099">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">c</span> := (<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span> <span class="id">m1</span>)#<span class="id">b</span>). <span class="tactic">intros</span> <span class="id">V</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_chunk_nat_pos">size_chunk_nat_pos</a></span> <span class="id">chunk</span>) <span class="kwd">as</span> [<span class="id">sz</span> <span class="id">SIZE</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_chunk_nat_pos">size_chunk_nat_pos</a></span> <span class="id">chunk</span>') <span class="kwd">as</span> [<span class="id">sz</span>' <span class="id">SIZE</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">v</span>) <span class="kwd">as</span> [ | <span class="id">mv1</span> <span class="id">mvl</span>] <span class="id">eqn</span>:<span class="id">ENC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="id">chunk</span> <span class="id">v</span>); <span class="tactic">rewrite</span> <span class="id">ENC</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">c</span>' := <span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> (<span class="id">mv1</span>::<span class="id">mvl</span>) <span class="id">ofs</span> <span class="id">c</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">mv1</span>, <span class="id">mvl</span>, (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id">ofs</span>' <span class="id">c</span>'), (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id">sz</span>' (<span class="id">ofs</span>' + 1) <span class="id">c</span>').<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">ENC</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_shape">encode_val_shape</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">V</span>', <span class="id">SIZE</span>'. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_shape">decode_val_shape</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">ofs</span>' <span class="id">ofs</span>).<br/>
- <span class="tactic">subst</span> <span class="id">ofs</span>'. <span class="id">left</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id">c</span>'. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#ZMap.gss">ZMap.gss</a></span>.<br/>
- <span class="id">right</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">ofs</span>').<br/>
&nbsp;If&nbsp;ofs&nbsp;&lt;&nbsp;ofs':&nbsp;&nbsp;the&nbsp;load&nbsp;reads&nbsp;(at&nbsp;ofs')&nbsp;a&nbsp;continuation&nbsp;byte&nbsp;from&nbsp;the&nbsp;write.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofs&nbsp;&nbsp;&nbsp;ofs'&nbsp;&nbsp;&nbsp;ofs+|chunk|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-------------------]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-------------------]&nbsp;&nbsp;read<br/>
*)</span>+ <span class="id">left</span>; <span class="tactic">split</span>. <span class="tactic">omega</span>. <span class="tactic">unfold</span> <span class="id">c</span>'. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_in">setN_in</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id">mv1</span> :: <span class="id">mvl</span>)) = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;- <span class="id">ENC</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">length</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">omega</span>.<br/>
&nbsp;If&nbsp;ofs&nbsp;&gt;&nbsp;ofs':&nbsp;&nbsp;the&nbsp;load&nbsp;reads&nbsp;(at&nbsp;ofs)&nbsp;the&nbsp;first&nbsp;byte&nbsp;from&nbsp;the&nbsp;write.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofs'&nbsp;&nbsp;&nbsp;ofs&nbsp;&nbsp;&nbsp;ofs'+|chunk'|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-------------------]&nbsp;&nbsp;write<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[----------------]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read<br/>
*)</span>+ <span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">omega</span>. <span class="tactic">replace</span> <span class="id">mv1</span> <span class="kwd">with</span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id">ofs</span> <span class="id">c</span>').<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_in">getN_in</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zsucc">Zsucc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">sz</span>')).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="tactic">rewrite</span> <span class="id">SIZE</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">c</span>'. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#ZMap.gss">ZMap.gss</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.compat_pointer_chunks">compat_pointer_chunks</a></span> (<span class="id">chunk1</span> <span class="id">chunk2</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span>, <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="AST.html#Mint32">Mint32</a></span> | <span class="id"><a href="AST.html#Many32">Many32</a></span>), (<span class="id"><a href="AST.html#Mint32">Mint32</a></span> | <span class="id"><a href="AST.html#Many32">Many32</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="AST.html#Mint64">Mint64</a></span> | <span class="id"><a href="AST.html#Many64">Many64</a></span>), (<span class="id"><a href="AST.html#Mint64">Mint64</a></span> | <span class="id"><a href="AST.html#Many64">Many64</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.compat_pointer_chunks_true">compat_pointer_chunks_true</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk1</span> <span class="id">chunk2</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#quantity_chunk">quantity_chunk</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="Memdata.html#quantity_chunk">quantity_chunk</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.compat_pointer_chunks">compat_pointer_chunks</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6100')">Proof.</div>
<div class="proofscript" id="proof6100">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">P</span>|[<span class="id">P</span>|[<span class="id">P</span>|<span class="id">P</span>]]]; <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">Q</span>|[<span class="id">Q</span>|[<span class="id">Q</span>|<span class="id">Q</span>]]];<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_pointer_store">load_pointer_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m2</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">v_b</span> <span class="id">v_o</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="FMemory.html#v_b">v_b</a></span> <span class="id"><a href="FMemory.html#v_o">v_o</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="FMemory.html#v_b">v_b</a></span> <span class="id"><a href="FMemory.html#v_o">v_o</a></span> /\ <span class="id"><a href="FMemory.html#Mem.compat_pointer_chunks">compat_pointer_chunks</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">chunk</span>' /\ <span class="id">b</span>' = <span class="id"><a href="FMemory.html#b">b</a></span> /\ <span class="id">ofs</span>' = <span class="id"><a href="FMemory.html#ofs">ofs</a></span>)<br/>
&nbsp;&nbsp;\/ (<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#b">b</a></span> \/ <span class="id">ofs</span>' + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id">ofs</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6101')">Proof.</div>
<div class="proofscript" id="proof6101">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id">b</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">ofs</span>' + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>') <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) <span class="id">ofs</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_store_overlap">load_store_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">mv1</span> &amp; <span class="id">mvl</span> &amp; <span class="id">mv1</span>' &amp; <span class="id">mvl</span>' &amp; <span class="id">ENC</span> &amp; <span class="id">DEC</span> &amp; <span class="id">CASES</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">DEC</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">CASES</span> <span class="kwd">as</span> [(<span class="id">A</span> &amp; <span class="id">B</span>) | [(<span class="id">A</span> &amp; <span class="id">B</span>) | (<span class="id">A</span> &amp; <span class="id">B</span>)]].<br/>
- <span class="comment">(*&nbsp;Same&nbsp;offset&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">ENC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>)<br/>
&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">auto</span> || <span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">P</span>|[<span class="id">P</span>|[<span class="id">P</span>|<span class="id">P</span>]]]; <span class="tactic">subst</span> <span class="id">chunk</span>'; <span class="tactic">destruct</span> <span class="id">v0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.compat_pointer_chunks_true">compat_pointer_chunks_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;ofs'&nbsp;&gt;&nbsp;ofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ENC</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H10</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">j</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="id">inv</span> <span class="id">P</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H8</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">n</span> &amp; <span class="id">P</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
- <span class="comment">(*&nbsp;ofs'&nbsp;&lt;&nbsp;ofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H7</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">j</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">subst</span> <span class="id">mv1</span>. <span class="id">inv</span> <span class="id">ENC</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_store_pointer_overlap">load_store_pointer_overlap</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v_b</span> <span class="id">v_o</span> <span class="id">m2</span> <span class="id">chunk</span>' <span class="id">ofs</span>' <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="FMemory.html#v_b">v_b</a></span> <span class="id"><a href="FMemory.html#v_o">v_o</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id">ofs</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">ofs</span>' &lt;&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">ofs</span>' + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>' &gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &gt; <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6102')">Proof.</div>
<div class="proofscript" id="proof6102">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_store_overlap">load_store_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">mv1</span> &amp; <span class="id">mvl</span> &amp; <span class="id">mv1</span>' &amp; <span class="id">mvl</span>' &amp; <span class="id">ENC</span> &amp; <span class="id">DEC</span> &amp; <span class="id">CASES</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">CASES</span> <span class="kwd">as</span> [(<span class="id">A</span> &amp; <span class="id">B</span>) | [(<span class="id">A</span> &amp; <span class="id">B</span>) | (<span class="id">A</span> &amp; <span class="id">B</span>)]].<br/>
- <span class="tactic">congruence</span>.<br/>
- <span class="id">inv</span> <span class="id">ENC</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H9</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">j</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">subst</span> <span class="id">mv1</span>'. <span class="id">inv</span> <span class="id">DEC</span>. <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">DEC</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">inv</span> <span class="id">DEC</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H10</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">j</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">subst</span> <span class="id">mv1</span>. <span class="id">inv</span> <span class="id">ENC</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">H8</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">n</span> &amp; <span class="id">P</span>). <span class="tactic">subst</span> <span class="id">mv1</span>. <span class="id">inv</span> <span class="id">ENC</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_store_pointer_mismatch">load_store_pointer_mismatch</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v_b</span> <span class="id">v_o</span> <span class="id">m2</span> <span class="id">chunk</span>' <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="FMemory.html#v_b">v_b</a></span> <span class="id"><a href="FMemory.html#v_o">v_o</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;~<span class="id"><a href="FMemory.html#Mem.compat_pointer_chunks">compat_pointer_chunks</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">chunk</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6103')">Proof.</div>
<div class="proofscript" id="proof6103">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_store_overlap">load_store_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>'); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">mv1</span> &amp; <span class="id">mvl</span> &amp; <span class="id">mv1</span>' &amp; <span class="id">mvl</span>' &amp; <span class="id">ENC</span> &amp; <span class="id">DEC</span> &amp; <span class="id">CASES</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">CASES</span> <span class="kwd">as</span> [(<span class="id">A</span> &amp; <span class="id">B</span>) | [(<span class="id">A</span> &amp; <span class="id">B</span>) | (<span class="id">A</span> &amp; <span class="id">B</span>)]]; <span class="tactic">try</span> <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ENC</span>; <span class="id">inv</span> <span class="id">DEC</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">elim</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.compat_pointer_chunks_true">compat_pointer_chunks_true</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_similar_chunks">store_similar_chunks</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk1</span> <span class="id">chunk2</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> = <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk1">chunk1</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk2">chunk2</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6104')">Proof.</div>
<div class="proofscript" id="proof6104">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk1</span> = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="id">chunk1</span> <span class="id">v1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="id">chunk2</span> <span class="id">v2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id">chunk1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id">chunk2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mkmem_ext">mkmem_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_compat">valid_access_compat</a></span> <span class="kwd">with</span> <span class="id">chunk1</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_compat">valid_access_compat</a></span> <span class="kwd">with</span> <span class="id">chunk2</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_signed_unsigned_8">store_signed_unsigned_8</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6105')">Proof.</div>
<div class="proofscript" id="proof6105">
 <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_similar_chunks">store_similar_chunks</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_int8_signed_unsigned">encode_val_int8_signed_unsigned</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_signed_unsigned_16">store_signed_unsigned_16</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6106')">Proof.</div>
<div class="proofscript" id="proof6106">
 <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_similar_chunks">store_similar_chunks</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_int16_signed_unsigned">encode_val_int16_signed_unsigned</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_int8_zero_ext">store_int8_zero_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 <span class="id"><a href="FMemory.html#n">n</a></span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6107')">Proof.</div>
<div class="proofscript" id="proof6107">
 <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_similar_chunks">store_similar_chunks</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_int8_zero_ext">encode_val_int8_zero_ext</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_int8_sign_ext">store_int8_sign_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 8 <span class="id"><a href="FMemory.html#n">n</a></span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6108')">Proof.</div>
<div class="proofscript" id="proof6108">
 <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_similar_chunks">store_similar_chunks</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_int8_sign_ext">encode_val_int8_sign_ext</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_int16_zero_ext">store_int16_zero_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 <span class="id"><a href="FMemory.html#n">n</a></span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6109')">Proof.</div>
<div class="proofscript" id="proof6109">
 <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_similar_chunks">store_similar_chunks</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_int16_zero_ext">encode_val_int16_zero_ext</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_int16_sign_ext">store_int16_sign_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 16 <span class="id"><a href="FMemory.html#n">n</a></span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6110')">Proof.</div>
<div class="proofscript" id="proof6110">
 <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_similar_chunks">store_similar_chunks</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_int16_sign_ext">encode_val_int16_sign_ext</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<br/>
<h2> Properties related to <span class="bracket"><span class="id">storebytes</span></span>. </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_storebytes">range_perm_storebytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span> -&gt;<br/>
&nbsp;&nbsp;{ <span class="id">m2</span> : <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> | <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span> }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6111')">Proof.</div>
<div class="proofscript" id="proof6111">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes</span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_store">storebytes_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">chunk</span> <span class="id">v</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6112')">Proof.</div>
<div class="proofscript" id="proof6112">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span>, <span class="id"><a href="FMemory.html#Mem.store">store</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">v</span>))) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m1</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mkmem_ext">mkmem_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">n</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="kwd">in</span> <span class="id">r</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_storebytes">store_storebytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">chunk</span> <span class="id">v</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6113')">Proof.</div>
<div class="proofscript" id="proof6113">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span>, <span class="id"><a href="FMemory.html#Mem.store">store</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m1</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">v</span>))) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mkmem_ext">mkmem_ext</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v0</span>.  <span class="tactic">elim</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Mem.STOREBYTES">STOREBYTES</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STOREBYTES.m1">m1</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STOREBYTES.b">b</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STOREBYTES.ofs">ofs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STOREBYTES.bytes">bytes</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.STOREBYTES.m2">m2</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Mem.STOREBYTES.STORE">STORE</a></span>: <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_access">storebytes_access</a></span>: <span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.mem_access">mem_access</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6114')">Proof.</div>
<div class="proofscript" id="proof6114">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>);<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_mem_contents">storebytes_mem_contents</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> = <span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span>) <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6115')">Proof.</div>
<div class="proofscript" id="proof6115">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>);<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_freelist">storebytes_freelist</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6116')">Proof.</div>
<div class="proofscript" id="proof6116">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.in_freelist_storebytes">in_freelist_storebytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6117')">Proof.</div>
<div class="proofscript" id="proof6117">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_validblocks">storebytes_validblocks</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6118')">Proof.</div>
<div class="proofscript" id="proof6118">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_nextblockid">storebytes_nextblockid</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6119')">Proof.</div>
<div class="proofscript" id="proof6119">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_storebytes_1">perm_storebytes_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6120')">Proof.</div>
<div class="proofscript" id="proof6120">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_access">storebytes_access</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_storebytes_2">perm_storebytes_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6121')">Proof.</div>
<div class="proofscript" id="proof6121">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_access">storebytes_access</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_storebytes_1</span> <span class="id">perm_storebytes_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_valid_access_1">storebytes_valid_access_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6122')">Proof.</div>
<div class="proofscript" id="proof6122">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_valid_access_2">storebytes_valid_access_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6123')">Proof.</div>
<div class="proofscript" id="proof6123">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">storebytes_valid_access_1</span> <span class="id">storebytes_valid_access_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.nextblock_storebytes">nextblock_storebytes</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6124')">Proof.</div>
<div class="proofscript" id="proof6124">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>);<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6125')">Proof.</div>
<div class="proofscript" id="proof6125">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_validblocks">storebytes_validblocks</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_valid_block_2">storebytes_valid_block_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6126')">Proof.</div>
<div class="proofscript" id="proof6126">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_validblocks">storebytes_validblocks</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">storebytes_valid_block_1</span> <span class="id">storebytes_valid_block_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_range_perm">storebytes_range_perm</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6127')">Proof.</div>
<div class="proofscript" id="proof6127">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>);<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_storebytes_same">loadbytes_storebytes_same</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6128')">Proof.</div>
<div class="proofscript" id="proof6128">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">assert</span> (<span class="id">STORE2</span>:=<span class="id"><a href="FMemory.html#Mem.STOREBYTES.STORE">STORE</a></span>). <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">STORE2</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="id">inv</span> <span class="id">STORE2</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_of_nat">nat_of_Z_of_nat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_same">getN_setN_same</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_storebytes_disjoint">loadbytes_storebytes_disjoint</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">len</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#len">len</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span> \/ <span class="id"><a href="Intv.html#disjoint">Intv.disjoint</a></span> (<span class="id">ofs</span>', <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#len">len</a></span>) (<span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span>, <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#len">len</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6129')">Proof.</div>
<div class="proofscript" id="proof6129">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' (<span class="id">ofs</span>' + <span class="id">len</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_disjoint">getN_setN_disjoint</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_eq">nat_of_Z_eq</a></span>; <span class="tactic">auto</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_storebytes_other">loadbytes_storebytes_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">len</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#len">len</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span><br/>
&nbsp;&nbsp;\/ <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#len">len</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span><br/>
&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>) &lt;= <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#len">len</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6130')">Proof.</div>
<div class="proofscript" id="proof6130">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_storebytes_disjoint">loadbytes_storebytes_disjoint</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="id">right</span>. <span class="tactic">apply</span> <span class="id"><a href="Intv.html#disjoint_range">Intv.disjoint_range</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_storebytes_other">load_storebytes_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span><br/>
&nbsp;&nbsp;\/ <span class="id">ofs</span>' + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span><br/>
&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#Mem.STOREBYTES.ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.bytes">bytes</a></span>) &lt;= <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m2">m2</a></span> <span class="id">b</span>' <span class="id">ofs</span>' = <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6131')">Proof.</div>
<div class="proofscript" id="proof6131">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES.m1">m1</a></span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.STOREBYTES.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.getN_setN_outside">getN_setN_outside</a></span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem.STOREBYTES">STOREBYTES</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.setN_concat">setN_concat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bytes1</span> <span class="id">bytes2</span> <span class="id">ofs</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> (<span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> ++ <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>) <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#c">c</a></span> = <span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span>)) (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6132')">Proof.</div>
<div class="proofscript" id="proof6132">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bytes1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">length</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">IHbytes1</span>. <span class="id">decEq</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_concat">storebytes_concat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">m1</span> <span class="id">bytes2</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span>)) <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> ++ <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6133')">Proof.</div>
<div class="proofscript" id="proof6133">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="id">H</span>; <span class="tactic">intro</span> <span class="id">ST1</span>. <span class="tactic">generalize</span> <span class="id">H0</span>; <span class="tactic">intro</span> <span class="id">ST2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">ST1</span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="kwd">in</span> <span class="id">ST2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes1</span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes1</span>)) (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes1</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes2</span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id">bytes1</span> ++ <span class="id">bytes2</span>))) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ST1</span>; <span class="id">inv</span> <span class="id">ST2</span>; <span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mkmem_ext">mkmem_ext</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>.  <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_concat">setN_concat</a></span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PMap.set2">PMap.set2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_plus">inj_plus</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes1</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">r</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">r0</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_split">storebytes_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">bytes2</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> ++ <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span>)) <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6134')">Proof.</div>
<div class="proofscript" id="proof6134">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_storebytes">range_perm_storebytes</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes1</span>) <span class="kwd">as</span> [<span class="id">m1</span> <span class="id">ST1</span>].<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.storebytes_range_perm">storebytes_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_plus">inj_plus</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_storebytes">range_perm_storebytes</a></span> <span class="id">m1</span> <span class="id">b</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes1</span>)) <span class="id">bytes2</span>) <span class="kwd">as</span> [<span class="id">m2</span>' <span class="id">ST2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>; <span class="tactic">eauto</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.storebytes_range_perm">storebytes_range_perm</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">H</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs0</span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_plus">inj_plus</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>').<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_concat">storebytes_concat</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_int64_split">store_int64_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt; <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + 4) (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6135')">Proof.</div>
<div class="proofscript" id="proof6135">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">store_valid_access_3</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_storebytes">store_storebytes</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">intros</span> <span class="id">SB</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_int64">encode_val_int64</a></span> <span class="kwd">in</span> <span class="id">SB</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.storebytes_split">storebytes_split</a></span>. <span class="id">eexact</span> <span class="id">SB</span>. <span class="tactic">intros</span> [<span class="id">m1</span> [<span class="id">SB1</span> <span class="id">SB2</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="kwd">in</span> <span class="id">SB2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SB2</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_store">storebytes_store</a></span>. <span class="tactic">exact</span> <span class="id">SB1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_store">storebytes_store</a></span>. <span class="tactic">exact</span> <span class="id">SB2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_plus_r">Zdivide_plus_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>. <span class="id">exists</span> 1; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storev_int64_split">storev_int64_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#a">a</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt; <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#a">a</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> (<span class="id"><a href="Values.html#Val.add">Val.add</a></span> <span class="id"><a href="FMemory.html#a">a</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 4))) (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6136')">Proof.</div>
<div class="proofscript" id="proof6136">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_int64_split">store_int64_split</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">m1</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storev">storev</a></span>, <span class="id"><a href="Values.html#Val.add">Val.add</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.addressing_int64_split">addressing_int64_split</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">store_valid_access_3</a></span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>]. <span class="tactic">exact</span> <span class="id">Q</span>.<br/>
Qed.</div>
<br/>
<h2> Properties related to <span class="bracket"><span class="id">alloc</span></span>. </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Mem.ALLOC">ALLOC</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.ALLOC.m1">m1</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="Mem.ALLOC.lo">lo</a></span> <span class="id"><a name="Mem.ALLOC.hi">hi</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.ALLOC.m2">m2</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.ALLOC.b">b</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Mem.ALLOC.ALLOC">ALLOC</a></span>: <span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span> = (<span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span>, <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_freelist">alloc_freelist</a></span>: <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6137')">Proof.</div>
<div class="proofscript" id="proof6137">
 <span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.in_freelist_alloc">in_freelist_alloc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6138')">Proof.</div>
<div class="proofscript" id="proof6138">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_validblocks">alloc_validblocks</a></span>: <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> :: <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6139')">Proof.</div>
<div class="proofscript" id="proof6139">
 <span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_nextblockid">alloc_nextblockid</a></span>: <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6140')">Proof.</div>
<div class="proofscript" id="proof6140">
 <span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>. Qed.</div>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_result">alloc_result</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6141')">Proof.</div>
<div class="proofscript" id="proof6141">
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_alloc">valid_block_alloc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6142')">Proof.</div>
<div class="proofscript" id="proof6142">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_validblocks">alloc_validblocks</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.fresh_block_alloc">fresh_block_alloc</a></span>:<br/>
&nbsp;&nbsp;~(<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6143')">Proof.</div>
<div class="proofscript" id="proof6143">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.nextblock_invalid">nextblock_invalid</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_new_block">valid_new_block</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6144')">Proof.</div>
<div class="proofscript" id="proof6144">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span>, <span class="id"><a href="FMemory.html#Mem.alloc_validblocks">alloc_validblocks</a></span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_block_alloc</span> <span class="id">fresh_block_alloc</span> <span class="id">valid_new_block</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_alloc_inv">valid_block_alloc_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' -&gt; <span class="id">b</span>' = <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> \/ <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6145')">Proof.</div>
<div class="proofscript" id="proof6145">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_validblocks">alloc_validblocks</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_alloc_1">perm_alloc_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6146')">Proof.</div>
<div class="proofscript" id="proof6146">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">intros</span>. <span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">invalid_noaccess</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">contradiction</span>. <span class="tactic">subst</span> <span class="id">b</span>'. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.nextblock_invalid">nextblock_invalid</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_alloc_2">perm_alloc_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span>, <span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6147')">Proof.</div>
<div class="proofscript" id="proof6147">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">intros</span>. <span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zle_true">zle_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zlt_true">zlt_true</a></span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_alloc_inv">perm_alloc_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span> <span class="kwd">else</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6148')">Proof.</div>
<div class="proofscript" id="proof6148">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">p</span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>. <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> <span class="id">ofs</span>); <span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_alloc_3">perm_alloc_3</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6149')">Proof.</div>
<div class="proofscript" id="proof6149">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_alloc_4">perm_alloc_4</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6150')">Proof.</div>
<div class="proofscript" id="proof6150">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">perm_alloc_1</span> <span class="id">perm_alloc_2</span> <span class="id">perm_alloc_3</span> <span class="id">perm_alloc_4</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_alloc_other">valid_access_alloc_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6151')">Proof.</div>
<div class="proofscript" id="proof6151">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_alloc_same">valid_access_alloc_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span> -&gt; (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6152')">Proof.</div>
<div class="proofscript" id="proof6152">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_access_alloc_other</span> <span class="id">valid_access_alloc_same</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_alloc_inv">valid_access_alloc_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> /\ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span> /\ (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6153')">Proof.</div>
<div class="proofscript" id="proof6153">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id">p</span>). <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> - 1) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id">p</span>). <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_alloc_unchanged">load_alloc_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6154')">Proof.</div>
<div class="proofscript" id="proof6154">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.valid_access_alloc_inv">valid_access_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>'. <span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_not_equal">sym_not_equal</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_alloc_other">load_alloc_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6155')">Proof.</div>
<div class="proofscript" id="proof6155">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.load_alloc_unchanged">load_alloc_unchanged</a></span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_alloc_same">load_alloc_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6156')">Proof.</div>
<div class="proofscript" id="proof6156">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_chunk_nat_pos">size_chunk_nat_pos</a></span> <span class="id">chunk</span>) <span class="kwd">as</span> [<span class="id">n</span> <span class="id">E</span>]. <span class="tactic">rewrite</span> <span class="id">E</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gi">ZMap.gi</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_undef">decode_val_undef</a></span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">load_alloc_same</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.ALLOC.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.ALLOC.hi">hi</a></span> -&gt; (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6157')">Proof.</div>
<div class="proofscript" id="proof6157">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id">chunk</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_load">valid_access_load</a></span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>. <span class="tactic">omega</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">v</span> <span class="id">LOAD</span>]. <span class="tactic">rewrite</span> <span class="id">LOAD</span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.load_alloc_same">load_alloc_same</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_alloc_unchanged">loadbytes_alloc_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6158')">Proof.</div>
<div class="proofscript" id="proof6158">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">B</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_1">perm_alloc_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n0</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_alloc_same">loadbytes_alloc_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">ofs</span> <span class="id">bytes</span> <span class="id">byte</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#byte">byte</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt; <span class="id"><a href="FMemory.html#byte">byte</a></span> = <span class="id"><a href="Memdata.html#Undef">Undef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6159')">Proof.</div>
<div class="proofscript" id="proof6159">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.ALLOC.b">b</a></span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id"><a href="FMemory.html#Mem.ALLOC.ALLOC">ALLOC</a></span>; <span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">B</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Coqlib.html#nat_of_Z">nat_of_Z</a></span> <span class="id">n</span>) <span class="id">ofs</span>. <span class="tactic">induction</span> <span class="id">n0</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gi">ZMap.gi</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem.ALLOC">ALLOC</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_block_alloc</span> <span class="id">fresh_block_alloc</span> <span class="id">valid_new_block</span>: <span class="id">mem</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_access_alloc_other</span> <span class="id">valid_access_alloc_same</span>: <span class="id">mem</span>.<br/>
<br/>
<h2> Properties related to <span class="bracket"><span class="id">free</span></span>. </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_free">range_perm_free</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span> -&gt;<br/>
&nbsp;&nbsp;{ <span class="id">m2</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> | <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span> }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6160')">Proof.</div>
<div class="proofscript" id="proof6160">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Mem.FREE">FREE</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.FREE.m1">m1</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.FREE.bf">bf</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="Mem.FREE.lo">lo</a></span> <span class="id"><a name="Mem.FREE.hi">hi</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.FREE.m2">m2</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Mem.FREE.FREE">FREE</a></span>: <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.free_range_perm">free_range_perm</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6161')">Proof.</div>
<div class="proofscript" id="proof6161">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="kwd">in</span> <span class="id">FREE</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_freelist">free_freelist</a></span>: <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6162')">Proof.</div>
<div class="proofscript" id="proof6162">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="kwd">in</span> <span class="id">FREE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="tactic">inversion</span> <span class="id">FREE</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.in_freelist_free">in_freelist_free</a></span>: <span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id">b</span>' &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6163')">Proof.</div>
<div class="proofscript" id="proof6163">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span>; <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_validblocks">free_validblocks</a></span>: <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6164')">Proof.</div>
<div class="proofscript" id="proof6164">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="kwd">in</span> <span class="id">FREE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="tactic">inversion</span> <span class="id">FREE</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_nextblockid">free_nextblockid</a></span>: <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6165')">Proof.</div>
<div class="proofscript" id="proof6165">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="kwd">in</span> <span class="id">FREE</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="tactic">inversion</span> <span class="id">FREE</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_result">free_result</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6166')">Proof.</div>
<div class="proofscript" id="proof6166">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="kwd">in</span> <span class="id">FREE</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.nextblock_free">nextblock_free</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6167')">Proof.</div>
<div class="proofscript" id="proof6167">
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_free_1">valid_block_free_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6168')">Proof.</div>
<div class="proofscript" id="proof6168">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_free_2">valid_block_free_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6169')">Proof.</div>
<div class="proofscript" id="proof6169">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_block_free_1</span> <span class="id">valid_block_free_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_free_1">perm_free_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6170')">Proof.</div>
<div class="proofscript" id="proof6170">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>, <span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span>). <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id">ofs</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_free_2">perm_free_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> -&gt; ~ <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6171')">Proof.</div>
<div class="proofscript" id="proof6171">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>, <span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zle_true">zle_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zlt_true">zlt_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">tauto</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_free_3">perm_free_3</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6172')">Proof.</div>
<div class="proofscript" id="proof6172">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">p</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>, <span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span>). <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id">ofs</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>); <span class="tactic">simpl</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_free_inv">perm_free_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> /\ <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>) \/ <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6173')">Proof.</div>
<div class="proofscript" id="proof6173">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>, <span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id">ofs</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_free_1">valid_access_free_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &gt;= <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6174')">Proof.</div>
<div class="proofscript" id="proof6174">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_1">perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>). <span class="tactic">intuition</span>. <span class="id">right</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_free_2">valid_access_free_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &gt; <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> -&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;~(<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6175')">Proof.</div>
<div class="proofscript" id="proof6175">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_free_inv_1">valid_access_free_inv_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6176')">Proof.</div>
<div class="proofscript" id="proof6176">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">generalize</span> (<span class="id">H</span> <span class="id">ofs0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>, <span class="id"><a href="FMemory.html#Mem.unchecked_free">unchecked_free</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span>). <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id">ofs0</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_free_inv_2">valid_access_free_inv_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &gt;= <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6177')">Proof.</div>
<div class="proofscript" id="proof6177">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_free_2">valid_access_free_2</a></span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">p</span>); <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_free">load_free</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &gt;= <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6178')">Proof.</div>
<div class="proofscript" id="proof6178">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_free_inv_1">valid_access_free_inv_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_free_1">valid_access_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_free_2">load_free_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6179')">Proof.</div>
<div class="proofscript" id="proof6179">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_free_inv_1">valid_access_free_inv_1</a></span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_free">loadbytes_free</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.FREE.bf">bf</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> &gt;= <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n">n</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.FREE.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.FREE.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6180')">Proof.</div>
<div class="proofscript" id="proof6180">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">n0</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_1">perm_free_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="id">right</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_free_2">loadbytes_free_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6181')">Proof.</div>
<div class="proofscript" id="proof6181">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.FREE.m2">m2</a></span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem.FREE">FREE</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_block_free_1</span> <span class="id">valid_block_free_2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">perm_free_1</span> <span class="id">perm_free_2</span> <span class="id">perm_free_3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">valid_access_free_1</span> <span class="id">valid_access_free_inv_1</span>: <span class="id">mem</span>.<br/>
<br/>
<h2> Properties related to <span class="bracket"><span class="id">drop_perm</span></span> </h2>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_drop_1">range_perm_drop_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m</span>', <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6182')">Proof.</div>
<div class="proofscript" id="proof6182">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>). <span class="tactic">auto</span>. <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_drop_2">range_perm_drop_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span> -&gt; {<span class="id">m</span>' | <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6183')">Proof.</div>
<div class="proofscript" id="proof6183">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>). <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">contradiction</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Mem.DROP">DROP</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.DROP.m">m</a></span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.DROP.b">b</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.DROP.lo">lo</a></span> <span class="id"><a name="Mem.DROP.hi">hi</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.DROP.p">p</a></span>: <span class="id"><a href="Memperm.html#permission">permission</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">m</span>': <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Mem.DROP.DROP">DROP</a></span>: <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_freelist">drop_freelist</a></span>: <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id">m</span>' = <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6184')">Proof.</div>
<div class="proofscript" id="proof6184">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.in_freelist_drop">in_freelist_drop</a></span>: <span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id">m</span>' <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6185')">Proof.</div>
<div class="proofscript" id="proof6185">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.drop_freelist">drop_freelist</a></span>; <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_validblocks">drop_validblocks</a></span>: <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id">m</span>' = <span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6186')">Proof.</div>
<div class="proofscript" id="proof6186">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_nextblockid">drop_nextblockid</a></span>: <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id">m</span>' = <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6187')">Proof.</div>
<div class="proofscript" id="proof6187">
 <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span>; <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.nextblock_drop">nextblock_drop</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id">m</span>' = <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6188')">Proof.</div>
<div class="proofscript" id="proof6188">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.drop_perm_valid_block_1">drop_perm_valid_block_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id">m</span>' <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6189')">Proof.</div>
<div class="proofscript" id="proof6189">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.drop_validblocks">drop_validblocks</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.drop_perm_valid_block_2">drop_perm_valid_block_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>', <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id">m</span>' <span class="id">b</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6190')">Proof.</div>
<div class="proofscript" id="proof6190">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.drop_validblocks">drop_validblocks</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_drop_1">perm_drop_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span>, <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6191')">Proof.</div>
<div class="proofscript" id="proof6191">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zle_true">zle_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zlt_true">zlt_true</a></span>. <span class="tactic">simpl</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_drop_2">perm_drop_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>', <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id">p</span>' -&gt; <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span> <span class="id">p</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6192')">Proof.</div>
<div class="proofscript" id="proof6192">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zle_true">zle_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zlt_true">zlt_true</a></span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_drop_3">perm_drop_3</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>', <span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id">p</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id">p</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6193')">Proof.</div>
<div class="proofscript" id="proof6193">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id">ofs</span>). <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span>).<br/>
&nbsp;&nbsp;<span class="id">byContradiction</span>. <span class="tactic">intuition</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_drop_4">perm_drop_4</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>', <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id">p</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id">p</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6194')">Proof.</div>
<div class="proofscript" id="proof6194">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>'. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id">ofs</span>). <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur">perm_cur</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">r</span>. <span class="tactic">tauto</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_access_drop_1">valid_access_drop_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">p</span>',<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> \/ <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span> <span class="id">p</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id">p</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id">p</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6195')">Proof.</div>
<div class="proofscript" id="proof6195">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id">ofs0</span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_1">perm_drop_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">intros</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_access_drop_2">valid_access_drop_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">p</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id">p</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id">p</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6196')">Proof.</div>
<div class="proofscript" id="proof6196">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_drop">load_drop</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> \/ <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">m</span>' <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6197')">Proof.</div>
<div class="proofscript" id="proof6197">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">chunk</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_drop_1">valid_access_drop_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_drop_2">valid_access_drop_2</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_drop">loadbytes_drop</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> \/ <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n">n</a></span> &lt;= <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> \/ <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> \/ <span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id">m</span>' <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6198')">Proof.</div>
<div class="proofscript" id="proof6198">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id">b</span>' <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.m">m</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id"><a href="FMemory.html#Mem.DROP.DROP">DROP</a></span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#Mem.DROP.b">b</a></span>). <span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> <span class="id"><a href="FMemory.html#Mem.DROP.lo">lo</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id"><a href="FMemory.html#Mem.DROP.hi">hi</a></span> <span class="id">ofs0</span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="FMemory.html#Mem.DROP.p">p</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_1">perm_drop_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n0</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem.DROP">DROP</a></span>.<br/>
<br/>
<h1> Generic injections </h1>
<br/>
<div class="doc">A memory state <span class="bracket"><span class="id">m1</span></span> generically injects into another memory state <span class="bracket"><span class="id">m2</span></span> via the
  memory injection <span class="bracket"><span class="id">f</span></span> if the following conditions hold:
<ul>
<li>
 each access in <span class="bracket"><span class="id">m2</span></span> that corresponds to a valid access in <span class="bracket"><span class="id">m1</span></span>
  is itself valid;
</li>
<li>
 the memory value associated in <span class="bracket"><span class="id">m1</span></span> to an accessible address
  must inject into <span class="bracket"><span class="id">m2</span></span>'s memory value at the corersponding address.
</li>
</ul>
</div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Mem.mem_inj">mem_inj</a></span> (<span class="id">f</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">m1</span> <span class="id">m2</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.mk_mem_inj">mk_mem_inj</a></span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_perm">mi_perm</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_align">mi_align</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#delta">delta</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_memval">mi_memval</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b1">b1</a></span>) (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span>+<span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#m2">m2</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b2">b2</a></span>)<br/>
&nbsp;&nbsp;}.<br/>
<br/>
<div class="doc">Preservation of permissions </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.perm_inj">perm_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6199')">Proof.</div>
<div class="proofscript" id="proof6199">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_perm">mi_perm</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.range_perm_inj">range_perm_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">k</span> <span class="id">p</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#lo">lo</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) (<span class="id"><a href="FMemory.html#hi">hi</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6200')">Proof.</div>
<div class="proofscript" id="proof6200">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> ((<span class="id">ofs</span> - <span class="id">delta</span>) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_access_inj">valid_access_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6201')">Proof.</div>
<div class="proofscript" id="proof6201">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> ((<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_inj">range_perm_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_align">mi_align</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of loads. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.getN_inj">getN_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#m1">m1</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b1">b1</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) (<span class="id"><a href="FMemory.html#m2">m2</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id"><a href="FMemory.html#b2">b2</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6202')">Proof.</div>
<div class="proofscript" id="proof6202">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_memval">mi_memval</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_cur">range_perm_cur</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> + 1) <span class="kwd">with</span> ((<span class="id">ofs</span> + 1) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.load_inj">load_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">v1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>, <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> /\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6203')">Proof.</div>
<div class="proofscript" id="proof6203">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id">chunk</span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>) (<span class="id">ofs</span> + <span class="id">delta</span>) (<span class="id">m2</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b2</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_inj">valid_access_inj</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_result">load_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_inject">decode_val_inject</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_inj">getN_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_valid_access">load_valid_access</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.loadbytes_inj">loadbytes_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">len</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">bytes1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bytes2</span>, <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span>) <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6204')">Proof.</div>
<div class="proofscript" id="proof6204">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">len</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.getN">getN</a></span> (<span class="id"><a href="Coqlib.html#nat_of_Z">nat_of_Z</a></span> <span class="id">len</span>) (<span class="id">ofs</span> + <span class="id">delta</span>) (<span class="id">m2</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b2</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> + <span class="id">len</span>) <span class="kwd">with</span> ((<span class="id">ofs</span> + <span class="id">len</span>) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_inj">range_perm_inj</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_inj">getN_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> 0 <span class="id">len</span>). <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_eq">nat_of_Z_eq</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_neg">nat_of_Z_neg</a></span>. <span class="tactic">simpl</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">omegaContradiction</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of stores. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.setN_inj">setN_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">access</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">delta</span> <span class="id">f</span> <span class="id">vl1</span> <span class="id">vl2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span>) <span class="id"><a href="FMemory.html#vl1">vl1</a></span> <span class="id"><a href="FMemory.html#vl2">vl2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">c1</span> <span class="id">c2</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">q</span>, <span class="id"><a href="FMemory.html#access">access</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> -&gt; <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> <span class="id"><a href="FMemory.html#c1">c1</a></span>) (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> (<span class="id"><a href="FMemory.html#q">q</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#c2">c2</a></span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">q</span>, <span class="id"><a href="FMemory.html#access">access</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> -&gt; <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#q">q</a></span> (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl1">vl1</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> <span class="id"><a href="FMemory.html#c1">c1</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> (<span class="id"><a href="FMemory.html#q">q</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) (<span class="id"><a href="FMemory.html#Mem.setN">setN</a></span> <span class="id"><a href="FMemory.html#vl2">vl2</a></span> (<span class="id"><a href="FMemory.html#p">p</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#c2">c2</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6205')">Proof.</div>
<div class="proofscript" id="proof6205">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">p</span> + <span class="id">delta</span> + 1) <span class="kwd">with</span> ((<span class="id">p</span> + 1) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHlist_forall2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gsspec">ZMap.gsspec</a></span> <span class="tactic">at</span> 1. <span class="tactic">destruct</span> (<span class="id"><a href="Maps.html#ZIndexed.eq">ZIndexed.eq</a></span> <span class="id">q0</span> <span class="id">p</span>). <span class="tactic">subst</span> <span class="id">q0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gss">ZMap.gss</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gso">ZMap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Maps.html#ZIndexed.t">ZIndexed.t</a></span> <span class="kwd">in</span> *. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.meminj_no_overlap">meminj_no_overlap</a></span> (<span class="id">f</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b1</span>' <span class="id">delta1</span> <span class="id">b2</span> <span class="id">b2</span>' <span class="id">delta2</span> <span class="id">ofs1</span> <span class="id">ofs2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b1</span>', <span class="id"><a href="FMemory.html#delta1">delta1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b2</span>', <span class="id"><a href="FMemory.html#delta2">delta2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">b1</span>' &lt;&gt; <span class="id">b2</span>' \/ <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta1">delta1</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#delta2">delta2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_mapped_inj">store_mapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">n1</span> <span class="id">m2</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.meminj_no_overlap">meminj_no_overlap</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6206')">Proof.</div>
<div class="proofscript" id="proof6206">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b2</span> (<span class="id">ofs</span> + <span class="id">delta</span>) <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_inj">valid_access_inj</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_store">valid_access_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">v2</span> <span class="id">H4</span>) <span class="kwd">as</span> [<span class="id">n2</span> <span class="id">STORE</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_store_1">perm_store_1</a></span>; [<span class="id">eexact</span> <span class="id">STORE</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_perm">mi_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_align">mi_align</a></span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs0</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">STORE</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">subst</span> <span class="id">b0</span>.<br/>
&nbsp;block&nbsp;=&nbsp;b1,&nbsp;block&nbsp;=&nbsp;b2&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b3</span> = <span class="id">b2</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">b3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">delta0</span> = <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#peq_true">peq_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_inj">setN_inj</a></span> <span class="kwd">with</span> (<span class="id">access</span> := <span class="kwd">fun</span> <span class="id">ofs</span> =&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m1</span> <span class="id">b1</span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_val_inject">encode_val_inject</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_memval">mi_memval</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b3</span> <span class="id">b2</span>). <span class="tactic">subst</span> <span class="id">b3</span>.<br/>
&nbsp;block&nbsp;&lt;&gt;&nbsp;b1,&nbsp;block&nbsp;=&nbsp;b2&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_other">setN_other</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_memval">mi_memval</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b2</span> &lt;&gt; <span class="id">b2</span> \/ <span class="id">ofs0</span> + <span class="id">delta0</span> &lt;&gt; (<span class="id">r</span> - <span class="id">delta</span>) + <span class="id">delta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span> 6 <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">store_valid_access_3</a></span>. <span class="id">eexact</span> <span class="id">H0</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">apply</span> <span class="id">A</span>. <span class="tactic">omega</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>. <span class="tactic">congruence</span>. <span class="tactic">omega</span>.<br/>
&nbsp;block&nbsp;&lt;&gt;&nbsp;b1,&nbsp;block&nbsp;&lt;&gt;&nbsp;b2&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_memval">mi_memval</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_unmapped_inj">store_unmapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">n1</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6207')">Proof.</div>
<div class="proofscript" id="proof6207">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_perm">mi_perm</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_align">mi_align</a></span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs0</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_memval">mi_memval</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_outside_inj">store_outside_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6208')">Proof.</div>
<div class="proofscript" id="proof6208">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;access&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">mi_align0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b2</span> <span class="id">b</span>). <span class="tactic">subst</span> <span class="id">b2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id">ofs0</span> + <span class="id">delta</span>) <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) (<span class="id">ofs0</span> + <span class="id">delta</span>)). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">byContradiction</span>. <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_mapped_inj">storebytes_mapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">n1</span> <span class="id">m2</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">bytes2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.meminj_no_overlap">meminj_no_overlap</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span>) <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6209')">Proof.</div>
<div class="proofscript" id="proof6209">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id">m2</span> <span class="id">b2</span> (<span class="id">ofs</span> + <span class="id">delta</span>) (<span class="id">ofs</span> + <span class="id">delta</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes2</span>)) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Writable</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> ((<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes1</span>)) + <span class="id">delta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_inj">range_perm_inj</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_range_perm">storebytes_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Coqlib.html#list_forall2_length">list_forall2_length</a></span> <span class="id">H3</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_storebytes">range_perm_storebytes</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H4</span>) <span class="kwd">as</span> [<span class="id">n2</span> <span class="id">STORE</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>; [<span class="tactic">apply</span> <span class="id">STORE</span> |].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_align">mi_align</a></span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs0</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m1</span> <span class="id">b0</span> <span class="id">ofs0</span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">STORE</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">subst</span> <span class="id">b0</span>.<br/>
&nbsp;block&nbsp;=&nbsp;b1,&nbsp;block&nbsp;=&nbsp;b2&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b3</span> = <span class="id">b2</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">b3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">delta0</span> = <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#peq_true">peq_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_inj">setN_inj</a></span> <span class="kwd">with</span> (<span class="id">access</span> := <span class="kwd">fun</span> <span class="id">ofs</span> =&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m1</span> <span class="id">b1</span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b3</span> <span class="id">b2</span>). <span class="tactic">subst</span> <span class="id">b3</span>.<br/>
&nbsp;block&nbsp;&lt;&gt;&nbsp;b1,&nbsp;block&nbsp;=&nbsp;b2&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_other">setN_other</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b2</span> &lt;&gt; <span class="id">b2</span> \/ <span class="id">ofs0</span> + <span class="id">delta0</span> &lt;&gt; (<span class="id">r</span> - <span class="id">delta</span>) + <span class="id">delta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span> 6 <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.storebytes_range_perm">storebytes_range_perm</a></span>. <span class="id">eexact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">r</span> - <span class="id">delta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Coqlib.html#list_forall2_length">list_forall2_length</a></span> <span class="id">H3</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> 6 <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>. <span class="tactic">congruence</span>. <span class="tactic">omega</span>.<br/>
&nbsp;block&nbsp;&lt;&gt;&nbsp;b1,&nbsp;block&nbsp;&lt;&gt;&nbsp;b2&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_unmapped_inj">storebytes_unmapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">n1</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6210')">Proof.</div>
<div class="proofscript" id="proof6210">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_align">mi_align</a></span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs0</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>. <span class="tactic">eapply</span> <span class="id">mi_memval0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_outside_inj">storebytes_outside_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6211')">Proof.</div>
<div class="proofscript" id="proof6211">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b2</span> <span class="id">b</span>). <span class="tactic">subst</span> <span class="id">b2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id">ofs0</span> + <span class="id">delta</span>) <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes2</span>)) (<span class="id">ofs0</span> + <span class="id">delta</span>)). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">byContradiction</span>. <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_empty_inj">storebytes_empty_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs1</span> <span class="id">m1</span>' <span class="id">m2</span> <span class="id">b2</span> <span class="id">ofs2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6212')">Proof.</div>
<div class="proofscript" id="proof6212">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_align0</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m1</span> <span class="id">b0</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b1</span>); <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b3</span> <span class="id">b2</span>); <span class="tactic">subst</span>; <span class="tactic">eapply</span> <span class="id">mi_memval0</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of allocations </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_right_inj">alloc_right_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">b2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m2</span>', <span class="id"><a href="FMemory.html#b2">b2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6213')">Proof.</div>
<div class="proofscript" id="proof6213">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">injection</span> <span class="id">H0</span>. <span class="tactic">intros</span> <span class="id">NEXT</span> <span class="id">MEM</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_1">perm_alloc_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m2</span> <span class="id">b0</span> (<span class="id">ofs</span> + <span class="id">delta</span>) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id">m2</span> <span class="id">b0</span>) <span class="tactic">by</span> <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">MEM</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NEXT</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_left_unmapped_inj">alloc_left_unmapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>' <span class="id">b1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m1</span>', <span class="id"><a href="FMemory.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6214')">Proof.</div>
<div class="proofscript" id="proof6214">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_align0</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">NEXT</span> <span class="id">MEM</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">MEM</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">NEXT</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gi">ZMap.gi</a></span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.inj_offset_aligned">inj_offset_aligned</a></span> (<span class="id">delta</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">size</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>, <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> &lt;= <span class="id"><a href="FMemory.html#size">size</a></span> -&gt; (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> | <span class="id"><a href="FMemory.html#delta">delta</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_left_mapped_inj">alloc_left_mapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>' <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m1</span>', <span class="id"><a href="FMemory.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inj_offset_aligned">inj_offset_aligned</a></span> <span class="id"><a href="FMemory.html#delta">delta</a></span> (<span class="id"><a href="FMemory.html#hi">hi</a></span>-<span class="id"><a href="FMemory.html#lo">lo</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6215')">Proof.</div>
<div class="proofscript" id="proof6215">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">subst</span> <span class="id">b0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">assert</span> (<span class="id">delta0</span> = <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">lo</span> &lt;= <span class="id">ofs</span> &lt; <span class="id">hi</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_3">perm_alloc_3</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H6</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">lo</span> &lt;= <span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> - 1 &lt; <span class="id">hi</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_3">perm_alloc_3</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H6</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_align0</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">NEXT</span> <span class="id">MEM</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">MEM</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">NEXT</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#ZMap.gi">ZMap.gi</a></span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_left_inj">free_left_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6216')">Proof.</div>
<div class="proofscript" id="proof6216">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">FREE</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_align0</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">FREE</span>; <span class="tactic">simpl</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_right_inj">free_right_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6217')">Proof.</div>
<div class="proofscript" id="proof6217">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.free_result">free_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">FREE</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PERM</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m1</span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m2</span>' <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_1">perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">b</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (~ (<span class="id">lo</span> &lt;= <span class="id">ofs</span> + <span class="id">delta</span> &lt; <span class="id">hi</span>)). <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_align0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mem_contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">FREE</span>; <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of <span class="bracket"><span class="id">drop_perm</span></span> operations. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_unmapped_inj">drop_unmapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6218')">Proof.</div>
<div class="proofscript" id="proof6218">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_align0</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">p</span> := <span class="id">p0</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id">ofs</span> <span class="id">m1</span>'.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b1</span>) <span class="kwd">with</span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id">ofs</span> <span class="id">m1</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mi_memval0</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_mapped_inj">drop_mapped_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.meminj_no_overlap">meminj_no_overlap</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#lo">lo</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) (<span class="id"><a href="FMemory.html#hi">hi</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>'<br/>
&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6219')">Proof.</div>
<div class="proofscript" id="proof6219">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ({ <span class="id">m2</span>' | <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id">m2</span> <span class="id">b2</span> (<span class="id">lo</span> + <span class="id">delta</span>) (<span class="id">hi</span> + <span class="id">delta</span>) <span class="id">p</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' }).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_drop_2">range_perm_drop_2</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> ((<span class="id">ofs</span> - <span class="id">delta</span>) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_drop_1">range_perm_drop_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> [<span class="id">m2</span>' <span class="id">DROP</span>]. <span class="id">exists</span> <span class="id">m2</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m2</span> <span class="id">b3</span> (<span class="id">ofs</span> + <span class="id">delta0</span>) <span class="id">k</span> <span class="id">p0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b0</span>).<br/>
&nbsp;b1&nbsp;=&nbsp;b0&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id">ofs</span> + <span class="id">delta0</span>) (<span class="id">lo</span> + <span class="id">delta0</span>)). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">hi</span> + <span class="id">delta0</span>) (<span class="id">ofs</span> + <span class="id">delta0</span>)). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Memperm.html#perm_order">perm_order</a></span> <span class="id">p</span> <span class="id">p0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_2">perm_drop_2</a></span>.  <span class="id">eexact</span> <span class="id">H0</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs</span>). <span class="tactic">omega</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_1">perm_drop_1</a></span>. <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;b1&nbsp;&lt;&gt;&nbsp;b0&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b3</span> <span class="id">b2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id">ofs</span> + <span class="id">delta0</span>) (<span class="id">lo</span> + <span class="id">delta</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> (<span class="id">hi</span> + <span class="id">delta</span>) (<span class="id">ofs</span> + <span class="id">delta0</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ofs</span> + <span class="id">delta0</span> - <span class="id">delta</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_drop_1">range_perm_drop_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_max">perm_max</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id">p0</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_align0</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">p</span> := <span class="id">p0</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;memval&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m1</span>'.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b0</span>) <span class="kwd">with</span> (<span class="id">m1</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m2</span>'.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b3</span>) <span class="kwd">with</span> (<span class="id">m2</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mi_memval0</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">DROP</span>; <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m2</span> <span class="id">b2</span> (<span class="id">lo</span> + <span class="id">delta</span>) (<span class="id">hi</span> + <span class="id">delta</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id">DROP</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_outside_inj">drop_outside_inj</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span>' <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6220')">Proof.</div>
<div class="proofscript" id="proof6220">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">b</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b2</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id">ofs</span> + <span class="id">delta</span>) <span class="id">lo</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">hi</span> (<span class="id">ofs</span> + <span class="id">delta</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">byContradiction</span>. <span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_align0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;contents&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m2</span>'.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b2</span>) <span class="kwd">with</span> (<span class="id">m2</span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)#<span class="id">b2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mi_memval0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Memory extensions </h1>
<br/>
<div class="doc"> A store <span class="bracket"><span class="id">m2</span></span> extends a store <span class="bracket"><span class="id">m1</span></span> if <span class="bracket"><span class="id">m2</span></span> can be obtained from <span class="bracket"><span class="id">m1</span></span>
  by increasing the sizes of the memory blocks of <span class="bracket"><span class="id">m1</span></span> (decreasing
  the low bounds, increasing the high bounds), and replacing some of
  the <span class="bracket"><span class="id">Vundef</span></span> values stored in <span class="bracket"><span class="id">m1</span></span> by more defined values stored
  in <span class="bracket"><span class="id">m2</span></span> at the same locations. </div>
<br/>
<div class="doc">COMMENT: <span class="bracket"><span class="id">extends</span>'</span> here is too strong to be used in our LDSim,
    because it requires equal on freelist and validblock set, which is 
    possibly not equal after a rely step in simulation </div>
<span class="kwd">Record</span> <span class="id">extends</span>' (<span class="id">m1</span> <span class="id">m2</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.mk_extends">mk_extends</a></span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mext_validblocks">mext_validblocks</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mext_freelist">mext_freelist</a></span>: <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">freelist</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mext_nextblockid">mext_nextblockid</a></span>: <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblockid">nextblockid</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mext_inj">mext_inj</a></span>:  <span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mext_perm_inv">mext_perm_inv</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> \/ ~<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span><br/>
&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.extends">extends</a></span> := <span class="id">extends</span>'.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.extends_refl">extends_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6221')">Proof.</div>
<div class="proofscript" id="proof6221">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">replace</span> (<span class="id">ofs</span> + 0) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">replace</span> (<span class="id">ofs</span> + 0) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#memval_lessdef_refl">memval_lessdef_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_extends">load_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>, <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6222')">Proof.</div>
<div class="proofscript" id="proof6222">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_inj">load_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v2</span> [<span class="id">A</span> <span class="id">B</span>]]. <span class="id">exists</span> <span class="id">v2</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + 0) <span class="kwd">with</span> <span class="id">ofs</span> <span class="kwd">in</span> <span class="id">A</span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Values.html#val_inject_id">val_inject_id</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadv_extends">loadv_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">addr1</span> <span class="id">addr2</span> <span class="id">v1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#addr1">addr1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#addr1">addr1</a></span> <span class="id"><a href="FMemory.html#addr2">addr2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>, <span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#addr2">addr2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6223')">Proof.</div>
<div class="proofscript" id="proof6223">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">addr2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.load_extends">load_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_extends">loadbytes_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">len</span> <span class="id">bytes1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bytes2</span>, <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="Memdata.html#memval_lessdef">memval_lessdef</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6224')">Proof.</div>
<div class="proofscript" id="proof6224">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + 0) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_inj">loadbytes_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_within_extends">store_within_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">m1</span>' <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6225')">Proof.</div>
<div class="proofscript" id="proof6225">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_mapped_inj">store_mapped_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Values.html#val_inject_id">val_inject_id</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>'; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + 0) <span class="kwd">with</span> <span class="id">ofs</span> <span class="kwd">in</span> <span class="id">A</span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_validblocks">store_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_validblocks">store_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_nextblockid">store_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_nextblockid">store_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_1">perm_store_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_outside_extends">store_outside_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span>', <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id">ofs</span>' &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6226')">Proof.</div>
<div class="proofscript" id="proof6226">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_validblocks">store_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_nextblockid">store_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.  <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_outside_inj">store_outside_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storev_extends">storev_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">addr1</span> <span class="id">v1</span> <span class="id">m1</span>' <span class="id">addr2</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#addr1">addr1</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#addr1">addr1</a></span> <span class="id"><a href="FMemory.html#addr2">addr2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#addr2">addr2</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6227')">Proof.</div>
<div class="proofscript" id="proof6227">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storev">storev</a></span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">addr2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_within_extends">store_within_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_within_extends">storebytes_within_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">m1</span>' <span class="id">bytes2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="Memdata.html#memval_lessdef">memval_lessdef</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6228')">Proof.</div>
<div class="proofscript" id="proof6228">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.storebytes_mapped_inj">storebytes_mapped_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>'; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + 0) <span class="kwd">with</span> <span class="id">ofs</span> <span class="kwd">in</span> <span class="id">A</span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_validblocks">storebytes_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_validblocks">storebytes_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_nextblockid">storebytes_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_nextblockid">storebytes_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_outside_extends">storebytes_outside_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span>', <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id">ofs</span>' &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6229')">Proof.</div>
<div class="proofscript" id="proof6229">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_validblocks">storebytes_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_nextblockid">storebytes_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.  <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_outside_inj">storebytes_outside_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_extends">alloc_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo1</span> <span class="id">hi1</span> <span class="id">b</span> <span class="id">m1</span>' <span class="id">lo2</span> <span class="id">hi2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#lo1">lo1</a></span> <span class="id"><a href="FMemory.html#hi1">hi1</a></span> = (<span class="id">m1</span>', <span class="id"><a href="FMemory.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#lo2">lo2</a></span> &lt;= <span class="id"><a href="FMemory.html#lo1">lo1</a></span> -&gt; <span class="id"><a href="FMemory.html#hi1">hi1</a></span> &lt;= <span class="id"><a href="FMemory.html#hi2">hi2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#lo2">lo2</a></span> <span class="id"><a href="FMemory.html#hi2">hi2</a></span> = (<span class="id">m2</span>', <span class="id"><a href="FMemory.html#b">b</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6230')">Proof.</div>
<div class="proofscript" id="proof6230">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id">m2</span> <span class="id">lo2</span> <span class="id">hi2</span>); <span class="tactic">intros</span> <span class="id">m2</span>' <span class="id">b</span>' <span class="id">ALLOC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b</span>' = <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ALLOC</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>. <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>'.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_validblocks">alloc_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_validblocks">alloc_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ALLOC</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">mext_freelist0</span>, <span class="id">mext_nextblockid0</span>, <span class="id">mext_validblocks0</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ALLOC</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_nextblockid">alloc_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_nextblockid">alloc_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ALLOC</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_left_mapped_inj">alloc_left_mapped_inj</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m1</span>) (<span class="id">m2</span> := <span class="id">m2</span>') (<span class="id">b2</span> := <span class="id">b</span>) (<span class="id">delta</span> := 0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_right_inj">alloc_right_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_0">Zdivide_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">b0</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>); <span class="tactic">intros</span> <span class="id">PERM</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EITHER</span>: <span class="id">lo1</span> &lt;= <span class="id">ofs</span> &lt; <span class="id">hi1</span> \/ ~(<span class="id">lo1</span> &lt;= <span class="id">ofs</span> &lt; <span class="id">hi1</span>)) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">EITHER</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_1">perm_alloc_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.free_left_extends">free_left_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6231')">Proof.</div>
<div class="proofscript" id="proof6231">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_validblocks">free_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_nextblockid">free_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_left_inj">free_left_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>]. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_inv">perm_free_inv</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [[<span class="id">A</span> <span class="id">B</span>]|<span class="id">A</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="id">right</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.free_right_extends">free_right_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6232')">Proof.</div>
<div class="proofscript" id="proof6232">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_validblocks">free_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_nextblockid">free_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_right_inj">free_right_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.free_parallel_extends">free_parallel_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6233')">Proof.</div>
<div class="proofscript" id="proof6233">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ({ <span class="id">m2</span>': <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span> | <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' }).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_free">range_perm_free</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + 0) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span> <span class="kwd">with</span> (<span class="id">b1</span> := <span class="id">b</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_range_perm">free_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> [<span class="id">m2</span>' <span class="id">FREE</span>]. <span class="id">exists</span> <span class="id">m2</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_validblocks">free_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_validblocks">free_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FREE</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FREE</span>). <span class="tactic">auto</span>.  <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_nextblockid">free_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_nextblockid">free_nextblockid</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FREE</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_right_inj">free_right_inj</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m1</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_left_inj">free_left_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span>. <span class="id">eexact</span> <span class="id">H0</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs</span>); <span class="tactic">omega</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_inv">perm_free_inv</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [[<span class="id">A</span> <span class="id">B</span>]|<span class="id">A</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="id">right</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_extends">valid_block_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6234')">Proof.</div>
<div class="proofscript" id="proof6234">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>. <span class="tactic">rewrite</span> <span class="id">mext_validblocks0</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_extends">perm_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6235')">Proof.</div>
<div class="proofscript" id="proof6235">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + 0) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_extends_inv">perm_extends_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> \/ ~<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6236')">Proof.</div>
<div class="proofscript" id="proof6236">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_extends">valid_access_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6237')">Proof.</div>
<div class="proofscript" id="proof6237">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + 0) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_inj">valid_access_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_pointer_extends">valid_pointer_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6238')">Proof.</div>
<div class="proofscript" id="proof6238">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_extends">valid_access_extends</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.weak_valid_pointer_extends">weak_valid_pointer_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6239')">Proof.</div>
<div class="proofscript" id="proof6239">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> 1. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span>. <span class="tactic">rewrite</span> !<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_iff">orb_true_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> []; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_extends">valid_pointer_extends</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.in_freelist_extends">in_freelist_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span>, <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6240')">Proof.</div>
<div class="proofscript" id="proof6240">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="tactic">rewrite</span> <span class="id">mext_freelist0</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<h1> Memory injections </h1>
<br/>
<div class="doc">A memory state <span class="bracket"><span class="id">m1</span></span> injects into another memory state <span class="bracket"><span class="id">m2</span></span> via the
  memory injection <span class="bracket"><span class="id">f</span></span> if the following conditions hold:
<ul>
<li>
 each access in <span class="bracket"><span class="id">m2</span></span> that corresponds to a valid access in <span class="bracket"><span class="id">m1</span></span>
  is itself valid;
</li>
<li>
 the memory value associated in <span class="bracket"><span class="id">m1</span></span> to an accessible address
  must inject into <span class="bracket"><span class="id">m2</span></span>'s memory value at the corersponding address;
</li>
<li>
 unallocated blocks in <span class="bracket"><span class="id">m1</span></span> must be mapped to <span class="bracket"><span class="id">None</span></span> by <span class="bracket"><span class="id">f</span></span>;
</li>
<li>
 if <span class="bracket"><span class="id">f</span> <span class="id">b</span> = <span class="id">Some</span>(<span class="id">b</span>', <span class="id">delta</span>)</span>, <span class="bracket"><span class="id">b</span>'</span> must be valid in <span class="bracket"><span class="id">m2</span></span>;
</li>
<li>
 distinct blocks in <span class="bracket"><span class="id">m1</span></span> are mapped to non-overlapping sub-blocks in <span class="bracket"><span class="id">m2</span></span>;
</li>
<li>
 the sizes of <span class="bracket"><span class="id">m2</span></span>'s blocks are representable with unsigned machine integers;
</li>
<li>
 pointers that could be represented using unsigned machine integers remain
  representable after the injection.
</li>
</ul>
</div>
<br/>
<span class="kwd">Record</span> <span class="id">inject</span>' (<span class="id">f</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">m1</span> <span class="id">m2</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.mk_inject">mk_inject</a></span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_inj">mi_inj</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_freeblocks">mi_freeblocks</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, ~(<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>) -&gt; <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_mappedblocks">mi_mappedblocks</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span>, <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_freelist">mi_freelist</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_no_overlap">mi_no_overlap</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.meminj_no_overlap">meminj_no_overlap</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_representable">mi_representable</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> \/ <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> - 1) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#delta">delta</a></span> &gt;= 0 /\ 0 &lt;= <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Mem.mi_perm_inv">mi_perm_inv</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> \/ ~<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span><br/>
&nbsp;&nbsp;}.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.inject">inject</a></span> := <span class="id">inject</span>'.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">mi_mappedblocks</span>: <span class="id">mem</span>.<br/>
<br/>
<div class="doc">Preservation of access validity and pointer validity </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.freelist_inject">freelist_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6241')">Proof.</div>
<div class="proofscript" id="proof6241">
 <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_inject_1">valid_block_inject_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6242')">Proof.</div>
<div class="proofscript" id="proof6242">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_block_dec">valid_block_dec</a></span> <span class="id">m1</span> <span class="id">b1</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_freeblocks">mi_freeblocks</a></span> <span class="kwd">in</span> <span class="id">n</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_block_inject_2">valid_block_inject_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6243')">Proof.</div>
<div class="proofscript" id="proof6243">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_mappedblocks">mi_mappedblocks</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">valid_block_inject_1</span> <span class="id">valid_block_inject_2</span>: <span class="id">mem</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_inject">perm_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6244')">Proof.</div>
<div class="proofscript" id="proof6244">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.perm_inject_inv">perm_inject_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> \/ ~<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6245')">Proof.</div>
<div class="proofscript" id="proof6245">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_perm_inv">mi_perm_inv</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.range_perm_inject">range_perm_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#lo">lo</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) (<span class="id"><a href="FMemory.html#hi">hi</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6246')">Proof.</div>
<div class="proofscript" id="proof6246">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_inj">range_perm_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_access_inject">valid_access_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6247')">Proof.</div>
<div class="proofscript" id="proof6247">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_inj">valid_access_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.mi_inj">mi_inj</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_pointer_inject">valid_pointer_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6248')">Proof.</div>
<div class="proofscript" id="proof6248">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_access_inject">valid_access_inject</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.weak_valid_pointer_inject">weak_valid_pointer_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6249')">Proof.</div>
<div class="proofscript" id="proof6249">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> 2. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span>. <span class="tactic">rewrite</span> !<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_iff">orb_true_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> - 1) <span class="kwd">with</span> ((<span class="id">ofs</span> - 1) + <span class="id">delta</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> []; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_inject">valid_pointer_inject</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">The following lemmas establish the absence of machine integer overflow
  during address computations. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.address_inject">address_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">ofs1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="FMemory.html#delta">delta</a></span>)) = <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6250')">Proof.</div>
<div class="proofscript" id="proof6250">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m1</span> <span class="id">b1</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs1</span>) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>) <span class="tactic">by</span> <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.mi_representable">mi_representable</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">delta</span> &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> <span class="id">ofs1</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">address_inject</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b1</span> <span class="id">ofs1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span>) <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="FMemory.html#delta">delta</a></span>)) = <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6251')">Proof.</div>
<div class="proofscript" id="proof6251">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.address_inject">address_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.weak_valid_pointer_inject_no_overflow">weak_valid_pointer_inject_no_overflow</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">b</span>' <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="FMemory.html#delta">delta</a></span>) &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6252')">Proof.</div>
<div class="proofscript" id="proof6252">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer_spec">weak_valid_pointer_spec</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="FMemory.html#Mem.valid_pointer_nonempty_perm">valid_pointer_nonempty_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.mi_representable">mi_representable</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_pointer_inject_no_overflow">valid_pointer_inject_no_overflow</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">b</span>' <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="FMemory.html#delta">delta</a></span>) &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6253')">Proof.</div>
<div class="proofscript" id="proof6253">
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer_inject_no_overflow">weak_valid_pointer_inject_no_overflow</a></span>, <span class="id"><a href="FMemory.html#Mem.valid_pointer_implies">valid_pointer_implies</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.valid_pointer_inject_val">valid_pointer_inject_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">b</span>' <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span>' <span class="id">ofs</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>' (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6254')">Proof.</div>
<div class="proofscript" id="proof6254">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">address_inject</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_inject">valid_pointer_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.weak_valid_pointer_inject_val">weak_valid_pointer_inject_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">b</span>' <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span>' <span class="id">ofs</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">weak_valid_pointer</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>' (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6255')">Proof.</div>
<div class="proofscript" id="proof6255">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer_inject">weak_valid_pointer_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">W</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer_spec">weak_valid_pointer_spec</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="FMemory.html#Mem.valid_pointer_nonempty_perm">valid_pointer_nonempty_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.mi_representable">mi_representable</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">auto</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.inject_no_overlap">inject_no_overlap</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">b1</span>' <span class="id">b2</span>' <span class="id">delta1</span> <span class="id">delta2</span> <span class="id">ofs1</span> <span class="id">ofs2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b1</span>', <span class="id"><a href="FMemory.html#delta1">delta1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b2</span>', <span class="id"><a href="FMemory.html#delta2">delta2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">b1</span>' &lt;&gt; <span class="id">b2</span>' \/ <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta1">delta1</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#delta2">delta2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6256')">Proof.</div>
<div class="proofscript" id="proof6256">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.different_pointers_inject">different_pointers_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b1</span> <span class="id">ofs1</span> <span class="id">b2</span> <span class="id">ofs2</span> <span class="id">b1</span>' <span class="id">delta1</span> <span class="id">b2</span>' <span class="id">delta2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">valid_pointer</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b1</span>', <span class="id"><a href="FMemory.html#delta1">delta1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b2</span>', <span class="id"><a href="FMemory.html#delta2">delta2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">b1</span>' &lt;&gt; <span class="id">b2</span>' \/<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="FMemory.html#delta1">delta1</a></span>)) &lt;&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="FMemory.html#delta2">delta2</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6257')">Proof.</div>
<div class="proofscript" id="proof6257">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer_valid_access">valid_pointer_valid_access</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">address_inject</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H1</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">address_inject</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H2</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_no_overlap">mi_no_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">apply</span> (<span class="id">H5</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs1</span>)). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">apply</span> (<span class="id">H1</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs2</span>)). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.disjoint_or_equal_inject">disjoint_or_equal_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b1</span> <span class="id">b1</span>' <span class="id">delta1</span> <span class="id">b2</span> <span class="id">b2</span>' <span class="id">delta2</span> <span class="id">ofs1</span> <span class="id">ofs2</span> <span class="id">sz</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b1</span>', <span class="id"><a href="FMemory.html#delta1">delta1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b2</span>', <span class="id"><a href="FMemory.html#delta2">delta2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> (<span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span>) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> (<span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span>) <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#sz">sz</a></span> &gt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b2">b2</a></span> \/ <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> = <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> \/ <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> \/ <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">b1</span>' &lt;&gt; <span class="id">b2</span>' \/ <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta1">delta1</a></span> = <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#delta2">delta2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta1">delta1</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#delta2">delta2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> + <span class="id"><a href="FMemory.html#delta2">delta2</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> + <span class="id"><a href="FMemory.html#delta1">delta1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6258')">Proof.</div>
<div class="proofscript" id="proof6258">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b1</span>' = <span class="id">b2</span>') <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">assert</span> (<span class="id">delta1</span> = <span class="id">delta2</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>. <span class="tactic">congruence</span>. <span class="id">right</span>. <span class="tactic">destruct</span> <span class="id">H5</span>. <span class="id">left</span>; <span class="tactic">congruence</span>. <span class="id">right</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span>' <span class="id">b2</span>'); <span class="tactic">auto</span>. <span class="tactic">subst</span>. <span class="id">right</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">i1</span> := (<span class="id">ofs1</span> + <span class="id">delta1</span>, <span class="id">ofs1</span> + <span class="id">delta1</span> + <span class="id">sz</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">i2</span> := (<span class="id">ofs2</span> + <span class="id">delta2</span>, <span class="id">ofs2</span> + <span class="id">delta2</span> + <span class="id">sz</span>)).<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">i1</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">i2</span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">i2</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">i1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Intv.range_disjoint</span>'; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Intv.html#disjoint">Intv.disjoint</a></span>, <span class="id"><a href="Intv.html#In">Intv.In</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.mi_no_overlap">mi_no_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">x</span> - <span class="id">delta1</span>). <span class="tactic">apply</span> <span class="id">H2</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">x</span> - <span class="id">delta2</span>). <span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.aligned_area_inject">aligned_area_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">ofs</span> <span class="id">al</span> <span class="id">sz</span> <span class="id">b</span>' <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#al">al</a></span> = 1 \/ <span class="id"><a href="FMemory.html#al">al</a></span> = 2 \/ <span class="id"><a href="FMemory.html#al">al</a></span> = 4 \/ <span class="id"><a href="FMemory.html#al">al</a></span> = 8 -&gt; <span class="id"><a href="FMemory.html#sz">sz</a></span> &gt; 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#al">al</a></span> | <span class="id"><a href="FMemory.html#sz">sz</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.range_perm">range_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#sz">sz</a></span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#al">al</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#al">al</a></span> | <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6259')">Proof.</div>
<div class="proofscript" id="proof6259">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">P</span>: <span class="id">al</span> &gt; 0) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Q</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zabs">Zabs</a></span> <span class="id">al</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zabs">Zabs</a></span> <span class="id">sz</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_bounds">Zdivide_bounds</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zabs.html#Zabs_eq">Zabs_eq</a></span> <span class="kwd">in</span> <span class="id">Q</span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zabs.html#Zabs_eq">Zabs_eq</a></span> <span class="kwd">in</span> <span class="id">Q</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">R</span>: <span class="id">exists</span> <span class="id">chunk</span>, <span class="id">al</span> = <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> /\ <span class="id">al</span> = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="id">exists</span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="id">exists</span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="id">exists</span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="id">exists</span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">R</span> <span class="kwd">as</span> [<span class="id">chunk</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.valid_access">valid_access</a></span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">omega</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.valid_access_inject">valid_access_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of loads </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.load_inject">load_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">v1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>, <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> /\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6260')">Proof.</div>
<div class="proofscript" id="proof6260">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.load_inj">load_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadv_inject">loadv_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">v1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#a1">a1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#a1">a1</a></span> <span class="id"><a href="FMemory.html#a2">a2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>, <span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#a2">a2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> /\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6261')">Proof.</div>
<div class="proofscript" id="proof6261">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.load_inject">load_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v2</span> [<span class="id">LOAD</span> <span class="id">INJ</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadv">loadv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs1</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">delta</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs1</span> + <span class="id">delta</span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">symmetry</span>. <span class="tactic">eapply</span> <span class="id">address_inject</span>'; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.loadbytes_inject">loadbytes_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">len</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">bytes1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bytes2</span>, <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#len">len</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span>) <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6262')">Proof.</div>
<div class="proofscript" id="proof6262">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_inj">loadbytes_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of stores </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_mapped_inject">store_mapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">n1</span> <span class="id">m2</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6263')">Proof.</div>
<div class="proofscript" id="proof6263">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_mapped_inj">store_mapped_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">n2</span> [<span class="id">STORE</span> <span class="id">MI</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">mi_mappedblocks0</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_block_1">store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">mi_freelist0</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_representable">mi_representable</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_1">perm_store_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_unmapped_inject">store_unmapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">v1</span> <span class="id">n1</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6264')">Proof.</div>
<div class="proofscript" id="proof6264">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_unmapped_inj">store_unmapped_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">mi_freelist0</span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span>; <span class="tactic">eauto</span>.  <br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_representable">mi_representable</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_1">perm_store_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_outside_inject">store_outside_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6265')">Proof.</div>
<div class="proofscript" id="proof6265">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_outside_inj">store_outside_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>.  <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">store_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_store_2">perm_store_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storev_mapped_inject">storev_mapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">chunk</span> <span class="id">m1</span> <span class="id">a1</span> <span class="id">v1</span> <span class="id">n1</span> <span class="id">m2</span> <span class="id">a2</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#a1">a1</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#a1">a1</a></span> <span class="id"><a href="FMemory.html#a2">a2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storev">storev</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#a2">a2</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span> /\ <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6266')">Proof.</div>
<div class="proofscript" id="proof6266">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.storev">storev</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs1</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">delta</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs1</span> + <span class="id">delta</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_mapped_inject">store_mapped_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">eapply</span> <span class="id">address_inject</span>'; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_mapped_inject">storebytes_mapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">n1</span> <span class="id">m2</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">bytes2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span>) <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6267')">Proof.</div>
<div class="proofscript" id="proof6267">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.storebytes_mapped_inj">storebytes_mapped_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">n2</span> [<span class="id">STORE</span> <span class="id">MI</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n2</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">mi_freeblocks0</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H3</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_freelist">mi_freelist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_unmapped_inject">storebytes_unmapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs</span> <span class="id">bytes1</span> <span class="id">n1</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes1">bytes1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#n1">n1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6268')">Proof.</div>
<div class="proofscript" id="proof6268">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_unmapped_inj">storebytes_unmapped_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">mi_freeblocks0</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_freelist">mi_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_outside_inject">storebytes_outside_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id">ofs</span>' + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes2">bytes2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6269')">Proof.</div>
<div class="proofscript" id="proof6269">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_outside_inj">storebytes_outside_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_freelist">mi_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.storebytes_empty_inject">storebytes_empty_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">b1</span> <span class="id">ofs1</span> <span class="id">m1</span>' <span class="id">m2</span> <span class="id">b2</span> <span class="id">ofs2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs1">ofs1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#ofs2">ofs2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6270')">Proof.</div>
<div class="proofscript" id="proof6270">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_empty_inj">storebytes_empty_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">mi_freeblocks0</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.storebytes_valid_block_1">storebytes_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span>  <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mi_freelist">mi_freelist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.storebytes_freelist">storebytes_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_right_inject">alloc_right_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">b2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m2</span>', <span class="id"><a href="FMemory.html#b2">b2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6271')">Proof.</div>
<div class="proofscript" id="proof6271">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">injection</span> <span class="id">H0</span>. <span class="tactic">intros</span> <span class="id">NEXT</span> <span class="id">MEM</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_right_inj">alloc_right_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="id">eelim</span> <span class="id"><a href="FMemory.html#Mem.fresh_block_alloc">fresh_block_alloc</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_left_unmapped_inject">alloc_left_unmapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>' <span class="id">b1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m1</span>', <span class="id"><a href="FMemory.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">f</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id">f</span>' <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">f</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">f</span>' <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b1">b1</a></span> -&gt; <span class="id">f</span>' <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6272')">Proof.</div>
<div class="proofscript" id="proof6272">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span>' := <span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id">b1</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id">f</span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id">f</span> <span class="id">f</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>). <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">b1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>). <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id">f</span>' <span class="id">m1</span> <span class="id">m2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">mi_inj0</span>; <span class="id">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#memval_inject_incr">memval_inject_incr</a></span> <span class="kwd">with</span> <span class="id">f</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">f</span>'; <span class="tactic">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_left_unmapped_inj">alloc_left_unmapped_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">f</span>'. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mi_freeblocks0</span>. <span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">elim</span> <span class="id">H3</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id">f</span>'. <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>); <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">b1</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>. <span class="id">eexact</span> <span class="id">H3</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H6</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H7</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">f</span>' <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_1">perm_alloc_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>.<br/>
&nbsp;incr&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;image&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>.<br/>
&nbsp;incr&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_left_mapped_inject">alloc_left_mapped_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>' <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m1</span>', <span class="id"><a href="FMemory.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#delta">delta</a></span> = 0 \/ 0 &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b2">b2</a></span> (<span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inj_offset_aligned">inj_offset_aligned</a></span> <span class="id"><a href="FMemory.html#delta">delta</a></span> (<span class="id"><a href="FMemory.html#hi">hi</a></span>-<span class="id"><a href="FMemory.html#lo">lo</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">delta</span>' <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id">delta</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#lo">lo</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id">delta</span>' &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">f</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id">f</span>' <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">f</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">f</span>' <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b1">b1</a></span> -&gt; <span class="id">f</span>' <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6273')">Proof.</div>
<div class="proofscript" id="proof6273">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> 4. <span class="tactic">rename</span> <span class="id">H2</span> <span class="id">into</span> <span class="id">H_in</span>. <span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span>' := <span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id">b1</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b2</span>, <span class="id">delta</span>) <span class="kwd">else</span> <span class="id">f</span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id">f</span> <span class="id">f</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>). <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">b1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>). <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id">f</span>' <span class="id">m1</span> <span class="id">m2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">mi_inj0</span>; <span class="id">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H8</span>. <span class="tactic">subst</span> <span class="id">b0</span> <span class="id">b3</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.fresh_block_alloc">fresh_block_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H8</span>. <span class="tactic">subst</span> <span class="id">b0</span> <span class="id">b3</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.fresh_block_alloc">fresh_block_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_valid_block">perm_valid_block</a></span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>). <span class="tactic">apply</span> <span class="id">H9</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H8</span>. <span class="tactic">subst</span> <span class="id">b0</span> <span class="id">b3</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.fresh_block_alloc">fresh_block_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#memval_inject_incr">memval_inject_incr</a></span> <span class="kwd">with</span> <span class="id">f</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">f</span>'. <span class="tactic">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_left_mapped_inj">alloc_left_mapped_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>). <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H9</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>; <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H12</span>. <span class="tactic">intros</span> <span class="id">P1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H13</span>. <span class="tactic">intros</span> <span class="id">P2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>); <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b3</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H10</span>; <span class="tactic">subst</span> <span class="id">b0</span> <span class="id">b1</span>' <span class="id">delta1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">b2</span>'); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b2</span>'. <span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">subst</span> <span class="id">b3</span> <span class="id">b2</span>' <span class="id">delta2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span>' <span class="id">b2</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b1</span>'. <span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">injection</span> <span class="id">H9</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">b</span>' <span class="id">delta0</span>. <span class="tactic">destruct</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">with</span> (<span class="id">k</span> := <span class="id"><a href="Memperm.html#Max">Max</a></span>) (<span class="id">p</span> := <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range_2">Ptrofs.unsigned_range_2</a></span> <span class="id">ofs</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span>; <span class="tactic">eauto</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">with</span> (<span class="id">k</span> := <span class="id"><a href="Memperm.html#Max">Max</a></span>) (<span class="id">p</span> := <span class="id"><a href="Memperm.html#Nonempty">Nonempty</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range_2">Ptrofs.unsigned_range_2</a></span> <span class="id">ofs</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H10</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">f</span>' <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>; <span class="tactic">clear</span> <span class="id">H9</span>; <span class="tactic">subst</span> <span class="id">b0</span> <span class="id">b3</span> <span class="id">delta0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EITHER</span>: <span class="id">lo</span> &lt;= <span class="id">ofs</span> &lt; <span class="id">hi</span> \/ ~(<span class="id">lo</span> &lt;= <span class="id">ofs</span> &lt; <span class="id">hi</span>)) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">EITHER</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">intros</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">perm_alloc_inv</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_1">perm_alloc_1</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>.<br/>
&nbsp;incr&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;image&nbsp;of&nbsp;b1&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>.<br/>
&nbsp;image&nbsp;of&nbsp;others&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">f</span>'; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_parallel_inject">alloc_parallel_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">lo1</span> <span class="id">hi1</span> <span class="id">m1</span>' <span class="id">b1</span> <span class="id">lo2</span> <span class="id">hi2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#lo1">lo1</a></span> <span class="id"><a href="FMemory.html#hi1">hi1</a></span> = (<span class="id">m1</span>', <span class="id"><a href="FMemory.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#lo2">lo2</a></span> &lt;= <span class="id"><a href="FMemory.html#lo1">lo1</a></span> -&gt; <span class="id"><a href="FMemory.html#hi1">hi1</a></span> &lt;= <span class="id"><a href="FMemory.html#hi2">hi2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">f</span>', <span class="id">exists</span> <span class="id">m2</span>', <span class="id">exists</span> <span class="id">b2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#lo2">lo2</a></span> <span class="id"><a href="FMemory.html#hi2">hi2</a></span> = (<span class="id">m2</span>', <span class="id"><a href="FMemory.html#b2">b2</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id">f</span>' <span class="id">m1</span>' <span class="id">m2</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">f</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">f</span>' <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b2">b2</a></span>, 0)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#b">b</a></span> &lt;&gt; <span class="id"><a href="FMemory.html#b1">b1</a></span> -&gt; <span class="id">f</span>' <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6274')">Proof.</div>
<div class="proofscript" id="proof6274">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id">m2</span> <span class="id">lo2</span> <span class="id">hi2</span>). <span class="tactic">intros</span> <span class="id">m2</span>' <span class="id">b2</span> <span class="id">ALLOC</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.alloc_left_mapped_inject">alloc_left_mapped_inject</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_right_inject">alloc_right_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">b2</span>). <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">alloc_freelist</a></span>, <span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span>. <span class="id">unfold_fl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := 0). <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">generalize</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_0">Zdivide_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> (<span class="id"><a href="FMemory.html#Mem.valid_not_valid_diff">valid_not_valid_diff</a></span> <span class="id">m2</span> <span class="id">b2</span> <span class="id">b2</span>); <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">f</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> <span class="id">D</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">f</span>'; <span class="id">exists</span> <span class="id">m2</span>'; <span class="id">exists</span> <span class="id">b2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of <span class="bracket"><span class="id">free</span></span> operations </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_left_inject">free_left_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6275')">Proof.</div>
<div class="proofscript" id="proof6275">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_left_inj">free_left_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>. <span class="tactic">intuition</span> <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_inv">perm_free_inv</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [[<span class="id">A</span> <span class="id">B</span>] | <span class="id">A</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="id">right</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_list_left_inject">free_list_left_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m2</span> <span class="id">l</span> <span class="id">m1</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free_list">free_list</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6276')">Proof.</div>
<div class="proofscript" id="proof6276">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [[<span class="id">b</span> <span class="id">lo</span>] <span class="id">hi</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id">m1</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>) <span class="kwd">as</span> [<span class="id">m11</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span> <span class="kwd">with</span> <span class="id">m11</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_left_inject">free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_right_inject">free_right_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6277')">Proof.</div>
<div class="proofscript" id="proof6277">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_right_inj">free_right_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.free_freelist">free_freelist</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.perm_free_list">perm_free_list</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free_list">free_list</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> /\<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">lo</span> <span class="id">hi</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#lo">lo</a></span>, <span class="id"><a href="FMemory.html#hi">hi</a></span>) <span class="id"><a href="FMemory.html#l">l</a></span> -&gt; <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6278')">Proof.</div>
<div class="proofscript" id="proof6278">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [[<span class="id">b1</span> <span class="id">lo1</span>] <span class="id">hi1</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id">m</span> <span class="id">b1</span> <span class="id">lo1</span> <span class="id">hi1</span>) <span class="kwd">as</span> [<span class="id">m1</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="FMemory.html#Mem.perm_free_2">perm_free_2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">E</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>). <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.free_inject">free_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">l</span> <span class="id">m1</span>' <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free_list">free_list</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b1">b1</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">lo1</span>, <span class="id">exists</span> <span class="id">hi1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FMemory.html#b1">b1</a></span>, <span class="id"><a href="FMemory.html#lo1">lo1</a></span>, <span class="id"><a href="FMemory.html#hi1">hi1</a></span>) <span class="id"><a href="FMemory.html#l">l</a></span> /\ <span class="id"><a href="FMemory.html#lo1">lo1</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt; <span class="id"><a href="FMemory.html#hi1">hi1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6279')">Proof.</div>
<div class="proofscript" id="proof6279">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_right_inject">free_right_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_list_left_inject">free_list_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_free_list">perm_free_list</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">lo1</span> [<span class="id">hi1</span> [<span class="id">C</span> <span class="id">D</span>]]]. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.free_parallel_inject">free_parallel_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>' <span class="id">b</span>' <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span>', <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id">b</span>' (<span class="id"><a href="FMemory.html#lo">lo</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) (<span class="id"><a href="FMemory.html#hi">hi</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6280')">Proof.</div>
<div class="proofscript" id="proof6280">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_free">range_perm_free</a></span> <span class="id">m2</span> <span class="id">b</span>' (<span class="id">lo</span> + <span class="id">delta</span>) (<span class="id">hi</span> + <span class="id">delta</span>)) <span class="kwd">as</span> [<span class="id">m2</span>' <span class="id">FREE</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.range_perm_inject">range_perm_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_range_perm">free_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m2</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_inject">free_inject</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m1</span>) (<span class="id">l</span> := (<span class="id">b</span>,<span class="id">lo</span>,<span class="id">hi</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">lo</span>, <span class="id">hi</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.mi_no_overlap">mi_no_overlap</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="id">eexact</span> <span class="id">n</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_max">perm_max</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ofs</span> + <span class="id">delta0</span> - <span class="id">delta</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.free_range_perm">free_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>]. <span class="tactic">congruence</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_outside_inject">drop_outside_inject</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">delta</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, <span class="id"><a href="FMemory.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">b</span>' <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#delta">delta</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6281')">Proof.</div>
<div class="proofscript" id="proof6281">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.drop_outside_inj">drop_outside_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.drop_validblocks">drop_validblocks</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span>. <span class="tactic">intros</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.drop_freelist">drop_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Composing two memory injections. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.mem_inj_compose">mem_inj_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> <span class="id">f</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> (<span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">f</span>') <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6282')">Proof.</div>
<div class="proofscript" id="proof6282">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;perm&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b</span>' <span class="id">delta</span>'] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b</span>') <span class="kwd">as</span> [[<span class="id">b</span>'' <span class="id">delta</span>''] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + (<span class="id">delta</span>' + <span class="id">delta</span>'')) <span class="kwd">with</span> ((<span class="id">ofs</span> + <span class="id">delta</span>') + <span class="id">delta</span>'') <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;align&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b</span>' <span class="id">delta</span>'] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b</span>') <span class="kwd">as</span> [[<span class="id">b</span>'' <span class="id">delta</span>''] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_align0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_align1</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span> + <span class="id">delta</span>') (<span class="id">p</span> := <span class="id">p</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">replace</span> <span class="id">ofs0</span> <span class="kwd">with</span> ((<span class="id">ofs0</span> - <span class="id">delta</span>') + <span class="id">delta</span>') <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">omega</span>.<br/>
&nbsp;memval&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b</span>' <span class="id">delta</span>'] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b</span>') <span class="kwd">as</span> [[<span class="id">b</span>'' <span class="id">delta</span>''] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + (<span class="id">delta</span>' + <span class="id">delta</span>'')) <span class="kwd">with</span> ((<span class="id">ofs</span> + <span class="id">delta</span>') + <span class="id">delta</span>'') <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memdata.html#memval_inject_compose">memval_inject_compose</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.inject_compose">inject_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id">f</span>' <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> (<span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id">f</span>') <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6283')">Proof.</div>
<div class="proofscript" id="proof6283">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="id">constructor</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mem_inj_compose">mem_inj_compose</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;unmapped&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">erewrite</span> <span class="id">mi_freeblocks0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mapped&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b</span>) <span class="kwd">as</span> [[<span class="id">b1</span> <span class="id">delta1</span>] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b2</span> <span class="id">delta2</span>] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b</span>) <span class="id">eqn</span>:? ; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span>. <span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b0</span>) <span class="id">eqn</span>:? ; [|<span class="tactic">discriminate</span>]. <span class="tactic">destruct</span> <span class="id">p</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist1</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b1x</span> <span class="id">delta1x</span>] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b1x</span>) <span class="kwd">as</span> [[<span class="id">b1y</span> <span class="id">delta1y</span>] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b2</span>) <span class="kwd">as</span> [[<span class="id">b2x</span> <span class="id">delta2x</span>] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b2x</span>) <span class="kwd">as</span> [[<span class="id">b2y</span> <span class="id">delta2y</span>] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1x</span> <span class="id">b2x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1x</span>. <span class="tactic">destruct</span> <span class="id">A</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">delta1y</span> = <span class="id">delta2y</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="id">right</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_no_overlap1</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H3</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">omega</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b</span>) <span class="kwd">as</span> [[<span class="id">b1</span> <span class="id">delta1</span>] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b2</span> <span class="id">delta2</span>] |] <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_representable0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ofs</span>' := <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span> + <span class="id">delta1</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>' = <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span> + <span class="id">delta1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ofs</span>'; <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_representable1</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs</span>').<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span> + <span class="id">delta1</span> - 1) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span> - 1) + <span class="id">delta1</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b</span>' <span class="id">delta</span>'] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span>' <span class="id">b</span>') <span class="kwd">as</span> [[<span class="id">b</span>'' <span class="id">delta</span>''] |] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">b</span>'' <span class="id">delta</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + (<span class="id">delta</span>' + <span class="id">delta</span>'')) <span class="kwd">with</span> ((<span class="id">ofs</span> + <span class="id">delta</span>') + <span class="id">delta</span>'') <span class="kwd">in</span> <span class="id">H0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_perm_inv1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.val_lessdef_inject_compose">val_lessdef_inject_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> <span class="id"><a href="FMemory.html#v3">v3</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v3">v3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6284')">Proof.</div>
<div class="proofscript" id="proof6284">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.val_inject_lessdef_compose">val_inject_lessdef_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> -&gt; <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="FMemory.html#v2">v2</a></span> <span class="id"><a href="FMemory.html#v3">v3</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#v1">v1</a></span> <span class="id"><a href="FMemory.html#v3">v3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6285')">Proof.</div>
<div class="proofscript" id="proof6285">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.extends_inject_compose">extends_inject_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6286')">Proof.</div>
<div class="proofscript" id="proof6286">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">f</span> <span class="kwd">with</span> (<span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="id">f</span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mem_inj_compose">mem_inj_compose</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">extensionality</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span>, <span class="id"><a href="Values.html#inject_id">inject_id</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">x</span>) <span class="kwd">as</span> [[<span class="id">y</span> <span class="id">delta</span>] | ]; <span class="tactic">auto</span>.<br/>
&nbsp;unmapped&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freeblocks0</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.valid_block_extends">valid_block_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;mapped&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_extends">perm_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="FMemory.html#Mem.perm_extends">perm_extends</a></span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_extends">perm_extends</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.inject_extends_compose">inject_extends_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> <span class="id"><a href="FMemory.html#f">f</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6287')">Proof.</div>
<div class="proofscript" id="proof6287">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H0</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;inj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">f</span> <span class="kwd">with</span> (<span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span> <span class="id">f</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mem_inj_compose">mem_inj_compose</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">extensionality</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span>, <span class="id"><a href="Values.html#inject_id">inject_id</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">x</span>) <span class="kwd">as</span> [[<span class="id">y</span> <span class="id">delta</span>] | ]; <span class="tactic">auto</span>. <span class="id">decEq</span>. <span class="id">decEq</span>. <span class="tactic">omega</span>.<br/>
&nbsp;unmapped&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;mapped&nbsp;*)</span>&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.valid_block_extends">valid_block_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_freelist0</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.in_freelist">in_freelist</a></span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">mi_no_overlap0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;representable&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_representable0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm_inv0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_inj">perm_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.extends_extends_compose">extends_extends_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.extends">extends</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6288')">Proof.</div>
<div class="proofscript" id="proof6288">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;nextblock&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">mext_validblocks0</span> <span class="id">b</span>). <span class="tactic">auto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;nextblockid&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;meminj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="kwd">with</span> (<span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.mem_inj_compose">mem_inj_compose</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">extensionality</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span>, <span class="id"><a href="Values.html#inject_id">inject_id</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">mext_perm_inv1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>]. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mext_perm_inv0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_extends">perm_extends</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Injecting a memory into itself. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.flat_inj">flat_inj</a></span> (<span class="id">thr</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Values.html#block">block</a></span>) : <span class="id"><a href="Values.html#meminj">meminj</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) =&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span>) <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="FMemory.html#b">b</a></span>, 0) <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Mem.inject_neutral">inject_neutral</a></span> (<span class="id">thr</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.mem_inj">mem_inj</a></span> (<span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span>) <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Mem.flat_inj_no_overlap">flat_inj_no_overlap</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thr</span> <span class="id">m</span>, <span class="id"><a href="FMemory.html#Mem.meminj_no_overlap">meminj_no_overlap</a></span> (<span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span>) <span class="id"><a href="FMemory.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6289')">Proof.</div>
<div class="proofscript" id="proof6289">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">thr</span>); <span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">thr</span>); <span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.neutral_inject">neutral_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> (<span class="id"><a href="FMemory.html#Mem.valid_block_list">valid_block_list</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>) <span class="id"><a href="FMemory.html#m">m</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.inject">inject</a></span> (<span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span> (<span class="id"><a href="FMemory.html#Mem.valid_block_list">valid_block_list</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>)) <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6290')">Proof.</div>
<div class="proofscript" id="proof6290">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block_list">valid_block_list</a></span>. <span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;meminj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;freeblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>, <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;mappedblocks&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>, <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b</span> (<span class="id"><a href="FMemory.html#Mem.validblocks">validblocks</a></span> <span class="id">m</span>)); <span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;freelist&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span>; <span class="tactic">inversion</span> <span class="id">H1</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;no&nbsp;overlap&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.flat_inj_no_overlap">flat_inj_no_overlap</a></span>.<br/>
&nbsp;range&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range_2">Ptrofs.unsigned_range_2</a></span> <span class="id">ofs</span>); <span class="tactic">omega</span>.<br/>
&nbsp;perm&nbsp;inv&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span>; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_0_r">Zplus_0_r</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.alloc_inject_neutral">alloc_inject_neutral</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">thr</span> <span class="id">m</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">b</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m</span>', <span class="id"><a href="FMemory.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">nextblock</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>) <span class="id"><a href="FMemory.html#thr">thr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6291')">Proof.</div>
<div class="proofscript" id="proof6291">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_left_mapped_inj">alloc_left_mapped_inj</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m</span>) (<span class="id">b2</span> := <span class="id">b</span>) (<span class="id">delta</span> := 0).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_right_inj">alloc_right_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_0">Zdivide_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.perm_implies">perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_2">perm_alloc_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_result">alloc_result</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.store_inject_neutral">store_inject_neutral</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m</span>' <span class="id">thr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> (<span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span>) <span class="id"><a href="FMemory.html#v">v</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6292')">Proof.</div>
<div class="proofscript" id="proof6292">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_mapped_inj">store_mapped_inj</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.flat_inj_no_overlap">flat_inj_no_overlap</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + 0) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">m</span>'' [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Mem.drop_inject_neutral">drop_inject_neutral</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m</span>' <span class="id">thr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span> <span class="id"><a href="FMemory.html#thr">thr</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6293')">Proof.</div>
<div class="proofscript" id="proof6293">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.inject_neutral">inject_neutral</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.drop_mapped_inj">drop_mapped_inj</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.flat_inj_no_overlap">flat_inj_no_overlap</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.flat_inj">flat_inj</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_0_r">Zplus_0_r</a></span>. <span class="tactic">intros</span> [<span class="id">m</span>'' [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<h1> Invariance properties between two memory states </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Mem.UNCHANGED_ON">UNCHANGED_ON</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Mem.UNCHANGED_ON.P">P</a></span>: <span class="id"><a href="Values.html#block">block</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Mem.unchanged_on">unchanged_on</a></span> (<span class="id">m_before</span> <span class="id">m_after</span>: <span class="id"><a href="FMemory.html#Mem.mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.mk_unchanged_on">mk_unchanged_on</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.unchanged_on_validblock">unchanged_on_validblock</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m_before">m_before</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m_after">m_after</a></span> <span class="id"><a href="FMemory.html#b">b</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.unchanged_on_perm">unchanged_on_perm</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m_before">m_before</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m_before">m_before</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> &lt;-&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m_after">m_after</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>);<br/>
&nbsp;&nbsp;<span class="id"><a name="Mem.unchanged_on_contents">unchanged_on_contents</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m_before">m_before</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Max">Max</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#m_after">m_after</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> (<span class="id"><a href="Maps.html#PMap.get">PMap.get</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#m_before">m_before</a></span>.(<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span>))<br/>
}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.unchanged_on_refl">unchanged_on_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6294')">Proof.</div>
<div class="proofscript" id="proof6294">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.valid_block_unchanged_on">valid_block_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6295')">Proof.</div>
<div class="proofscript" id="proof6295">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.unchanged_on_validblock">unchanged_on_validblock</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.perm_unchanged_on">perm_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6296')">Proof.</div>
<div class="proofscript" id="proof6296">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">unchanged_on_perm0</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_valid_block">perm_valid_block</a></span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.perm_unchanged_on_2">perm_unchanged_on_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt; <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#k">k</a></span> <span class="id"><a href="FMemory.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6297')">Proof.</div>
<div class="proofscript" id="proof6297">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">unchanged_on_perm0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.unchanged_on_trans">unchanged_on_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>, <span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m2">m2</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m1">m1</a></span> <span class="id"><a href="FMemory.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6298')">Proof.</div>
<div class="proofscript" id="proof6298">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">do</span> 2 (<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.unchanged_on_validblock">unchanged_on_validblock</a></span>; <span class="tactic">eauto</span>).<br/>
- <span class="tactic">intros</span>. <span class="tactic">transitivity</span> (<span class="id"><a href="FMemory.html#Mem.perm">perm</a></span> <span class="id">m2</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>); <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.unchanged_on_perm">unchanged_on_perm</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_block_unchanged_on">valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">transitivity</span> (<span class="id"><a href="Maps.html#ZMap.get">ZMap.get</a></span> <span class="id">ofs</span> (<span class="id"><a href="FMemory.html#Mem.mem_contents">mem_contents</a></span> <span class="id">m2</span>)#<span class="id">b</span>); <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.unchanged_on_contents">unchanged_on_contents</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_unchanged_on">perm_unchanged_on</a></span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.loadbytes_unchanged_on_1">loadbytes_unchanged_on_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n">n</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6299')">Proof.</div>
<div class="proofscript" id="proof6299">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">n</span> 0).<br/>
+ <span class="id">erewrite</span> ! <span class="id"><a href="FMemory.html#Mem.loadbytes_empty">loadbytes_empty</a></span> <span class="tactic">by</span> <span class="tactic">assumption</span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span>. <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id">ofs</span> + <span class="id">n</span>) <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_exten">getN_exten</a></span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#nat_of_Z_eq">nat_of_Z_eq</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">unchanged_on_contents0</span>, <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">unchanged_on_perm0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n0</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> &lt;- <span class="id">unchanged_on_perm0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.loadbytes_unchanged_on">loadbytes_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">b</span> <span class="id">ofs</span> <span class="id">n</span> <span class="id">bytes</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="FMemory.html#n">n</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.loadbytes">loadbytes</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6300')">Proof.</div>
<div class="proofscript" id="proof6300">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">n</span> 0).<br/>
+ <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_empty">loadbytes_empty</a></span> <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">assumption</span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_unchanged_on_1">loadbytes_unchanged_on_1</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.loadbytes_range_perm">loadbytes_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.load_unchanged_on_1">load_unchanged_on_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6301')">Proof.</div>
<div class="proofscript" id="proof6301">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">load</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.valid_access_dec">valid_access_dec</a></span> <span class="id">m</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Readable">Readable</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.getN_exten">getN_exten</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.unchanged_on_contents">unchanged_on_contents</a></span>, <span class="id"><a href="FMemory.html#Mem.perm_cur_max">perm_cur_max</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_unchanged_on">perm_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_false">pred_dec_false</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]; <span class="tactic">elim</span> <span class="id">n</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_unchanged_on_2">perm_unchanged_on_2</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.load_unchanged_on">load_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">load</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id">m</span>' <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="FMemory.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6302')">Proof.</div>
<div class="proofscript" id="proof6302">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.load_unchanged_on_1">load_unchanged_on_1</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.store_unchanged_on">store_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">store</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="FMemory.html#chunk">chunk</a></span> -&gt; ~ <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6303')">Proof.</div>
<div class="proofscript" id="proof6303">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>. <span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.store_validblocks">store_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
- <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_mem_contents">store_mem_contents</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> (<span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H0</span> <span class="id">ofs0</span>). <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.storebytes_unchanged_on">storebytes_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">bytes</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.storebytes">storebytes</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#ofs">ofs</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="FMemory.html#bytes">bytes</a></span>) -&gt; ~ <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6304')">Proof.</div>
<div class="proofscript" id="proof6304">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.storebytes_validblocks">storebytes_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_1">perm_storebytes_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_storebytes_2">perm_storebytes_2</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.storebytes_mem_contents">storebytes_mem_contents</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.setN_outside">setN_outside</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs0</span> (<span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">bytes</span>))); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H0</span> <span class="id">ofs0</span>). <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.alloc_unchanged_on">alloc_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m</span>' <span class="id">b</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">alloc</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = (<span class="id">m</span>', <span class="id"><a href="FMemory.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6305')">Proof.</div>
<div class="proofscript" id="proof6305">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.alloc_validblocks">alloc_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_1">perm_alloc_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_alloc_4">perm_alloc_4</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_not_valid_diff">valid_not_valid_diff</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
- <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">B</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">A</span>.  <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.valid_not_valid_diff">valid_not_valid_diff</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.free_unchanged_on">free_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; ~ <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6306')">Proof.</div>
<div class="proofscript" id="proof6306">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.free_validblocks">free_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_1">perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">lo</span>); <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> <span class="id">hi</span> <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">elim</span> (<span class="id">H0</span> <span class="id">ofs</span>). <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_free_3">perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">free</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.drop_perm_unchanged_on">drop_perm_unchanged_on</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">p</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#lo">lo</a></span> <span class="id"><a href="FMemory.html#hi">hi</a></span> <span class="id"><a href="FMemory.html#p">p</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="FMemory.html#lo">lo</a></span> &lt;= <span class="id"><a href="FMemory.html#i">i</a></span> &lt; <span class="id"><a href="FMemory.html#hi">hi</a></span> -&gt; ~ <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON.P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6307')">Proof.</div>
<div class="proofscript" id="proof6307">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="FMemory.html#Mem.drop_validblocks">drop_validblocks</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_3">perm_drop_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (~ (<span class="id">lo</span> &lt;= <span class="id">ofs</span> &lt; <span class="id">hi</span>)). { <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">eelim</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_drop_4">perm_drop_4</a></span>; <span class="tactic">eauto</span>. <br/>
- <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.drop_perm">drop_perm</a></span> <span class="kwd">in</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.range_perm_dec">range_perm_dec</a></span> <span class="id">m</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id"><a href="Memperm.html#Cur">Cur</a></span> <span class="id"><a href="Memperm.html#Freeable">Freeable</a></span>); <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem.UNCHANGED_ON">UNCHANGED_ON</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Mem.unchanged_on_implies">unchanged_on_implies</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">P</span> <span class="id">Q</span>: <span class="id"><a href="Values.html#block">block</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#P">P</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="FMemory.html#Q">Q</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="FMemory.html#Mem.valid_block">valid_block</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> -&gt; <span class="id"><a href="FMemory.html#P">P</a></span> <span class="id"><a href="FMemory.html#b">b</a></span> <span class="id"><a href="FMemory.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.unchanged_on">unchanged_on</a></span> <span class="id"><a href="FMemory.html#Q">Q</a></span> <span class="id"><a href="FMemory.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6308')">Proof.</div>
<div class="proofscript" id="proof6308">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">unchanged_on_perm0</span>; <span class="tactic">auto</span>. <br/>
- <span class="tactic">apply</span> <span class="id">unchanged_on_contents0</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.perm_valid_block">perm_valid_block</a></span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="FMemory.html#Mem">Mem</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id"><a name="mem">mem</a></span> := <span class="id"><a href="FMemory.html#mem">Mem.mem</a></span>.<br/>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="FMemory.html#alloc">Mem.alloc</a></span> <span class="id"><a href="FMemory.html#free">Mem.free</a></span> <span class="id"><a href="FMemory.html#store">Mem.store</a></span> <span class="id"><a href="FMemory.html#load">Mem.load</a></span> <span class="id"><a href="FMemory.html#storebytes">Mem.storebytes</a></span> <span class="id"><a href="FMemory.html#loadbytes">Mem.loadbytes</a></span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_not_valid_diff</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_implies</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_cur</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_max</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_valid_block</span><br/>
&nbsp;&nbsp;<span class="id">Mem.range_perm_implies</span><br/>
&nbsp;&nbsp;<span class="id">Mem.range_perm_cur</span><br/>
&nbsp;&nbsp;<span class="id">Mem.range_perm_max</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_implies</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_valid_block</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_perm</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_load</span><br/>
&nbsp;&nbsp;<span class="id">Mem.load_valid_access</span><br/>
&nbsp;&nbsp;<span class="id">Mem.loadbytes_range_perm</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_store</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_store_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_store_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.store_valid_block_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.store_valid_block_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.store_valid_access_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.store_valid_access_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.store_valid_access_3</span><br/>
&nbsp;&nbsp;<span class="id">Mem.storebytes_range_perm</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_storebytes_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_storebytes_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.storebytes_valid_access_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.storebytes_valid_access_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.nextblock_storebytes</span><br/>
&nbsp;&nbsp;<span class="id">Mem.storebytes_valid_block_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.storebytes_valid_block_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.alloc_result</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_block_alloc</span><br/>
&nbsp;&nbsp;<span class="id">Mem.fresh_block_alloc</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_new_block</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_alloc_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_alloc_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_alloc_3</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_alloc_4</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_alloc_inv</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_alloc_other</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_alloc_same</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_alloc_inv</span><br/>
&nbsp;&nbsp;<span class="id">Mem.range_perm_free</span><br/>
&nbsp;&nbsp;<span class="id">Mem.free_range_perm</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_block_free_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_block_free_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_free_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_free_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.perm_free_3</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_free_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_free_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_free_inv_1</span><br/>
&nbsp;&nbsp;<span class="id">Mem.valid_access_free_inv_2</span><br/>
&nbsp;&nbsp;<span class="id">Mem.unchanged_on_refl</span><br/>
: <span class="id">mem</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="GMemory.html">GMemory</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="strip">strip</a></span> (<span class="id">fm</span>: <span class="id"><a href="FMemory.html#mem">mem</a></span>) : <span class="id"><a href="GMemory.html#gmem">gmem</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.mk_gmem">GMem.mk_gmem</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#mem_contents">Mem.mem_contents</a></span> <span class="id"><a href="FMemory.html#fm">fm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#mem_access">Mem.mem_access</a></span> <span class="id"><a href="FMemory.html#fm">fm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#validblocks">Mem.validblocks</a></span> <span class="id"><a href="FMemory.html#fm">fm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#access_max">Mem.access_max</a></span> <span class="id"><a href="FMemory.html#fm">fm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#invalid_noaccess">Mem.invalid_noaccess</a></span> <span class="id"><a href="FMemory.html#fm">fm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#contents_default">Mem.contents_default</a></span> <span class="id"><a href="FMemory.html#fm">fm</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="embed">embed</a></span> (<span class="id">gm</span>: <span class="id"><a href="GMemory.html#gmem">gmem</a></span>) (<span class="id">fl</span>: <span class="id"><a href="MemAux.html#freelist">freelist</a></span>) (<span class="id">m</span>: <span class="id"><a href="FMemory.html#mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Embed">Embed</a></span>: <span class="id"><a href="FMemory.html#freelist">Mem.freelist</a></span> <span class="id">m</span> = <span class="id">fl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">m</span> = <span class="id">gm</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">gm</span> <span class="id">fl</span> <span class="id">m</span>.<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
