<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module ConflictReorder</title>
<meta name="description" content="Documentation of Coq module ConflictReorder" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module ConflictReorder</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="InteractionSemantics.html">InteractionSemantics</a></span> <span class="id"><a href="GAST.html">GAST</a></span> <span class="id"><a href="GMemory.html">GMemory</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html">GlobDefs</a></span> <span class="id"><a href="ETrace.html">ETrace</a></span> <span class="id"><a href="GlobSemantics.html">GlobSemantics</a></span> <span class="id"><a href="GlobSemantics_Lemmas.html">GlobSemantics_Lemmas</a></span> <span class="id"><a href="NPSemantics.html">NPSemantics</a></span> <span class="id"><a href="TypedSemantics.html">TypedSemantics</a></span> .<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="DRF.html">DRF</a></span> <span class="id"><a href="USimDRF.html">USimDRF</a></span> <span class="id"><a href="NPDRF.html">NPDRF</a></span> <span class="id"><a href="Init.html">Init</a></span> <span class="id"><a href="FPLemmas.html">FPLemmas</a></span> <span class="id"><a href="PRaceLemmas.html">PRaceLemmas</a></span> <span class="id"><a href="SmileReorder.html">SmileReorder</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical.html">Classical</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Wf.html">Wf</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
<div class="doc">This file contains lemmas about reordering under the condition of data-race, used in the equivalence of DRF and NPDRF and also the equivalence of Safe and NPSafe.</div>
<span class="kwd">Local</span> <span class="kwd">Notation</span> "'&lt;&lt;' <span class="id">i</span> ',' <span class="id">c</span> ',' <span class="id">sg</span> ',' <span class="id">F</span> '&gt;&gt;'" := {|<span class="id"><a href="GlobDefs.html#Core.Build_t">Core.i</a></span> := <span class="id">i</span>; <span class="id">Core.c</span> := <span class="id">c</span>; <span class="id">Core.sg</span> := <span class="id">sg</span>; <span class="id">Core.F</span> := <span class="id">F</span>|} (<span class="tactic">at</span> <span class="id">level</span> 60, <span class="id">right</span> <span class="id">associativity</span>).<br/>
<span class="kwd">Local</span> <span class="kwd">Definition</span> <span class="id"><a name="pc_valid_tid">pc_valid_tid</a></span> {<span class="id">ge</span>}:= @<span class="id"><a href="GSimDefs.html#pc_valid_tid">GSimDefs.pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#ge">ge</a></span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> "{ <span class="id">A</span> , <span class="id">B</span> , <span class="id">C</span> , <span class="id">D</span> }" := {|<span class="id"><a href="GlobDefs.html#Build_ProgConfig">thread_pool</a></span>:=<span class="id">A</span>;<span class="id">cur_tid</span>:=<span class="id">B</span>;<span class="id">gm</span>:=<span class="id">C</span>;<span class="id">atom_bit</span>:= <span class="id">D</span>|}(<span class="tactic">at</span> <span class="id">level</span> 70,<span class="id">right</span> <span class="id">associativity</span>).  <span class="kwd">Local</span> <span class="kwd">Notation</span> "{-| <span class="id">PC</span> , <span class="id">T</span> }" := ({|<span class="id"><a href="GlobDefs.html#Build_ProgConfig">thread_pool</a></span> := <span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span> <span class="id">PC</span>; <span class="id">cur_tid</span> := <span class="id">T</span>;<span class="id">gm</span> := <span class="id"><a href="GlobDefs.html#gm">gm</a></span> <span class="id">PC</span>; <span class="id">atom_bit</span> := <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">PC</span> |}) (<span class="tactic">at</span> <span class="id">level</span> 70,<span class="id">right</span> <span class="id">associativity</span>).<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="CReorder">CReorder</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> <span class="id"><a name="CReorder.GE">GE</a></span>:<span class="id"><a href="GlobDefs.html#GlobEnv.t">GlobEnv.t</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id"><a name="CReorder.wdge">wdge</a></span>:<span class="kwd">forall</span> <span class="id">ix</span>,<span class="id"><a href="InteractionSemantics.html#mod_wd">mod_wd</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#ix">ix</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> <span class="id">wdge</span>':<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>,<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8803')">Proof.</div>
<div class="proofscript" id="proof8803">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1 <span class="kwd">as</span> [|[]];<span class="tactic">destruct</span> 1;<span class="tactic">split</span>;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#valid_tid_backwards_preserve">valid_tid_backwards_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#halted_preserve">halted_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#valid_tid_backwards_preserve">valid_tid_backwards_preserve</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="id">right</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#halted_preserve">halted_preserve</a></span>;<span class="tactic">eauto</span>. <span class="id">right</span>;<span class="id">right</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 5 <span class="id">eexists</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#valid_tid_backwards_preserve">valid_tid_backwards_preserve</a></span> <span class="kwd">with</span>(<span class="id">thdp1</span>:=<span class="id">thdp</span>') <span class="kwd">in</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#valid_tid_backwards_preserve">valid_tid_backwards_preserve</a></span> ;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#halted_preserve">halted_preserve</a></span> <span class="kwd">with</span>(<span class="id">thdp2</span>:=<span class="id">thdp</span>') <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#halted_preserve">halted_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_taustar_pc_valid_tid_backwards_preservation">npnsw_taustar_pc_valid_tid_backwards_preservation</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>,<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8804')">Proof.</div>
<div class="proofscript" id="proof8804">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1;<span class="tactic">intros</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHtau_star</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_taustar_to_taustar">npnsw_taustar_to_taustar</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (@<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8805')">Proof.</div>
<div class="proofscript" id="proof8805">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1;<span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [|[|]];<span class="tactic">eapply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestar_globstar">corestar_globstar</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (@<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8806')">Proof.</div>
<div class="proofscript" id="proof8806">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestar_coretaustar">corestar_coretaustar</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#star">star</a></span> (@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8807')">Proof.</div>
<div class="proofscript" id="proof8807">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1;<span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="type_glob_step_cur_valid_id">type_glob_step_cur_valid_id</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#x">x</a></span> &lt;&gt; <span class="id"><a href="TypedSemantics.html#glob_sw">glob_sw</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#cur_valid_id">cur_valid_id</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8808')">Proof.</div>
<div class="proofscript" id="proof8808">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">c</span>, <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#gettop_valid_tid">gettop_valid_tid</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">solv_thread</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestar_Glocality">corestar_Glocality</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">pc1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#star">star</a></span> (@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#thread_sim">thread_sim</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#GPre">GPre</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>',<span class="id"><a href="ETrace.html#star">star</a></span> (@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc1</span>' /\ <span class="id"><a href="SmileReorder.html#GPost">GPost</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>'.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id">pc1</span>'.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>) /\ <span class="id"><a href="SmileReorder.html#thread_sim">thread_sim</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>' <span class="id">pc1</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8809')">Proof.</div>
<div class="proofscript" id="proof8809">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">pc1</span>. <span class="tactic">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>;<span class="id">constructor</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H4</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#GPre_subset">GPre_subset</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> <span class="id">R</span>;[|<span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.union_subset">FP.union_subset</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#corestep_Glocality">corestep_Glocality</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#globstep_eff">globstep_eff</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#globstep_eff">globstep_eff</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H11</span> <span class="kwd">in</span> *;<span class="tactic">clear</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#GPre_GEffect_GPost_Rule">GPre_GEffect_GPost_Rule</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">s2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H7</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id">x</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span>;<span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id">s2</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHl</span> <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H12</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_taustar">corestar_taustar</a></span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#corestar_globstar">corestar_globstar</a></span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#taustar_eff">taustar_eff</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_taustar">corestar_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#corestar_globstar">corestar_globstar</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#taustar_eff">taustar_eff</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H12</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x</span> =<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>). <span class="tactic">inversion</span> <span class="id">H6</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H18</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#GPost_GEffect_GPost_Rule1">GPost_GEffect_GPost_Rule1</a></span> <span class="kwd">in</span> <span class="id">H16</span> ;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="core_taustar_Glocality">core_taustar_Glocality</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">pc1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#thread_sim">thread_sim</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#GPre">GPre</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>',<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc1</span>' /\ <span class="id"><a href="SmileReorder.html#GPost">GPost</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>'.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id">pc1</span>'.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>) /\ <span class="id"><a href="SmileReorder.html#thread_sim">thread_sim</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>' <span class="id">pc1</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8810')">Proof.</div>
<div class="proofscript" id="proof8810">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#tau_star_to_star">tau_star_to_star</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestar_Glocality">corestar_Glocality</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestar_coretaustar">corestar_coretaustar</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_half_I_smile">npnswstep_half_I_smile</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">pc1</span> <span class="id">fp</span>' <span class="id">pc2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#entat">entat</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id">fp</span>' <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>' <span class="id">pc2</span>' <span class="id">pc3</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#entat">entat</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>, <span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc1</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id">pc1</span>' <span class="id">fp</span>' <span class="id">pc2</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc2</span>' (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>') <span class="id"><a href="GlobDefs.html#O">O</a></span>) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc3</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span> <span class="id">pc3</span>' = <span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GMem.eq</span>' (<span class="id"><a href="GlobDefs.html#gm">gm</a></span> <span class="id">pc3</span>')(<span class="id"><a href="GlobDefs.html#gm">gm</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8811')">Proof.</div>
<div class="proofscript" id="proof8811">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#atomblock_open_reorderstep1">atomblock_open_reorderstep1</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc1</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x1</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">H11</span>. <span class="tactic">apply</span> <span class="id">GMem.eq</span>'<span class="id">_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">H12</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#atomblock_open_reorder_corestar">atomblock_open_reorder_corestar</a></span> <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span> <span class="kwd">in</span> <span class="id">H16</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">x0</span> = <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x0</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>). <span class="tactic">inversion</span> <span class="id">H8</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H19</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="kwd">in</span> <span class="id">H14</span>;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H16</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">GMem.eq</span>'<span class="id">_trans</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">GMem.eq</span>'<span class="id">_sym</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="localstep_locality2">localstep_locality2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i_x</span> <span class="id">F</span> <span class="id">cc</span> <span class="id">m</span> <span class="id">fp</span> <span class="id">cc</span>' <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#step">step</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#F">F</a></span>) <span class="id"><a href="ConflictReorder.html#cc">cc</a></span> <span class="id"><a href="ConflictReorder.html#m">m</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">cc</span>' <span class="id">m</span>' -&gt;      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m1</span> <span class="id">fp1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> (<span class="id">fp0</span> : <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>) (<span class="id">q1</span> : <span class="id"><a href="InteractionSemantics.html#core">InteractionSemantics.core</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)))  (<span class="id">m0</span> : <span class="id"><a href="GMemory.html#gmem">gmem</a></span>),<span class="id"><a href="InteractionSemantics.html#step">step</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#cc">cc</a></span> <span class="id"><a href="ConflictReorder.html#m1">m1</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> <span class="id"><a href="ConflictReorder.html#q1">q1</a></span> <span class="id"><a href="ConflictReorder.html#m0">m0</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">fp2</span> <span class="id">cc2</span> <span class="id">m2</span>,<span class="id"><a href="InteractionSemantics.html#step">step</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#F">F</a></span>) <span class="id"><a href="ConflictReorder.html#cc">cc</a></span> <span class="id"><a href="ConflictReorder.html#m1">m1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#cc2">cc2</a></span> <span class="id"><a href="ConflictReorder.html#m2">m2</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#LPre">LPre</a></span> <span class="id"><a href="ConflictReorder.html#m">m</a></span> <span class="id"><a href="ConflictReorder.html#m1">m1</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#F">F</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m1</span>', <span class="id"><a href="InteractionSemantics.html#step">step</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#i_x">i_x</a></span>)) (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#F">F</a></span>) <span class="id"><a href="ConflictReorder.html#cc">cc</a></span> <span class="id"><a href="ConflictReorder.html#m1">m1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">cc</span>' <span class="id">m1</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8812')">Proof.</div>
<div class="proofscript" id="proof8812">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="ConflictReorder.html#CReorder.wdge">wdge</a></span> <span class="id">i_x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="InteractionSemantics.html#step_locality_2">step_locality_2</a></span> <span class="id">_</span> <span class="id"><a href="ConflictReorder.html#CReorder.wdge">wdge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InteractionSemantics.html#corestep_locality_2">corestep_locality_2</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#LPre_comm">LPre_comm</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestep_locality2">corestep_locality2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>' <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">H_corestep</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp0</span> <span class="id">pc0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> <span class="id"><a href="ConflictReorder.html#pc0">pc0</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">fp</span>' <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' <span class="id">pc</span>'-&gt;<span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#LPre">LPre</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id">pc</span>'.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> (<span class="id"><a href="SmileReorder.html#getfl">getfl</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp1</span> <span class="id">pc</span>'1,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id">pc</span>' <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id">pc</span>'1 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>,<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8813')">Proof.</div>
<div class="proofscript" id="proof8813">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_tp_core</span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">clear</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#getfl">getfl</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#LPre_comm">LPre_comm</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#localstep_locality2">localstep_locality2</a></span> <span class="kwd">in</span> <span class="id">H_core_step</span> <span class="kwd">as</span> [];<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">thdp</span>'',<span class="id"><a href="GlobDefs.html#ThreadPool.update">ThreadPool.update</a></span> <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>) <span class="id">c</span>' <span class="id">thdp</span>'').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>)) <span class="id">eqn</span>:<span class="id">eq3</span>;[|<span class="tactic">inversion</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t0</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">clear</span> <span class="id">H</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> {|<span class="id"><a href="GlobDefs.html#Build_ProgConfig">thread_pool</a></span>:=<span class="id">x0</span>;<span class="id">cur_tid</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>);<span class="id">gm</span>:=<span class="id">x</span>;<span class="id">atom_bit</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span>)|}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span>={|<span class="id"><a href="GlobDefs.html#Build_ProgConfig">thread_pool</a></span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>);<span class="id">cur_tid</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>);<span class="id">gm</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#gm">GlobDefs.gm</a></span>);<span class="id">atom_bit</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span>) |}). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H_corestep</span> <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">inversion</span> <span class="id">H_tp_core0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span> <span class="id">H1</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">c</span>',<span class="id"><a href="GlobDefs.html#Core.update">Core.update</a></span> <span class="id">c</span> <span class="id">cc2</span> <span class="id">c</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">c</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">thdp</span>'',<span class="id"><a href="GlobDefs.html#ThreadPool.update">ThreadPool.update</a></span> <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>) <span class="id">c</span>' <span class="id">thdp</span>'').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>)) <span class="id">eqn</span>:<span class="id">eq3</span>;[|<span class="tactic">inversion</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">clear</span> <span class="id">H</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H1</span> <span class="kwd">with</span> (<span class="id">pc</span>':=( {|<span class="id"><a href="GlobDefs.html#Build_ProgConfig">thread_pool</a></span>:=<span class="id">x</span>;<span class="id">cur_tid</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>);<span class="id">gm</span>:=<span class="id">m2</span>;<span class="id">atom_bit</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span>)|}));<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span>={|<span class="id"><a href="GlobDefs.html#Build_ProgConfig">thread_pool</a></span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>);<span class="id">cur_tid</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>);<span class="id">gm</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#gm">GlobDefs.gm</a></span>);<span class="id">atom_bit</span>:=<span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span>) |}). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="safe_succeed">safe_succeed</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">step</span> <span class="id">abort</span> (<span class="id">pc</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="id"><a href="ConflictReorder.html#step">step</a></span> <span class="id"><a href="ConflictReorder.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#star">star</a></span> <span class="id"><a href="ConflictReorder.html#step">step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="id"><a href="ConflictReorder.html#step">step</a></span> <span class="id"><a href="ConflictReorder.html#abort">abort</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8814')">Proof.</div>
<div class="proofscript" id="proof8814">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ETrace.html#safe_state">safe_state</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#cons_star_star">cons_star_star</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="safe_state_tau_process">safe_state_tau_process</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">t</span> <span class="id">c</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_atomO</span>: <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_safe</span>:<span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_invthdp</span>:<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_cexists</span>:<span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id"><a href="ConflictReorder.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_cstep</span>: <span class="id">exists</span> <span class="id">m</span> <span class="id">fp</span> <span class="id">cc</span>' <span class="id">gm</span>', <span class="id"><a href="InteractionSemantics.html#step">step</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> (<span class="id"><a href="GlobDefs.html#Core.i">Core.i</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>))) (<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> (<span class="id"><a href="GlobDefs.html#Core.i">Core.i</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>)))  (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span>(<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>)(<span class="id"><a href="GlobDefs.html#Core.F">Core.F</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>)) (<span class="id"><a href="GlobDefs.html#Core.c">Core.c</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>) <span class="id"><a href="ConflictReorder.html#m">m</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">cc</span>' <span class="id">gm</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8815')">Proof.</div>
<div class="proofscript" id="proof8815">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="kwd">in</span> <span class="id">H_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ETrace.html#star">star</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>) ({-|<span class="id">pc</span>,<span class="id">t</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;[|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
Really&nbsp;need&nbsp;inv&nbsp;thdp?*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#gettop_valid_tid">gettop_valid_tid</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">solv_thread</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#safe_succeed">safe_succeed</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ETrace.html#star">star</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>}) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>})). <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_and_or">not_and_or</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solv_thread</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="ConflictReorder.html#CReorder.wdge">wdge</a></span> (<span class="id"><a href="GlobDefs.html#Core.i">Core.i</a></span> <span class="id">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#step_not_atext">step_not_atext</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> <span class="id">T1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#step_not_halt">step_not_halt</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> <span class="id">T2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>;[|<span class="id">contradiction</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_cexists</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>. <span class="tactic">inversion</span> <span class="id">H_tp_core</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">H_core_atext</span>. <span class="tactic">inversion</span> <span class="id">H_core_atext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unfocus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_exists">type_glob_step_exists</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ETrace.html#safe_state">safe_state</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#star_step">star_step</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H_cexists</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>;<span class="tactic">inversion</span> <span class="id">H_tp_core</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">H_core_atext</span>. <span class="tactic">inversion</span> <span class="id">H_core_atext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H_cexists</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>;<span class="tactic">inversion</span> <span class="id">H_tp_core</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">T2</span> <span class="kwd">in</span> <span class="id">H_core_halt</span>. <span class="tactic">inversion</span> <span class="id">H_core_halt</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H_cexists</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>;<span class="tactic">inversion</span> <span class="id">H_tp_core</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">H_core_atext</span>. <span class="tactic">inversion</span> <span class="id">H_core_atext</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H_cexists</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>;<span class="tactic">inversion</span> <span class="id">H_tp_core</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">H_core_atext</span>. <span class="tactic">inversion</span> <span class="id">H_core_atext</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_cexists</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>;<span class="tactic">inversion</span> <span class="id">H_tp_core</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">T2</span> <span class="kwd">in</span> <span class="id">H_core_halt</span>. <span class="tactic">inversion</span> <span class="id">H_core_halt</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="not_abort_rule">not_abort_rule</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ @<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#ThreadPool.halted">ThreadPool.halted</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span>)) \/ (<span class="id">exists</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="ConflictReorder.html#l">l</a></span> &lt;&gt; <span class="id"><a href="ETrace.html#sw">sw</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8816')">Proof.</div>
<div class="proofscript" id="proof8816">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_and_or">not_and_or</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="id">Hsimpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="type_restrict_core">type_restrict_core</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_a</span>: <span class="id"><a href="ConflictReorder.html#x">x</a></span> &lt;&gt; <span class="id"><a href="TypedSemantics.html#ret">ret</a></span>)(<span class="id">H_b</span>: <span class="id"><a href="ConflictReorder.html#x">x</a></span> &lt;&gt; <span class="id"><a href="TypedSemantics.html#glob_halt">glob_halt</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#l">l</a></span> &lt;&gt; <span class="id"><a href="ETrace.html#sw">sw</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span> <span class="id">l</span>' <span class="id">fp</span>' <span class="id">pc1</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#y">y</a></span> <span class="id">pc</span>' <span class="id">l</span>' <span class="id">fp</span>' <span class="id">pc1</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span>' &lt;&gt; <span class="id"><a href="ETrace.html#sw">sw</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#y">y</a></span> = <span class="id"><a href="ConflictReorder.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8817')">Proof.</div>
<div class="proofscript" id="proof8817">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="id">specialize</span> (<span class="id"><a href="ConflictReorder.html#CReorder.wdge">wdge</a></span> (<span class="id"><a href="GlobDefs.html#Core.i">Core.i</a></span> <span class="id">c</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H_tp_core</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">H_tp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>;<span class="tactic">inversion</span> <span class="id">H_tp_core0</span>;<span class="tactic">subst</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#step_not_atext">step_not_atext</a></span> <span class="kwd">in</span> <span class="id">H_core_step</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_core_step</span> <span class="kwd">in</span> <span class="id">H_core_atext</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H_core_atext</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#step_not_halt">step_not_halt</a></span> <span class="kwd">in</span> <span class="id">H_core_step</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_core_step</span> <span class="kwd">in</span> <span class="id">H_core_halt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H_core_halt</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">contradiction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">edestruct</span> <span class="id"><a href="InteractionSemantics.html#atext_not_halt">atext_not_halt</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">erewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H_core_atext</span>;<span class="tactic">inversion</span> <span class="id">H_core_atext</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H_core_halt</span>;<span class="tactic">inversion</span> <span class="id">H_core_halt</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">H_core_atext</span> <span class="kwd">in</span> <span class="id">H_core_atext0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H_core_atext0</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H_not_prim</span>)).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestep_reorder_rule_alter">corestep_reorder_rule_alter</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>})) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc</span>' ,@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8818')">Proof.</div>
<div class="proofscript" id="proof8818">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span>({-|<span class="id">pc</span>,<span class="id">t2</span>}) \/ ~<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id">pc</span>,<span class="id">t2</span>})). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#not_abort_rule">not_abort_rule</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solv_thread</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_exists">type_glob_step_exists</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R1</span>:<span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id">pc1</span>,<span class="id">t2</span>}) = <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id">pc</span>,<span class="id">t2</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>. <span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span>. <span class="id">solv_thread</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#type_restrict_core">type_restrict_core</a></span> <span class="kwd">in</span> <span class="id">R1</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span>(<span class="tactic">intro</span> <span class="id">contra</span>;<span class="tactic">inversion</span> <span class="id">contra</span>;<span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">fail</span>). <span class="tactic">clear</span> <span class="id">H5</span>. <span class="tactic">rename</span> <span class="id">H4</span> <span class="id">into</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>( (<span class="id">exists</span> (<span class="id">fp</span> : <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>) (<span class="id">pc</span>' : <span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span>),<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>, <span class="id">t2</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp1</span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>) \/ ~  (<span class="id">exists</span> (<span class="id">fp</span> : <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>) (<span class="id">pc</span>' : <span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span>), <span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>, <span class="id">t2</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp1</span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>,<span class="id">t2</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' -&gt; <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span>;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">c</span>,<span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">t1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c">c</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> (<span class="id">c</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">c2</span>,<span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">t2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c2">c2</a></span> /\ <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="id">pc1</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">t2</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c2">c2</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H</span>;<span class="id">Coqlib.inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#gettop_backwards_preserve">gettop_backwards_preserve</a></span> <span class="kwd">in</span> <span class="id">H_tp_core0</span> <span class="kwd">as</span> <span class="id">R1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> (<span class="id">c2</span>&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>,<span class="id">t2</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<span class="id"><a href="InteractionSemantics.html#LPre">LPre</a></span> <span class="id">pc</span>'.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id">pc</span>.(<span class="id"><a href="GlobDefs.html#gm">gm</a></span>) <span class="id">fp1</span> (<span class="id"><a href="SmileReorder.html#getfl">getfl</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#corestep_eff">corestep_eff</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#corestep_eff">corestep_eff</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#LEffect_fpsmile_LPre_Rule">LEffect_fpsmile_LPre_Rule</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#dif_thd_disj_fl">dif_thd_disj_fl</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id"><a href="ConflictReorder.html#corestep_locality2">corestep_locality2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="kwd">forall</span> <span class="id">fp</span>'' <span class="id">pc</span>'',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>,<span class="id">t2</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>'' <span class="id">pc</span>'' -&gt; <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>'' (<span class="id"><a href="Footprint.html#FP.maxsmile">FP.maxsmile</a></span> <span class="id">fp1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.maxsmile_smile_subset">FP.maxsmile_smile_subset</a></span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">L1</span>:<span class="id"><a href="InteractionSemantics.html#LPre">LPre</a></span> (<span class="id"><a href="GlobDefs.html#gm">gm</a></span> ({-|<span class="id">pc</span>,<span class="id">t2</span>}))(<span class="id"><a href="GlobDefs.html#gm">gm</a></span> <span class="id">pc1</span>)(<span class="id"><a href="Footprint.html#FP.maxsmile">FP.maxsmile</a></span> <span class="id">fp1</span>)(<span class="id"><a href="SmileReorder.html#getfl">getfl</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">c2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">c3</span>,<span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span> <span class="id">pc1</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) <span class="id">t1</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="ConflictReorder.html#c3">c3</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">c</span>'. <span class="id">solv_thread</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">Coqlib.peq</a></span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id">pc1</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">clear</span> <span class="id">H</span>;<span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.upd_top_inv">ThreadPool.upd_top_inv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#corestep_eff">corestep_eff</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">E1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#getfl">getfl</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">c</span> = <span class="id"><a href="SmileReorder.html#getfl">getfl</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#core_Fpreservation">core_Fpreservation</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=({-|<span class="id">pc</span>,<span class="id">t1</span>}));<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#getcurcore">getcurcore</a></span>. <span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span> = <span class="id">t1</span>). <span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Footprint.html#FP.maxsmile_smile">FP.maxsmile_smile</a></span> <span class="id">fp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#LPre_comm">LPre_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#LEffect_fpsmile_LPre_Rule">LEffect_fpsmile_LPre_Rule</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#dif_thd_disj_fl">dif_thd_disj_fl</a></span> <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id">t2</span>)(<span class="id">t2</span>:=<span class="id">t1</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_locality2">corestep_locality2</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Corollary</span> <span class="id"><a name="corestep_reorder_rule_alter2">corestep_reorder_rule_alter2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>})) \/ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> /\ <span class="id">exists</span> <span class="id">pc1</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id">pc1</span>'/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc2</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc1</span>',<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id">pc2</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> ({-|<span class="id">pc2</span>',<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8819')">Proof.</div>
<div class="proofscript" id="proof8819">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_reorder_rule_alter">corestep_reorder_rule_alter</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span> <span class="kwd">as</span> [|[]];<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> (<span class="id">_</span>&amp;<span class="id">_</span>&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#corestep_reorder_rule">corestep_reorder_rule</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestep_conflict">corestep_conflict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>})) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8820')">Proof.</div>
<div class="proofscript" id="proof8820">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_reorder_rule_alter">corestep_reorder_rule_alter</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span> <span class="kwd">as</span> [|[]];<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span> <span class="kwd">as</span> (?&amp;?&amp;?). <span class="tactic">eauto</span>.    <br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_fpnotemp">npnswstep_fpnotemp</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#fp">fp</a></span>&lt;&gt; <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8821')">Proof.</div>
<div class="proofscript" id="proof8821">
  <span class="tactic">destruct</span> 1 <span class="kwd">as</span> [|[]];<span class="tactic">auto</span>;<span class="tactic">intro</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="id">contradiction</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_conflict">npnswstep_conflict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span>({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>})) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8822')">Proof.</div>
<div class="proofscript" id="proof8822">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_fpnotemp">npnswstep_fpnotemp</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_fpnotemp">npnswstep_fpnotemp</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_conflict">corestep_conflict</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">right</span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_reorder_rule_alter">npnswstep_reorder_rule_alter</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>})) \/ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>)\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc</span>',<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id">pc</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8823')">Proof.</div>
<div class="proofscript" id="proof8823">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#glob_npnsw_step_type">glob_npnsw_step_type</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">x</span>&amp;<span class="id">step1</span>&amp;<span class="id">type1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#glob_npnsw_step_type">glob_npnsw_step_type</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">y</span>&amp;<span class="id">step2</span>&amp;<span class="id">type2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp2</span> \/ ~<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">type1</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">step1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="tactic">inversion</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc1</span> = <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">type2</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">step2</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="tactic">inversion</span> <span class="id">H5</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ETrace.html#tau">tau</a></span> &lt;&gt; <span class="id"><a href="ETrace.html#sw">sw</a></span>). <span class="tactic">intro</span> <span class="id">L</span>;<span class="tactic">inversion</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span>  <span class="id"><a href="SmileReorder.html#globstep_reorder_rule">globstep_reorder_rule</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">pc</span>'&amp;<span class="id">step</span>'&amp;<span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="id">right</span>;<span class="id">exists</span> <span class="id">pc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">type2</span> <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="tactic">unfold</span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">x</span> = <span class="id"><a href="TypedSemantics.html#core">core</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">type1</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">step1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">y</span> = <span class="id"><a href="TypedSemantics.html#core">core</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">type2</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">step2</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_reorder_rule_alter">corestep_reorder_rule_alter</a></span> <span class="kwd">in</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [|[|]];<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>;<span class="tactic">unfold</span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="id">left</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_conflict_min_rule">npnsw_conflict_min_rule</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp20</span> <span class="id">fp21</span> <span class="id">pc20</span> <span class="id">pc21</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ConflictReorder.html#fp20">fp20</a></span> <span class="id"><a href="ConflictReorder.html#pc20">pc20</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc20">pc20</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp21">fp21</a></span> <span class="id"><a href="ConflictReorder.html#pc21">pc21</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp20">fp20</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp21">fp21</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8824')">Proof.</div>
<div class="proofscript" id="proof8824">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_star_tau_N_equiv">tau_star_tau_N_equiv</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">x</span> = <span class="id">x</span> + 1). <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_N_split">tau_N_split</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">pc</span>'&amp;<span class="id">fp</span>&amp;<span class="id">fp</span>'&amp;<span class="id">N1</span>&amp;<span class="id">N2</span>&amp;?).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp1</span> <span class="id">fp</span> \/ ~<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp1</span> <span class="id">fp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHx</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union">fpsmile_union</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>,<span class="id">fp</span>',<span class="id">pc</span>',<span class="id">pc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_star_tau_N_equiv">tau_star_tau_N_equiv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">N2</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H8</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">in</span> *;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="halfatomblockstep">halfatomblockstep</a></span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>'=&gt; <span class="id"><a href="ConflictReorder.html#l">l</a></span> = <span class="id"><a href="ETrace.html#tau">tau</a></span> /\ <span class="id">exists</span> <span class="id">pc1</span> ,<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#entat">entat</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="halfatomblockstep_cur_valid_id">halfatomblockstep_cur_valid_id</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#cur_valid_id">cur_valid_id</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8825')">Proof.</div>
<div class="proofscript" id="proof8825">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#type_glob_step_cur_valid_id">type_glob_step_cur_valid_id</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="halfatomblock_abort">halfatomblock_abort</a></span> (<span class="id">pc</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>):<span class="kwd">Prop</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>', <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="halfatomblockabort_sw">halfatomblockabort_sw</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8826')">Proof.</div>
<div class="proofscript" id="proof8826">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep_cur_valid_id">halfatomblockstep_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>. <span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>,<span class="id">H2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="halfatomblockstep_star">halfatomblockstep_star</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">l</span>', <span class="id"><a href="ETrace.html#star">star</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id">l</span>' <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8827')">Proof.</div>
<div class="proofscript" id="proof8827">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#corestar_globstar">corestar_globstar</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#tau_star_to_star">tau_star_to_star</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.emp_union_fp">FP.emp_union_fp</a></span> <span class="kwd">with</span>(<span class="id">fp</span>:=<span class="id">fp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="npnsw_star_abort">npnsw_star_abort</a></span> (<span class="id">pc</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>):<span class="kwd">Prop</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'/\ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>'.<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="star_abort">star_abort</a></span> (<span class="id">pc</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>):<span class="kwd">Prop</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>', <span class="id"><a href="ETrace.html#star">star</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="predicted_abort1">predicted_abort1</a></span> (<span class="id">pc</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>):<span class="kwd">Prop</span>:=<br/>
&nbsp;&nbsp;|<span class="id"><a name="atomblock_abort_mk">atomblock_abort_mk</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id">pc</span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' -&gt;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id">pc</span><br/>
&nbsp;&nbsp;|<span class="id"><a name="npnsw_star_abort_mk">npnsw_star_abort_mk</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span>' <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="id">pc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id">pc</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="predicted_abort">predicted_abort</a></span>:= <span class="kwd">fun</span> <span class="id">pc</span>=&gt; <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span> /\  <span class="id"><a href="SmileReorder.html#cur_valid_id">cur_valid_id</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> /\ (<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> \/ <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="predicted_abort_predicted_abort1">predicted_abort_predicted_abort1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8828')">Proof.</div>
<div class="proofscript" id="proof8828">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=<span class="id">pc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>,<span class="id">H0</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="step_star_abort_suc">step_star_abort_suc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#l">l</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8829')">Proof.</div>
<div class="proofscript" id="proof8829">
 <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="taustar_abort_suc">taustar_abort_suc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8830')">Proof.</div>
<div class="proofscript" id="proof8830">
 <span class="tactic">intros</span>;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#tau_star_to_star">tau_star_to_star</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [];<span class="tactic">do</span> 3 <span class="id">eexists</span>;<span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_taustar_abort_suc">npnsw_taustar_abort_suc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8831')">Proof.</div>
<div class="proofscript" id="proof8831">
 <span class="tactic">intros</span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#npnsw_taustar_to_taustar">npnsw_taustar_to_taustar</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#taustar_abort_suc">taustar_abort_suc</a></span>;<span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_star_abort_suc">npnsw_star_abort_suc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8832')">Proof.</div>
<div class="proofscript" id="proof8832">
 <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_taustar_star_abort_suc">npnsw_taustar_star_abort_suc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8833')">Proof.</div>
<div class="proofscript" id="proof8833">
 <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_star_abort_elim">npnsw_star_abort_elim</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt; <span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8834')">Proof.</div>
<div class="proofscript" id="proof8834">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>. <span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#npnsw_taustar_to_taustar">npnsw_taustar_to_taustar</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#tau_star_to_star">tau_star_to_star</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> []. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="halfatomblock_abort_elim">halfatomblock_abort_elim</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt; <span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8835')">Proof.</div>
<div class="proofscript" id="proof8835">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep_star">halfatomblockstep_star</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_star_conflict">npnswstep_star_conflict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>', <span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8836')">Proof.</div>
<div class="proofscript" id="proof8836">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">V0</span>:<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span> <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span> <span class="kwd">as</span> [<span class="id">_</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_star_fpnotemp_cur_valid_id">npnsw_star_fpnotemp_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc1</span> <span class="id">t2</span>). <span class="tactic">destruct</span> <span class="id">H5</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_conflict_min_rule">npnsw_conflict_min_rule</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">fp2</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">fp20</span>&amp;<span class="id">fp21</span>&amp;<span class="id">pc20</span>&amp;<span class="id">pc21</span>&amp;<span class="id">star1</span>&amp;<span class="id">step1</span>&amp;<span class="id">smile1</span>&amp;<span class="id">conflict1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_star_reorder">npnswstep_star_reorder</a></span> <span class="kwd">in</span> <span class="id">smile1</span> <span class="kwd">as</span> <span class="id">E1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">E1</span> <span class="kwd">as</span> (<span class="id">pc1</span>'&amp;<span class="id">star1</span>'&amp;<span class="id">pc2</span>'&amp;<span class="id">step2</span>'&amp;<span class="id">memeq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span> <span class="kwd">as</span> <span class="id">Eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Eq1</span> <span class="kwd">in</span> <span class="id">memeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">pc22</span>,<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id">pc2</span>',<span class="id">t2</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp21</span> <span class="id"><a href="ConflictReorder.html#pc22">pc22</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_starN">mem_eq_npnsw_step_starN</a></span> <span class="kwd">in</span> <span class="id">memeq</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">memeq</span> <span class="kwd">as</span> (<span class="id">pc22</span>&amp;<span class="id">step</span>'&amp;<span class="id">memeq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">in</span> <span class="id">step</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">step</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">conflict1</span> <span class="kwd">as</span> <span class="id">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_fpnotemp">npnswstep_fpnotemp</a></span> <span class="kwd">in</span> <span class="id">step2</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_fpnotemp">npnswstep_fpnotemp</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_conflict">corestep_conflict</a></span> <span class="kwd">in</span> <span class="id">conflict1</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">step2</span>';<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">conflict1</span> <span class="kwd">as</span> [<span class="id">abort0</span>|<span class="id">conflict1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span>' <span class="kwd">as</span> <span class="id">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eq1</span> <span class="kwd">in</span> <span class="id">abort0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">abort0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">conflict1</span> <span class="kwd">as</span> (<span class="id">fp</span>&amp;<span class="id">pc</span>'&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp20</span> <span class="id">fp</span>),<span class="id">pc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">star1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="id">pc1</span>' = ({-|<span class="id">pc1</span>',<span class="id">t2</span>})). <span class="tactic">rewrite</span> <span class="id">star1</span>'. <span class="tactic">destruct</span> <span class="id">pc1</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">left</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="globstep_reorder_rule_alter">globstep_reorder_rule_alter</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">pc</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#y">y</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ConflictReorder.html#l1">l1</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ConflictReorder.html#l2">l2</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> = <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#l1">l1</a></span> &lt;&gt; <span class="id"><a href="ETrace.html#sw">sw</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#l2">l2</a></span> &lt;&gt; <span class="id"><a href="ETrace.html#sw">sw</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>})) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> /\ <span class="id">exists</span> <span class="id">pc1</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t2">t2</a></span>}) <span class="id"><a href="ConflictReorder.html#l2">l2</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id">pc1</span>'/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc2</span>',<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#y">y</a></span> ({-|<span class="id">pc1</span>',<span class="id"><a href="ConflictReorder.html#t1">t1</a></span>}) <span class="id"><a href="ConflictReorder.html#l1">l1</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id">pc2</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> ({-|<span class="id">pc2</span>',<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>})).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8837')">Proof.</div>
<div class="proofscript" id="proof8837">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp2</span> \/ ~ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">right</span>. <span class="tactic">split</span>;<span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#globstep_reorder_rule">globstep_reorder_rule</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>,<span class="id">l2</span>;<span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">y</span>,<span class="id">l1</span>;<span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_reorder_rule_alter2">corestep_reorder_rule_alter2</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc2</span> = <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_step_glob_predict_star_alter_cons_tideq">npnsw_step_glob_predict_star_alter_cons_tideq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>' (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>') <span class="id"><a href="ConflictReorder.html#b">b</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>) <span class="id"><a href="ConflictReorder.html#b">b</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8838')">Proof.</div>
<div class="proofscript" id="proof8838">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">L1</span>:<span class="id">pc</span>' = ({-|<span class="id">pc</span>',<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>'})). <span class="tactic">destruct</span> <span class="id">pc</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">L2</span>:<span class="id">pc</span> = ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;-<span class="id">L1</span> <span class="kwd">in</span> *;<span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id">L2</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_assoc">FP.fp_union_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">L2</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">L1</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="safe_state_not_abort">safe_state_not_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#safe_state">safe_state</a></span> <span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8839')">Proof.</div>
<div class="proofscript" id="proof8839">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ETrace.html#safe_state">safe_state</a></span>;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#star_abort">star_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">intros</span>;<span class="tactic">intro</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_step_glob_predict_star_alter_O_cons_tidneq">npnsw_step_glob_predict_star_alter_O_cons_tidneq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_safe</span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt; ~ <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_atomO</span>: <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t">t</a></span> &lt;&gt; <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="GlobDefs.html#O">O</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="GlobDefs.html#O">O</a></span> <span class="id">fp</span>' \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp0</span>, <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="GlobDefs.html#O">O</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8840')">Proof.</div>
<div class="proofscript" id="proof8840">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp</span>' \/~<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span> = ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_star_reorder">npnswstep_star_reorder</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> (<span class="id">pc1</span>'&amp;<span class="id">star1</span>&amp;<span class="id">pc2</span>'&amp;<span class="id">step2</span>&amp;<span class="id">eq</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc1</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="PRaceLemmas.html#nonhalt_biteq_taustar_npnsw_tau_star_equiv">nonhalt_biteq_taustar_npnsw_tau_star_equiv</a></span> <span class="kwd">in</span> <span class="id">star1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="PRaceLemmas.html#nohalt_nptaustar">nohalt_nptaustar</a></span> <span class="kwd">in</span> <span class="id">star1</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_star_conflict">npnswstep_star_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> ?;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_star_fpnotemp_cur_valid_id">npnsw_star_fpnotemp_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H2</span> <span class="id">H8</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">Step1</span>:<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span> <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">destruct</span> <span class="id">H10</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
eapply&nbsp;safe_succeed&nbsp;in&nbsp;H_safe;[|try&nbsp;eapply&nbsp;star_step;[eauto|constructor]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;safe_state_not_abort&nbsp;in&nbsp;H_safe.*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H_safe</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H10</span>. <span class="id">econstructor</span> 2;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span> <span class="kwd">as</span> (<span class="id">fp0</span>&amp;<span class="id">pc</span>''&amp;<span class="id">star1</span>&amp;<span class="id">conflict1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">conflict1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="id">exists</span> <span class="id">fp0</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>'' = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="PRaceLemmas.html#nonhalt_biteq_taustar_npnsw_tau_star_equiv">nonhalt_biteq_taustar_npnsw_tau_star_equiv</a></span> <span class="kwd">in</span> <span class="id">star1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="PRaceLemmas.html#nohalt_nptaustar">nohalt_nptaustar</a></span> <span class="kwd">in</span> <span class="id">star1</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestep_I_conflict">corestep_I_conflict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">pc1</span> <span class="id">fp</span>' <span class="id">pc2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#entat">entat</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id">fp</span>' <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>})) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>' <span class="id">fp1</span>' <span class="id">pc2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#entat">entat</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>, <span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc1</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> (<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span>) <span class="id">pc1</span>' <span class="id">fp1</span>' <span class="id">pc2</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp1</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8841')">Proof.</div>
<div class="proofscript" id="proof8841">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">R1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">R1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span>' <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#gettop_valid_tid">gettop_valid_tid</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">solv_thread</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id">pc</span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span> <span class="id">pc</span>'). <span class="id">left</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">swstep</span>:<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span> <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">destruct</span> <span class="id">H6</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#taustar_fpconflict_split">taustar_fpconflict_split</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H11</span> <span class="id">H12</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#atomblock_open_reorderstep1">atomblock_open_reorderstep1</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H0</span>;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">fail</span>);<span class="tactic">try</span>(<span class="tactic">intro</span> <span class="id">contra</span>;<span class="tactic">inversion</span> <span class="id">contra</span>;<span class="tactic">fail</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc1</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x4</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span>. <span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H6</span>. <span class="tactic">apply</span> <span class="id">GMem.eq</span>'<span class="id">_refl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">H11</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H7</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestep">mem_eq_corestep</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H8</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span> &lt;&gt; <span class="id">t</span>). <span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x3</span>). <span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#atomblock_open_reorder_corestar">atomblock_open_reorder_corestar</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="tactic">try</span>(<span class="tactic">intro</span> <span class="id">contra</span>;<span class="tactic">inversion</span> <span class="id">contra</span>;<span class="tactic">fail</span>);<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">fail</span>);<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x5</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x8</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_tid_bit_preserve">corestar_tid_bit_preserve</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">GMem.eq</span>'<span class="id">_sym</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestep">mem_eq_corestep</a></span> <span class="kwd">in</span> <span class="id">H19</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x3</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span> = <span class="id">x3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H21</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestep_changebit">corestep_changebit</a></span> <span class="kwd">with</span>(<span class="id">x</span>:=<span class="id"><a href="GlobDefs.html#I">I</a></span>) <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#changepc_again">changepc_again</a></span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x7</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>) <span class="id"><a href="GlobDefs.html#I">I</a></span> = ({-|<span class="id">x7</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_tid_bit_preserve">corestar_tid_bit_preserve</a></span> <span class="kwd">in</span> <span class="id">H15</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="kwd">in</span> <span class="id">H21</span>. <span class="tactic">destruct</span> <span class="id">x3</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H21</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H22</span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x8</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span> = ({-|<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x8</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>) <span class="id"><a href="GlobDefs.html#I">I</a></span>, <span class="id">t</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H23</span> <span class="kwd">in</span> <span class="id">H19</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_conflict">corestep_conflict</a></span> <span class="kwd">in</span> <span class="id">H19</span> <span class="kwd">as</span> ?;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H16</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_tid_bit_preserve">corestar_tid_bit_preserve</a></span> <span class="kwd">in</span> <span class="id">H15</span> <span class="kwd">as</span> ?. <span class="tactic">destruct</span> <span class="id">H25</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span> = <span class="id">t</span>). <span class="tactic">destruct</span> <span class="id">x3</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H21</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H27</span>,<span class="id">H25</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H24</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H24</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus_1">tau_plus_1</a></span> <span class="kwd">in</span> <span class="id">H24</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span> <span class="kwd">in</span> <span class="id">H24</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span> <span class="kwd">in</span> <span class="id">H24</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#corestar_globstar">corestar_globstar</a></span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobSemantics_Lemmas.html#GE_mod_wd_star_tp_inv">GE_mod_wd_star_tp_inv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_step_glob_predict_star_alter_I_cons_tidneq">npnsw_step_glob_predict_star_alter_I_cons_tidneq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_safe</span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt; ~ <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>})),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t">t</a></span> &lt;&gt; <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="GlobDefs.html#I">I</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="GlobDefs.html#I">I</a></span> <span class="id">fp</span>' \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp0</span> <span class="id">b</span>, <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#b">b</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8842')">Proof.</div>
<div class="proofscript" id="proof8842">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span>(<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp1</span> <span class="id">fp2</span>) \/ ~ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp1</span> <span class="id">fp2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp1</span>). <span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_subset">fpsmile_subset</a></span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_subset">FP.union_subset</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp2</span>). <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_subset">fpsmile_subset</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_subset">FP.union_subset</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span> = ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_star_reorder">npnswstep_star_reorder</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span> <span class="kwd">as</span> (<span class="id">pc1</span>'&amp;<span class="id">star1</span>&amp;<span class="id">pc2</span>'&amp;<span class="id">step1</span>&amp;<span class="id">memeq</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span> = <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H3</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> ({-|<span class="id">pc</span>',<span class="id">t</span>}) <span class="kwd">as</span> <span class="id">pc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span> = <span class="id">t</span>). <span class="tactic">rewrite</span> <span class="id">Heqpc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">pc</span>' <span class="id">Heqpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHtau_star</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_globstep">mem_eq_globstep</a></span> <span class="kwd">in</span> <span class="id">memeq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">memeq</span> <span class="kwd">as</span> (<span class="id">pc3</span>'&amp;<span class="id">step2</span>&amp;<span class="id">memeq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">memeq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">memeq</span> <span class="kwd">as</span> (<span class="id">pc4</span>'&amp;<span class="id">star2</span>&amp;<span class="id">_</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#glob_npnsw_step_type">glob_npnsw_step_type</a></span> <span class="kwd">in</span> <span class="id">step1</span> <span class="kwd">as</span> [<span class="id">x</span>[<span class="id">step</span>' <span class="id">type</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#atomblock_open_reorderstep1">atomblock_open_reorderstep1</a></span> <span class="kwd">in</span> <span class="id">step</span>' <span class="kwd">as</span> <span class="id">E1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">E1</span> <span class="kwd">as</span> [<span class="id">pc10</span>[<span class="id">entstep</span>[<span class="id">pc20</span>[<span class="id">step3</span>[<span class="id">thdpeq</span> <span class="id">gmeq</span>]]]]].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc3</span>' (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc20</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span>|-<span class="id">_</span>/\<span class="id">_</span> =&gt; <span class="tactic">split</span> <span class="kwd">end</span>;<span class="tactic">simpl</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">step2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">step2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">gmeq</span>; <span class="tactic">apply</span> <span class="id">GMem.eq</span>'<span class="id">_refl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> [<span class="id">pce</span>[<span class="id">star3</span> <span class="id">memeq</span>]];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">step3alt</span>:<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc10</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>) <span class="id"><a href="GlobDefs.html#O">O</a></span>) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span> <span class="id">pc20</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span>. <span class="tactic">destruct</span> <span class="id">type</span>' <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc10</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>) <span class="id"><a href="GlobDefs.html#O">O</a></span>) <span class="kwd">as</span> <span class="id">pc10</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc10</span>'=({-|<span class="id">pc10</span>',<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})). <span class="tactic">rewrite</span> <span class="id">Heqpc10</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">step3alt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#changeatombit_corestar_preserve">changeatombit_corestar_preserve</a></span> <span class="kwd">in</span> <span class="id">star3</span> <span class="kwd">as</span> <span class="id">star3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">star3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc20</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>) <span class="id">t</span> <span class="id"><a href="GlobDefs.html#O">O</a></span> = ({-|<span class="id">pc20</span>,<span class="id">t</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc20</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">atom_bit</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">type</span>' <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="id">Coqlib.inv</span> <span class="id">step3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H12</span> <span class="kwd">in</span> <span class="id">star3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_corestar_reorder">npnswstep_corestar_reorder</a></span> <span class="kwd">in</span> <span class="id">star3</span>';<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">star3</span>' <span class="kwd">as</span> [<span class="id">pc11</span>[<span class="id">star3</span>' <span class="id">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpc10</span>' <span class="kwd">in</span> <span class="id">star3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#changeatombitI_corestar_preserve">changeatombitI_corestar_preserve</a></span> <span class="kwd">in</span> <span class="id">star3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">star3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(  (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span> <span class="id">pc10</span>, <span class="id">t</span>, <span class="id"><a href="GlobDefs.html#gm">gm</a></span> <span class="id">pc10</span>, <span class="id"><a href="GlobDefs.html#O">O</a></span>}) <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>) = <span class="id">pc10</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc10</span>;<span class="tactic">f_equal</span>;<span class="id">Coqlib.inv</span> <span class="id">entstep</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H13</span> <span class="kwd">in</span> <span class="id">star3</span>';<span class="tactic">clear</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span> <span class="kwd">as</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(({-|<span class="id">pc1</span>',<span class="id">t</span>}) = <span class="id">pc1</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc1</span>';<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H13</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpc10</span>';<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">entstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">entstep</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">type</span>' <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="id">Coqlib.inv</span> <span class="id">step</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">L</span>;<span class="tactic">inversion</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpconflict_union">fpconflict_union</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp1</span> \/ ~ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">O1</span>:<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_star_conflict">npnswstep_star_conflict</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#type_glob_step_cur_valid_id">type_glob_step_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">auto</span>;[|<span class="tactic">intro</span> <span class="id">contra</span>;<span class="tactic">inversion</span> <span class="id">contra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_taustar_pc_valid_tid_backwards_preservation">npnsw_taustar_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span>' <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H_safe</span> <span class="id">t</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>. <span class="id">instantiate</span>(1:=<span class="id">pc</span>). <span class="tactic">destruct</span> <span class="id">pc</span>,<span class="id">H0</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span> <span class="kwd">as</span> (<span class="id">fp1</span>'&amp;<span class="id">pc1</span>'&amp;<span class="id">star1</span>&amp;<span class="id">conflict1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">exists</span> <span class="id">fp1</span>',<span class="id"><a href="GlobDefs.html#O">O</a></span>. <span class="tactic">split</span>;[<span class="id">econstructor</span>|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_O_preservation">npnsw_taustar_O_preservation</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>;[<span class="id">contradiction</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span> = ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">O1</span>:<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_star_reorder">npnswstep_star_reorder</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span> <span class="kwd">as</span> (<span class="id">pc1</span>'&amp;<span class="id">star1</span>'&amp;<span class="id">pc2</span>'&amp;<span class="id">step1</span>'&amp;<span class="id">memeq</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_globstep">mem_eq_globstep</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span> <span class="kwd">as</span> (<span class="id">pc3</span>'&amp;<span class="id">entstep</span>&amp;<span class="id">memeq2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> <span class="id">L2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L2</span> <span class="kwd">as</span> (<span class="id">pc4</span>'&amp;<span class="id">star2</span>'&amp;<span class="id">memeq3</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span> = <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#glob_npnsw_step_type">glob_npnsw_step_type</a></span> <span class="kwd">in</span> <span class="id">step1</span>' <span class="kwd">as</span> <span class="id">L3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L3</span> <span class="kwd">as</span> (<span class="id">x</span>&amp;<span class="id">step1</span>''&amp;<span class="id">type</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">type</span>' <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">step1</span>'';<span class="tactic">subst</span>;<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_I_conflict">corestep_I_conflict</a></span> <span class="kwd">in</span> <span class="id">step1</span>'' <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">wdge</span>' <span class="id">O1</span> <span class="id">star1</span>' <span class="id">H9</span> <span class="id">H_safe</span> <span class="id">H</span> <span class="id">H1</span> <span class="id">step1</span>';<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">star1</span>' <span class="kwd">as</span> <span class="id">inv1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_cur_valid_id">npnsw_step_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">step1</span>' <span class="kwd">as</span> <span class="id">v1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_O_preservation">npnsw_taustar_O_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span>' <span class="kwd">as</span> <span class="id">O2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc1</span>' <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> ({-|<span class="id">pc1</span>',<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc1</span>',<span class="id">v1</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">star1</span>';<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#halfatomblockabort_sw">halfatomblockabort_sw</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> ? ;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>)). <span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H_safe</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>) <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> ;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_cur_valid_id">npnsw_step_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> <span class="id">v2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span> <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>,<span class="id">v2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H_safe</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>) <span class="id">v2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span>' <span class="kwd">as</span> ?. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>' = <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">star1</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H14</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp1</span> <span class="id">x0</span>),<span class="id"><a href="GlobDefs.html#I">I</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">star1</span>';<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">step1</span>'';<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_step_race_glob_predict_star_alter_cons">npnsw_step_race_glob_predict_star_alter_cons</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">H_safe</span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt; ~ <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>})),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8843')">Proof.</div>
<div class="proofscript" id="proof8843">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">clear</span> <span class="id">H1</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' = <span class="id">t1</span> \/ <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_cons_tideq">npnsw_step_glob_predict_star_alter_cons_tideq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_O_cons_tidneq">npnsw_step_glob_predict_star_alter_O_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp</span>) <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">fp</span>'&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp1</span>) <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">H7</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_I_cons_tidneq">npnsw_step_glob_predict_star_alter_I_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp</span>) <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">fp</span>'&amp;<span class="id">b</span>'&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp1</span>) <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span> <span class="kwd">in</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' = <span class="id">t2</span> \/ <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_cons_tideq">npnsw_step_glob_predict_star_alter_cons_tideq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_O_cons_tidneq">npnsw_step_glob_predict_star_alter_O_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp</span>) <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span> <span class="kwd">in</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> (<span class="id">fp</span>'&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp2</span>) <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span> <span class="kwd">in</span> <span class="id">L1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">H8</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span> <span class="kwd">in</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_I_cons_tidneq">npnsw_step_glob_predict_star_alter_I_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp</span>) <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> (<span class="id">fp</span>'&amp;<span class="id">b</span>'&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span> <span class="kwd">with</span>(<span class="id">fp3</span>:=<span class="id">fp2</span>) <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">Eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_O_cons_tidneq">npnsw_step_glob_predict_star_alter_O_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_O_cons_tidneq">npnsw_step_glob_predict_star_alter_O_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id">t1</span>)(<span class="id">t2</span>:=<span class="id">t2</span>);<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span> <span class="kwd">as</span> (<span class="id">fp0</span>&amp;<span class="id">p1</span>&amp;<span class="id">conflict1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>')(<span class="id">t2</span>:=<span class="id">t2</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>}) = <span class="id">pc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">H10</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq0</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_I_cons_tidneq">npnsw_step_glob_predict_star_alter_I_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id">t1</span>)(<span class="id">t2</span>:=<span class="id">t2</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> (<span class="id">fp0</span>&amp;<span class="id">b0</span>&amp;<span class="id">p0</span>&amp;<span class="id">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>')(<span class="id">t2</span>:=<span class="id">t2</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id">Eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>}) = <span class="id">pc</span>). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">try</span> <span class="id">contradiction</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq0</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span> <span class="kwd">as</span> (<span class="id">fp0</span>&amp;<span class="id">p0</span>&amp;<span class="id">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>')(<span class="id">t2</span>:=<span class="id">t1</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Eq0</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>}) = <span class="id">pc</span>). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">p0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">intro</span> <span class="id">L</span>;<span class="tactic">inversion</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">H9</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">Eq1</span>:({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>}) = <span class="id">pc</span>). <span class="tactic">destruct</span> <span class="id">pc</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>,<span class="id">b2</span>;<span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_I_cons_tidneq">npnsw_step_glob_predict_star_alter_I_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_glob_predict_star_alter_O_cons_tidneq">npnsw_step_glob_predict_star_alter_O_cons_tidneq</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">L2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">L2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id">t1</span>)(<span class="id">t2</span>:=<span class="id">t2</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span> <span class="kwd">as</span> (?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>')(<span class="id">t2</span>:=<span class="id">t2</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Eq0</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H9</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 1 <span class="kwd">with</span>(<span class="id">t1</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>')(<span class="id">t2</span>:=<span class="id">t1</span>);<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Eq0</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">constructor</span>;<span class="tactic">rewrite</span> <span class="id">Eq1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="tactic">inversion</span> <span class="id">H9</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Eq0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_step_race_glob_predict_star_alter_cons_2">npnsw_step_race_glob_predict_star_alter_cons_2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> /\ <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>})) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8844')">Proof.</div>
<div class="proofscript" id="proof8844">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>((<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt; ~ <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id">pc</span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>})) \/ ~(<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt; ~ <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id">pc</span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_race_glob_predict_star_alter_cons">npnsw_step_race_glob_predict_star_alter_cons</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_not_ex">not_all_not_ex</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">t</span>). <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H3</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="swstep_glob_predict_star_alter_preserve">swstep_glob_predict_star_alter_preserve</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#glob_sw">glob_sw</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">b</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#b">b</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#b">b</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8845')">Proof.</div>
<div class="proofscript" id="proof8845">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span>' = ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>'})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Coqlib.inv</span> <span class="id">H0</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="swstep_race_glob_predict_star_alter_cons">swstep_race_glob_predict_star_alter_cons</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>  <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#glob_sw">glob_sw</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8846')">Proof.</div>
<div class="proofscript" id="proof8846">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 2;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#swstep_glob_predict_star_alter_preserve">swstep_glob_predict_star_alter_preserve</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#swstep_glob_predict_star_alter_preserve">swstep_glob_predict_star_alter_preserve</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mem_eq_abort">mem_eq_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">pc</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ix</span>,<span class="id"><a href="InteractionSemantics.html#mod_wd">mod_wd</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="ConflictReorder.html#ge">ge</a></span> <span class="id"><a href="ConflictReorder.html#ix">ix</a></span>))-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#ge">ge</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8847')">Proof.</div>
<div class="proofscript" id="proof8847">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span>;<span class="tactic">destruct</span> 3;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> (?&amp;?&amp;?&amp;?). <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_exists">type_glob_step_exists</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_globstep">mem_eq_globstep</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bitC">bitC</a></span>:<span class="id"><a href="GlobDefs.html#Bit">Bit</a></span>-&gt;@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">b</span> <span class="id">pc</span>=&gt; <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>) <span class="id"><a href="ConflictReorder.html#b">b</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="onesteprace">onesteprace</a></span> (<span class="id">pc</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>)(<span class="id">t</span>':<span class="id"><a href="GlobDefs.html#tid">tid</a></span>)(<span class="id">fp</span>:<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>):<span class="kwd">Prop</span>:=<br/>
&nbsp;&nbsp;|<span class="id"><a name="mkrace">mkrace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>' <span class="id">pc</span>'' <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>'}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span> &lt;&gt; <span class="id">t</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id">pc</span> <span class="id">t</span>' <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="onesteprace_race_glob_predict">onesteprace_race_glob_predict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">t</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>-&gt; <span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict">glob_predict</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8848')">Proof.</div>
<div class="proofscript" id="proof8848">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestep_abort_lemma">corestep_abort_lemma</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) \/ (<span class="id">exists</span> <span class="id">fp2</span> <span class="id">pc2</span>, <span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8849')">Proof.</div>
<div class="proofscript" id="proof8849">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>. <span class="tactic">intro</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_or_and">not_or_and</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_and_or">not_and_or</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H2</span>. <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>. <span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solv_thread</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">solv_thread</span>. <span class="id">solv_thread</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H4</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_exists">type_glob_step_exists</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span> \/ ~<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?. <span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>;<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">gl</span> = <span class="id"><a href="ETrace.html#tau">tau</a></span>). <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H5</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#predict_step_ex">predict_step_ex</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_abort">npnswstep_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">x</span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hx</span>:<span class="id"><a href="ConflictReorder.html#x">x</a></span> = <span class="id"><a href="TypedSemantics.html#core">core</a></span> \/ <span class="id"><a href="ConflictReorder.html#x">x</a></span> = <span class="id"><a href="TypedSemantics.html#call">call</a></span> \/ <span class="id"><a href="ConflictReorder.html#x">x</a></span> = <span class="id"><a href="TypedSemantics.html#ret">ret</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hinv</span>:<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8850')">Proof.</div>
<div class="proofscript" id="proof8850">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H5</span>;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="id">solv_thread</span>;<span class="id">solv_thread</span>;<span class="id">solv_thread</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_exists">type_glob_step_exists</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>;<span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x0</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H5</span>;<span class="tactic">subst</span>;<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">gl</span> = <span class="id"><a href="ETrace.html#tau">tau</a></span>). <span class="tactic">inversion</span> <span class="id">H5</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H7</span>;<span class="tactic">eauto</span>. <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#predict_step_ex">predict_step_ex</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_abort_alt">npnswstep_abort_alt</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) \/ <span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8851')">Proof.</div>
<div class="proofscript" id="proof8851">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id">pc</span> <span class="id">t</span> <span class="id">fp</span>\/ ~ <span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id">pc</span> <span class="id">t</span> <span class="id">fp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>. <span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_abort">npnswstep_abort</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_step_cons_star_abort">npnsw_step_cons_star_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">k</span> <span class="id">pc1</span> <span class="id">fp1</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="ConflictReorder.html#j">j</a></span> /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id">fp</span>') \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">k</span> <span class="id">pc1</span> <span class="id">fp1</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8852')">Proof.</div>
<div class="proofscript" id="proof8852">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">j</span> <span class="kwd">using</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_induction">well_founded_induction</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf">lt_wf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
j=0*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_abort_alt">npnswstep_abort_alt</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">exists</span> 0;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">FP.subset_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>. <span class="id">exists</span> 1;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">with</span>(<span class="id">fp</span>:=<span class="id">fp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
j+1*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span> \/ ~<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_conflict">npnswstep_conflict</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">exists</span> 0;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">Omega.omega</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">FP.subset_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">Hsimpl</span>. <span class="id">right</span>. <span class="id">exists</span> 1;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">with</span>(<span class="id">fp</span>:=<span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_reorder">npnswstep_reorder</a></span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_starN">mem_eq_npnsw_step_starN</a></span> <span class="kwd">in</span> <span class="id">H11</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_sym">mem_eq_pc_sym</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_abort">mem_eq_abort</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>;<span class="tactic">destruct</span> <span class="id">H13</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H17</span>. <span class="tactic">rewrite</span> <span class="id">H17</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_N_S">tau_N_S</a></span> <span class="kwd">in</span> <span class="id">H13</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H18</span>;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">with</span>(<span class="id">fp1</span>:=<span class="id">fp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union2_subset">FP.union2_subset</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H16</span>. <span class="tactic">rewrite</span> <span class="id">H16</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_N_S">tau_N_S</a></span> <span class="kwd">in</span> <span class="id">H13</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H17</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_pc_valid_tid_preservation">npnsw_step_pc_valid_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="empsmile">empsmile</a></span>:<span class="kwd">forall</span> <span class="id">fp</span>, <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8853')">Proof.</div>
<div class="proofscript" id="proof8853">
 <span class="tactic">intro</span>;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>;<span class="tactic">intro</span>;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tau_N_conflict_split">tau_N_conflict_split</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">State</span>:<span class="kwd">Type</span>) (<span class="id">Step</span>:<span class="id"><a href="ConflictReorder.html#State">State</a></span>-&gt;<span class="id"><a href="ETrace.html#glabel">glabel</a></span>-&gt;<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>-&gt;<span class="id"><a href="ConflictReorder.html#State">State</a></span>-&gt;<span class="kwd">Prop</span>) <span class="id">i</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">fp0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="ConflictReorder.html#Step">Step</a></span> <span class="id"><a href="ConflictReorder.html#i">i</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span> <span class="id">fp1</span> <span class="id">fp2</span> <span class="id">pc1</span> <span class="id">pc2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="ConflictReorder.html#Step">Step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>/\ <span class="id"><a href="ConflictReorder.html#j">j</a></span>&lt;<span class="id"><a href="ConflictReorder.html#i">i</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#Step">Step</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> /\<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp0">fp0</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span>) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8854')">Proof.</div>
<div class="proofscript" id="proof8854">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">i</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp0</span> \/ ~ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp1</span> <span class="id">fp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>. <span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpconflict_dif_trans">fpconflict_dif_trans</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id">IHi</span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">x</span>). <span class="id">Esimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union">fpsmile_union</a></span>;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>&lt;- <span class="id"><a href="Footprint.html#FP.fp_union_assoc">FP.fp_union_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 0;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#empsmile">empsmile</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">FP.subset_emp</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_tauN_reorder">npnswstep_tauN_reorder</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">pc1</span> <span class="id">pc2</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>'' ({-|<span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>})).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8855')">Proof.</div>
<div class="proofscript" id="proof8855">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">j</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_refl">mem_eq_pc_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union_elim">fpsmile_union_elim</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union_elim2">fpsmile_union_elim2</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_reorder">npnswstep_reorder</a></span> <span class="kwd">in</span>  <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_starN">mem_eq_npnsw_step_starN</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHj</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H9</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">s</span>' = <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H14</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_N_S">tau_N_S</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_trans">mem_eq_pc_trans</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">s</span>' =<span class="id">t</span> ). <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_tauN_conflict">npnswstep_tauN_conflict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">k</span> <span class="id">pc1</span> <span class="id">fp1</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt; <span class="id"><a href="ConflictReorder.html#j">j</a></span> /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id">fp</span>') \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">k</span> <span class="id">pc1</span> <span class="id">fp1</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>/\ <span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="ConflictReorder.html#j">j</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8856')">Proof.</div>
<div class="proofscript" id="proof8856">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">j</span> <span class="kwd">as</span> [<span class="id">j</span> <span class="id">IHj</span>] <span class="kwd">using</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_induction">well_founded_induction</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf">lt_wf</a></span>);<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>. <span class="id">contradict</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span>;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#empsmile">empsmile</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span> \/ ~ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>. <span class="tactic">destruct</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_conflict">npnswstep_conflict</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">exists</span> 0;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">Omega.omega</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">FP.subset_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">right</span>. <span class="id">exists</span> 1;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">with</span>(<span class="id">fp</span>:=<span class="id">x</span>); <span class="id">econstructor</span> 2;[<span class="tactic">eauto</span>|<span class="id">constructor</span>]. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpconflict_dif_trans">fpconflict_dif_trans</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_reorder">npnswstep_reorder</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_starN">mem_eq_npnsw_step_starN</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R1</span>:<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">s</span>' =<span class="id">t</span>). <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R2</span>:<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x</span> = <span class="id">t</span>). <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHj</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H9</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">destruct</span> <span class="id">H10</span>;<span class="id">Hsimpl</span>;<span class="tactic">rewrite</span> <span class="id">R1</span>, &lt;- <span class="id">R2</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_N_S">tau_N_S</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>;[<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>|];<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_N_S">tau_N_S</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>; <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnsw_star_cons_star_abort">npnsw_star_cons_star_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#i">i</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">k</span> <span class="id">pc1</span> <span class="id">fp1</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="ConflictReorder.html#j">j</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">k</span> <span class="id">pc1</span> <span class="id">fp1</span>, <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8857')">Proof.</div>
<div class="proofscript" id="proof8857">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">i</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHi</span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_step_cons_star_abort">npnsw_step_cons_star_abort</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">left</span>. <span class="id">Hsimpl</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>. <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp0</span> <span class="id">x1</span> \/ ~ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp0</span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_tauN_reorder">npnswstep_tauN_reorder</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_tauN_conflict">npnswstep_tauN_conflict</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H11</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_pc_valid_tid_preservation">npnsw_step_pc_valid_tid_preservation</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="corestep_bitC_again">corestep_bitC_again</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">b</span> <span class="id">b</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> (<span class="id"><a href="ConflictReorder.html#bitC">bitC</a></span> <span class="id"><a href="ConflictReorder.html#b">b</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> (<span class="id"><a href="ConflictReorder.html#bitC">bitC</a></span> <span class="id"><a href="ConflictReorder.html#b">b</a></span> <span class="id">pc</span>')-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> (<span class="id"><a href="ConflictReorder.html#bitC">bitC</a></span> <span class="id">b</span>' <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> (<span class="id"><a href="ConflictReorder.html#bitC">bitC</a></span> <span class="id">b</span>' <span class="id">pc</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8858')">Proof.</div>
<div class="proofscript" id="proof8858">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>,<span class="id">pc</span>'. <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#bitC">bitC</a></span>,<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_cons_onesteprace">npnswstep_cons_onesteprace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#onesteprace">onesteprace</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#t">t</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8859')">Proof.</div>
<div class="proofscript" id="proof8859">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">clear</span> <span class="id">H1</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp</span>' \/ ~<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp</span> <span class="id">fp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>. <span class="tactic">destruct</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#globstep_reorder_rule">globstep_reorder_rule</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> ?;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H0</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> (<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>;<span class="tactic">fail</span>);<span class="tactic">try</span> (<span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>;<span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H13</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>. <span class="id">econstructor</span> 2;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span> 2. <span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H13</span> <span class="kwd">as</span> ?;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">econstructor</span> 2. <span class="id">left</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>. <span class="tactic">inversion</span> <span class="id">H10</span>;<span class="tactic">subst</span>. <span class="tactic">simpl</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>.  <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [|[]];<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_conflict">corestep_conflict</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="PRaceLemmas.html#predict_star_race_to_alter">predict_star_race_to_alter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="PRaceLemmas.html#predict_race_to_star">predict_race_to_star</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H0</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;[|<span class="id">econstructor</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H0</span>|<span class="id">econstructor</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H4</span>| |];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstar_npnswstep_reorder">npnswstar_npnswstep_reorder</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>'  <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'' <span class="id">x</span> (<span class="id">Hx</span>:<span class="id"><a href="ConflictReorder.html#x">x</a></span> = <span class="id"><a href="TypedSemantics.html#core">core</a></span> \/ <span class="id"><a href="ConflictReorder.html#x">x</a></span> = <span class="id"><a href="TypedSemantics.html#call">call</a></span> \/ <span class="id"><a href="ConflictReorder.html#x">x</a></span> = <span class="id"><a href="TypedSemantics.html#ret">ret</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' ({-|<span class="id">pc</span>'',<span class="id"><a href="ConflictReorder.html#t">t</a></span>})-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>', <span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="ConflictReorder.html#x">x</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' <span class="id">pc1</span>'/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc2</span>', <span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id">pc1</span>',<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>}) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc2</span>'/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id">pc</span>'',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) ({-|<span class="id">pc2</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8860')">Proof.</div>
<div class="proofscript" id="proof8860">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 2;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_refl">mem_eq_pc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_O_preservation">npnsw_step_O_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union_elim">fpsmile_union_elim</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union_elim2">fpsmile_union_elim2</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">s</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#globstep_reorder_rule">globstep_reorder_rule</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_change">mem_eq_pc_change</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">s</span>') <span class="kwd">in</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_star">mem_eq_npnsw_step_star</a></span> <span class="kwd">in</span> <span class="id">H17</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span> <span class="kwd">in</span> <span class="id">H16</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H16</span> <span class="kwd">as</span> ?. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H19</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H9</span>,<span class="id">H19</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_cons">tau_star_cons</a></span> <span class="kwd">in</span> <span class="id">H17</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_trans">mem_eq_pc_trans</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_change">mem_eq_pc_change</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [|[]];<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H12</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstar_corestep_reorder">npnswstar_corestep_reorder</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>'  <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' ({-|<span class="id">pc</span>'',<span class="id"><a href="ConflictReorder.html#t">t</a></span>})-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>', <span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' <span class="id">pc1</span>'/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc2</span>', <span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id">pc1</span>',<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>}) <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc2</span>'/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> ({-|<span class="id">pc</span>'',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) ({-|<span class="id">pc2</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8861')">Proof.</div>
<div class="proofscript" id="proof8861">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstar_npnswstep_reorder">npnswstar_npnswstep_reorder</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstar_corestep_conflict">npnswstar_corestep_conflict</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.wd">GlobEnv.wd</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span>' ({-|<span class="id">pc</span>'',<span class="id"><a href="ConflictReorder.html#t">t</a></span>})-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">fp</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#abort">abort</a></span>({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp1</span> <span class="id">pc1</span>,<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8862')">Proof.</div>
<div class="proofscript" id="proof8862">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">pc</span>''. <span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_star_tau_N_equiv">tau_star_tau_N_equiv</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'' <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H</span>. <span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span>'0 <span class="id">fp</span>' \/ ~ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span>'0 <span class="id">fp</span>'). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>. <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">s</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHx</span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_abort_alt">npnswstep_abort_alt</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H7</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#globstep_reorder_rule_alter">globstep_reorder_rule_alter</a></span> <span class="kwd">in</span> <span class="id">H11</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H7</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H11</span> <span class="kwd">as</span> [|[]];<span class="tactic">auto</span>;<span class="id">Hsimpl</span>;<span class="id">right</span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">assumption</span>). <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="kwd">in</span> <span class="id">H5</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpconflict_dif_trans">fpconflict_dif_trans</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H7</span> <span class="kwd">as</span> [|[]];<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">subst</span>;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstar_corestep_reorder">npnswstar_corestep_reorder</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_conflict">corestep_conflict</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>;<span class="tactic">auto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span>;<span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_sw_halfatomblockabort">npnswstep_sw_halfatomblockabort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>})-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp1</span> <span class="id">pc1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8863')">Proof.</div>
<div class="proofscript" id="proof8863">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>,<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">x</span> \/ ~ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [|[]];<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_I_conflict">corestep_I_conflict</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span>;<span class="tactic">auto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_half_I_smile">npnswstep_half_I_smile</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(( <span class="id">exists</span> <span class="id">fp1</span> <span class="id">pc1</span>, <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>) \/ ~ ( <span class="id">exists</span> <span class="id">fp1</span> <span class="id">pc1</span>,<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> ({-|<span class="id">pc</span>,<span class="id">t</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>. <span class="tactic">destruct</span> <span class="id">H11</span>;<span class="tactic">auto</span>. <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x4</span> <span class="id">t</span> <span class="id"><a href="GlobDefs.html#I">I</a></span>) <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_tid_bit_preserve">corestar_tid_bit_preserve</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span>,<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>;<span class="tactic">simpl</span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">T1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_abort">mem_eq_abort</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_tid_bit_preserve">corestar_tid_bit_preserve</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span> = <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H12</span> <span class="id">H8</span> <span class="id">H1</span> <span class="id">H9</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H9</span> <span class="kwd">in</span> *;<span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span> <span class="kwd">as</span> [|[]];  <span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="id">econstructor</span> ;<span class="id">solv_thread</span>;<span class="id">solv_thread</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_exists">type_glob_step_exists</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#corestar_tid_bit_preserve">corestar_tid_bit_preserve</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x5</span>;<span class="tactic">subst</span>;<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H15</span>;<span class="tactic">subst</span>;<span class="tactic">inversion</span> <span class="id">H17</span>;<span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">fp0</span>=<span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>). <span class="tactic">inversion</span> <span class="id">H15</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">gl</span>=<span class="id"><a href="ETrace.html#tau">tau</a></span>). <span class="tactic">inversion</span> <span class="id">H15</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H8</span> ;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">x3</span>) <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#predict_step_ex_alt">predict_step_ex_alt</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x2</span> = <span class="id">t</span>). <span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H16</span>,<span class="id">H19</span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H6</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#corestar_globstar">corestar_globstar</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobSemantics_Lemmas.html#GE_mod_wd_star_tp_inv">GE_mod_wd_star_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x2</span> = <span class="id">t</span>). <span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H16</span>,<span class="id">H19</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">NNPP</a></span>;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp0</span> <span class="id">fp</span> \/ ~ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id">fp0</span> <span class="id">fp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H19</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#smile_conflict">smile_conflict</a></span> <span class="kwd">in</span> <span class="id">H19</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;-<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [|[]];<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H19</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">gl</span>=<span class="id"><a href="ETrace.html#tau">tau</a></span>). <span class="tactic">inversion</span> <span class="id">H15</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H19</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus_1">tau_plus_1</a></span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">x</span> <span class="id">fp0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unfocus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span> = <span class="id">t</span> /\ <span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">x3</span> = <span class="id"><a href="GlobDefs.html#I">I</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>;<span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id">t</span>). <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">v1</span>:<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id">x3</span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)). <span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H6</span>;<span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#corestar_globstar">corestar_globstar</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobSemantics_Lemmas.html#GE_mod_wd_star_tp_inv">GE_mod_wd_star_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">wdge</span> <span class="id">wdge</span>' <span class="id">H8</span> <span class="id">H19</span> <span class="id">H15</span> <span class="id">H13</span> <span class="id">H18</span> <span class="id">H20</span> <span class="id">H21</span> <span class="id">v1</span>. <span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H20</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">gl</span> = <span class="id"><a href="ETrace.html#tau">tau</a></span>). <span class="tactic">inversion</span> <span class="id">H15</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">pc</span>'', <span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x4</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span>) <span class="id"><a href="GlobDefs.html#I">I</a></span>) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp0</span> <span class="id">pc</span>'' ).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> ({-|<span class="id">x3</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>'}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x4</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>') <span class="id"><a href="GlobDefs.html#I">I</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x3</span>;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>. <span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">x3</span>) <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#predict_step_ex">predict_step_ex</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="TypedSemantics.html#type_glob_step">type_glob_step</a></span> <span class="id"><a href="TypedSemantics.html#core">core</a></span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x3</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span>) <span class="id"><a href="GlobDefs.html#O">O</a></span>) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">fp0</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>'0 (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span>) <span class="id"><a href="GlobDefs.html#O">O</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H15</span>;<span class="tactic">subst</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x3</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x3</span>) <span class="id"><a href="GlobDefs.html#O">O</a></span>) <span class="kwd">as</span> <span class="id">pc0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>((<span class="id"><a href="SmileReorder.html#changepc">changepc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x3</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>') <span class="id"><a href="GlobDefs.html#O">O</a></span>) = ({-|<span class="id">pc0</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>'})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpc0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc0</span>) <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#predict_step_ex">predict_step_ex</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpc0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpc0</span>. <span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqpc0</span>. <span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#changepc">changepc</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TypedSemantics.html#type_glob_step_elim">type_glob_step_elim</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="halfatomblock_abort_atom">halfatomblock_abort_atom</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8864')">Proof.</div>
<div class="proofscript" id="proof8864">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>,<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="race_predict_sw">race_predict_sw</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> (@<span class="id"><a href="PRaceLemmas.html#glob_predict">glob_predict</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict">glob_predict</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8865')">Proof.</div>
<div class="proofscript" id="proof8865">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;[<span class="id">econstructor</span>|<span class="id">econstructor</span> 2];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>;[<span class="id">econstructor</span>|<span class="id">econstructor</span> 2];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mem_eq_halfatomblock_abort">mem_eq_halfatomblock_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">pc</span>' <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8866')">Proof.</div>
<div class="proofscript" id="proof8866">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>,<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_globstep">mem_eq_globstep</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_abort">mem_eq_abort</a></span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_sym">mem_eq_pc_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_sw_star_halfatomblockabort">npnswstep_sw_star_halfatomblockabort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id">pc</span>'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span> <span class="id">fp1</span> <span class="id">pc1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="Footprint.html#FP.smile">FP.smile</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="ConflictReorder.html#j">j</a></span> /\ (<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> \/ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">exists</span> <span class="id">fp2</span> <span class="id">pc2</span>, <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> /\ (( <span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt; <span class="id"><a href="ConflictReorder.html#j">j</a></span> /\<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span>)\/ (<span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> /\<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> ))))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8867')">Proof.</div>
<div class="proofscript" id="proof8867">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">j</span> <span class="kwd">using</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_induction">well_founded_induction</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf">lt_wf</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_sw_halfatomblockabort">npnswstep_sw_halfatomblockabort</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#empsmile">empsmile</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 0;<span class="id">Esimpl</span>;<span class="tactic">auto</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#empsmile">empsmile</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Hsimpl</span>.  <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">o1</span>:<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstar_bit">npnswstar_bit</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort_atom">halfatomblock_abort_atom</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span> ;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span> \/ ~<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp</span> <span class="id">fp0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_conflict">npnswstep_conflict</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>. <span class="id">exists</span> 0;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#empsmile">empsmile</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>;[<span class="id">Omega.omega</span>|<span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#empsmile">empsmile</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>)<span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_reorder">npnswstep_reorder</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_starN">mem_eq_npnsw_step_starN</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_halfatomblock_abort">mem_eq_halfatomblock_abort</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> <span class="id">v1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>;<span class="tactic">simpl</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H11</span>,<span class="id">H15</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_N_S">tau_N_S</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H14</span>;<span class="id">Hsimpl</span>;<span class="tactic">try</span>( <span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_union">fpsmile_union</a></span>;<span class="tactic">eapply</span> <span class="id"><a href="FPLemmas.html#fpsmile_sym">fpsmile_sym</a></span>;<span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H14</span>;<span class="id">Hsimpl</span>;[<span class="id">left</span>|<span class="id">right</span>];<span class="tactic">try</span> <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H16</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">left</span>;<span class="tactic">split</span>;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">right</span>;<span class="tactic">split</span>;<span class="tactic">eauto</span>. <span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mem_eq_halfatomstep">mem_eq_halfatomstep</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>' <span class="id">fp</span> <span class="id">pc1</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pc1</span>', <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id">pc</span>' <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc1</span>' /\ <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id">pc1</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8868')">Proof.</div>
<div class="proofscript" id="proof8868">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>;<span class="tactic">intros</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_globstep">mem_eq_globstep</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_corestar">mem_eq_corestar</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstar_sw_star_halfatomblockabort">npnswstar_sw_star_halfatomblockabort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">j</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HO</span>:<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> (@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span>) <span class="id"><a href="ConflictReorder.html#i">i</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.inv">ThreadPool.inv</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.(<span class="id"><a href="GlobDefs.html#thread_pool">thread_pool</a></span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t">t</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id">pc</span>',<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id">pc</span>'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id">pc</span>''  \/ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span> <span class="id">fp1</span> <span class="id">pc1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#k">k</a></span>&lt;= <span class="id"><a href="ConflictReorder.html#j">j</a></span> /\<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#k">k</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>  /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> \/ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">exists</span> <span class="id">fp2</span> <span class="id">pc2</span>, <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> /\ (<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> \/<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#pc2">pc2</a></span> )))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8869')">Proof.</div>
<div class="proofscript" id="proof8869">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">i</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHi</span> <span class="kwd">in</span> <span class="id">H6</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp0</span> <span class="id">x0</span> \/ ~ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp0</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">with</span>(<span class="id">pc</span>:=<span class="id">pc</span>) <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_tauN_conflict">npnswstep_tauN_conflict</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#tau_N_conflict_split">tau_N_conflict_split</a></span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H12</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Omega.omega</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_tauN_reorder">npnswstep_tauN_reorder</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> ({-|<span class="id">x3</span>,<span class="id">t</span>}) \/ <span class="id"><a href="GlobSemantics.html#abort">abort</a></span> ({-|<span class="id">x3</span>,<span class="id">t</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>;[<span class="id">left</span>;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_halfatomblock_abort">mem_eq_halfatomblock_abort</a></span>|<span class="id">right</span>;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_abort">mem_eq_abort</a></span>];<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_sym">mem_eq_pc_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_sw_halfatomblockabort">npnswstep_sw_halfatomblockabort</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="tactic">rewrite</span> <span class="id">H15</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">rewrite</span> <span class="id">H15</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H10</span>;<span class="tactic">eauto</span>. <span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_abort_alt">npnswstep_abort_alt</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">rewrite</span> <span class="id">H15</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>. <span class="tactic">destruct</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H14</span>;<span class="tactic">clear</span> <span class="id">H14</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span> <span class="kwd">in</span> <span class="id">H17</span>;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstar_bit">npnswstar_bit</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">pc</span>',<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id">x5</span> <span class="id">pc</span>' /\ (<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> ({-|<span class="id">x3</span>,<span class="id">t</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">x4</span> <span class="id">pc</span>' \/ <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> ({-|<span class="id">x3</span>,<span class="id">t</span>}) <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id">x4</span> <span class="id">pc</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l1">npnswstep_l1</a></span> <span class="kwd">in</span> <span class="id">H13</span>. <span class="id">Hsimpl</span>. <span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_globstep">mem_eq_globstep</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">left</span>;<span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l3">npnswstep_l3</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_halfatomstep">mem_eq_halfatomstep</a></span> <span class="kwd">in</span> <span class="id">H12</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp0</span> <span class="id">x4</span> \/ ~ <span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id">fp0</span> <span class="id">x4</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H15</span>,<span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_conflict">npnswstep_conflict</a></span> <span class="kwd">in</span> <span class="id">H15</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x2</span> = <span class="id">t</span>). <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H18</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H17</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H17</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstep_reorder">npnswstep_reorder</a></span> <span class="kwd">in</span> <span class="id">H15</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x2</span> = <span class="id">t</span>). <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H20</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H17</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">clear</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H11</span> <span class="kwd">as</span> [|[]];<span class="tactic">try</span>(<span class="tactic">inversion</span> <span class="id">H11</span>;<span class="tactic">subst</span>;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.emp_never_conflict">FP.emp_never_conflict</a></span> <span class="kwd">in</span> <span class="id">H16</span> <span class="kwd">as</span> [];<span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#corestep_I_conflict">corestep_I_conflict</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H15</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H11</span>;<span class="tactic">subst</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span> <span class="kwd">in</span> <span class="id">H16</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="kwd">in</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_half_I_smile">npnswstep_half_I_smile</a></span> <span class="kwd">in</span> <span class="id">H11</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span>*.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">x2</span> = <span class="id">t</span>). <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H24</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span> <span class="kwd">in</span> <span class="id">H19</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union">conflict_union</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_O_preservation">npnsw_step_O_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Arguments</span> <span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> [<span class="id">GE</span>].<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">race</span>' {<span class="id">ge</span>} : (@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id">ge</span>-&gt;<span class="id"><a href="GlobDefs.html#tid">tid</a></span>-&gt;<span class="id"><a href="GlobDefs.html#Bit">Bit</a></span>-&gt;<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>-&gt;<span class="kwd">Prop</span>)-&gt;@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id">ge</span>-&gt;<span class="id"><a href="GlobDefs.html#tid">tid</a></span>-&gt;<span class="id"><a href="GlobDefs.html#tid">tid</a></span>-&gt;<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>-&gt;<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt;<span class="id"><a href="GlobDefs.html#Bit">Bit</a></span>-&gt;<span class="id"><a href="GlobDefs.html#Bit">Bit</a></span>-&gt;<span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Race">Race</a></span>: <span class="kwd">forall</span> (<span class="id">predict</span>:@<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id">ge</span>-&gt;<span class="id"><a href="GlobDefs.html#tid">tid</a></span>-&gt;<span class="id"><a href="GlobDefs.html#Bit">Bit</a></span>-&gt;<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>-&gt;<span class="kwd">Prop</span>) <span class="id">pc</span> <span class="id">t1</span> <span class="id">b1</span> <span class="id">fp1</span> <span class="id">t2</span> <span class="id">b2</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#t1">t1</a></span> &lt;&gt; <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predict">predict</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t1">t1</a></span> <span class="id"><a href="ConflictReorder.html#b1">b1</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predict">predict</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> <span class="id"><a href="ConflictReorder.html#b2">b2</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="GlobDefs.html#I">I</a></span> \/ <span class="id"><a href="ConflictReorder.html#b2">b2</a></span> &lt;&gt; <span class="id"><a href="GlobDefs.html#I">I</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.conflict">FP.conflict</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">race</span>' <span class="id"><a href="ConflictReorder.html#predict">predict</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t1">t1</a></span> <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#b1">b1</a></span> <span class="id"><a href="ConflictReorder.html#b2">b2</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">race</span>'<span class="id">_sound</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">predict</span> <span class="id">pc</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">fp1</span> <span class="id">fp2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">race</span>' <span class="id"><a href="ConflictReorder.html#predict">predict</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t1">t1</a></span> <span class="id"><a href="ConflictReorder.html#t2">t2</a></span> <span class="id"><a href="ConflictReorder.html#fp1">fp1</a></span> <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id"><a href="ConflictReorder.html#b1">b1</a></span> <span class="id"><a href="ConflictReorder.html#b2">b2</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#predict">predict</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8870')">Proof.</div>
<div class="proofscript" id="proof8870">
 <span class="tactic">inversion</span> 1;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="predicted_abort1_sw">predicted_abort1_sw</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#cur_valid_id">cur_valid_id</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8871')">Proof.</div>
<div class="proofscript" id="proof8871">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#type_glob_step_cur_valid_id">type_glob_step_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">auto</span>;[|<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_taustar_pc_valid_tid_backwards_preservation">npnsw_taustar_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_predicted_abort">npnswstep_predicted_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hinv</span>:<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span>  <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8872')">Proof.</div>
<div class="proofscript" id="proof8872">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_cons">tau_star_cons</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_cons">tau_star_cons</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=({-|<span class="id">pc</span>,<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>})).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_cur_valid_id">npnsw_step_cur_valid_id</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>,<span class="id">H0</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="predicted_abort1_predicted_abort">predicted_abort1_predicted_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span>  <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>' /\ <span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8873')">Proof.</div>
<div class="proofscript" id="proof8873">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 2;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblock_abort">halfatomblock_abort</a></span>,<span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">inversion</span> <span class="id">H4</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#type_glob_step_cur_valid_id">type_glob_step_cur_valid_id</a></span> ;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_thdpinv">npnsw_taustar_thdpinv</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#npnsw_star_abort">npnsw_star_abort</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>. <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_O_preservation">npnsw_taustar_O_preservation</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>)). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_pc_valid_tid_preservation">npnsw_taustar_pc_valid_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">predicted_abort_predicted_abort1</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span>  <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_star">tau_star</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id">pc</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8874')">Proof.</div>
<div class="proofscript" id="proof8874">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 2;<span class="tactic">intros</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#predicted_abort_predicted_abort1">predicted_abort_predicted_abort1</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_predicted_abort">npnswstep_predicted_abort</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstar_bit">npnswstar_bit</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mem_eq_predicted_abort">mem_eq_predicted_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8875')">Proof.</div>
<div class="proofscript" id="proof8875">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span>. <span class="tactic">intros</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="kwd">in</span> <span class="id">R</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>. <span class="tactic">split</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>;[<span class="id">left</span>;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_abort">mem_eq_abort</a></span>|<span class="id">right</span>;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_halfatomblock_abort">mem_eq_halfatomblock_abort</a></span>];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_sym">mem_eq_pc_sym</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mem_eq_predicted_abort1">mem_eq_predicted_abort1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#mem_eq_pc">mem_eq_pc</a></span> <span class="id"><a href="ConflictReorder.html#CReorder.GE">GE</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8876')">Proof.</div>
<div class="proofscript" id="proof8876">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 2;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_star">mem_eq_npnsw_step_star</a></span> <span class="kwd">in</span> <span class="id">H</span> ;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_halfatomblock_abort">mem_eq_halfatomblock_abort</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>;<span class="id">Hsimpl</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#mem_eq_npnsw_step_star">mem_eq_npnsw_step_star</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">eauto</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#mem_eq_pc_sym">mem_eq_pc_sym</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#mem_eq_abort">mem_eq_abort</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=<span class="id">pc</span>'). <span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span> = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id">pc</span>' (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span>,<span class="id">R</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">destruct</span> <span class="id">R</span>;<span class="id">Hsimpl</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pc</span>',<span class="id">H7</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_sw_predicted_abort">npnswstep_sw_predicted_abort</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">pc</span> <span class="id">fp</span> <span class="id">fp2</span> <span class="id">pc</span>' <span class="id">pc</span>'' <span class="id">pc</span>''',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Hneq</span>:      <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>''),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span>' <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#i">i</a></span> <span class="id">pc</span>'' <span class="id"><a href="ConflictReorder.html#fp2">fp2</a></span> <span class="id">pc</span>'''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id">pc</span>'''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">j</span> <span class="id">t</span> <span class="id">fp</span>' <span class="id">pc1</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span> /\ <span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#j">j</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) <span class="id">fp</span>' <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\  <span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span> <span class="id"><a href="ConflictReorder.html#pc1">pc1</a></span> /\ <span class="id"><a href="ConflictReorder.html#j">j</a></span>&lt;= <span class="id"><a href="ConflictReorder.html#i">i</a></span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8877')">Proof.</div>
<div class="proofscript" id="proof8877">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 6 <span class="kwd">as</span> [?[]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ETrace.html#tau_N">tau_N</a></span> <span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> 1 <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">with</span>(<span class="id">fp</span>:=<span class="id">fp</span>). <span class="id">econstructor</span> ;<span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>'') <span class="kwd">as</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">pc</span>'' = ({-|<span class="id">pc</span>',<span class="id">t</span>})). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">pc</span>'' <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstar_sw_star_halfatomblockabort">npnswstar_sw_star_halfatomblockabort</a></span> <span class="kwd">in</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">subst</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#predicted_abort">predicted_abort</a></span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>' = <span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstar_bit">npnswstar_bit</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">subst</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[|<span class="tactic">destruct</span> <span class="id">H8</span>;<span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnsw_taustar_pc_valid_tid_backwards_preservation">npnsw_taustar_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_pc_valid_tid_backwards_preservation">npnswstep_pc_valid_tid_backwards_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_tid_preservation">npnsw_taustar_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnsw_taustar_pc_valid_tid_preservation">npnsw_taustar_pc_valid_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H9</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>'=<span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus_1">tau_plus_1</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_star_star">tau_star_star</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H10</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span>. <span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SmileReorder.html#npnswstar_bit">npnswstar_bit</a></span> <span class="kwd">in</span> <span class="id">H9</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ConflictReorder.html#halfatomblockstep">halfatomblockstep</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>'=<span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H12</span>,<span class="id"><a href="SmileReorder.html#pc_cur_tid">pc_cur_tid</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#tau_plus2star">tau_plus2star</a></span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span> 2;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">intro</span> <span class="id">R</span>;<span class="tactic">inversion</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>;<span class="tactic">apply</span> <span class="id"><a href="USimDRF.html#conflict_union_ano">conflict_union_ano</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GlobDefs.html#atom_bit">atom_bit</a></span> <span class="id">pc</span>'=<span class="id"><a href="GlobDefs.html#O">O</a></span>). <span class="tactic">inversion</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnswstep_l2">npnswstep_l2</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_tid_preservation">npnsw_step_tid_preservation</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="npnswstep_sw_predicted_abort1">npnswstep_sw_predicted_abort1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span>  <span class="id">pc</span> <span class="id">fp</span> <span class="id">pc</span>' <span class="id">pc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Hneq</span>:      <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>' &lt;&gt; <span class="id"><a href="GlobDefs.html#cur_tid">cur_tid</a></span> <span class="id">pc</span>''),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SmileReorder.html#invpc">invpc</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#glob_npnsw_step">glob_npnsw_step</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ETrace.html#tau">tau</a></span> <span class="id"><a href="ConflictReorder.html#fp">fp</a></span> <span class="id">pc</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobSemantics.html#glob_step">glob_step</a></span> <span class="id">pc</span>' <span class="id"><a href="ETrace.html#sw">sw</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> <span class="id">pc</span>''-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="ConflictReorder.html#pc_valid_tid">pc_valid_tid</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span> <span class="id"><a href="ConflictReorder.html#t">t</a></span>/\  <span class="id"><a href="ConflictReorder.html#predicted_abort1">predicted_abort1</a></span> ({-|<span class="id"><a href="ConflictReorder.html#pc">pc</a></span>,<span class="id"><a href="ConflictReorder.html#t">t</a></span>}) ) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="PRaceLemmas.html#race">race</a></span> <span class="id"><a href="PRaceLemmas.html#glob_predict_star_alter">glob_predict_star_alter</a></span> <span class="id"><a href="ConflictReorder.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof8878')">Proof.</div>
<div class="proofscript" id="proof8878">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="SmileReorder.html#npnsw_step_thdpinv">npnsw_step_thdpinv</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">v1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#GE_mod_wd_tp_inv">GE_mod_wd_tp_inv</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> <span class="id">v2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ConflictReorder.html#predicted_abort1_predicted_abort">predicted_abort1_predicted_abort</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ETrace.html#tau_star_tau_N_equiv">tau_star_tau_N_equiv</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ConflictReorder.html#npnswstep_sw_predicted_abort">npnswstep_sw_predicted_abort</a></span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">apply</span> <span class="id"><a href="FPLemmas.html#tauN_taustar">tauN_taustar</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">predicted_abort_predicted_abort1</span>' <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="ConflictReorder.html#CReorder">CReorder</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
