<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module selection_proof</title>
<meta name="description" content="Documentation of Coq module selection_proof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module selection_proof</h1>
<div class="coq">
<br/>
<br/>
<div class="doc">Correctness of instruction selection </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Maps.html">Maps</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span> <span class="id"><a href="Linking.html">Linking</a></span> <span class="id"><a href="Errors.html">Errors</a></span> <span class="id"><a href="Integers.html">Integers</a></span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Memory.html">Memory</a></span> <span class="id"><a href="Events.html">Events</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Switch.html">Switch</a></span> <span class="id"><a href="Cminor.html">Cminor</a></span> <span class="id"><a href="Op.html">Op</a></span> <span class="id"><a href="CminorSel.html">CminorSel</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="SelectOp.html">SelectOp</a></span> <span class="id"><a href="SelectDiv.html">SelectDiv</a></span> <span class="id"><a href="SplitLong.html">SplitLong</a></span> <span class="id"><a href="SelectLong.html">SelectLong</a></span> <span class="id">Selection</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="SelectOpproof.html">SelectOpproof</a></span> <span class="id"><a href="SelectDivproof.html">SelectDivproof</a></span> <span class="id"><a href="SplitLongproof.html">SplitLongproof</a></span> <span class="id"><a href="SelectLongproof.html">SelectLongproof</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CUAST.html">CUAST</a></span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="Blockset.html">Blockset</a></span> <span class="id"><a href="LDSimDefs_local.html">LDSimDefs_local</a></span> <span class="id"><a href="LDSim_local.html">LDSim_local</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="InteractionSemantics.html">InteractionSemantics</a></span> <span class="id"><a href="IS_local.html">IS_local</a></span> <span class="id"><a href="val_casted.html">val_casted</a></span> <span class="id"><a href="InjRels.html">InjRels</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html">MemOpFP</a></span> <span class="id"><a href="Op_fp.html">Op_fp</a></span> <span class="id"><a href="Cminor_op_footprint.html">Cminor_op_footprint</a></span> <span class="id"><a href="Cminor_local.html">Cminor_local</a></span> <span class="id"><a href="CminorSel_local.html">CminorSel_local</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selectop_proof.html">selectop_proof</a></span> <span class="id"><a href="selectdiv_proof.html">selectdiv_proof</a></span> <span class="id"><a href="splitlong_proof.html">splitlong_proof</a></span> <span class="id"><a href="selectlong_proof.html">selectlong_proof</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection.html">selection</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="empfp">empfp</a></span>:=<span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="footprint">footprint</a></span>:=<span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">cminorsel_scope</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<br/>
<h1> Relational specification of instruction selection </h1>
<span class="kwd">Definition</span> <span class="id"><a name="match_fundef">match_fundef</a></span> (<span class="id">scu</span>: <span class="id"><a href="Cminor_local.html#cminor_comp_unit">cminor_comp_unit</a></span>) (<span class="id">f</span>: <span class="id"><a href="Cminor.html#fundef">Cminor.fundef</a></span>) (<span class="id">tf</span>: <span class="id"><a href="CminorSel.html#fundef">CminorSel.fundef</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">hf</span>, <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> /\ <span class="id">sel_fundef</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span>) <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_cu">match_cu</a></span> (<span class="id">scu</span>: <span class="id"><a href="Cminor_local.html#cminor_comp_unit">cminor_comp_unit</a></span>) (<span class="id">tcu</span>: <span class="id"><a href="CminorSel_local.html#cminorsel_comp_unit">cminorsel_comp_unit</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CUAST.html#match_comp_unit_gen">match_comp_unit_gen</a></span> (<span class="id"><a href="selection_proof.html#match_fundef">match_fundef</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span> <span class="id"><a href="selection_proof.html#tcu">tcu</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_globdefs_sound">record_globdefs_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">dm</span> <span class="id">id</span> <span class="id">gd</span>, (<span class="id">record_globdefs</span> <span class="id"><a href="selection_proof.html#dm">dm</a></span>)!<span class="id"><a href="selection_proof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#gd">gd</a></span> -&gt; <span class="id"><a href="selection_proof.html#dm">dm</a></span>!<span class="id"><a href="selection_proof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#gd">gd</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7217')">Proof.</div>
<div class="proofscript" id="proof7217">
&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">id</span> <span class="id">gd</span> =&gt; <span class="kwd">if</span> <span class="id">globdef_of_interest</span> <span class="id"><a href="selection_proof.html#gd">gd</a></span> <span class="kwd">then</span> <span class="id"><a href="Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#gd">gd</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="kwd">else</span> <span class="id"><a href="selection_proof.html#m">m</a></span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">m</span>' =&gt; <span class="id">m</span>'!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gd</span> -&gt; <span class="id"><a href="selection_proof.html#m">m</a></span>!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gd</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="id">P</span> <span class="id">dm</span> (<span class="id"><a href="Maps.html#PTree.fold">PTree.fold</a></span> <span class="id">f</span> <span class="id">dm</span> (<span class="id"><a href="Maps.html#PTree.empty">PTree.empty</a></span> <span class="id">_</span>))).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PTree_Properties.fold_rec">PTree_Properties.fold_rec</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">P</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">red</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="Maps.html#PTree.gempty">PTree.gempty</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">P</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">unfold</span> <span class="id">f</span> <span class="kwd">in</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">globdef_of_interest</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gsspec">PTree.gsspec</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">id</span> <span class="id">k</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">id</span> <span class="id">k</span>). <span class="tactic">congruence</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">X</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lookup_helper_correct_1">lookup_helper_correct_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">globs</span> <span class="id">name</span> <span class="id">sg</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;<span class="id">lookup_helper</span> <span class="id"><a href="selection_proof.html#globs">globs</a></span> <span class="id"><a href="selection_proof.html#name">name</a></span> <span class="id"><a href="selection_proof.html#sg">sg</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#globs">globs</a></span>!<span class="id"><a href="selection_proof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="AST.html#Gfun">Gfun</a></span> (<span class="id"><a href="AST.html#External">External</a></span> (<span class="id"><a href="AST.html#EF_runtime">EF_runtime</a></span> <span class="id"><a href="selection_proof.html#name">name</a></span> <span class="id"><a href="selection_proof.html#sg">sg</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7218')">Proof.</div>
<div class="proofscript" id="proof7218">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">P</span> := <span class="kwd">fun</span> (<span class="id">m</span>: <span class="id"><a href="Maps.html#PTree.t">PTree.t</a></span> <span class="id">globdef</span>) <span class="id">res</span> =&gt; <span class="id"><a href="selection_proof.html#res">res</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span> -&gt; <span class="id"><a href="selection_proof.html#m">m</a></span>!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="AST.html#Gfun">Gfun</a></span>(<span class="id"><a href="AST.html#External">External</a></span> (<span class="id"><a href="AST.html#EF_runtime">EF_runtime</a></span> <span class="id">name</span> <span class="id">sg</span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">P</span> <span class="id">globs</span> (<span class="id"><a href="Maps.html#PTree.fold">PTree.fold</a></span> (<span class="id">lookup_helper_aux</span> <span class="id">name</span> <span class="id">sg</span>) <span class="id">globs</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PTree_Properties.fold_rec">PTree_Properties.fold_rec</a></span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">EITHER</span>: <span class="id">k</span> = <span class="id">id</span> /\ <span class="id">v</span> = <span class="id"><a href="AST.html#Gfun">Gfun</a></span> (<span class="id"><a href="AST.html#External">External</a></span> (<span class="id"><a href="AST.html#EF_runtime">EF_runtime</a></span> <span class="id">name</span> <span class="id">sg</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/  <span class="id">a</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">lookup_helper_aux</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">String.string_dec</a></span> <span class="id">name</span> <span class="id">name0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AST.html#signature_eq">signature_eq</a></span> <span class="id">sg</span> <span class="id">sg0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">repeat</span> <span class="tactic">f_equal</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">EITHER</span> <span class="kwd">as</span> [[<span class="id">X</span> <span class="id">Y</span>] | <span class="id">X</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">k</span> <span class="id">v</span>. <span class="tactic">apply</span> <span class="id"><a href="Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">X</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gso">PTree.gso</a></span> <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id">lookup_helper</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Maps.html#PTree.fold">PTree.fold</a></span> (<span class="id">lookup_helper_aux</span> <span class="id">name</span> <span class="id">sg</span>) <span class="id">globs</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>); <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lookup_helper_correct">lookup_helper_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cu</span> <span class="id">name</span> <span class="id">sg</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;<span class="id">lookup_helper</span> (<span class="id">record_globdefs</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#cu">cu</a></span>)) <span class="id"><a href="selection_proof.html#name">name</a></span> <span class="id"><a href="selection_proof.html#sg">sg</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="splitlong_proof.html#helper_declared">helper_declared</a></span> <span class="id"><a href="selection_proof.html#cu">cu</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#name">name</a></span> <span class="id"><a href="selection_proof.html#sg">sg</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7219')">Proof.</div>
<div class="proofscript" id="proof7219">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#lookup_helper_correct_1">lookup_helper_correct_1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#record_globdefs_sound">record_globdefs_sound</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="get_helpers_correct">get_helpers_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cu</span> <span class="id">hf</span>,<br/>
&nbsp;&nbsp;<span class="id">get_helpers</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#cu">cu</a></span>) = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> -&gt; <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#cu">cu</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7220')">Proof.</div>
<div class="proofscript" id="proof7220">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">red</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span> 20 <span class="kwd">using</span> <span class="id"><a href="selection_proof.html#lookup_helper_correct">lookup_helper_correct</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_program_match">transf_program_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">scu</span> <span class="id">tcu</span>, <span class="id"><a href="selection.html#transf_program">transf_program</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#tcu">tcu</a></span> -&gt; <span class="id"><a href="selection_proof.html#match_cu">match_cu</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span> <span class="id"><a href="selection_proof.html#tcu">tcu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7221')">Proof.</div>
<div class="proofscript" id="proof7221">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_transform_partial_cunit2">match_transform_partial_cunit2</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#get_helpers_correct">get_helpers_correct</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Correctness of the instruction selection functions for expressions </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION">PRESERVATION</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.scu">scu</a></span>: <span class="id"><a href="Cminor_local.html#cminor_comp_unit">cminor_comp_unit</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.tcu">tcu</a></span>: <span class="id"><a href="CminorSel_local.html#cminorsel_comp_unit">cminorsel_comp_unit</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.sge">sge</a></span>: <span class="id"><a href="Cminor.html#genv">Cminor.genv</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.tge">tge</a></span>: <span class="id"><a href="CminorSel.html#genv">CminorSel.genv</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SGEINIT">SGEINIT</a></span>: <span class="id"><a href="CUAST.html#globalenv_generic">globalenv_generic</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.TGEINIT">TGEINIT</a></span>: <span class="id"><a href="CUAST.html#globalenv_generic">globalenv_generic</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.S_EQ">S_EQ</a></span>: <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span>.(<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span>) = <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span>.(<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.TRANSF">TRANSF</a></span>: <span class="id"><a href="selection_proof.html#match_cu">match_cu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ge_match">ge_match</a></span>: <span class="id"><a href="LDSim_local.html#ge_match_strict">ge_match_strict</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7222')">Proof.</div>
<div class="proofscript" id="proof7222">
 <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_cu_ge_match_strict">match_cu_ge_match_strict</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="genv_match">genv_match</a></span>: <span class="id"><a href="Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="CUAST.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="selection_proof.html#match_fundef">match_fundef</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7223')">Proof.</div>
<div class="proofscript" id="proof7223">
 <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_cu_match_genv">match_cu_match_genv</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="symbols_preserved">symbols_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="AST.html#ident">ident</a></span>), <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#s">s</a></span> = <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7224')">Proof.</div>
<div class="proofscript" id="proof7224">
 <span class="tactic">destruct</span> <span class="id"><a href="selection_proof.html#genv_match">genv_match</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="senv_preserved">senv_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7225')">Proof.</div>
<div class="proofscript" id="proof7225">
 <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_cu_senv_preserved">match_cu_senv_preserved</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_ptr_translated">function_ptr_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">f</span>: <span class="id"><a href="Cminor.html#fundef">Cminor.fundef</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span> /\ <span class="id"><a href="selection_proof.html#match_fundef">match_fundef</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7226')">Proof.</div>
<div class="proofscript" id="proof7226">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="selection_proof.html#genv_match">genv_match</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cminor.html#fundef">Cminor.fundef</a></span>, <span class="id"><a href="CminorSel.html#fundef">fundef</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>, <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">mge_defs</span> <span class="id">b</span>). <span class="id">inv</span> <span class="id">mge_defs</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">x</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_translated">functions_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>, <span class="id"><a href="Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span> /\ <span class="id"><a href="selection_proof.html#match_fundef">match_fundef</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7227')">Proof.</div>
<div class="proofscript" id="proof7227">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Integers.html#Ptrofs.eq_dec">Ptrofs.eq_dec</a></span>; [|<span class="tactic">discriminate</span>]. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sig_function_translated">sig_function_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id"><a href="selection_proof.html#match_fundef">match_fundef</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span> -&gt; <span class="id"><a href="CminorSel.html#funsig">funsig</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span> = <span class="id"><a href="Cminor.html#funsig">Cminor.funsig</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7228')">Proof.</div>
<div class="proofscript" id="proof7228">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">hf</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">destruct</span> <span class="id">f</span>; <span class="id">monadInv</span> <span class="id">Q</span>; <span class="tactic">auto</span>. <span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stackspace_function_translated">stackspace_function_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">dm</span> <span class="id">hf</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id">sel_function</span> <span class="id"><a href="selection_proof.html#dm">dm</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span> -&gt; <span class="id"><a href="CminorSel.html#fn_stackspace">fn_stackspace</a></span> <span class="id"><a href="selection_proof.html#tf">tf</a></span> = <span class="id"><a href="Cminor.html#fn_stackspace">Cminor.fn_stackspace</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7229')">Proof.</div>
<div class="proofscript" id="proof7229">
 <span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="helper_functions_preserved">helper_functions_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">hf</span>, <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> -&gt; <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7230')">Proof.</div>
<div class="proofscript" id="proof7230">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">name</span> <span class="id">sg</span>, <span class="id"><a href="splitlong_proof.html#helper_declared">helper_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#name">name</a></span> <span class="id"><a href="selection_proof.html#sg">sg</a></span> -&gt; <span class="id"><a href="splitlong_proof.html#helper_declared">helper_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#name">name</a></span> <span class="id"><a href="selection_proof.html#sg">sg</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="splitlong_proof.html#helper_declared">helper_declared</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CUAST.html#match_comp_unit_defmap">match_comp_unit_defmap</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="selection_proof.html#PRESERVATION.TRANSF">TRANSF</a></span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cminor.html#fundef">Cminor.fundef</a></span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">R</span>; <span class="id">inv</span> <span class="id">R</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> (<span class="id">hf</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">monadInv</span> <span class="id">B</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span>; <span class="tactic">intros</span>. <span class="id">decompose</span> [<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#and">Logic.and</a></span>] <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>. <span class="tactic">auto</span> 20. <br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CMCONSTR">CMCONSTR</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CMCONSTR.hf">hf</a></span>: <span class="id"><a href="SplitLong.html#helper_functions">helper_functions</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CMCONSTR.HF">HF</a></span>: <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.hf">hf</a></span>.<br/>
<span class="kwd">Let</span> <span class="id">HF</span>': <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.hf">hf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7231')">Proof.</div>
<div class="proofscript" id="proof7231">
 <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#helper_functions_preserved">helper_functions_preserved</a></span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CMCONSTR.sp">sp</a></span>: <span class="id"><a href="Values.html#val">val</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CMCONSTR.e">e</a></span>: <span class="id"><a href="Cminor.html#env">env</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CMCONSTR.m">m</a></span>: <span class="id"><a href="Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_condexpr_of_expr_fp">eval_condexpr_of_expr_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">le</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.bool_of_val">Val.bool_of_val</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_condexpr">eval_condexpr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">condexpr_of_expr</span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id"><a href="selection_proof.html#b">b</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_condexpr_fp">eval_condexpr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">condexpr_of_expr</span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7232')">Proof.</div>
<div class="proofscript" id="proof7232">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">a</span>. <span class="id">functional</span> <span class="tactic">induction</span> (<span class="id">condexpr_of_expr</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;compare&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">eqexpr</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H7</span>, <span class="id">H9</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Op.html#eval_condition">eval_condition</a></span>) <span class="id">eqn</span>:<span class="id">EC</span>;[<span class="id">inv</span> <span class="id">H7</span>|<span class="tactic">discriminate</span>]. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b0</span> = <span class="id">b</span>) <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">b0</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>). <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;condition&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">eqexpr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">va0</span>; [<span class="id">exploit</span> <span class="id">IHc</span>|<span class="id">exploit</span> <span class="id">IHc0</span>]; <span class="tactic">eauto</span>; <span class="tactic">intros</span> [<span class="id">EC</span> <span class="id">ECFP</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;let&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">eqexpr</span>. <span class="id">exploit</span> <span class="id">IHc</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">EC</span> <span class="id">ECFP</span>]. <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;default&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">split</span>; <span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="id">TrivFP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_load_fp">eval_load_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">chunk</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.loadv">Mem.loadv</a></span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">load</span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">load</span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span>) (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> (<span class="id"><a href="MemOpFP.html#loadv_fp">loadv_fp</a></span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span>) <span class="id"><a href="selection_proof.html#fp">fp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7233')">Proof.</div>
<div class="proofscript" id="proof7233">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">load</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="selectop_proof.html#eval_addressing_fp">eval_addressing_fp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">chunk</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="SelectOp.html#addressing">addressing</a></span> <span class="id">chunk</span> <span class="id">a</span>). <span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">EV</span> [<span class="id">EF</span> <span class="id">EQ</span>]]]. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CminorSel.html#eval_Eload">eval_Eload</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CminorSel_local.html#eval_Eload_fp">eval_Eload_fp</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#loadv_fp">loadv_fp</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_store_fp">eval_store_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">fp1</span> <span class="id">fp2</span> <span class="id">f</span> <span class="id">k</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#fp1">fp1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span> <span class="id"><a href="selection_proof.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.storev">Mem.storev</a></span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#step">step</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> (<span class="id"><a href="CminorSel_local.html#Core_State">Core_State</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> (<span class="id">store</span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span>) <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span>) <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="selection_proof.html#fp1">fp1</a></span> <span class="id"><a href="selection_proof.html#fp2">fp2</a></span>) (<span class="id"><a href="MemOpFP.html#storev_fp">storev_fp</a></span> <span class="id"><a href="selection_proof.html#chunk">chunk</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span>)) (<span class="id"><a href="CminorSel_local.html#Core_State">Core_State</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="CminorSel.html#Sskip">Sskip</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span>) <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7234')">Proof.</div>
<div class="proofscript" id="proof7234">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="id">H3</span>; <span class="tactic">destruct</span> <span class="id">v1</span>; <span class="tactic">simpl</span>; <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">store</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="selectop_proof.html#eval_addressing_fp">eval_addressing_fp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">chunk</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="SelectOp.html#addressing">addressing</a></span> <span class="id">chunk</span> <span class="id">a1</span>). <span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">EV</span> [<span class="id">EF</span> <span class="id">EQ</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CminorSel_local.html#step_store">step_store</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Correctness of instruction selection for operators </div>
<span class="kwd">Ltac</span> <span class="id">uopexploit</span> <span class="id">H1</span> <span class="id">H2</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">A</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">B</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="id">exacteval</span> <span class="id">H2</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span> [<span class="id">v</span> [<span class="id">A</span> <span class="id">B</span>]]; <span class="id">evalge</span> <span class="id">A</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_sel_unop_fp">eval_sel_unop_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">op</span> <span class="id">a1</span> <span class="id">v1</span> <span class="id">fp</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_unop">eval_unop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_unop</span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>') /\<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_unop</span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7235')">Proof.</div>
<div class="proofscript" id="proof7235">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">FuncInv</span>; <span class="tactic">try</span> <span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_cast8unsigned">eval_cast8unsigned</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_cast8unsigned_fp">eval_cast8unsigned_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_cast8signed">eval_cast8signed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_cast8signed_fp">eval_cast8signed_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_cast16unsigned">eval_cast16unsigned</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_cast16unsigned_fp">eval_cast16unsigned_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_cast16signed">eval_cast16signed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_cast16signed_fp">eval_cast16signed_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_negint">eval_negint</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_negint_fp">eval_negint_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_notint">eval_notint</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_notint_fp">eval_notint_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_negf">eval_negf</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_negf_fp">eval_negf_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_absf">eval_absf</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_absf_fp">eval_absf_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_negfs">eval_negfs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_negfs_fp">eval_negfs_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_absfs">eval_absfs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_absfs_fp">eval_absfs_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_singleoffloat">eval_singleoffloat</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_singleoffloat_fp">eval_singleoffloat_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_floatofsingle">eval_floatofsingle</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_floatofsingle_fp">eval_floatofsingle_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_intoffloat">eval_intoffloat</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_intoffloat_fp">eval_intoffloat_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_intuoffloat">eval_intuoffloat</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_intuoffloat_fp">eval_intuoffloat_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_floatofint">eval_floatofint</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_floatofint_fp">eval_floatofint_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_floatofintu">eval_floatofintu</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_floatofintu_fp">eval_floatofintu_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_intofsingle">eval_intofsingle</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_intofsingle_fp">eval_intofsingle_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_intuofsingle">eval_intuofsingle</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_intuofsingle_fp">eval_intuofsingle_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_singleofint">eval_singleofint</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_singleofint_fp">eval_singleofint_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="SelectOpproof.html#eval_singleofintu">eval_singleofintu</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_singleofintu_fp">eval_singleofintu_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_negl">eval_negl</a></span> <span class="id">H</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_negl_fp">eval_negl_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_notl">eval_notl</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_notl_fp">eval_notl_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_intoflong">eval_intoflong</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_intoflong_fp">eval_intoflong_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_longofint">eval_longofint</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_longofint_fp">eval_longofint_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_longofintu">eval_longofintu</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_longofintu_fp">eval_longofintu_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_longoffloat">eval_longoffloat</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_longoffloat_fp">eval_longoffloat_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SplitLongproof.html#eval_longuoffloat">eval_longuoffloat</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.  <span class="tactic">eapply</span> <span class="id"><a href="splitlong_proof.html#eval_longuoffloat_fp">eval_longuoffloat_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_floatoflong">eval_floatoflong</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_floatoflong_fp">eval_floatoflong_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SplitLongproof.html#eval_floatoflongu">eval_floatoflongu</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="splitlong_proof.html#eval_floatoflongu_fp">eval_floatoflongu_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_longofsingle">eval_longofsingle</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_longofsingle_fp">eval_longofsingle_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SplitLongproof.html#eval_longuofsingle">eval_longuofsingle</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="splitlong_proof.html#eval_longuofsingle_fp">eval_longuofsingle_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SelectLongproof.html#eval_singleoflong">eval_singleoflong</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_singleoflong_fp">eval_singleoflong_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">uopexploit</span> <span class="id"><a href="SplitLongproof.html#eval_singleoflongu">eval_singleoflongu</a></span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="splitlong_proof.html#eval_singleoflongu_fp">eval_singleoflongu_fp</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CMCONSTR.tprog">tprog</a></span> := <span class="id"><a href="AST.html#mkprogram">mkprogram</a></span> (<span class="id"><a href="CUAST.html#cu_defs">cu_defs</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span>) (<span class="id"><a href="CUAST.html#cu_public">cu_public</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span>) 1%<span class="id">positive</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">bexploit1</span> <span class="id">T1</span> <span class="id">H1</span> <span class="id">H2</span> :=<br/>
&nbsp;&nbsp;(<span class="id">exploit</span> <span class="id">T1</span>; [<span class="tactic">exact</span> <span class="id">H1</span>|<span class="tactic">exact</span> <span class="id">H2</span>|]) || (<span class="id">exploit</span> <span class="id">T1</span>; [<span class="tactic">exact</span> <span class="id">H1</span>|<span class="tactic">exact</span> <span class="id">H2</span>| |]).<br/>
<span class="kwd">Ltac</span> <span class="id">bexploit2</span> <span class="id">T1</span> <span class="id">H1</span> <span class="id">H2</span> :=<br/>
&nbsp;&nbsp;((<span class="id">exploit</span> (<span class="id">T1</span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.tprog">tprog</a></span>); <span class="tactic">subst</span> <span class="id">tprog</span>; [<span class="id">exacteval</span> <span class="id">H1</span>|<span class="id">exacteval</span> <span class="id">H2</span>|])<br/>
&nbsp;&nbsp;|| (<span class="id">exploit</span> (<span class="id">T1</span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.tprog">tprog</a></span>); <span class="tactic">subst</span> <span class="id">tprog</span>; [<span class="id">exacteval</span> <span class="id">H1</span>|<span class="id">exacteval</span> <span class="id">H2</span>| | ])<br/>
&nbsp;&nbsp;|| (<span class="id">exploit</span> (<span class="id">T1</span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.tprog">tprog</a></span>); <span class="tactic">subst</span> <span class="id">tprog</span>; [|<span class="id">exacteval</span> <span class="id">H1</span>|<span class="id">exacteval</span> <span class="id">H2</span>| ])<br/>
&nbsp;&nbsp;|| (<span class="id">exploit</span> (<span class="id">T1</span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.tprog">tprog</a></span>); <span class="tactic">subst</span> <span class="id">tprog</span>; [|<span class="id">exacteval</span> <span class="id">H1</span>|<span class="id">exacteval</span> <span class="id">H2</span>| | ])).<br/>
<span class="kwd">Ltac</span> <span class="id">bexploit</span> <span class="id">T1</span> <span class="id">T2</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H1</span>: (<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">a1</span> <span class="id">_</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>: (<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">a2</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id">context</span>[(<span class="id">_</span> ?<span class="id">a1</span> ?<span class="id">a2</span>)] ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; (((<span class="id">bexploit2</span> <span class="id">T1</span> <span class="id">H1</span> <span class="id">H2</span>); <span class="tactic">eauto</span>; <span class="tactic">intros</span> [?<span class="id">v</span> [?<span class="id">A</span> ?<span class="id">B</span>]]; <span class="id">evalge</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| ((<span class="id">bexploit1</span> <span class="id">T1</span> <span class="id">H1</span> <span class="id">H2</span>); <span class="tactic">eauto</span>; <span class="tactic">intros</span> [?<span class="id">v</span> [?<span class="id">A</span> ?<span class="id">B</span>]]));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">eauto</span>| <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">T2</span>; <span class="tactic">eauto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">exploit</span> <span class="id">T2</span>; [<span class="tactic">exact</span> <span class="id">H1</span>|<span class="tactic">eauto</span>|<span class="tactic">exact</span> <span class="id">H2</span>|<span class="tactic">eauto</span>|<span class="tactic">eauto</span>|]; <span class="tactic">simpl</span>; <span class="id">TrivFP</span>; <span class="tactic">fail</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_sel_binop_fp">eval_sel_binop_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">op</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">fp1</span> <span class="id">fp2</span> <span class="id">v</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#fp1">fp1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span> <span class="id"><a href="selection_proof.html#fp2">fp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_op_footprint.html#eval_binop_fp">eval_binop_fp</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_binop</span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>') /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.sp">sp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.e">e</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR.m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_binop</span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#a1">a1</a></span> <span class="id"><a href="selection_proof.html#a2">a2</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="selection_proof.html#fp1">fp1</a></span> <span class="id"><a href="selection_proof.html#fp2">fp2</a></span>) <span class="id"><a href="selection_proof.html#fp">fp</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7236')">Proof.</div>
<div class="proofscript" id="proof7236">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | [<span class="id">H1</span>: ?<span class="id">x</span> = <span class="id">_</span>, <span class="id">H</span>: <span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>  <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">FuncInv</span>; <span class="tactic">subst</span>; <span class="id">TrivFP</span>. <br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_add">eval_add</a></span> <span class="id"><a href="selectop_proof.html#eval_add_fp">eval_add_fp</a></span>. <br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_sub">eval_sub</a></span> <span class="id"><a href="selectop_proof.html#eval_sub_fp">eval_sub_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_mul">eval_mul</a></span> <span class="id"><a href="selectop_proof.html#eval_mul_fp">eval_mul_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_divs">eval_divs</a></span> <span class="id"><a href="selectdiv_proof.html#eval_divs_fp">eval_divs_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_divu">eval_divu</a></span> <span class="id"><a href="selectdiv_proof.html#eval_divu_fp">eval_divu_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_mods">eval_mods</a></span> <span class="id"><a href="selectdiv_proof.html#eval_mods_fp">eval_mods_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_modu">eval_modu</a></span> <span class="id"><a href="selectdiv_proof.html#eval_modu_fp">eval_modu_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_and">eval_and</a></span> <span class="id"><a href="selectop_proof.html#eval_and_fp">eval_and_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_or">eval_or</a></span> <span class="id"><a href="selectop_proof.html#eval_or_fp">eval_or_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_xor">eval_xor</a></span> <span class="id"><a href="selectop_proof.html#eval_xor_fp">eval_xor_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_shl">eval_shl</a></span> <span class="id"><a href="selectop_proof.html#eval_shl_fp">eval_shl_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_shr">eval_shr</a></span> <span class="id"><a href="selectop_proof.html#eval_shr_fp">eval_shr_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_shru">eval_shru</a></span> <span class="id"><a href="selectop_proof.html#eval_shru_fp">eval_shru_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_addf">eval_addf</a></span> <span class="id"><a href="selectop_proof.html#eval_addf_fp">eval_addf_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_subf">eval_subf</a></span> <span class="id"><a href="selectop_proof.html#eval_subf_fp">eval_subf_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_mulf">eval_mulf</a></span> <span class="id"><a href="selectop_proof.html#eval_mulf_fp">eval_mulf_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_divf">eval_divf</a></span> <span class="id"><a href="selectdiv_proof.html#eval_divf_fp">eval_divf_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_addfs">eval_addfs</a></span> <span class="id"><a href="selectop_proof.html#eval_addfs_fp">eval_addfs_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_subfs">eval_subfs</a></span> <span class="id"><a href="selectop_proof.html#eval_subfs_fp">eval_subfs_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_mulfs">eval_mulfs</a></span> <span class="id"><a href="selectop_proof.html#eval_mulfs_fp">eval_mulfs_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_divfs">eval_divfs</a></span> <span class="id"><a href="selectdiv_proof.html#eval_divfs_fp">eval_divfs_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_addl">eval_addl</a></span> <span class="id"><a href="selectlong_proof.html#eval_addl_fp">eval_addl_fp</a></span>. <br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_subl">eval_subl</a></span> <span class="id"><a href="selectlong_proof.html#eval_subl_fp">eval_subl_fp</a></span>. <br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_mull">eval_mull</a></span> <span class="id"><a href="selectlong_proof.html#eval_mull_fp">eval_mull_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_divls">eval_divls</a></span> <span class="id"><a href="selectdiv_proof.html#eval_divls_fp">eval_divls_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_divlu">eval_divlu</a></span> <span class="id"><a href="selectdiv_proof.html#eval_divlu_fp">eval_divlu_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_modls">eval_modls</a></span> <span class="id"><a href="selectdiv_proof.html#eval_modls_fp">eval_modls_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectDivproof.html#eval_modlu">eval_modlu</a></span> <span class="id"><a href="selectdiv_proof.html#eval_modlu_fp">eval_modlu_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_andl">eval_andl</a></span> <span class="id"><a href="selectlong_proof.html#eval_andl_fp">eval_andl_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_orl">eval_orl</a></span> <span class="id"><a href="selectlong_proof.html#eval_orl_fp">eval_orl_fp</a></span>. <br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_xorl">eval_xorl</a></span> <span class="id"><a href="selectlong_proof.html#eval_xorl_fp">eval_xorl_fp</a></span>. <br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_shll">eval_shll</a></span> <span class="id"><a href="selectlong_proof.html#eval_shll_fp">eval_shll_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_shrl">eval_shrl</a></span> <span class="id"><a href="selectlong_proof.html#eval_shrl_fp">eval_shrl_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectLongproof.html#eval_shrlu">eval_shrlu</a></span> <span class="id"><a href="selectlong_proof.html#eval_shrlu_fp">eval_shrlu_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_comp_opt">eval_comp_opt</a></span> <span class="id"><a href="selectop_proof.html#eval_comp_opt_fp">eval_comp_opt_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_compu_opt">eval_compu_opt</a></span> <span class="id"><a href="selectop_proof.html#eval_compu_opt_fp">eval_compu_opt_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_compf_opt">eval_compf_opt</a></span> <span class="id"><a href="selectop_proof.html#eval_compf_opt_fp">eval_compf_opt_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit</span> <span class="id"><a href="SelectOpproof.html#eval_compfs_opt">eval_compfs_opt</a></span> <span class="id"><a href="selectop_proof.html#eval_compfs_opt_fp">eval_compfs_opt_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bexploit2</span> <span class="id"><a href="SelectLongproof.html#eval_cmpl">eval_cmpl</a></span> <span class="id">H</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>; <span class="id">evalge</span> <span class="id">A</span>. <span class="tactic">split</span>; [<span class="tactic">eauto</span>|<span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_cmpl_fp">eval_cmpl_fp</a></span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<span class="id">bexploit2</span> <span class="id"><a href="SelectLongproof.html#eval_cmplu">eval_cmplu</a></span> <span class="id">H</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>. <span class="id">evalge</span> <span class="id">A</span>. <span class="tactic">split</span>; [<span class="tactic">eauto</span>|<span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_cmplu_fp">eval_cmplu_fp</a></span>; <span class="tactic">eauto</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="selection_proof.html#PRESERVATION.CMCONSTR">CMCONSTR</a></span>.<br/>
<br/>
<div class="doc">Recognition of calls to built-in functions </div>
<div class="doc">TODO: modified spec.. could be useless </div>
<span class="kwd">Lemma</span> <span class="id"><a name="expr_is_addrof_ident_correct">expr_is_addrof_ident_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;<span class="id">expr_is_addrof_ident</span> <span class="id"><a href="selection_proof.html#e">e</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#e">e</a></span> = <span class="id"><a href="Cminor.html#Econst">Cminor.Econst</a></span> (<span class="id"><a href="Cminor.html#Oaddrsymbol">Cminor.Oaddrsymbol</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7237')">Proof.</div>
<div class="proofscript" id="proof7237">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">id</span>. <span class="tactic">unfold</span> <span class="id">expr_is_addrof_ident</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">c</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">predSpec</span> <span class="id"><a href="Integers.html#Ptrofs.eq">Ptrofs.eq</a></span> <span class="id"><a href="Integers.html#Ptrofs.eq_spec">Ptrofs.eq_spec</a></span> <span class="id">i0</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="classify_call_correct">classify_call_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span> <span class="id">fd</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_expr">Cminor.eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#fd">fd</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">classify_call</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Call_default</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id">Call_imm</span> <span class="id">id</span> =&gt; <span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> /\ <span class="id"><a href="selection_proof.html#v">v</a></span> = <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span><br/>
&nbsp;&nbsp;| <span class="id">Call_builtin</span> <span class="id">ef</span> =&gt; <span class="id"><a href="selection_proof.html#fd">fd</a></span> = <span class="id"><a href="AST.html#External">External</a></span> <span class="id">ef</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7238')">Proof.</div>
<div class="proofscript" id="proof7238">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">classify_call</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">expr_is_addrof_ident</span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">id</span>|] <span class="id">eqn</span>:<span class="id">EA</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#expr_is_addrof_ident_correct">expr_is_addrof_ident_correct</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_find_funct_ptr">Genv.find_funct_find_funct_ptr</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">DFL</span>: <span class="id">exists</span> <span class="id">b1</span>, <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#b1">b1</a></span> /\ <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span> = <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="selection_proof.html#b1">b1</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="tactic">by</span> (<span class="id">exists</span> <span class="id">b</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">globdef</span>; <span class="tactic">destruct</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>)!<span class="id">id</span> <span class="kwd">as</span> [[[<span class="id">f</span>|<span class="id">ef</span>] |<span class="id">gv</span>] |] <span class="id">eqn</span>:<span class="id">G</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AST.html#ef_inline">ef_inline</a></span> <span class="id">ef</span>) <span class="id">eqn</span>:<span class="id">INLINE</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#find_def_symbol">find_def_symbol</a></span> <span class="kwd">in</span> <span class="id">G</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr_iff">Genv.find_funct_ptr_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">G</span> <span class="kwd">as</span> [<span class="id">b</span>' [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Translation of <span class="bracket"><span class="id">switch</span></span> statements </div>
<span class="kwd">Inductive</span> <span class="id"><a name="Rint">Rint</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Rint_intro">Rint_intro</a></span>: <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="selection_proof.html#Rint">Rint</a></span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Rlong">Rlong</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="Rlong_intro">Rlong_intro</a></span>: <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="selection_proof.html#Rlong">Rlong</a></span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) (<span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH">SEL_SWITCH</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span>: <span class="id"><a href="CminorSel.html#expr">expr</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="CminorSel.html#expr">expr</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span>: <span class="id"><a href="CminorSel.html#expr">expr</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="CminorSel.html#expr">expr</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span>: <span class="id"><a href="CminorSel.html#expr">expr</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="CminorSel.html#expr">expr</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span>: <span class="id"><a href="CminorSel.html#expr">expr</a></span> -&gt; <span class="id"><a href="CminorSel.html#expr">expr</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.modulus">modulus</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.R">R</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.no_ptr">no_ptr</a></span>: <span class="kwd">forall</span> <span class="id">z</span> <span class="id">v</span> <span class="id">b</span> <span class="id">i</span>, <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#z">z</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <span class="id"><a href="selection_proof.html#v">v</a></span> &lt;&gt; <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_cmp_eq">eval_make_cmp_eq</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="selection_proof.html#n">n</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) (<span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>)).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_cmp_eq_fp">eval_make_cmp_eq_fp</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="selection_proof.html#n">n</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_cmp_ltu">eval_make_cmp_ltu</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="selection_proof.html#n">n</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) (<span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>)).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_cmp_ltu_fp">eval_make_cmp_ltu_fp</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="selection_proof.html#n">n</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_sub">eval_make_sub</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="selection_proof.html#n">n</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> ((<span class="id"><a href="selection_proof.html#i">i</a></span> - <span class="id"><a href="selection_proof.html#n">n</a></span>) <span class="id">mod</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span>) <span class="id">v</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_sub_fp">eval_make_sub_fp</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">i</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="selection_proof.html#n">n</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_to_int">eval_make_to_int</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="selection_proof.html#Rint">Rint</a></span> (<span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id">mod</span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span>) <span class="id">v</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.SEL_SWITCH.eval_make_to_int_fp">eval_make_to_int_fp</a></span>: <span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> <span class="id">a</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;    <br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">exactcond</span> <span class="id">A</span> := <span class="tactic">eapply</span> <span class="id"><a href="CminorSel_local.html#eval_condexpr_preserved">eval_condexpr_preserved</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">A</span>; <span class="tactic">try</span> <span class="id">gegen</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">gegen</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_switch_correct_rec_fp">sel_switch_correct_rec_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">varg</span> <span class="id">i</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#varg">varg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">arg</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Switch.html#wf_comptree">wf_comptree</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#varg">varg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Switch.html#comptree_match">comptree_match</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_exitexpr">eval_exitexpr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_switch</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>) <span class="id"><a href="selection_proof.html#x">x</a></span> /\<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_exitexpr_fp">eval_exitexpr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_switch</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>) <span class="id"><a href="selection_proof.html#empfp">empfp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7239')">Proof.</div>
<div class="proofscript" id="proof7239">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">x</span>; <span class="tactic">intros</span> <span class="id">Ri</span>. <span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">le</span>; <span class="tactic">intros</span> <span class="id">WF</span> <span class="id">ARG</span> <span class="id">MATCH</span>; <span class="id">inv</span> <span class="id">WF</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MATCH</span>; <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;eq&nbsp;test&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">arg</span>) <span class="id">key</span>) (<span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">key</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_cmp_eq">eval_make_cmp_eq</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_cmp_eq_fp">eval_make_cmp_eq_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">arg</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">fp</span>' [<span class="id">H0</span> <span class="id">B</span>]]. <span class="tactic">apply</span> <span class="id"><a href="selectdiv_proof.html#subset_emp_emp">subset_emp_emp</a></span> <span class="kwd">in</span> <span class="id">B</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#eval_condexpr_of_expr_fp">eval_condexpr_of_expr_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">arg</span>) <span class="id">key</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">key</span>)). <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zeq">zeq</a></span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">constructor</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">key</span>); <span class="id">inv</span> <span class="id">MATCH</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">IHt</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>' <span class="id">B</span>']. <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;lt&nbsp;test&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">arg</span>) <span class="id">key</span>) (<span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">key</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_cmp_ltu">eval_make_cmp_ltu</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_cmp_ltu_fp">eval_make_cmp_ltu_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">arg</span>)); <span class="tactic">try</span> (<span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">fp</span>' [? <span class="id">B</span>]]. <span class="tactic">apply</span> <span class="id"><a href="selectdiv_proof.html#subset_emp_emp">subset_emp_emp</a></span> <span class="kwd">in</span> <span class="id">B</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#eval_condexpr_of_expr_fp">eval_condexpr_of_expr_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">arg</span>) <span class="id">key</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">key</span>)). <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="id">constructor</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">key</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">IHt1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>' <span class="id">B</span>']. <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">IHt2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span>' <span class="id">B</span>']. <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;jump&nbsp;table&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_sub">eval_make_sub</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span>). <span class="tactic">eapply</span> <span class="id"><a href="CminorSel.html#eval_Eletvar">eval_Eletvar</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ofs</span>). <span class="tactic">auto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_sub_fp">eval_make_sub_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span>). <span class="tactic">eapply</span> <span class="id"><a href="CminorSel.html#eval_Eletvar">eval_Eletvar</a></span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ofs</span>). <span class="tactic">auto</span>. <span class="tactic">intros</span> (<span class="id">fp</span>' &amp; <span class="id">A</span>' &amp; <span class="id">B</span>'). <span class="tactic">apply</span> <span class="id"><a href="selectdiv_proof.html#subset_emp_emp">subset_emp_emp</a></span> <span class="kwd">in</span> <span class="id">B</span>'; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">i</span>' := (<span class="id">i</span> - <span class="id">ofs</span>) <span class="id">mod</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id">v</span>' :: <span class="id">le</span>) (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) <span class="id">sz</span>) (<span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">i</span>' <span class="id">sz</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_cmp_ltu">eval_make_cmp_ltu</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_cmp_ltu_fp">eval_make_cmp_ltu_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id">v</span>' :: <span class="id">le</span>) (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> 0)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">fp</span>' [? <span class="id">B</span>']]. <span class="tactic">apply</span> <span class="id"><a href="selectdiv_proof.html#subset_emp_emp">subset_emp_emp</a></span> <span class="kwd">in</span> <span class="id">B</span>'; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#eval_condexpr_of_expr_fp">eval_condexpr_of_expr_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> 0) <span class="id">sz</span>) (<span class="id">v</span>' :: <span class="id">le</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">i</span>' <span class="id">sz</span>); <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="id">constructor</span>. <span class="tactic">intros</span> [<span class="id">E</span> <span class="id">F</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_to_int">eval_make_to_int</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id">v</span>' :: <span class="id">le</span>) (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>'' &amp; <span class="id">C</span> &amp; <span class="id">D</span>). <span class="id">inv</span> <span class="id">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.eval_make_to_int_fp">eval_make_to_int_fp</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> (<span class="id">v</span>' :: <span class="id">le</span>) (<span class="id"><a href="CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">fp</span>' [<span class="id">C</span>' <span class="id">D</span>']]. <span class="tactic">apply</span> <span class="id"><a href="selectdiv_proof.html#subset_emp_emp">subset_emp_emp</a></span> <span class="kwd">in</span> <span class="id">D</span>'; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">i</span>' <span class="id">sz</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ { <span class="tactic">split</span>; <span class="tactic">repeat</span> (<span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>). <span class="id">all</span>: <span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> (<span class="id">IHt</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">arg</span>)); <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1:= <span class="id">v</span>' :: <span class="id">le</span>). <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">G</span> <span class="id">I</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">repeat</span> (<span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_switch_correct_fp">sel_switch_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">dfl</span> <span class="id">cases</span> <span class="id">arg</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">varg</span> <span class="id">fp</span> <span class="id">i</span> <span class="id">t</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> <span class="id"><a href="selection_proof.html#dfl">dfl</a></span> <span class="id"><a href="selection_proof.html#cases">cases</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> <span class="id"><a href="selection_proof.html#varg">varg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.R">R</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#varg">varg</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="selection_proof.html#i">i</a></span> &lt; <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.modulus">modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_exitexpr">eval_exitexpr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id">sel_switch</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Switch.html#switch_target">switch_target</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span> <span class="id"><a href="selection_proof.html#dfl">dfl</a></span> <span class="id"><a href="selection_proof.html#cases">cases</a></span>) /\<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_exitexpr_fp">eval_exitexpr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id">sel_switch</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_eq">make_cmp_eq</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_cmp_ltu">make_cmp_ltu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_sub">make_sub</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH.make_to_int">make_to_int</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>)) <span class="id"><a href="selection_proof.html#fp">fp</a></span> .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7240')">Proof.</div>
<div class="proofscript" id="proof7240">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="Switch.html#validate_switch_correct">validate_switch_correct</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_switch_correct_rec_fp">sel_switch_correct_rec_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (2:= <span class="id">varg</span> :: <span class="id">le</span>). <span class="id">instantiate</span> (1:= 0%<span class="id">nat</span>). <span class="tactic">auto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="id">TrivFP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="selection_proof.html#PRESERVATION.SEL_SWITCH">SEL_SWITCH</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_switch_int_correct_fp">sel_switch_int_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">dfl</span> <span class="id">cases</span> <span class="id">arg</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">i</span> <span class="id">fp</span> <span class="id">t</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span> <span class="id"><a href="selection_proof.html#dfl">dfl</a></span> <span class="id"><a href="selection_proof.html#cases">cases</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_exitexpr">eval_exitexpr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id">sel_switch_int</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>)) (<span class="id"><a href="Switch.html#switch_target">switch_target</a></span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span>) <span class="id"><a href="selection_proof.html#dfl">dfl</a></span> <span class="id"><a href="selection_proof.html#cases">cases</a></span>) /\<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_exitexpr_fp">eval_exitexpr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id">sel_switch_int</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>)) <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7241')">Proof.</div>
<div class="proofscript" id="proof7241">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">INTCONST</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="Op.html#Ointconst">Ointconst</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>) <span class="id"><a href="CminorSel.html#Enil">Enil</a></span>) (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="selection_proof.html#n">n</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="id">econstructor</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sel_switch_correct_fp">sel_switch_correct_fp</a></span> <span class="kwd">with</span> (<span class="id">R</span> := <span class="id"><a href="selection_proof.html#Rint">Rint</a></span>); <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="id">inv</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SelectOpproof.html#eval_comp_opt">eval_comp_opt</a></span>. <span class="id">eexact</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> (<span class="id">INTCONST</span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Integers.html#Ceq">Ceq</a></span>). <span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmp">Val.cmp</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">revert</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">predSpec</span> <span class="id"><a href="Integers.html#Int.eq">Int.eq</a></span> <span class="id"><a href="Integers.html#Int.eq_spec">Int.eq_spec</a></span> <span class="id">n0</span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>); <span class="tactic">intros</span> <span class="id">B</span>; <span class="id">inv</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zeq_true">zeq_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zeq_false">zeq_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Integers.html#Int.repr_unsigned">Int.repr_unsigned</a></span> <span class="id">n0</span>). <span class="tactic">congruence</span>.<br/>
- <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="SelectOpproof.html#eval_comp_opt">eval_comp_opt</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id"><a href="Integers.html#Ceq">Ceq</a></span>); <span class="tactic">simpl</span>. <span class="tactic">exact</span> <span class="id">H</span>. <span class="id">instantiate</span> (2:= <span class="id"><a href="CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="Op.html#Ointconst">Ointconst</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)) <span class="id"><a href="CminorSel.html#Enil">Enil</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">vc</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selectop_proof.html#eval_comp_opt_fp">eval_comp_opt_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id"><a href="Integers.html#Ceq">Ceq</a></span>); <span class="tactic">simpl</span>. <span class="tactic">exact</span> <span class="id">H</span>. <span class="tactic">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;4: <span class="id">instantiate</span> (1:=<span class="id"><a href="selection_proof.html#empfp">empfp</a></span>); <span class="id">TrivFP</span>; <span class="tactic">eauto</span>. 1,2: <span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="id">inv</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SelectOpproof.html#eval_compu_opt">eval_compu_opt</a></span>. <span class="id">eexact</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> (<span class="id">INTCONST</span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)). <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Integers.html#Clt">Clt</a></span>). <span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int.ltu">Int.ltu</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span> <span class="kwd">in</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n0</span>) <span class="id">n</span>); <span class="id">inv</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">clear</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">exploit</span> <span class="id"><a href="SelectOpproof.html#eval_compu_opt">eval_compu_opt</a></span>. <span class="tactic">exact</span> <span class="id">H</span>. <span class="id">instantiate</span> (2:=  <span class="id"><a href="CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="Op.html#Ointconst">Ointconst</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)) <span class="id"><a href="CminorSel.html#Enil">Enil</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">vc</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">B</span>. <span class="id">exploit</span> (<span class="id"><a href="selectop_proof.html#eval_compu_opt_fp">eval_compu_opt_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id"><a href="Integers.html#Clt">Clt</a></span>). <span class="tactic">exact</span> <span class="id">H</span>. <span class="tactic">eauto</span>. 3: <span class="tactic">exact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;1,2: <span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">TrivFP</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">destruct</span> <span class="id"><a href="Integers.html#Int.ltu">Int.ltu</a></span>; <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="id">inv</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SelectOpproof.html#eval_sub">eval_sub</a></span>. <span class="id">eexact</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> (<span class="id">INTCONST</span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)). <span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">inv</span> <span class="id">B</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n0</span> - <span class="id">n</span>) <span class="id">mod</span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int.sub">Int.sub</a></span> <span class="id">n0</span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int.sub">Int.sub</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.unsigned_repr_eq">Int.unsigned_repr_eq</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">exploit</span> <span class="id"><a href="SelectOpproof.html#eval_sub">eval_sub</a></span>. <span class="tactic">exact</span> <span class="id">H</span>. <span class="id">instantiate</span> (2:= (<span class="id"><a href="CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="Op.html#Ointconst">Ointconst</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)) <span class="id"><a href="CminorSel.html#Enil">Enil</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">vb</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selectop_proof.html#eval_sub_fp">eval_sub_fp</a></span>. <span class="tactic">exact</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (2:= (<span class="id"><a href="CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="Op.html#Ointconst">Ointconst</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> <span class="id">n</span>)) <span class="id"><a href="CminorSel.html#Enil">Enil</a></span>)).<br/>
&nbsp;&nbsp;1-2: <span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">TrivFP</span>. <br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">i0</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">R</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#Zmod_small">Zmod_small</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_range">Int.unsigned_range</a></span>). <span class="id">constructor</span>.<br/>
- <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">Triv</span>.<br/>
- <span class="id">constructor</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_range">Int.unsigned_range</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_switch_long_correct_fp">sel_switch_long_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">dfl</span> <span class="id">cases</span> <span class="id">arg</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">i</span> <span class="id">fp</span> <span class="id">t</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="Integers.html#Int64.modulus">Int64.modulus</a></span> <span class="id"><a href="selection_proof.html#dfl">dfl</a></span> <span class="id"><a href="selection_proof.html#cases">cases</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_exitexpr">eval_exitexpr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id">sel_switch_long</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>)) (<span class="id"><a href="Switch.html#switch_target">switch_target</a></span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="selection_proof.html#i">i</a></span>) <span class="id"><a href="selection_proof.html#dfl">dfl</a></span> <span class="id"><a href="selection_proof.html#cases">cases</a></span>) /\<br/>
&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_exitexpr_fp">eval_exitexpr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id"><a href="CminorSel.html#XElet">XElet</a></span> <span class="id"><a href="selection_proof.html#arg">arg</a></span> (<span class="id">sel_switch_long</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="selection_proof.html#t">t</a></span>)) <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7242')">Proof.</div>
<div class="proofscript" id="proof7242">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sel_switch_correct_fp">sel_switch_correct_fp</a></span> <span class="kwd">with</span> (<span class="id">R</span> := <span class="id"><a href="selection_proof.html#Rlong">Rlong</a></span>); <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="tactic">eapply</span> <span class="id"><a href="CminorSel_local.html#eval_expr_preserved">eval_expr_preserved</a></span>. 4: <span class="tactic">eapply</span> <span class="id"><a href="SelectLongproof.html#eval_cmpl">eval_cmpl</a></span>.<br/>
&nbsp;&nbsp;1-3:<span class="tactic">try</span> <span class="id">gegen</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">gegen</span>. <span class="id">exacteval</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> <span class="id"><a href="SelectLongproof.html#eval_longconst">eval_longconst</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">R</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpl">Val.cmpl</a></span>. <span class="tactic">simpl</span>. <span class="tactic">f_equal</span>; <span class="tactic">f_equal</span>. <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.eq">Int64.eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int64.unsigned_repr">Int64.unsigned_repr</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zeq">zeq</a></span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n0</span>) <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.max_unsigned">Int64.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>. <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">EVALFP</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="id">inv</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selectlong_proof.html#eval_cmpl_fp">eval_cmpl_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.TGEINIT">TGEINIT</a></span>); <span class="tactic">simpl</span>. <span class="tactic">exact</span> <span class="id">EVAL</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (2:= <span class="id"><a href="SelectLong.html#longconst">longconst</a></span> (<span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;1-2: <span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (2:= <span class="id"><a href="Integers.html#Ceq">Ceq</a></span>). <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpl">Val.cmpl</a></span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">TrivFP</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="tactic">eapply</span> <span class="id"><a href="CminorSel_local.html#eval_expr_preserved">eval_expr_preserved</a></span>. 4: <span class="tactic">eapply</span> <span class="id"><a href="SelectLongproof.html#eval_cmplu">eval_cmplu</a></span>.<br/>
&nbsp;&nbsp;1-3:<span class="tactic">try</span> <span class="id">gegen</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">gegen</span>. <span class="id">exacteval</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> <span class="id"><a href="SelectLongproof.html#eval_longconst">eval_longconst</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">R</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmplu">Val.cmplu</a></span>. <span class="tactic">simpl</span>. <span class="tactic">f_equal</span>; <span class="tactic">f_equal</span>. <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.ltu">Int64.ltu</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int64.unsigned_repr">Int64.unsigned_repr</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n0</span>) <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.max_unsigned">Int64.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>. <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">EVALFP</span> <span class="id">R</span> <span class="id">RANGE</span>. <span class="id">inv</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selectlong_proof.html#eval_cmplu_fp">eval_cmplu_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.TGEINIT">TGEINIT</a></span>); <span class="tactic">simpl</span>. <span class="tactic">exact</span> <span class="id">EVAL</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (2:= <span class="id"><a href="SelectLong.html#longconst">longconst</a></span> (<span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;1-2: <span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (2:= <span class="id"><a href="Integers.html#Clt">Clt</a></span>). <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmplu">Val.cmplu</a></span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="id">TrivFP</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span> <span class="id">RANGE</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SelectLongproof.html#eval_subl">eval_subl</a></span>; <span class="tactic">auto</span>. <span class="id">exacteval</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> <span class="id"><a href="SelectLongproof.html#eval_longconst">eval_longconst</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">evalge</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">R</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">inv</span> <span class="id">B</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n0</span> - <span class="id">n</span>) <span class="id">mod</span> <span class="id"><a href="Integers.html#Int64.modulus">Int64.modulus</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> (<span class="id"><a href="Integers.html#Int64.sub">Int64.sub</a></span> <span class="id">n0</span> (<span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.sub">Int64.sub</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int64.unsigned_repr_eq">Int64.unsigned_repr_eq</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int64.unsigned_repr">Int64.unsigned_repr</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.max_unsigned">Int64.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">EVALFP</span> <span class="id">R</span> <span class="id">RANGE</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SelectLongproof.html#eval_subl">eval_subl</a></span>; <span class="tactic">auto</span>. <span class="id">exacteval</span> <span class="id">EVAL</span>. <span class="tactic">apply</span> <span class="id"><a href="SelectLongproof.html#eval_longconst">eval_longconst</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">evalge</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selectlong_proof.html#eval_subl_fp">eval_subl_fp</a></span>; <span class="tactic">auto</span>. 5: <span class="tactic">exact</span> <span class="id">A</span>. 1-2: <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CminorSel_local.html#eval_expr_preserved">eval_expr_preserved</a></span>. 4: <span class="tactic">apply</span> <span class="id"><a href="SelectLongproof.html#eval_longconst">eval_longconst</a></span> <span class="kwd">with</span> (<span class="id">n</span>:= <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>). 1-3: <span class="tactic">try</span> <span class="id">gegen</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">gegen</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selectlong_proof.html#eval_longconst_fp">eval_longconst_fp</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">n</span>). <span class="id">TrivFP</span>. <br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">i0</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SplitLongproof.html#eval_lowlong">eval_lowlong</a></span>. <span class="id">exacteval</span> <span class="id">EVAL</span>. <span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">evalge</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">R</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">inv</span> <span class="id">B</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n</span> <span class="id">mod</span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span>) <span class="kwd">with</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_repr_eq">Int.unsigned_repr_eq</a></span>.<br/>
- <span class="tactic">intros</span> <span class="id">until</span> <span class="id">i0</span>; <span class="tactic">intros</span> <span class="id">EVAL</span> <span class="id">EVALFP</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SplitLongproof.html#eval_lowlong">eval_lowlong</a></span>. <span class="id">exacteval</span> <span class="id">EVAL</span>. <span class="tactic">intros</span> (<span class="id">vb</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">evalge</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="splitlong_proof.html#eval_lowlong_fp">eval_lowlong_fp</a></span>; <span class="tactic">eauto</span>. <br/>
- <span class="id">constructor</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int64.unsigned_range">Int64.unsigned_range</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Compatibility of evaluation functions with the "less defined than" relation. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">TrivialExists</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> /\ <span class="id">_</span> ] =&gt; <span class="id">exists</span> <span class="id">x</span>; <span class="tactic">split</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_unop_lessdef">eval_unop_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">v1</span> <span class="id">v1</span>' <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_unop">eval_unop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt; <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id">v1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="Cminor.html#eval_unop">eval_unop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id">v1</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7243')">Proof.</div>
<div class="proofscript" id="proof7243">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">v</span>; <span class="tactic">intros</span> <span class="id">EV</span> <span class="id">LD</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">EV</span>; <span class="id">TrivialExists</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_binop_lessdef">eval_binop_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">v1</span> <span class="id">v1</span>' <span class="id">v2</span> <span class="id">v2</span>' <span class="id">v</span> <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id">v1</span>' -&gt; <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id">v2</span>' -&gt; <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id">v1</span>' <span class="id">v2</span>' <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7244')">Proof.</div>
<div class="proofscript" id="proof7244">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">m</span>'; <span class="tactic">intros</span> <span class="id">EV</span> <span class="id">LD1</span> <span class="id">LD2</span> <span class="id">ME</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> <span class="id">op</span> <span class="id">v1</span>' <span class="id">v2</span>' <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id">v</span> <span class="id">v</span>').<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">LD1</span>. <span class="id">inv</span> <span class="id">LD2</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">destruct</span> <span class="id">v1</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">EV</span>; <span class="id">TrivialExists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">EV</span>; <span class="id">TrivialExists</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">CMPU</span>: <span class="kwd">forall</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> (<span class="id"><a href="Cminor.html#Ocmpu">Ocmpu</a></span> <span class="id"><a href="selection_proof.html#c">c</a></span>) <span class="id">v1</span> <span class="id">v2</span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>' : <span class="id"><a href="Values.html#val">val</a></span>, <span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> (<span class="id"><a href="Cminor.html#Ocmpu">Ocmpu</a></span> <span class="id"><a href="selection_proof.html#c">c</a></span>) <span class="id">v1</span>' <span class="id">v2</span>' <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id">v</span> <span class="id">v</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">c</span> <span class="id">A</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LD1</span>; <span class="id">inv</span> <span class="id">LD2</span>; <span class="tactic">try</span> (<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">v1</span>'; <span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">v2</span>'; <span class="id">inv</span> <span class="id">A</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> (<span class="id"><a href="Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span>) <span class="id">c</span> <span class="id">v1</span>' <span class="id">v2</span>') <span class="id">eqn</span>:<span class="id">R</span>; [|<span class="tactic">discriminate</span>] .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="Values.html#Val.cmpu_bool_lessdef">Val.cmpu_bool_lessdef</a></span> <span class="kwd">with</span> (<span class="id">valid_ptr</span>':= <span class="id"><a href="Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span>')<span class="kwd">in</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.valid_pointer_extends">Mem.valid_pointer_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">CMPLU</span>: <span class="kwd">forall</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> (<span class="id"><a href="Cminor.html#Ocmplu">Ocmplu</a></span> <span class="id"><a href="selection_proof.html#c">c</a></span>) <span class="id">v1</span> <span class="id">v2</span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>' : <span class="id"><a href="Values.html#val">val</a></span>, <span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> (<span class="id"><a href="Cminor.html#Ocmplu">Ocmplu</a></span> <span class="id"><a href="selection_proof.html#c">c</a></span>) <span class="id">v1</span>' <span class="id">v2</span>' <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id">v</span> <span class="id">v</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">c</span> <span class="id">A</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmplu">Val.cmplu</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#Val.cmplu_bool">Val.cmplu_bool</a></span> (<span class="id"><a href="Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span>) <span class="id">c</span> <span class="id">v1</span> <span class="id">v2</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">C</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>; <span class="id">inv</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Values.html#Val.cmplu_bool_lessdef">Val.cmplu_bool_lessdef</a></span> <span class="kwd">with</span> (<span class="id">valid_ptr</span>' := (<span class="id"><a href="Memory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">m</span>')) <span class="kwd">in</span> <span class="id">C</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Memory.html#Mem.valid_pointer_extends">Mem.valid_pointer_extends</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span>. <span class="id">exists</span> (<span class="id"><a href="Values.html#Val.of_bool">Val.of_bool</a></span> <span class="id">b</span>); <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_binop_lessdef_fp">eval_binop_lessdef_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">v1</span> <span class="id">v1</span>' <span class="id">v2</span> <span class="id">v2</span>' <span class="id">v</span> <span class="id">fp</span> <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_binop">eval_binop</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_op_footprint.html#eval_binop_fp">eval_binop_fp</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id">v1</span>' -&gt; <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id">v2</span>' -&gt; <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="Cminor_op_footprint.html#eval_binop_fp">eval_binop_fp</a></span> <span class="id"><a href="selection_proof.html#op">op</a></span> <span class="id">v1</span>' <span class="id">v2</span>' <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7245')">Proof.</div>
<div class="proofscript" id="proof7245">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">m</span>'; <span class="tactic">intros</span> <span class="id">EV</span> <span class="id">EF</span> <span class="id">LD1</span> <span class="id">LD2</span> <span class="id">ME</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LD1</span>. <span class="id">inv</span> <span class="id">LD2</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">destruct</span> <span class="id">v1</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">EV</span>; <span class="id">TrivialExists</span>; <span class="id">TrivFP</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v2</span>'; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="id">TrivialExists</span>; <span class="id">TrivFP</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt; <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="id">TrivialExists</span>; <span class="id">TrivFP</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="doc">TODO: lemma, mem_extend -&gt; weak_valid_pointer_fp/valid_pointer_fp subset </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Integers.html#Int.eq">Int.eq</a></span>, <span class="id"><a href="Values.html#Val.cmp_different_blocks">Val.cmp_different_blocks</a></span>; <span class="id">inv</span> <span class="id">EF</span>; <span class="id">TrivFP</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="MemOpFP.html#weak_valid_pointer_extend_subset">weak_valid_pointer_extend_subset</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Integers.html#Int.eq">Int.eq</a></span>, <span class="id"><a href="Values.html#Val.cmp_different_blocks">Val.cmp_different_blocks</a></span>; <span class="id">inv</span> <span class="id">EF</span>; <span class="id">TrivFP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="MemOpFP.html#weak_valid_pointer_extend_subset">weak_valid_pointer_extend_subset</a></span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>. <span class="id">inv</span> <span class="id">EF</span>. <span class="tactic">apply</span> <span class="id"><a href="selectop_proof.html#subset2_union">subset2_union</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_union_subset">FP.subset_union_subset</a></span>. <span class="tactic">apply</span> <span class="id"><a href="MemOpFP.html#weak_valid_pointer_extend_subset">weak_valid_pointer_extend_subset</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_union_subset">FP.subset_union_subset</a></span>, <span class="id"><a href="MemOpFP.html#weak_valid_pointer_extend_subset">weak_valid_pointer_extend_subset</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">EF</span>. <span class="id">TrivFP</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">destruct</span> <span class="id">v1</span>'; <span class="id">inv</span> <span class="id">EV</span>; <span class="tactic">simpl</span>; <span class="id">TrivialExists</span>; <span class="id">TrivFP</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">simpl</span>; <span class="id">TrivialExists</span>; <span class="id">TrivFP</span>; <span class="tactic">destruct</span> <span class="id">v2</span>'; <span class="id">inv</span> <span class="id">EV</span>. }<br/>
Qed.</div>
<br/>
<h1> Semantic preservation for instruction selection. </h1>
<br/>
<div class="doc">Relationship between the local environments. </div>
<span class="kwd">Definition</span> <span class="id"><a name="env_lessdef">env_lessdef</a></span> (<span class="id">e1</span> <span class="id">e2</span>: <span class="id"><a href="Cminor.html#env">env</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">v1</span>, <span class="id"><a href="selection_proof.html#e1">e1</a></span>!<span class="id"><a href="selection_proof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> -&gt; <span class="id">exists</span> <span class="id">v2</span>, <span class="id"><a href="selection_proof.html#e2">e2</a></span>!<span class="id"><a href="selection_proof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_var_lessdef">set_var_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">id</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e1">e1</a></span> <span class="id"><a href="selection_proof.html#e2">e2</a></span> -&gt; <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> (<span class="id"><a href="Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#e1">e1</a></span>) (<span class="id"><a href="Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#e2">e2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7246')">Proof.</div>
<div class="proofscript" id="proof7246">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gsspec">PTree.gsspec</a></span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v2</span>; <span class="tactic">split</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_optvar_lessdef">set_optvar_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">optid</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e1">e1</a></span> <span class="id"><a href="selection_proof.html#e2">e2</a></span> -&gt; <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> (<span class="id"><a href="Cminor.html#set_optvar">set_optvar</a></span> <span class="id"><a href="selection_proof.html#optid">optid</a></span> <span class="id"><a href="selection_proof.html#v1">v1</a></span> <span class="id"><a href="selection_proof.html#e1">e1</a></span>) (<span class="id"><a href="Cminor.html#set_optvar">set_optvar</a></span> <span class="id"><a href="selection_proof.html#optid">optid</a></span> <span class="id"><a href="selection_proof.html#v2">v2</a></span> <span class="id"><a href="selection_proof.html#e2">e2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7247')">Proof.</div>
<div class="proofscript" id="proof7247">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cminor.html#set_optvar">set_optvar</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">optid</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_var_lessdef">set_var_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_params_lessdef">set_params_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">il</span> <span class="id">vl1</span> <span class="id">vl2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="selection_proof.html#vl1">vl1</a></span> <span class="id"><a href="selection_proof.html#vl2">vl2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> (<span class="id"><a href="Cminor.html#set_params">set_params</a></span> <span class="id"><a href="selection_proof.html#vl1">vl1</a></span> <span class="id"><a href="selection_proof.html#il">il</a></span>) (<span class="id"><a href="Cminor.html#set_params">set_params</a></span> <span class="id"><a href="selection_proof.html#vl2">vl2</a></span> <span class="id"><a href="selection_proof.html#il">il</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7248')">Proof.</div>
<div class="proofscript" id="proof7248">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">il</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.gempty">PTree.gempty</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_var_lessdef">set_var_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_locals_lessdef">set_locals_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e1</span> <span class="id">e2</span>, <span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e1">e1</a></span> <span class="id"><a href="selection_proof.html#e2">e2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">il</span>, <span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> (<span class="id"><a href="Cminor.html#set_locals">set_locals</a></span> <span class="id"><a href="selection_proof.html#il">il</a></span> <span class="id"><a href="selection_proof.html#e1">e1</a></span>) (<span class="id"><a href="Cminor.html#set_locals">set_locals</a></span> <span class="id"><a href="selection_proof.html#il">il</a></span> <span class="id"><a href="selection_proof.html#e2">e2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7249')">Proof.</div>
<div class="proofscript" id="proof7249">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">il</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_var_lessdef">set_var_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Semantic preservation for expressions. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.EXPRESSIONS">EXPRESSIONS</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXPRESSIONS.hf">hf</a></span>: <span class="id"><a href="SplitLong.html#helper_functions">helper_functions</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.EXPRESSIONS.HF">HF</a></span>: <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.EXPRESSIONS.hf">hf</a></span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">TrivEval</span> := <span class="tactic">do</span> 2 <span class="id">eexists</span>; <span class="tactic">split</span>;[<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>|<span class="tactic">split</span>;[<span class="tactic">eauto</span>|<span class="tactic">split</span>;[<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>|<span class="id">TrivFP</span>]]].<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_expr_correct_fp">sel_expr_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">a</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_local.html#eval_expr_fp">Cminor_local.eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="Cminor.html#eval_expr">Cminor.eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>' <span class="id">le</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>' -&gt; <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>' <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>' <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_expr</span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_expr_fp">eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>' <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_expr</span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7250')">Proof.</div>
<div class="proofscript" id="proof7250">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;Evar&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]]. <span class="id">TrivEval</span>.<br/>
&nbsp;Econst&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">cst</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">FuncInv</span>; <span class="tactic">subst</span>; <span class="tactic">try</span> (<span class="id">TrivEval</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">i</span>), <span class="id"><a href="selection_proof.html#empfp">empfp</a></span>. <span class="tactic">split</span>. <span class="id">exploit</span> <span class="id"><a href="SelectLongproof.html#eval_longconst">eval_longconst</a></span>. <span class="tactic">intro</span>. <span class="id">evalge</span> <span class="id">H</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">gegen</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="selectlong_proof.html#eval_longconst_fp">eval_longconst_fp</a></span>. <span class="id">TrivFP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="selection_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="id">fold</span> (<span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id">i</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SelectOpproof.html#eval_addrsymbol">eval_addrsymbol</a></span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]]. <span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="selection_proof.html#empfp">empfp</a></span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_addrsymbol_fp">eval_addrsymbol_fp</a></span>. <span class="id">TrivFP</span>.<br/>
&nbsp;Eunop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_expr_fp</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_unop_lessdef">eval_unop_lessdef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">C</span> <span class="id">D</span>]]. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_sel_unop_fp">eval_sel_unop_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [[<span class="id">vo</span> [<span class="id">E</span> <span class="id">F</span>]] [<span class="id">fpo</span> [<span class="id">E</span>' <span class="id">F</span>']]]. <span class="id">TrivEval</span>.<br/>
<div class="doc">TODO: Cminor.eval_expr det </div>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">assert</span> (<span class="id">v2</span> = <span class="id">v1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_expr_det">Cminor_local.eval_expr_det</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Values.html#Val.lessdef_trans">Val.lessdef_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="selectop_proof.html#subset_trans">subset_trans</a></span> <span class="kwd">with</span> <span class="id">fp</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;Ebinop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_expr_fp1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_expr_fp2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v2</span>' &amp; <span class="id">fp2</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_binop_lessdef">eval_binop_lessdef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">E</span> <span class="id">F</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_binop_lessdef_fp">eval_binop_lessdef_fp</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H3</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">fp</span>' [<span class="id">E</span>' <span class="id">F</span>']].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_sel_binop_fp">eval_sel_binop_fp</a></span>. 2: <span class="id">eexact</span> <span class="id">A</span>. 3: <span class="id">eexact</span> <span class="id">C</span>. 1-5: <span class="tactic">eauto</span>. <span class="tactic">intros</span> [[<span class="id">vo</span> [<span class="id">G</span> <span class="id">I</span>]] [<span class="id">fpo</span> [<span class="id">G</span>' <span class="id">I</span>']]]. <span class="id">TrivEval</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">assert</span> (<span class="id">v3</span> = <span class="id">v1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_expr_det">Cminor_local.eval_expr_det</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">v4</span> = <span class="id">v2</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_expr_det">Cminor_local.eval_expr_det</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="id">inv</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Values.html#Val.lessdef_trans">Val.lessdef_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="selectop_proof.html#subset_trans">subset_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp1</span>' <span class="id">fp2</span>') <span class="id">fp</span>'); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="selectop_proof.html#subset2_union">subset2_union</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_assoc">FP.fp_union_assoc</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_union_subset">FP.subset_union_subset</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_assoc">FP.fp_union_assoc</a></span>, (<span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="id">fp1</span>), &lt;- <span class="id"><a href="Footprint.html#FP.fp_union_assoc">FP.fp_union_assoc</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_union_subset">FP.subset_union_subset</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span> <span class="id">fp3</span>). <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_union_subset">FP.subset_union_subset</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;Eload&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vaddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_expr_fp</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vaddr</span>' &amp; <span class="id">fpaddr</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>'). <span class="id">inv</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.loadv_extends">Mem.loadv_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_load_fp">eval_load_fp</a></span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">exact</span> <span class="id">A</span>'. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">E</span> <span class="id">F</span>]. <span class="id">TrivEval</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">assert</span> (<span class="id">vaddr</span> = <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">i</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_expr_det">Cminor_local.eval_expr_det</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H9</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="selectop_proof.html#subset2_union">subset2_union</a></span>; <span class="id">TrivFP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_exprlist_correct_fp">sel_exprlist_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">a</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_local.html#eval_exprlist_fp">Cminor_local.eval_exprlist_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="Cminor.html#eval_exprlist">Cminor.eval_exprlist</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>' <span class="id">le</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>' -&gt; <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>' <span class="id">fp</span>', <span class="id"><a href="CminorSel.html#eval_exprlist">eval_exprlist</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>' <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_exprlist</span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_exprlist_fp">eval_exprlist_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>' <span class="id"><a href="selection_proof.html#le">le</a></span> (<span class="id">sel_exprlist</span> <span class="id"><a href="selection_proof.html#a">a</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7251')">Proof.</div>
<div class="proofscript" id="proof7251">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Values.html#val">val</a></span>), <span class="id"><a href="selection_proof.html#empfp">empfp</a></span>. <span class="tactic">split</span>;[|<span class="tactic">split</span>;[<span class="tactic">auto</span>|<span class="tactic">split</span>;[|<span class="id">TrivFP</span>]]]; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_exprlist_fp</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vl</span>' &amp; <span class="id">fpl</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>' :: <span class="id">vl</span>'), (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp1</span>' <span class="id">fpl</span>'); <span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">assert</span> (<span class="id">v0</span> = <span class="id">v1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_expr_det">Cminor_local.eval_expr_det</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">vl0</span> = <span class="id">vl</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_exprlist_det">Cminor_local.eval_exprlist_det</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">subst</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="selectop_proof.html#subset2_union">subset2_union</a></span>; <span class="id">TrivFP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_builtin_arg_correct_fp">sel_builtin_arg_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">m</span> <span class="id">m</span>' <span class="id">a</span> <span class="id">v</span> <span class="id">fp</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>' -&gt; <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor.html#eval_expr">Cminor.eval_expr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_local.html#eval_expr_fp">Cminor_local.eval_expr_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>' <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel.html#eval_builtin_arg">CminorSel.eval_builtin_arg</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>' (<span class="id">sel_builtin_arg</span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#c">c</a></span>) <span class="id">v</span>' /\ <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CminorSel_local.html#eval_builtin_arg_fp">CminorSel_local.eval_builtin_arg_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>' (<span class="id">sel_builtin_arg</span> <span class="id"><a href="selection_proof.html#a">a</a></span> <span class="id"><a href="selection_proof.html#c">c</a></span>) <span class="id">fp</span>' /\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7252')">Proof.</div>
<div class="proofscript" id="proof7252">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">sel_builtin_arg</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">fp1</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v1</span>, <span class="id">fp1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AST.html#builtin_arg_ok">builtin_arg_ok</a></span> (<span class="id"><a href="SelectOp.html#builtin_arg">builtin_arg</a></span> (<span class="id">sel_expr</span> <span class="id">a</span>)) <span class="id">c</span>).<br/>
&nbsp;&nbsp;* <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="SelectOpproof.html#eval_builtin_arg">eval_builtin_arg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selectop_proof.html#eval_builtin_arg_fp">eval_builtin_arg_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;* <span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sel_builtin_args_correct_fp">sel_builtin_args_correct_fp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">e</span>' <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>' -&gt; <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_local.html#eval_exprlist_fp">Cminor_local.eval_exprlist_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#al">al</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span>, <span class="id"><a href="Cminor.html#eval_exprlist">Cminor.eval_exprlist</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#al">al</a></span> <span class="id"><a href="selection_proof.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cl</span>, <span class="id">exists</span> <span class="id">vl</span>' <span class="id">fpl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="CminorSel.html#eval_builtin_arg">CminorSel.eval_builtin_arg</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sel_builtin_args</span> <span class="id"><a href="selection_proof.html#al">al</a></span> <span class="id"><a href="selection_proof.html#cl">cl</a></span>) <span class="id">vl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="selection_proof.html#vl">vl</a></span> <span class="id">vl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="CminorSel_local.html#eval_builtin_arg_fp">CminorSel_local.eval_builtin_arg_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sel_builtin_args</span> <span class="id"><a href="selection_proof.html#al">al</a></span> <span class="id"><a href="selection_proof.html#cl">cl</a></span>) <span class="id">fpl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> <span class="id">fph</span> <span class="id">fpt</span> =&gt; <span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="selection_proof.html#fph">fph</a></span> <span class="id"><a href="selection_proof.html#fpt">fpt</a></span>) <span class="id"><a href="selection_proof.html#empfp">empfp</a></span> <span class="id">fpl</span>') <span class="id"><a href="selection_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7253')">Proof.</div>
<div class="proofscript" id="proof7253">
&nbsp;&nbsp;<span class="tactic">induction</span> 3; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Values.html#val">val</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>; <span class="tactic">split</span>; <span class="id">constructor</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>. <span class="id">TrivFP</span>.<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_builtin_arg_correct_fp">sel_builtin_arg_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id">IHeval_exprlist_fp</span> <span class="kwd">as</span> (<span class="id">vl</span>' &amp; <span class="id">fpl</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">v0</span> = <span class="id">v1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_expr_det">Cminor_local.eval_expr_det</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">vl</span> = <span class="id">vl1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="Cminor_local.html#eval_exprlist_det">Cminor_local.eval_exprlist_det</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">clear</span> <span class="id">H9</span> <span class="id">H11</span>. <span class="id">exists</span> (<span class="id">v1</span>' :: <span class="id">vl</span>'), (<span class="id">fp1</span>' :: <span class="id">fpl</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>; <span class="id">TrivFP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="selection_proof.html#PRESERVATION.EXPRESSIONS">EXPRESSIONS</a></span>.<br/>
<br/>
<div class="doc">Semantic preservation for functions and statements. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_cont">match_cont</a></span>: <span class="id"><a href="SplitLong.html#helper_functions">helper_functions</a></span> -&gt; <span class="id"><a href="Cminor.html#cont">Cminor.cont</a></span> -&gt; <span class="id"><a href="CminorSel.html#cont">CminorSel.cont</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_cont_stop">match_cont_stop</a></span>: <span class="kwd">forall</span> <span class="id">hf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="Cminor.html#Kstop">Cminor.Kstop</a></span> <span class="id"><a href="CminorSel.html#Kstop">Kstop</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_cont_seq">match_cont_seq</a></span>: <span class="kwd">forall</span> <span class="id">hf</span> <span class="id">s</span> <span class="id">s</span>' <span class="id">k</span> <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sel_stmt</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#s">s</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> (<span class="id"><a href="Cminor.html#Kseq">Cminor.Kseq</a></span> <span class="id"><a href="selection_proof.html#s">s</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>) (<span class="id"><a href="CminorSel.html#Kseq">Kseq</a></span> <span class="id">s</span>' <span class="id">k</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_cont_block">match_cont_block</a></span>: <span class="kwd">forall</span> <span class="id">hf</span> <span class="id">k</span> <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> (<span class="id"><a href="Cminor.html#Kblock">Cminor.Kblock</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>) (<span class="id"><a href="CminorSel.html#Kblock">Kblock</a></span> <span class="id">k</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_cont_call">match_cont_call</a></span>: <span class="kwd">forall</span> <span class="id">hf</span> <span class="id">hf</span>' <span class="id">id</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">k</span> <span class="id">f</span>' <span class="id">e</span>' <span class="id">k</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sel_function</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">f</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt; <span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id">hf</span>' (<span class="id"><a href="Cminor.html#Kcall">Cminor.Kcall</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>) (<span class="id"><a href="CminorSel.html#Kcall">Kcall</a></span> <span class="id"><a href="selection_proof.html#id">id</a></span> <span class="id">f</span>' <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">k</span>').<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_call_cont">match_call_cont</a></span> (<span class="id">k</span>: <span class="id"><a href="Cminor.html#cont">Cminor.cont</a></span>) (<span class="id">k</span>': <span class="id"><a href="CminorSel.html#cont">CminorSel.cont</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">hf</span>, <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>'.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="union_fp_list">union_fp_list</a></span> (<span class="id">fpl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>) : <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> <span class="id">fph</span> <span class="id">fpt</span> =&gt; <span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="selection_proof.html#fph">fph</a></span> <span class="id"><a href="selection_proof.html#fpt">fpt</a></span>) <span class="id"><a href="selection_proof.html#empfp">empfp</a></span> <span class="id"><a href="selection_proof.html#fpl">fpl</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_state">match_state</a></span>: <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Cminor_local.html#core">Cminor_local.core</a></span> * <span class="id"><a href="Memory.html#mem">mem</a></span> -&gt; <span class="id"><a href="CminorSel_local.html#core">CminorSel_local.core</a></span> * <span class="id"><a href="Memory.html#mem">mem</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="match_state_intro">match_state_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">fp</span>' <span class="id">hf</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>' <span class="id">sp</span> <span class="id">e</span> <span class="id">m</span> <span class="id">e</span>' <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HF</span>: <span class="id"><a href="splitlong_proof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TF</span>: <span class="id">sel_function</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">f</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TS</span>: <span class="id">sel_stmt</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#s">s</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">s</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MC</span>: <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LD</span>: <span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ME</span>: <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_state">match_state</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Cminor_local.html#Core_State">Cminor_local.Core_State</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#s">s</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span>, <span class="id"><a href="selection_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CminorSel_local.html#Core_State">Core_State</a></span> <span class="id">f</span>' <span class="id">s</span>' <span class="id">k</span>' <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>', <span class="id">m</span>')<br/>
| <span class="id"><a name="match_callstate">match_callstate</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">fp</span>' <span class="id">f</span> <span class="id">f</span>' <span class="id">args</span> <span class="id">args</span>' <span class="id">k</span> <span class="id">k</span>' <span class="id">m</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TF</span>: <span class="id"><a href="selection_proof.html#match_fundef">match_fundef</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id">f</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MC</span>: <span class="id"><a href="selection_proof.html#match_call_cont">match_call_cont</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LD</span>: <span class="id"><a href="Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="selection_proof.html#args">args</a></span> <span class="id">args</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ME</span>: <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_state">match_state</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Cminor_local.html#Core_Callstate">Cminor_local.Core_Callstate</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#args">args</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>, <span class="id"><a href="selection_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CminorSel_local.html#Core_Callstate">Core_Callstate</a></span> <span class="id">f</span>' <span class="id">args</span>' <span class="id">k</span>', <span class="id">m</span>')<br/>
| <span class="id"><a name="match_returnstate">match_returnstate</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">fp</span>' <span class="id">v</span> <span class="id">v</span>' <span class="id">k</span> <span class="id">k</span>' <span class="id">m</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MC</span>: <span class="id"><a href="selection_proof.html#match_call_cont">match_call_cont</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LD</span>: <span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id">v</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ME</span>: <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#fp">fp</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_state">match_state</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Cminor_local.html#Core_Returnstate">Cminor_local.Core_Returnstate</a></span> <span class="id"><a href="selection_proof.html#v">v</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>, <span class="id"><a href="selection_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CminorSel_local.html#Core_Returnstate">Core_Returnstate</a></span> <span class="id">v</span>' <span class="id">k</span>', <span class="id">m</span>')<br/>
<br/>
| <span class="id"><a name="match_builtin_1">match_builtin_1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">fp</span>' <span class="id">fpl</span> <span class="id">hf</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">args</span>' <span class="id">optid</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">e</span> <span class="id">k</span> <span class="id">m</span> <span class="id">al</span> <span class="id">f</span>' <span class="id">e</span>' <span class="id">k</span>' <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TF</span>: <span class="id">sel_function</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">f</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MC</span>: <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LDA</span>: <span class="id"><a href="Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="selection_proof.html#args">args</a></span> <span class="id">args</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LDE</span>: <span class="id"><a href="selection_proof.html#env_lessdef">env_lessdef</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id">e</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ME</span>: <span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EA</span>: <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="CminorSel.html#eval_builtin_arg">CminorSel.eval_builtin_arg</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>') <span class="id"><a href="selection_proof.html#al">al</a></span> <span class="id">args</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INLINE</span>: <span class="id"><a href="AST.html#ef_inline">ef_inline</a></span> <span class="id"><a href="selection_proof.html#ef">ef</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EAFP</span>: <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="CminorSel_local.html#eval_builtin_arg_fp">CminorSel_local.eval_builtin_arg_fp</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>' <span class="id">m</span>') <span class="id"><a href="selection_proof.html#al">al</a></span> <span class="id"><a href="selection_proof.html#fpl">fpl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">fp</span>' (<span class="id"><a href="selection_proof.html#union_fp_list">union_fp_list</a></span> <span class="id"><a href="selection_proof.html#fpl">fpl</a></span>)) <span class="id"><a href="selection_proof.html#fp">fp</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_state">match_state</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Cminor_local.html#Core_Callstate">Cminor_local.Core_Callstate</a></span> (<span class="id"><a href="AST.html#External">External</a></span> <span class="id"><a href="selection_proof.html#ef">ef</a></span>) <span class="id"><a href="selection_proof.html#args">args</a></span> (<span class="id"><a href="Cminor.html#Kcall">Cminor.Kcall</a></span> <span class="id"><a href="selection_proof.html#optid">optid</a></span> <span class="id"><a href="selection_proof.html#f">f</a></span> <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id"><a href="selection_proof.html#e">e</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>), <span class="id"><a href="selection_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CminorSel_local.html#Core_State">Core_State</a></span> <span class="id">f</span>' (<span class="id"><a href="CminorSel.html#Sbuiltin">Sbuiltin</a></span> (<span class="id">sel_builtin_res</span> <span class="id"><a href="selection_proof.html#optid">optid</a></span>) <span class="id"><a href="selection_proof.html#ef">ef</a></span> <span class="id"><a href="selection_proof.html#al">al</a></span>) <span class="id">k</span>' <span class="id"><a href="selection_proof.html#sp">sp</a></span> <span class="id">e</span>', <span class="id">m</span>').<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="MS">MS</a></span> <span class="id">b</span> <span class="id">n</span> <span class="id">mu</span> <span class="id">fp</span> <span class="id">fp</span>' <span class="id">cm</span> <span class="id">cm</span>': <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_state">match_state</a></span> <span class="id"><a href="selection_proof.html#fp">fp</a></span> <span class="id">fp</span>' <span class="id"><a href="selection_proof.html#cm">cm</a></span> <span class="id">cm</span>' /\<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">c</span>, <span class="id">m</span>) := <span class="id"><a href="selection_proof.html#cm">cm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">c</span>', <span class="id">m</span>') := <span class="id">cm</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="selection_proof.html#mu">mu</a></span>) <span class="id"><a href="selection_proof.html#b">b</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span>) /\<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="selection_proof.html#mu">mu</a></span>) <span class="id"><a href="selection_proof.html#b">b</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id"><a href="selection_proof.html#b">b</a></span>) /\<br/>
&nbsp;&nbsp;(<span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> <span class="id"><a href="selection_proof.html#mu">mu</a></span>) /\<br/>
&nbsp;&nbsp;(<span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id"><a href="selection_proof.html#mu">mu</a></span> <span class="id"><a href="selection_proof.html#m">m</a></span> <span class="id">m</span>') /\<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="selection_proof.html#c">c</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Cminor_local.html#Core_State">Cminor_local.Core_State</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="selection_proof.html#n">n</a></span> = 1%<span class="id">nat</span> /\ <span class="id"><a href="selection_proof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Cminor_local.html#Core_Callstate">Cminor_local.Core_Callstate</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="selection_proof.html#n">n</a></span> = 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Cminor_local.html#Core_Returnstate">Cminor_local.Core_Returnstate</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="selection_proof.html#n">n</a></span> = 2%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">invMS</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="selection_proof.html#MS">MS</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">cm1</span> ?<span class="id">cm2</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">cm1</span> <span class="kwd">as</span> [<span class="id">sc</span> <span class="id">Hm</span>]; <span class="tactic">destruct</span> <span class="id">cm2</span> <span class="kwd">as</span> [<span class="id">tc</span> <span class="id">Lm</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="selection_proof.html#MS">MS</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">MS</span> [<span class="id">SVALID</span> [<span class="id">TVALID</span> [<span class="id">AGMU</span> [<span class="id">RCPRESV</span> <span class="id">INDEX</span>]]]]]<br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="selection_proof.html#MS">MS</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">cm1</span> ?<span class="id">cm2</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="selection_proof.html#MS">MS</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">MS</span> [<span class="id">SVALID</span> [<span class="id">TVALID</span> [<span class="id">AGMU</span> [<span class="id">RCPRESV</span> <span class="id">INDEX</span>]]]]]<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="call_cont_commut">call_cont_commut</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">hf</span> <span class="id">k</span> <span class="id">k</span>', <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt; <span class="id"><a href="selection_proof.html#match_call_cont">match_call_cont</a></span> (<span class="id"><a href="Cminor.html#call_cont">Cminor.call_cont</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>) (<span class="id"><a href="CminorSel.html#call_cont">call_cont</a></span> <span class="id">k</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7254')">Proof.</div>
<div class="proofscript" id="proof7254">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">constructor</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#match_cont_call">match_cont_call</a></span> <span class="kwd">with</span> (<span class="id">hf</span> := <span class="id">hf</span>); <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="match_is_call_cont">match_is_call_cont</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">hf</span> <span class="id">k</span> <span class="id">k</span>', <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt; <span class="id"><a href="Cminor.html#is_call_cont">Cminor.is_call_cont</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> -&gt; <span class="id"><a href="selection_proof.html#match_call_cont">match_call_cont</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7255')">Proof.</div>
<div class="proofscript" id="proof7255">
&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">constructor</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#match_cont_call">match_cont_call</a></span> <span class="kwd">with</span> (<span class="id">hf</span> := <span class="id">hf</span>); <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="match_call_cont_cont">match_call_cont_cont</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">k</span>', <span class="id"><a href="selection_proof.html#match_call_cont">match_call_cont</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt; <span class="id">exists</span> <span class="id">hf</span>, <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7256')">Proof.</div>
<div class="proofscript" id="proof7256">
&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">simple</span> <span class="tactic">refine</span> (<span class="kwd">let</span> <span class="id">hf</span> : <span class="id"><a href="SplitLong.html#helper_functions">helper_functions</a></span> := <span class="id">_</span> <span class="kwd">in</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">hf</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="find_label_commut">find_label_commut</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">hf</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">k</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span> <span class="id">k</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">sel_stmt</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id"><a href="selection_proof.html#s">s</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Cminor.html#find_label">Cminor.find_label</a></span> <span class="id"><a href="selection_proof.html#lbl">lbl</a></span> <span class="id"><a href="selection_proof.html#s">s</a></span> <span class="id"><a href="selection_proof.html#k">k</a></span>, <span class="id"><a href="CminorSel.html#find_label">find_label</a></span> <span class="id"><a href="selection_proof.html#lbl">lbl</a></span> <span class="id">s</span>' <span class="id">k</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">s1</span>, <span class="id">k1</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">s1</span>', <span class="id">k1</span>') =&gt; <span class="id">sel_stmt</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id">s1</span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id">s1</span>' /\ <span class="id"><a href="selection_proof.html#match_cont">match_cont</a></span> <span class="id"><a href="selection_proof.html#hf">hf</a></span> <span class="id">k1</span> <span class="id">k1</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7257')">Proof.</div>
<div class="proofscript" id="proof7257">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">k</span>'; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">MC</span> <span class="id">SE</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">SE</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;store&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">store</span>. <span class="tactic">destruct</span> (<span class="id"><a href="SelectOp.html#addressing">addressing</a></span> <span class="id">m</span> (<span class="id">sel_expr</span> <span class="id">e</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;call&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classify_call</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id">e</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;tailcall&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classify_call</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id">e</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs1</span> (<span class="id"><a href="Cminor.html#Kseq">Cminor.Kseq</a></span> <span class="id">s2</span> <span class="id">k</span>)). <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Cminor.html#find_label">Cminor.find_label</a></span> <span class="id">lbl</span> <span class="id">s1</span> (<span class="id"><a href="Cminor.html#Kseq">Cminor.Kseq</a></span> <span class="id">s2</span> <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">sx</span> <span class="id">kx</span>] | ];<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CminorSel.html#find_label">find_label</a></span> <span class="id">lbl</span> <span class="id">x</span> (<span class="id"><a href="CminorSel.html#Kseq">Kseq</a></span> <span class="id">x0</span> <span class="id">k</span>')) <span class="kwd">as</span> [[<span class="id">sy</span> <span class="id">ky</span>] | ];<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">IHs2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;ifthenelse&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs1</span> <span class="id">k</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Cminor.html#find_label">Cminor.find_label</a></span> <span class="id">lbl</span> <span class="id">s1</span> <span class="id">k</span>) <span class="kwd">as</span> [[<span class="id">sx</span> <span class="id">kx</span>] | ];<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CminorSel.html#find_label">find_label</a></span> <span class="id">lbl</span> <span class="id">x</span> <span class="id">k</span>') <span class="kwd">as</span> [[<span class="id">sy</span> <span class="id">ky</span>] | ];<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">IHs2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;loop&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;block&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHs</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;switch&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="Integers.html#Int64.modulus">Int64.modulus</a></span> <span class="id">n</span> <span class="id">l</span> (<span class="id">compile_switch</span> <span class="id"><a href="Integers.html#Int64.modulus">Int64.modulus</a></span> <span class="id">n</span> <span class="id">l</span>)); <span class="id">inv</span> <span class="id">SE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span> <span class="id">n</span> <span class="id">l</span> (<span class="id">compile_switch</span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span> <span class="id">n</span> <span class="id">l</span>)); <span class="id">inv</span> <span class="id">SE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;return&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">o</span>; <span class="id">inv</span> <span class="id">SE</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;label&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AST.html#ident_eq">ident_eq</a></span> <span class="id">lbl</span> <span class="id">l</span>). <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">IHs</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">Ex_index</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Cminor_local.html#Core_State">Cminor_local.Core_State</a></span>] =&gt; <span class="id">exists</span> 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Cminor_local.html#Core_Callstate">Cminor_local.Core_Callstate</a></span>] =&gt; <span class="id">exists</span> 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Cminor_local.html#Core_Returnstate">Cminor_local.Core_Returnstate</a></span>] =&gt; <span class="id">exists</span> 2%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">resolvfp</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">_</span> <span class="id"><a href="selection_proof.html#empfp">empfp</a></span>] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="selection_proof.html#empfp">empfp</a></span> <span class="id">_</span>] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.emp_union_fp">FP.emp_union_fp</a></span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp1</span>' ?<span class="id">fp1</span> |- <span class="id">Injections.FPMatch</span>' ?<span class="id">mu</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span> <span class="id">_</span>) (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span>' <span class="id">_</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Injections.fp_match_union</span>'; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp1</span>' ?<span class="id">fp1</span> |- <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span>' <span class="id">_</span>) (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span> <span class="id">_</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp1</span>' ?<span class="id">fp1</span> |- <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span>' <span class="id">_</span>) <span class="id">_</span>) (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span> <span class="id">_</span>) <span class="id">_</span>)=&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp</span> ?<span class="id">fp</span>' |- <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span> ?<span class="id">fp</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp</span> ?<span class="id">fp</span>' |- <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp</span>' <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_union_subset">FP.subset_union_subset</a></span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="selection_proof.html#empfp">empfp</a></span> =&gt; <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'<br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp1</span> ?<span class="id">fp2</span> |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> ?<span class="id">fp2</span> ?<span class="id">fp1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_subset_T</span>' <span class="kwd">with</span> <span class="id">fp2</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H</span>; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp2</span> ?<span class="id">fp1</span> |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp1</span> <span class="id">_</span>) ?<span class="id">fp2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_union_S</span>'; <span class="id">resolvfp</span><br/>
&nbsp;&nbsp;| |- <span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> ?<span class="id">fp</span> ?<span class="id">fp</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> ?<span class="id">fp</span> ?<span class="id">fp</span> =&gt; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#fp_match_id">fp_match_id</a></span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">eresolvfp</span>:= <span class="id">resolvfp</span>; <span class="tactic">eauto</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">resvalid</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
<div class="doc">valid blocks </div>
&nbsp;&nbsp;| <span class="id">H</span>: (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> ?<span class="id">S</span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> ?<span class="id">m1</span> <span class="id"><a href="selection_proof.html#x">x</a></span>), <span class="id">H</span>': <span class="id"><a href="Memory.html#Mem.free">Mem.free</a></span> ?<span class="id">m1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">m2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> ?<span class="id">S</span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> ?<span class="id">m2</span> <span class="id"><a href="selection_proof.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">X</span>; <span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">X</span>; <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.valid_block_free_1">Mem.valid_block_free_1</a></span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> ?<span class="id">S</span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> ?<span class="id">m1</span> <span class="id"><a href="selection_proof.html#x">x</a></span>), <span class="id">H</span>': <span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> ?<span class="id">m1</span> <span class="id">_</span> <span class="id">_</span> = (?<span class="id">m2</span>,<span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> ?<span class="id">S</span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> ?<span class="id">m2</span> <span class="id"><a href="selection_proof.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">X</span>; <span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">X</span>; <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.valid_block_alloc">Mem.valid_block_alloc</a></span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> ?<span class="id">S</span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> ?<span class="id">m1</span> <span class="id"><a href="selection_proof.html#x">x</a></span>), <span class="id">H</span>': <span class="id"><a href="Memory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> ?<span class="id">m1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">m2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> ?<span class="id">S</span> <span class="id"><a href="selection_proof.html#x">x</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> ?<span class="id">m2</span> <span class="id"><a href="selection_proof.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">X</span>; <span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">X</span>; <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span><br/>
<div class="doc">Mem inv </div>
&nbsp;&nbsp;| <span class="id">H1</span>: <span class="id"><a href="Memory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> ?<span class="id">m1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">m2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>: <span class="id"><a href="Memory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> ?<span class="id">m1</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H3</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id">_</span> ?<span class="id">m2</span> ?<span class="id">m2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#store_val_inject_unmapped_closed_preserved">MemClosures_local.store_val_inject_unmapped_closed_preserved</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>);  <span class="tactic">try</span> <span class="id">eassumption</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">compute</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>); <span class="tactic">try</span> <span class="tactic">omega</span><br/>
&nbsp;&nbsp;| <span class="id">H1</span>: <span class="id"><a href="Memory.html#Mem.free">Mem.free</a></span> ?<span class="id">m1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">m2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>: <span class="id"><a href="Memory.html#Mem.free">Mem.free</a></span> ?<span class="id">m1</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ?<span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H3</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id">_</span> ?<span class="id">m2</span> ?<span class="id">m2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#free_inject_unmapped_closed_preserved">MemClosures_local.free_inject_unmapped_closed_preserved</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>);  <span class="tactic">try</span> <span class="id">eassumption</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">compute</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>); <span class="tactic">try</span> <span class="tactic">omega</span><br/>
&nbsp;&nbsp;| <span class="id">H1</span>: <span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> ?<span class="id">m1</span> <span class="id">_</span> <span class="id">_</span> = (?<span class="id">m2</span>, <span class="id">_</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span>: <span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> ?<span class="id">m1</span>' <span class="id">_</span> <span class="id">_</span> = (?<span class="id">m2</span>', <span class="id">_</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H3</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id">_</span> ?<span class="id">m2</span> ?<span class="id">m2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">Right</span> := <span class="id">right</span>; <span class="id">Ex_index</span>; <span class="tactic">do</span> 3 <span class="id">eexists</span>; <span class="tactic">split</span>; [<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>|<span class="id">resolvfp</span>].<br/>
<span class="kwd">Ltac</span> <span class="id">FP</span>:= <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">P</span> /\ <span class="id">_</span> =&gt; <span class="tactic">assert</span> <span class="id">P</span>; [<span class="id">eresolvfp</span>| <span class="tactic">try</span> (<span class="tactic">split</span>;[<span class="tactic">auto</span>; <span class="tactic">fail</span>|])] <span class="kwd">end</span>.<br/>
<span class="kwd">Ltac</span> <span class="id">Left</span> := <span class="id">left</span>; <span class="id">Ex_index</span>; <span class="tactic">split</span>; [<span class="tactic">auto</span>|<span class="id">eresolvfp</span>].<br/>
<span class="kwd">Ltac</span> <span class="id">splitMS</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;[<span class="id">econstructor</span>; <span class="id">eresolvfp</span> |<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;[<span class="tactic">try</span> <span class="id">resvalid</span>; <span class="tactic">auto</span> |<span class="tactic">split</span>; [<span class="tactic">try</span> <span class="id">resvalid</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="tactic">split</span>; [<span class="tactic">auto</span>| <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">resvalid</span>; <span class="tactic">eauto</span>]]]].<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="TRANSF_local_ldsim">TRANSF_local_ldsim</a></span>:<br/>
&nbsp;&nbsp;@<span class="id"><a href="LDSim_local.html#local_ldsim">local_ldsim</a></span> <span class="id"><a href="Cminor_local.html#Cminor_IS">Cminor_IS</a></span> <span class="id"><a href="CminorSel_local.html#CminorSel_IS">CminorSel_IS</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7258')">Proof.</div>
<div class="proofscript" id="proof7258">
&nbsp;&nbsp;<span class="tactic">eapply</span> (@<span class="id"><a href="LDSim_local.html#Local_ldsim">Local_ldsim</a></span> <span class="id"><a href="Cminor_local.html#Cminor_IS">Cminor_IS</a></span> <span class="id"><a href="CminorSel_local.html#CminorSel_IS">CminorSel_IS</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span>%<span class="id">nat</span> <span class="id"><a href="selection_proof.html#MS">MS</a></span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;index&nbsp;wf&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf">lt_wf</a></span>.<br/>
&nbsp;wd_mu&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="id">invMS</span>. <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;inj&nbsp;ge&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="id">invMS</span>; <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_ge_init_inj">proper_mu_ge_init_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;ge&nbsp;match&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#ge_match">ge_match</a></span>.<br/>
&nbsp;initial&nbsp;call&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">mu</span> <span class="id">fid</span> <span class="id">args</span> <span class="id">args</span>' <span class="id">score</span> <span class="id">GE_INIT_INJ</span> <span class="id">INJID</span> <span class="id">GARG</span> <span class="id">ARGREL</span> <span class="id">INITCORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#init_core_local">init_core_local</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cminor_local.html#init_core">Cminor_local.init_core</a></span>, <span class="id"><a href="CminorSel_local.html#init_core">init_core</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#generic_init_core">generic_init_core</a></span> <span class="kwd">in</span> <span class="id">INITCORE</span> |- * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="selection_proof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">fid</span>) <span class="id">eqn</span>: <span class="id">FIND</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">b</span>) <span class="id">eqn</span>: <span class="id">FINDB</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tf</span> &amp; <span class="id">FINDB</span>' &amp; (<span class="id">hf</span> &amp; <span class="id">HF</span> &amp; <span class="id">MATCHF</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">FINDB</span>'. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cminor_local.html#fundef_init">Cminor_local.fundef_init</a></span> <span class="kwd">in</span> <span class="id">INITCORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">tfd</span>, <span class="id">tf</span> = <span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="selection_proof.html#tfd">tfd</a></span>)  <span class="kwd">as</span> [<span class="id">tfd</span> <span class="id">INTERNAL</span>] <span class="tactic">by</span> (<span class="id">monadInv</span> <span class="id">MATCHF</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CminorSel_local.html#fundef_init">fundef_init</a></span>. <span class="id">erewrite</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>;[|<span class="id">eexists</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="id">args</span> (<span class="id"><a href="AST.html#sig_args">sig_args</a></span> (<span class="id"><a href="Cminor.html#funsig">Cminor.funsig</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id">f</span>)))) <span class="id">eqn</span>: <span class="id">WDARGS</span>; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="val_casted.html#wd_args_inject">wd_args_inject</a></span>; <span class="tactic">eauto</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">sm0</span> <span class="id">tm0</span> <span class="id">INITSM</span> <span class="id">INITTM</span> <span class="id">MEMINITINJ</span> <span class="id">sm</span> <span class="id">tm</span> [<span class="id">HRELY</span> <span class="id">LRELY</span> <span class="id">MINJ</span>]. <span class="id">exists</span> 0%<span class="id">nat</span>. <span class="id">inv</span> <span class="id">INITCORE</span>.<br/>
<div class="doc">This could be a general purposed lemma... </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">args</span>' = <span class="id">args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">ARGREL</span> <span class="id">GARG</span> <span class="id">MEMINITINJ</span>; <span class="tactic">clear</span>. <span class="id">revert</span> <span class="id">args</span>'. <span class="tactic">induction</span> <span class="id">args</span>; <span class="tactic">intros</span> <span class="id">args</span>' <span class="id">REL</span> <span class="id">G</span> <span class="id">MEMREL</span>; <span class="id">inv</span> <span class="id">REL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">G</span>. <span class="tactic">f_equal</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">MEMREL</span>. <span class="tactic">apply</span> <span class="id">inj_inject_id</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>. <span class="tactic">apply</span> <span class="id">IHargs</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">args</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>; [<span class="id">eexists</span>;<span class="tactic">eauto</span>|]. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">eexists</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span>; <span class="tactic">induction</span> <span class="id">args</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MEMINITINJ</span>. <span class="id">inv</span> <span class="id">HRELY</span>. <span class="id">inv</span> <span class="id">LRELY</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#inject_implies_extends">inject_implies_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">b0</span> <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">EQNEXT</span>, &lt;- <span class="id">dom_eq_src</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [<span class="id">b</span>' <span class="id">A</span>]. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">GE_INIT_INJ</span>. <span class="tactic">rewrite</span> <span class="id">mu_shared_src</span> <span class="kwd">in</span> <span class="id">dom_eq_src</span>. <span class="tactic">rewrite</span> <span class="id">mu_shared_tgt</span> <span class="kwd">in</span> <span class="id">dom_eq_tgt</span>. <span class="tactic">rewrite</span> <span class="id"><a href="selection_proof.html#PRESERVATION.S_EQ">S_EQ</a></span> <span class="kwd">in</span> <span class="id">dom_eq_src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sm0</span>) &lt;-&gt; <span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="selection_proof.html#b">b</a></span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">tm0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">dom_eq_src</span>, &lt;- <span class="id">dom_eq_tgt</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQNEXT</span>, <span class="id">EQNEXT0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_total">Pos.lt_total</a></span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sm0</span>) (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">tm0</span>)) <span class="kwd">as</span> [<span class="id">LT</span> | [<span class="id">EQ</span> | <span class="id">LT</span>]]; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">generalize</span> <span class="id">H4</span> <span class="id">LT</span>; <span class="tactic">clear</span>; <span class="tactic">intros</span>; <span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">LT</span>; <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_irrefl">Pos.lt_irrefl</a></span>; <span class="tactic">eauto</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">FP.subset_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMINITINJ</span>. <span class="id">inv</span> <span class="id">HRELY</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">EQNEXT</span>. <span class="tactic">apply</span> <span class="id">dom_eq_src</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMINITINJ</span>. <span class="id">inv</span> <span class="id">LRELY</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">EQNEXT</span>. <span class="tactic">apply</span> <span class="id">dom_eq_tgt</span>; <span class="tactic">auto</span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMINITINJ</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? ? ? . <span class="id">exploit</span> <span class="id">inj_inject_id</span>. <span class="tactic">exact</span> <span class="id">H0</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">A</span>. <span class="id">inv</span> <span class="id">A</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="MemClosures_local.html#reach_closed_unmapped_closed">MemClosures_local.reach_closed_unmapped_closed</a></span>. <span class="id">inv</span> <span class="id">LRELY</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;tau&nbsp;step*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">Hfp</span>' <span class="id">Hcore</span>' <span class="id">Hm</span>' <span class="id">MS</span> <span class="id">STEP</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">MS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">STEP</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">Lm</span>; <span class="tactic">intros</span> <span class="id">MS</span>'; <span class="id">invMS</span>; <span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">try</span> (<span class="id">monadInv</span> <span class="id">TS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;skip&nbsp;seq&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MC</span>. <span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;skip&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MC</span>. <span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;skip&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.free_parallel_extends">Mem.free_parallel_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">MC</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="id">erewrite</span> <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#match_is_call_cont">match_is_call_cont</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;assign&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_var_lessdef">set_var_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;store&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vaddr</span>' &amp; <span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">fp2</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.storev_extends">Mem.storev_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#eval_store_fp">eval_store_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vaddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">inv</span> <span class="id">B</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>, <span class="id">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">FP</span>. <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="id">resolvfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Scall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#classify_call_correct">classify_call_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classify_call</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) <span class="id">a</span>) <span class="kwd">as</span> [ | <span class="id">id</span> | <span class="id">ef</span>] <span class="id">eqn</span>:<span class="id">CC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="comment">(*&nbsp;indirect&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vf</span>' &amp; <span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_exprlist_correct_fp">sel_exprlist_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vargs</span>' &amp; <span class="id">fp2</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">fd</span>' &amp; <span class="id">U</span> &amp; <span class="id">V</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">FP</span>. <span class="id">splitMS</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#match_cont_call">match_cont_call</a></span> <span class="kwd">with</span> (<span class="id">hf</span> := <span class="id">hf</span>); <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="comment">(*&nbsp;direct&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">b</span> [<span class="id">U</span> <span class="id">V</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_exprlist_correct_fp">sel_exprlist_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vargs</span>' &amp; <span class="id">fp2</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">fd</span>' &amp; <span class="id">X</span> &amp; <span class="id">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">vf</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="selection_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="selection_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">FP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_union_S</span>'; <span class="id">resolvfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#match_cont_call">match_cont_call</a></span> <span class="kwd">with</span> (<span class="id">hf</span> := <span class="id">hf</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="comment">(*&nbsp;turned&nbsp;into&nbsp;Sbuiltin&nbsp;*)</span><br/>
&nbsp;which&nbsp;we&nbsp;do&nbsp;not&nbsp;support&nbsp;currently&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>. <span class="tactic">subst</span> <span class="id">fd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">INLINE</span>: <span class="id"><a href="AST.html#ef_inline">ef_inline</a></span> <span class="id">ef</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">CC</span>; <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id">classify_call</span>, <span class="id"><a href="AST.html#ef_inline">ef_inline</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>, <span class="id">ef</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_builtin_args_correct_fp">sel_builtin_args_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vargs</span>' &amp; <span class="id">fp2</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Left</span>. <span class="tactic">destruct</span> <span class="id">INDEX</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>); <span class="id">resolvfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Stailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.free_parallel_extends">Mem.free_parallel_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span> <span class="kwd">in</span> <span class="id">P</span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vf</span>' &amp; <span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_exprlist_correct_fp">sel_exprlist_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vargs</span>' &amp; <span class="id">fp2</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">C</span>' &amp; <span class="id">D</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">fd</span>' &amp; <span class="id">E</span> &amp; <span class="id">F</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">exploit</span> <span class="id"><a href="selection_proof.html#classify_call_correct">classify_call_correct</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classify_call</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>)) <span class="kwd">as</span> [ | <span class="id">id</span> | <span class="id">ef</span>] <span class="id">eqn</span>:<span class="id">CC</span>; <span class="tactic">intros</span>.<br/>
&nbsp;*)</span><span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;*)</span> <span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">b</span> [<span class="id">U</span> <span class="id">V</span>]]. <span class="tactic">subst</span> <span class="id">vf</span>. <span class="id">inv</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> <span class="id"><a href="selection_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">rewrite</span> <span class="id"><a href="selection_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fp1</span>' = <span class="id"><a href="selection_proof.html#empfp">empfp</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">CC</span> <span class="id">A</span>'; <span class="tactic">clear</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">classify_call</span> <span class="kwd">in</span> <span class="id">CC</span>. <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">CC</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">CC</span>: <span class="id">context</span>[<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">unfold</span> <span class="id"><a href="SelectOp.html#addrsymbol">addrsymbol</a></span>, <span class="id"><a href="SelectOp.html#Olea_ptr">Olea_ptr</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">InvEvalFP</span>; <span class="id">InvEval</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">FuncInv</span>; <span class="tactic">subst</span>; <span class="id">TrivFP</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">TrivFP</span>.<br/>
&nbsp;*)</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">FP</span>. <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="id">resolvfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#call_cont_commut">call_cont_commut</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Seq&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">constructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sifthenelse&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.bool_of_val">Val.bool_of_val</a></span> <span class="id">v</span>' <span class="id">b</span>). <span class="id">inv</span> <span class="id">B</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#eval_condexpr_of_expr_fp">eval_condexpr_of_expr_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">C</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sloop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sblock&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sexit&nbsp;seq&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MC</span>. <span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sexit0&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MC</span>. <span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;SexitS&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MC</span>. <span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sswitch&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">TS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">set</span> (<span class="id">ct</span> := <span class="id">compile_switch</span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span> <span class="id">default</span> <span class="id">cases</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span> <span class="id">default</span> <span class="id">cases</span> <span class="id">ct</span>) <span class="id">eqn</span>:<span class="id">VALID</span>; <span class="id">inv</span> <span class="id">TS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>'). <span class="id">inv</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_switch_int_correct_fp">sel_switch_int_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">C</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="tactic">set</span> (<span class="id">ct</span> := <span class="id">compile_switch</span> <span class="id"><a href="Integers.html#Int64.modulus">Int64.modulus</a></span> <span class="id">default</span> <span class="id">cases</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Switch.html#validate_switch">validate_switch</a></span> <span class="id"><a href="Integers.html#Int64.modulus">Int64.modulus</a></span> <span class="id">default</span> <span class="id">cases</span> <span class="id">ct</span>) <span class="id">eqn</span>:<span class="id">VALID</span>; <span class="id">inv</span> <span class="id">TS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">A</span>' &amp; <span class="id">B</span>'). <span class="id">inv</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_switch_long_correct_fp">sel_switch_long_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">C</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sreturn&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.free_parallel_extends">Mem.free_parallel_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span> <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#call_cont_commut">call_cont_commut</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sreturn&nbsp;Some&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.free_parallel_extends">Mem.free_parallel_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="selection_proof.html#stackspace_function_translated">stackspace_function_translated</a></span> <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="selection_proof.html#sel_expr_correct_fp">sel_expr_correct_fp</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">fp</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">A</span>' <span class="id">B</span>']]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#call_cont_commut">call_cont_commut</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Slabel&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Sgoto&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sel_stmt</span> (<span class="id"><a href="CUAST.html#comp_unit_defmap">comp_unit_defmap</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.scu">scu</a></span>) (<span class="id"><a href="Cminor.html#fn_body">Cminor.fn_body</a></span> <span class="id">f</span>) = <span class="id"><a href="Errors.html#OK">OK</a></span> (<span class="id"><a href="CminorSel.html#fn_body">fn_body</a></span> <span class="id">f</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">monadInv</span> <span class="id">TF</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="selection_proof.html#find_label_commut">find_label_commut</a></span> <span class="id">hf</span> <span class="id">lbl</span> (<span class="id"><a href="Cminor.html#fn_body">Cminor.fn_body</a></span> <span class="id">f</span>) (<span class="id"><a href="Cminor.html#call_cont">Cminor.call_cont</a></span> <span class="id">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#call_cont_commut">call_cont_commut</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CminorSel.html#find_label">find_label</a></span> <span class="id">lbl</span> (<span class="id"><a href="CminorSel.html#fn_body">fn_body</a></span> <span class="id">f</span>') (<span class="id"><a href="CminorSel.html#call_cont">call_cont</a></span> <span class="id">k</span>'0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">s</span>'' <span class="id">k</span>'']|] <span class="id">eqn</span>:?; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>. <span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;internal&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">TF</span> <span class="kwd">as</span> (<span class="id">hf</span> &amp; <span class="id">HF</span> &amp; <span class="id">TF</span>). <span class="id">specialize</span> (<span class="id">MC</span> <span class="id">hf</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">TF</span>. <span class="tactic">generalize</span> <span class="id">EQ</span>; <span class="tactic">intros</span> <span class="id">TF</span>; <span class="id">monadInv</span> <span class="id">TF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.alloc_extends">Mem.alloc_extends</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_refl">Zle_refl</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_refl">Zle_refl</a></span>. <span class="tactic">intros</span> [<span class="id">m2</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">FP</span>. <span class="tactic">unfold</span> <span class="id"><a href="MemOpFP.html#alloc_fp">alloc_fp</a></span>. <span class="id">erewrite</span> <span class="id"><a href="Memory.html#Mem.mext_next">Mem.mext_next</a></span>; <span class="tactic">eauto</span>. <span class="id">resolvfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_locals_lessdef">set_locals_lessdef</a></span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_params_lessdef">set_params_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="MemOpFP.html#alloc_fp">alloc_fp</a></span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="Memory.html#Mem.mext_next">Mem.mext_next</a></span>; <span class="tactic">eauto</span>. <span class="id">resolvfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#match_call_cont_cont">match_call_cont_cont</a></span> <span class="kwd">in</span> <span class="id">MC</span>. <span class="tactic">destruct</span> <span class="id">MC</span> <span class="kwd">as</span> (<span class="id">hf0</span> &amp; <span class="id">MC</span>). <span class="id">inv</span> <span class="id">MC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Right</span>. <span class="id">econstructor</span>. <span class="id">FP</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">optid</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#set_var_lessdef">set_var_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;at&nbsp;external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Cminor_local.html#at_external">Cminor_local.at_external</a></span>, <span class="id"><a href="CminorSel_local.html#at_external">at_external</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">f</span> <span class="id">sg</span> <span class="id">argSrc</span> <span class="id">MS</span> <span class="id">ATEXT</span> <span class="id">RC</span> <span class="id">GARG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">f0</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">e</span> <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CUAST.html#invert_symbol_from_string">invert_symbol_from_string</a></span> <span class="id"><a href="selection_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">name</span>) <span class="id">eqn</span>:<span class="id">SYMBNAME</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">discriminate</span>. <span class="id">inv</span> <span class="id">ATEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invMS</span>; <span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">TF</span> <span class="kwd">as</span> [<span class="id">hf0</span> [<span class="id">HF0</span> <span class="id">SEL</span>]]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEL</span>. <span class="id">inv</span> <span class="id">SEL</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="CUAST.html#match_genvs_invert_symbol_from_string_preserved">match_genvs_invert_symbol_from_string_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Ex_index</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">simpl</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="LDSimDefs.html#arg_rel">LDSimDefs.arg_rel</a></span>. <span class="id">revert</span> <span class="id">args</span>' <span class="id">AGMU</span> <span class="id">LD</span> <span class="id">GARG</span>; <span class="tactic">clear</span>.<br/>
<div class="doc">should be extracted as a lemma ... </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">argSrc</span>; <span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">LD</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">LD</span>. <span class="id">inv</span> <span class="id">GARG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">clear</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">IHargSrc</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">v2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>. <span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">econstructor</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>; <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unmapped_closed_reach_closed_preserved_by_extends">MemClosures_local.unmapped_closed_reach_closed_preserved_by_extends</a></span>; <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">eresolvfp</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#extends_reach_closed_implies_inject">extends_reach_closed_implies_inject</a></span>; <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">splitMS</span>. <span class="id">eexists</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_cu_match_genv">match_cu_match_genv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">hf</span>' [<span class="id">HF</span>' <span class="id">SEL</span>']]. <span class="tactic">destruct</span> <span class="id">f1</span>; <span class="id">monadInv</span> <span class="id">SEL</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;after&nbsp;external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Cminor_local.html#after_external">Cminor_local.after_external</a></span>, <span class="id"><a href="CminorSel_local.html#after_external">after_external</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">oresSrc</span> <span class="id">Hcore</span>' <span class="id">oresTgt</span> <span class="id">MS</span> <span class="id">GRES</span> <span class="id">AFTEXT</span> <span class="id">RESREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hcore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invMS</span>; <span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">TF</span> <span class="kwd">as</span> [<span class="id">hf0</span> [<span class="id">HF0</span> <span class="id">TF</span>]]. <span class="id">monadInv</span> <span class="id">TF</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hcore</span>' = <span class="id"><a href="Cminor_local.html#Core_Returnstate">Cminor_local.Core_Returnstate</a></span> (<span class="kwd">match</span> <span class="id">oresSrc</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id">v</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span> <span class="kwd">end</span>) <span class="id">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">oresSrc</span>, (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>); <span class="id">inv</span> <span class="id">AFTEXT</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="val_casted.html#val_has_type_func">val_has_type_func</a></span> <span class="id">v</span> <span class="id">t</span>); <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>. } <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">match</span> <span class="id">oresSrc</span>, (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> =&gt; <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id">v</span> <span class="id">ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="kwd">as</span> <span class="id">HRES</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">oresSrc</span>, (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>); <span class="id">inv</span> <span class="id">AFTEXT</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="val_casted.html#val_has_type_func">val_has_type_func</a></span> <span class="id">v</span> <span class="id">t</span>) <span class="id">eqn</span>:<span class="id">A</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="val_casted.html#val_has_type_funcP">val_has_type_funcP</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">AFTEXT</span>. <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">AFTEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CminorSel_local.html#Core_Returnstate">Core_Returnstate</a></span> (<span class="kwd">match</span> <span class="id">oresTgt</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id">v</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span> <span class="kwd">end</span>) <span class="id">k</span>'). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">oresSrc</span>, <span class="id">oresTgt</span>, (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>); <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">RESREL</span>; <span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">HRES</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hm</span>' <span class="id">Lm</span>' [<span class="id">HRELY</span> <span class="id">LRELY</span> <span class="id">INV</span>]. <span class="tactic">subst</span>. <span class="id">Ex_index</span>. <span class="id">splitMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">oresSrc</span>, (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>), <span class="id">oresTgt</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">RESREL</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">apply</span> <span class="id">proper_mu_inject_incr</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#extends_rely_extends">extends_rely_extends</a></span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">SVALID</span> <span class="kwd">in</span> <span class="id">S</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">HRELY</span>. <span class="tactic">rewrite</span> <span class="id">EQNEXT</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">T</span>. <span class="tactic">apply</span> <span class="id">TVALID</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">LRELY</span>. <span class="tactic">rewrite</span> <span class="id">EQNEXT</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LRELY</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#reach_closed_unmapped_closed">MemClosures_local.reach_closed_unmapped_closed</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;halt&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Cminor_local.html#halted">Cminor_local.halted</a></span>, <span class="id"><a href="CminorSel_local.html#halted">halted</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">resSrc</span> <span class="id">MS</span> <span class="id">HALT</span> <span class="id">RC</span> <span class="id">GRES</span>. <span class="tactic">destruct</span> <span class="id">Hcore</span>, <span class="id">k</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HALT</span>. <span class="id">invMS</span>; <span class="id">inv</span> <span class="id">MS</span>.  <span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#match_call_cont_cont">match_call_cont_cont</a></span> <span class="kwd">in</span> <span class="id">MC</span>. <span class="tactic">destruct</span> <span class="id">MC</span> <span class="kwd">as</span> (<span class="id">hf0</span> &amp; <span class="id">MC</span>). <span class="id">inv</span> <span class="id">MC</span>. <span class="id">exists</span> <span class="id">resSrc</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. { <span class="tactic">f_equal</span>. <span class="id">inv</span> <span class="id">LD</span>; <span class="tactic">auto</span>. <span class="id">contradiction</span>. } <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">AGMU</span> <span class="id">GRES</span>. <span class="tactic">clear</span>; <span class="tactic">intros</span>. <span class="comment">(**&nbsp;should&nbsp;be&nbsp;extracted&nbsp;to&nbsp;lemma&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">resSrc</span>; <span class="tactic">try</span> <span class="id">constructor</span>. <span class="id">econstructor</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">GRES</span>. <span class="id">inv</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">GRES</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">GRES</span> <span class="kwd">as</span> [<span class="id">b</span>' <span class="id">INJ</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>; <span class="tactic">rewrite</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">A</span>. <span class="id">inv</span> <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>; <span class="tactic">rewrite</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unmapped_closed_reach_closed_preserved_by_extends">MemClosures_local.unmapped_closed_reach_closed_preserved_by_extends</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolvfp</span>. <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#extends_reach_closed_implies_inject">extends_reach_closed_implies_inject</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="selection_proof.html#PRESERVATION">PRESERVATION</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_local_ldsim">transf_local_ldsim</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">scu</span> <span class="id">tcu</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="selection.html#transf_program">selection.transf_program</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="selection_proof.html#tcu">tcu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">tG</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span> <span class="id"><a href="Cminor_local.html#Cminor_IS">Cminor_IS</a></span> <span class="id"><a href="selection_proof.html#scu">scu</a></span> <span class="id"><a href="selection_proof.html#sge">sge</a></span> <span class="id"><a href="selection_proof.html#sG">sG</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span> <span class="id"><a href="CminorSel_local.html#CminorSel_IS">CminorSel_IS</a></span> <span class="id"><a href="selection_proof.html#tcu">tcu</a></span> <span class="id"><a href="selection_proof.html#tge">tge</a></span> <span class="id"><a href="selection_proof.html#tG">tG</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="selection_proof.html#sge">sge</a></span> = <span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="selection_proof.html#tge">tge</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSim_local.html#local_ldsim">local_ldsim</a></span> <span class="id"><a href="selection_proof.html#sG">sG</a></span> <span class="id"><a href="selection_proof.html#tG">tG</a></span> <span class="id"><a href="selection_proof.html#sge">sge</a></span> <span class="id"><a href="selection_proof.html#tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7259')">Proof.</div>
<div class="proofscript" id="proof7259">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="selection_proof.html#TRANSF_local_ldsim">TRANSF_local_ldsim</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="selection_proof.html#transf_program_match">transf_program_match</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
