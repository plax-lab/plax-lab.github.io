<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module stacking_proof</title>
<meta name="description" content="Documentation of Coq module stacking_proof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module stacking_proof</h1>
<div class="coq">
<br/>
<br/>
<div class="doc">Correctness proof for the translation from Linear to Mach. </div>
<br/>
<div class="doc">This file proves semantic preservation for the <span class="bracket"><span class="id">Stacking</span></span> pass. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Integers.html">Integers</a></span> <span class="id"><a href="AST.html">AST</a></span> <span class="id"><a href="Linking.html">Linking</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Memory.html">Memory</a></span> <span class="id"><a href="Separation.html">Separation</a></span> <span class="id"><a href="Events.html">Events</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="Smallstep.html">Smallstep</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Op.html">Op</a></span> <span class="id"><a href="Locations.html">Locations</a></span> <span class="id"><a href="Bounds.html">Bounds</a></span> <span class="id"><a href="Conventions.html">Conventions</a></span> <span class="id"><a href="Stacklayout.html">Stacklayout</a></span> <span class="id"><a href="Lineartyping.html">Lineartyping</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">sep_scope</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CUAST.html">CUAST</a></span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="Blockset.html">Blockset</a></span> <span class="id"><a href="LDSimDefs_local.html">LDSimDefs_local</a></span> <span class="id"><a href="LDSim_local.html">LDSim_local</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="InteractionSemantics.html">InteractionSemantics</a></span> <span class="id"><a href="IS_local.html">IS_local</a></span> <span class="id"><a href="val_casted.html">val_casted</a></span> <span class="id"><a href="InjRels.html">InjRels</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LTL.html">LTL</a></span> <span class="id"><a href="LTL_local.html">LTL_local</a></span> <span class="id"><a href="Linear.html">Linear</a></span> <span class="id"><a href="Linear_local.html">Linear_local</a></span> <span class="id"><a href="Lineartyping_local.html">Lineartyping_local</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html">Mach</a></span> <span class="id"><a href="Mach_local.html">Mach_local</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Stacking</span> <span class="id"><a href="stacking.html">stacking</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_cu">match_cu</a></span> (<span class="id">cu</span>: <span class="id"><a href="Linear_local.html#Linear_comp_unit">Linear_comp_unit</a></span>) (<span class="id">tcu</span>: <span class="id"><a href="Mach_local.html#Mach_comp_unit">Mach_comp_unit</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CUAST.html#match_comp_unit_gen">match_comp_unit_gen</a></span> (<span class="kwd">fun</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="stacking_proof.html#cu">cu</a></span> <span class="id"><a href="stacking_proof.html#tcu">tcu</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_program_match">transf_program_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cu</span> <span class="id">tcu</span>, <span class="id"><a href="stacking.html#transf_program">transf_program</a></span> <span class="id"><a href="stacking_proof.html#cu">cu</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tcu">tcu</a></span> -&gt; <span class="id"><a href="stacking_proof.html#match_cu">match_cu</a></span> <span class="id"><a href="stacking_proof.html#cu">cu</a></span> <span class="id"><a href="stacking_proof.html#tcu">tcu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7607')">Proof.</div>
<div class="proofscript" id="proof7607">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_transform_partial_cunit">match_transform_partial_cunit</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_arguments_no_mreg">set_arguments_no_mreg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg</span> <span class="id">args</span> <span class="id">ls</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span>) <span class="id"><a href="stacking_proof.html#args">args</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7608')">Proof.</div>
<div class="proofscript" id="proof7608">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:? . <span class="id">inv</span> <span class="id">Heqb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">args</span> (<span class="id"><a href="AST.html#sig_args">sig_args</a></span> <span class="id">sg</span>) 0. <span class="tactic">clear</span>. <br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">args</span>; <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Basic properties of the translation </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="typesize_typesize">typesize_typesize</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> = 4 * <span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7609')">Proof.</div>
<div class="proofscript" id="proof7609">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="size_type_chunk">size_type_chunk</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7610')">Proof.</div>
<div class="proofscript" id="proof7610">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="align_type_chunk">align_type_chunk</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = 4 * <span class="id"><a href="Locations.html#typealign">Locations.typealign</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7611')">Proof.</div>
<div class="proofscript" id="proof7611">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="slot_outgoing_argument_valid">slot_outgoing_argument_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">sg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span>)) -&gt; <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7612')">Proof.</div>
<div class="proofscript" id="proof7612">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zle_true">zle_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="load_result_inject">load_result_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt; <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7613')">Proof.</div>
<div class="proofscript" id="proof7613">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">v</span>'; <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span>, <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">intros</span>; <span class="tactic">auto</span>; <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION">PRESERVATION</a></span>.<br/>
&nbsp;&nbsp;<br/>
<div class="doc">This predicate is defined in Asmgenproof0 </div>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.return_address_offset">return_address_offset</a></span>: <span class="id"><a href="Mach.html#function">Mach.function</a></span> -&gt; <span class="id"><a href="Mach.html#code">Mach.code</a></span> -&gt; <span class="id"><a href="Integers.html#ptrofs">ptrofs</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.Mach_IS">Mach_IS</a></span> := <span class="id"><a href="Mach_local.html#Mach_IS">Mach_IS</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.return_address_offset">return_address_offset</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.return_address_offset_exists">return_address_offset_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="Mach.html#Mcall">Mcall</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span> <span class="id"><a href="stacking_proof.html#ros">ros</a></span> :: <span class="id"><a href="stacking_proof.html#c">c</a></span>) (<span class="id"><a href="Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ofs</span>, <span class="id"><a href="stacking_proof.html#PRESERVATION.return_address_offset">return_address_offset</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.step">step</a></span> := <span class="id"><a href="Mach_local.html#step">Mach_local.step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.return_address_offset">return_address_offset</a></span>.<br/>
<br/>
<div class="doc">Declare properties on compunits and global envs </div>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.scu">scu</a></span>: <span class="id"><a href="Linear_local.html#Linear_comp_unit">Linear_comp_unit</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.tcu">tcu</a></span>: <span class="id"><a href="Mach_local.html#Mach_comp_unit">Mach_comp_unit</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.TRANSF">TRANSF</a></span>: <span class="id"><a href="stacking_proof.html#match_cu">match_cu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tcu">tcu</a></span>.<br/>
<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.sge">sge</a></span> <span class="id"><a name="PRESERVATION.sG">sG</a></span>: <span class="id"><a href="Linear.html#genv">Linear.genv</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.tge">tge</a></span> <span class="id"><a name="PRESERVATION.tG">tG</a></span>: <span class="id"><a href="Mach.html#genv">Mach.genv</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.GE_INIT">GE_INIT</a></span>: <span class="id"><a href="Linear_local.html#Linear_IS">Linear_IS</a></span>.(<span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.scu">scu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.TGE_INIT">TGE_INIT</a></span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.Mach_IS">Mach_IS</a></span>.(<span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.tcu">tcu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.S_EQ">S_EQ</a></span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span>.(<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span>) = <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>.(<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wt_prog">wt_prog</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="stacking_proof.html#i">i</a></span>, <span class="id"><a href="AST.html#Gfun">Gfun</a></span> <span class="id"><a href="stacking_proof.html#fd">fd</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.scu">scu</a></span>.(<span class="id"><a href="CUAST.html#cu_defs">cu_defs</a></span>) -&gt; <span class="id"><a href="Lineartyping.html#wt_fundef">wt_fundef</a></span> <span class="id"><a href="stacking_proof.html#fd">fd</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7614')">Proof.</div>
<div class="proofscript" id="proof7614">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Coqlib.html#list_forall2_in_left">list_forall2_in_left</a></span>. <span class="id">eexact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TRANSF">TRANSF</a></span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> ([<span class="id">i</span>' <span class="id">g</span>] &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">R</span>. <span class="tactic">destruct</span> <span class="id">fd</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
- <span class="id">monadInv</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id">transf_function</span> <span class="kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Lineartyping.html#wt_function">wt_function</a></span> <span class="id">f</span>). <span class="tactic">auto</span>. <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Frame properties, part of them are already proved in Stackingproof.v </div>
<div class="doc">Need to inspect Separation.v to make sure understanding memory assertions </div>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES">FRAME_PROPERTIES</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.f">f</a></span>: <span class="id"><a href="Linear.html#function">Linear.function</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.b">b</a></span> := <span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> := <span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>: <span class="id"><a href="Mach.html#function">Mach.function</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>: <span class="id">transf_function</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="unfold_transf_function">unfold_transf_function</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span> = <span class="id"><a href="Mach.html#mkfunction">Mach.mkfunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transl_body</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_link">fe_ofs_link</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7615')">Proof.</div>
<div class="proofscript" id="proof7615">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="tactic">unfold</span> <span class="id">transf_function</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>); <span class="tactic">simpl</span> <span class="id">negb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#b">b</a></span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_function_well_typed">transf_function_well_typed</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7616')">Proof.</div>
<div class="proofscript" id="proof7616">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="tactic">unfold</span> <span class="id">transf_function</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>); <span class="tactic">simpl</span> <span class="id">negb</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_no_overflow">size_no_overflow</a></span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span>) &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7617')">Proof.</div>
<div class="proofscript" id="proof7617">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="tactic">unfold</span> <span class="id">transf_function</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>); <span class="tactic">simpl</span> <span class="id">negb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#b">b</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bound_stack_data_stacksize">bound_stack_data_stacksize</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) &lt;= <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#bound_stack_data">bound_stack_data</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7618')">Proof.</div>
<div class="proofscript" id="proof7618">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#b">b</a></span>, <span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span>, <span class="id"><a href="Bounds.html#bound_stack_data">bound_stack_data</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax1">Zmax1</a></span>.<br/>
Qed.</div>
<br/>
<h1> Memory assertions used to describe the contents of stack frames </h1>
<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add">Z.add</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul">Z.mul</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide">Z.divide</a></span>.<br/>
<br/>
<div class="doc">Accessing the stack frame using <span class="bracket"><span class="id">load_stack</span></span> and <span class="bracket"><span class="id">store_stack</span></span>. </div>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_get_stack">contains_get_stack</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">spec</span> <span class="id">m</span> <span class="id">ty</span> <span class="id">sp</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#contains">contains</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#spec">spec</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> /\ <span class="id"><a href="stacking_proof.html#spec">spec</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7619')">Proof.</div>
<div class="proofscript" id="proof7619">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#load_stack">load_stack</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)) <span class="kwd">with</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#loadv_rule">loadv_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hasvalue_get_stack">hasvalue_get_stack</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">sp</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#hasvalue">hasvalue</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7620')">Proof.</div>
<div class="proofscript" id="proof7620">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#contains_get_stack">contains_get_stack</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_set_stack">contains_set_stack</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">spec</span>: <span class="id"><a href="Values.html#val">val</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">v</span> <span class="id">spec1</span> <span class="id">m</span> <span class="id">ty</span> <span class="id">sp</span> <span class="id">ofs</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#contains">contains</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#spec1">spec1</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#spec">spec</a></span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="Separation.html#contains">contains</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#spec">spec</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7621')">Proof.</div>
<div class="proofscript" id="proof7621">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)) <span class="kwd">with</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#storev_rule">storev_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The original contains_locations' proof depends on progam.... although don't need to...
    thus can't be reused........ </div>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="contains_locations">contains_locations</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">pos</span> <span class="id">bound</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">sl</span>: <span class="id"><a href="Locations.html#slot">slot</a></span>) (<span class="id">ls</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) : <span class="id"><a href="Separation.html#massert">massert</a></span> := {|<br/>
&nbsp;&nbsp;<span class="id"><a href="Separation.html#Build_massert">m_pred</a></span> := <span class="kwd">fun</span> <span class="id">m</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(8 | <span class="id"><a href="stacking_proof.html#pos">pos</a></span>) /\ 0 &lt;= <span class="id"><a href="stacking_proof.html#pos">pos</a></span> /\ <span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#bound">bound</a></span> &lt;= <span class="id"><a href="Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#bound">bound</a></span>) <span class="id"><a href="Memtype.html#Cur">Cur</a></span> <span class="id"><a href="Memtype.html#Freeable">Freeable</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, 0 &lt;= <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> &lt;= <span class="id"><a href="stacking_proof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="Locations.html#typealign">typealign</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> | <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="Memory.html#Mem.load">Mem.load</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)) <span class="id"><a href="stacking_proof.html#v">v</a></span>;<br/>
&nbsp;&nbsp;<span class="id">m_footprint</span> := <span class="kwd">fun</span> <span class="id">b</span> <span class="id">ofs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span> /\ <span class="id"><a href="stacking_proof.html#pos">pos</a></span> &lt;= <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> &lt; <span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#bound">bound</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7622')">Next Obligation.</div>
<div class="proofscript" id="proof7622">
&nbsp;clear&nbsp;unused&nbsp;context...&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">S_EQ</span> <span class="id">Mach_IS</span> <span class="id">TRANSF</span> <span class="id">return_address_offset_exists</span> <span class="id">GE_INIT</span> <span class="id">TGE_INIT</span> <span class="id">step</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">scu</span> <span class="id">tcu</span> <span class="id">sge</span> <span class="id">tge</span> <span class="id">sG</span> <span class="id">tG</span> <span class="id">TRANSF_F</span> <span class="id">return_address_offset</span> <span class="id">b</span> <span class="id">fe</span> <span class="id">f</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>. <br/>
- <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_unchanged_on">Mem.perm_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">exploit</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.load_unchanged_on">Mem.load_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#size_type_chunk">size_type_chunk</a></span>, <span class="id"><a href="stacking_proof.html#typesize_typesize">typesize_typesize</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof7623')">Next Obligation.</div>
<div class="proofscript" id="proof7623">
&nbsp;clear&nbsp;unused&nbsp;context...&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">S_EQ</span> <span class="id">Mach_IS</span> <span class="id">TRANSF</span> <span class="id">return_address_offset_exists</span> <span class="id">GE_INIT</span> <span class="id">TGE_INIT</span> <span class="id">step</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">scu</span> <span class="id">tcu</span> <span class="id">sge</span> <span class="id">tge</span> <span class="id">sG</span> <span class="id">tG</span> <span class="id">TRANSF_F</span> <span class="id">return_address_offset</span> <span class="id">b</span> <span class="id">fe</span> <span class="id">f</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="valid_access_location">valid_access_location</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;(8 | <span class="id"><a href="stacking_proof.html#pos">pos</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#bound">bound</a></span>) <span class="id"><a href="Memtype.html#Cur">Cur</a></span> <span class="id"><a href="Memtype.html#Freeable">Freeable</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> &lt;= <span class="id"><a href="stacking_proof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="Locations.html#typealign">typealign</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> | <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) <span class="id"><a href="stacking_proof.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7624')">Proof.</div>
<div class="proofscript" id="proof7624">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memtype.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#size_type_chunk">size_type_chunk</a></span>, <span class="id"><a href="stacking_proof.html#typesize_typesize">typesize_typesize</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">omega</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#align_type_chunk">align_type_chunk</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_trans">Zdivide_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (8 / (4 * <span class="id"><a href="Locations.html#typealign">typealign</a></span> <span class="id">ty</span>)); <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_divide_mono_l">Z.mul_divide_mono_l</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="get_location">get_location</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> &lt;= <span class="id"><a href="stacking_proof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="Locations.html#typealign">typealign</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> | <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)) <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7625')">Proof.</div>
<div class="proofscript" id="proof7625">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">U</span> &amp; <span class="id">V</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#load_stack">load_stack</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>, <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_location">set_location</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span> <span class="id">P</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> &lt;= <span class="id"><a href="stacking_proof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="Locations.html#typealign">typealign</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> | <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)) <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7626')">Proof.</div>
<div class="proofscript" id="proof7626">
&nbsp;clear&nbsp;unused&nbsp;context...&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">S_EQ</span> <span class="id">Mach_IS</span> <span class="id">TRANSF</span> <span class="id">return_address_offset_exists</span> <span class="id">GE_INIT</span> <span class="id">TGE_INIT</span> <span class="id">step</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">scu</span> <span class="id">tcu</span> <span class="id">sge</span> <span class="id">tge</span> <span class="id">sG</span> <span class="id">tG</span> <span class="id">TRANSF_F</span> <span class="id">return_address_offset</span> <span class="id">b</span> <span class="id">fe</span> <span class="id">f</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="kwd">as</span> [<span class="id">m</span>' <span class="id">STORE</span>]. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#valid_access_location">valid_access_location</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PERM</span>: <span class="id"><a href="Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">pos</span> (<span class="id">pos</span> + 4 * <span class="id">bound</span>) <span class="id"><a href="Memtype.html#Cur">Cur</a></span> <span class="id"><a href="Memtype.html#Freeable">Freeable</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. }<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>'; <span class="tactic">split</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>, <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="tactic">omega</span>.<br/>
- <span class="tactic">simpl</span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
+ <span class="tactic">unfold</span> <span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs0</span> <span class="id">ty0</span>)); [|<span class="tactic">destruct</span> (<span class="id"><a href="Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs0</span> <span class="id">ty0</span>))].<br/>
* <span class="comment">(*&nbsp;same&nbsp;location&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">e</span>. <span class="tactic">rename</span> <span class="id">ofs0</span> <span class="id">into</span> <span class="id">ofs</span>. <span class="tactic">rename</span> <span class="id">ty0</span> <span class="id">into</span> <span class="id">ty</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id">v</span>'); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.load_store_similar_2">Mem.load_store_similar_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.load_result_inject">Val.load_result_inject</a></span>; <span class="tactic">auto</span>.<br/>
* <span class="comment">(*&nbsp;different&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v0</span> &amp; <span class="id">X</span> &amp; <span class="id">Y</span>). <span class="id">exists</span> <span class="id">v0</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">X</span>; <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>. <span class="tactic">congruence</span>. <span class="id">right</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="stacking_proof.html#size_type_chunk">size_type_chunk</a></span>, ! <span class="id"><a href="stacking_proof.html#typesize_typesize">typesize_typesize</a></span>. <span class="tactic">omega</span>.<br/>
* <span class="comment">(*&nbsp;overlapping&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memory.html#Mem.valid_access_load">Mem.valid_access_load</a></span> <span class="id">m</span>' (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty0</span>) <span class="id">sp</span> (<span class="id">pos</span> + 4 * <span class="id">ofs0</span>)) <span class="kwd">as</span> [<span class="id">v</span>'' <span class="id">LOAD</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.valid_access_implies">Mem.valid_access_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="Memtype.html#Writable">Writable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#valid_access_location">valid_access_location</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>''; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">apply</span> (<span class="id"><a href="Separation.html#m_invar">m_invar</a></span> <span class="id">P</span>) <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span>; <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#size_type_chunk">size_type_chunk</a></span>, <span class="id"><a href="stacking_proof.html#typesize_typesize">typesize_typesize</a></span>. <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">C</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="initial_locations">initial_locations</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">P</span> <span class="id">sl</span> <span class="id">ls</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> (<span class="id"><a href="stacking_proof.html#pos">pos</a></span> + 4 * <span class="id"><a href="stacking_proof.html#bound">bound</a></span>) ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;(8 | <span class="id"><a href="stacking_proof.html#pos">pos</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7627')">Proof.</div>
<div class="proofscript" id="proof7627">
&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>). <span class="tactic">split</span>.<br/>
- <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memory.html#Mem.valid_access_load">Mem.valid_access_load</a></span> <span class="id">m</span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id">sp</span> (<span class="id">pos</span> + 4 * <span class="id">ofs</span>)) <span class="kwd">as</span> [<span class="id">v</span> <span class="id">LOAD</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#valid_access_location">valid_access_location</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_locations_exten">contains_locations_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id">ls</span>' (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id">ls</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7628')">Proof.</div>
<div class="proofscript" id="proof7628">
&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_locations_incr">contains_locations_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">j</span>' <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7629')">Proof.</div>
<div class="proofscript" id="proof7629">
&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">contains_callee_saves</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">rl</span> <span class="id">ls</span></span> is a memory assertion that holds
  if block <span class="bracket"><span class="id">sp</span></span>, starting at offset <span class="bracket"><span class="id">pos</span></span>, contains the values of the
  callee-save registers <span class="bracket"><span class="id">rl</span></span> as given by the location map <span class="bracket"><span class="id">ls</span></span>,
  up to the memory injection <span class="bracket"><span class="id">j</span></span>.  The memory layout of the registers in <span class="bracket"><span class="id">rl</span></span>
  is the same as that implemented by <span class="bracket"><span class="id">save_callee_save_rec</span></span>. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="contains_callee_saves">contains_callee_saves</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">pos</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Machregs.html#mreg">mreg</a></span>) (<span class="id">ls</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) : <span class="id"><a href="Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id">r</span> :: <span class="id">rl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sz</span> := <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pos1</span> := <span class="id"><a href="Coqlib.html#align">align</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#sz">sz</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Separation.html#contains">contains</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos1">pos1</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">r</span>)) <span class="id"><a href="stacking_proof.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="stacking_proof.html#pos1">pos1</a></span> + <span class="id"><a href="stacking_proof.html#sz">sz</a></span>) <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_callee_saves_incr">contains_callee_saves_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">j</span>' <span class="id">sp</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rl</span> <span class="id">pos</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7630')">Proof.</div>
<div class="proofscript" id="proof7630">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span> <span class="kwd">as</span> [ | <span class="id">r1</span> <span class="id">rl</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">reflexivity</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sepconj_morph_1">sepconj_morph_1</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#contains_imp">contains_imp</a></span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_callee_saves_exten">contains_callee_saves_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls</span>' <span class="id">rl</span> <span class="id">pos</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> -&gt; <span class="id">ls</span>' (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Separation.html#massert_eqv">massert_eqv</a></span> (<span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id">ls</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7631')">Proof.</div>
<div class="proofscript" id="proof7631">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span> <span class="kwd">as</span> [ | <span class="id">r1</span> <span class="id">rl</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">reflexivity</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sepconj_morph_2">sepconj_morph_2</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Separation logic assertions describing the stack frame at <span class="bracket"><span class="id">sp</span></span>.
  It must contain:
  - the values of the <span class="bracket"><span class="kwd">Local</span></span> stack slots of <span class="bracket"><span class="id">ls</span></span>, as per <span class="bracket"><span class="id">contains_locations</span></span>
  - the values of the <span class="bracket"><span class="id">Outgoing</span></span> stack slots of <span class="bracket"><span class="id">ls</span></span>, as per <span class="bracket"><span class="id">contains_locations</span></span>
  - the <span class="bracket"><span class="id">parent</span></span> pointer representing the back link to the caller's frame
  - the <span class="bracket"><span class="id">retaddr</span></span> pointer representing the saved return address
  - the initial values of the used callee-save registers as given by <span class="bracket"><span class="id">ls0</span></span>,
    as per <span class="bracket"><span class="id">contains_callee_saves</span></span>.
In addition, we use a nonseparating conjunction to record the fact that
we have full access rights on the stack frame, except the part that
represents the Linear stack data. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="frame_contents_1">frame_contents_1</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) (<span class="id">parent</span> <span class="id">retaddr</span>: <span class="id"><a href="Values.html#val">val</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_local">fe_ofs_local</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#bound_local">bound_local</a></span>) <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span><br/>
&nbsp;** <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#bound_outgoing">bound_outgoing</a></span>) <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span><br/>
&nbsp;** <span class="id"><a href="Separation.html#hasvalue">hasvalue</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_link">fe_ofs_link</a></span>) <span class="id"><a href="stacking_proof.html#parent">parent</a></span><br/>
&nbsp;** <span class="id"><a href="Separation.html#hasvalue">hasvalue</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>) <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span><br/>
&nbsp;** <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="frame_contents">frame_contents</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) (<span class="id">parent</span> <span class="id">retaddr</span>: <span class="id"><a href="Values.html#val">val</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Separation.html#mconj">mconj</a></span> (<span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> 0 <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span>) **<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span>) + <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#bound_stack_data">bound_stack_data</a></span>)) <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span>)).<br/>
<br/>
<div class="doc">Accessing components of the frame. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_local">frame_get_local</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> -&gt; <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id">offset_local</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)) <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7632')">Proof.</div>
<div class="proofscript" id="proof7632">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_outgoing">frame_get_outgoing</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> -&gt; <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id">offset_arg</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)) <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7633')">Proof.</div>
<div class="proofscript" id="proof7633">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_parent">frame_get_parent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="AST.html#Tptr">Tptr</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_link">fe_ofs_link</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7634')">Proof.</div>
<div class="proofscript" id="proof7634">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#hasvalue_get_stack">hasvalue_get_stack</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_retaddr">frame_get_retaddr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="AST.html#Tptr">Tptr</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7635')">Proof.</div>
<div class="proofscript" id="proof7635">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick4">sep_pick4</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#hasvalue_get_stack">hasvalue_get_stack</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Assigning a <span class="bracket"><span class="kwd">Local</span></span> or <span class="bracket"><span class="id">Outgoing</span></span> stack slot. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_set_local">frame_set_local</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> -&gt; <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id">offset_local</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)) <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7636')">Proof.</div>
<div class="proofscript" id="proof7636">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#set_location">set_location</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">m</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span> <span class="id">sp</span> <span class="id"><a href="stacking_proof.html#i">i</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span> <span class="id"><a href="stacking_proof.html#i">i</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span>).<br/>
&nbsp;&nbsp;{  <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#frame_mconj">frame_mconj</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_preserved">sep_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_set_outgoing">frame_set_outgoing</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> -&gt; <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id">offset_arg</span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)) <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7637')">Proof.</div>
<div class="proofscript" id="proof7637">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">intros</span> <span class="id">SEP</span>. <br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#set_location">set_location</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">m</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span> <span class="id">sp</span> <span class="id"><a href="stacking_proof.html#i">i</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span> <span class="id"><a href="stacking_proof.html#i">i</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span>).<br/>
&nbsp;&nbsp;{  <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#frame_mconj">frame_mconj</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_preserved">sep_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by change of location maps. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_contents_exten">frame_contents_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls</span>' <span class="id">ls0</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">P</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id">ls</span>' (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#used_callee_save">used_callee_save</a></span>) -&gt; <span class="id">ls0</span>' (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id">ls</span>' <span class="id">ls0</span>' <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7638')">Proof.</div>
<div class="proofscript" id="proof7638">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- ! (<span class="id"><a href="stacking_proof.html#contains_locations_exten">contains_locations_exten</a></span> <span class="id">ls</span> <span class="id">ls</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span>  &lt;- <span class="id"><a href="stacking_proof.html#contains_callee_saves_exten">contains_callee_saves_exten</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by assignment to registers. </div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_set_reg">frame_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">v</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7639')">Proof.</div>
<div class="proofscript" id="proof7639">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_contents_exten">frame_contents_exten</a></span> <span class="kwd">with</span> <span class="id">ls</span> <span class="id">ls0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_undef_regs">frame_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7640')">Proof.</div>
<div class="proofscript" id="proof7640">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_set_regpair">frame_set_regpair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">p</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7641')">Proof.</div>
<div class="proofscript" id="proof7641">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_set_res">frame_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">res</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> (<span class="id"><a href="Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="stacking_proof.html#res">res</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7642')">Proof.</div>
<div class="proofscript" id="proof7642">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by change of memory injection. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_contents_incr">frame_contents_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">j</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7643')">Proof.</div>
<div class="proofscript" id="proof7643">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="stacking_proof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="stacking_proof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span>  &lt;- <span class="id"><a href="stacking_proof.html#contains_callee_saves_incr">contains_callee_saves_incr</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<h1> Agreement between location sets and Mach states </h1>
<br/>
<div class="doc">TODO: 
    we have to strengthen agree_reg, to forbid such behavior when
    Linear regs of value Vundef are mapped to pointer to global vars in Mach regs. </div>
<br/>
<div class="doc">when evaluating an comparison, a cmp footprint would be generated when 
    comparing pointer values with others. Thus this behavior would introduce
    new footprint (comparison) which is not desirable </div>
<br/>
<div class="doc">but it is not enough... we want to preserve agree_reg all the time,
    where as loading memory contents to registers might invalidate the predicate..
    Linear: load 0 eax
    Mach: load 0 eax
    where m<span class="bracket">0</span> = Vundef, m'<span class="bracket">0</span> = Vptr _ _... </div>
<br/>
<div class="doc">I have to consider, in what situation a pointer value would be related to Vundef? </div>
<br/>
<div class="doc">DONE: modified semantics of operations in Op.v and Cminor.v, excluding behaviour of comparing Vundefs </div>
<div class="doc">Agreement with Mach register states </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_regs">agree_regs</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">ls</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) (<span class="id">rs</span>: <span class="id"><a href="Mach.html#regset">regset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>).<br/>
<br/>
<div class="doc">Agreement over locations </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="agree_locs">agree_locs</a></span> (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="mk_agree_locs">mk_agree_locs</a></span> {<br/>
<br/>
<div class="doc">Unused registers have the same value as in the caller </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="agree_unused_reg">agree_unused_reg</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) -&gt; <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>);<br/>
<br/>
<div class="doc">Incoming stack slots have the same value as the
        corresponding Outgoing stack slots in the caller </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="agree_incoming">agree_incoming</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Incoming">Incoming</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="Conventions.html#loc_parameters">loc_parameters</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Incoming">Incoming</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)<br/>
}.<br/>
<br/>
<div class="doc">Auxiliary predicate used at call points </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_callee_save">agree_callee_save</a></span> (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Locations.html#R">R</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Locations.html#S">S</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>.<br/>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_regs</span></span>. </h2>
<br/>
<div class="doc">Values of registers </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_reg">agree_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7644')">Proof.</div>
<div class="proofscript" id="proof7644">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_reglist">agree_reglist</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="LTL.html#reglist">reglist</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span>) (<span class="id"><a href="stacking_proof.html#rs">rs</a></span>##<span class="id"><a href="stacking_proof.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7645')">Proof.</div>
<div class="proofscript" id="proof7645">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="stacking_proof.html#agree_reg">agree_reg</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">agree_reg</span> <span class="id">agree_reglist</span>: <span class="id">stacking</span>.<br/>
<br/>
<div class="doc">Preservation under assignments of machine registers. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_reg">agree_regs_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) (<span class="id"><a href="Mach.html#Regmap.set">Regmap.set</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id">v</span>' <span class="id"><a href="stacking_proof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7646')">Proof.</div>
<div class="proofscript" id="proof7646">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#Regmap.set">Regmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Mach.html#RegEq.eq">RegEq.eq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gss">Locmap.gss</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_pair">agree_regs_set_pair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">p</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) (<span class="id"><a href="Mach.html#set_pair">set_pair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id">v</span>' <span class="id"><a href="stacking_proof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7647')">Proof.</div>
<div class="proofscript" id="proof7647">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.hiword_inject">Val.hiword_inject</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.loword_inject">Val.loword_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_res">agree_regs_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">res</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="stacking_proof.html#res">res</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) (<span class="id"><a href="Mach.html#set_res">set_res</a></span> <span class="id"><a href="stacking_proof.html#res">res</a></span> <span class="id">v</span>' <span class="id"><a href="stacking_proof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7648')">Proof.</div>
<div class="proofscript" id="proof7648">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">IHres2</span>. <span class="tactic">apply</span> <span class="id">IHres1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.hiword_inject">Val.hiword_inject</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.loword_inject">Val.loword_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_exten">agree_regs_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">ls</span>' <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id">ls</span>' (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span> \/ <span class="id">ls</span>' (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) /\ <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">ls</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7649')">Proof.</div>
<div class="proofscript" id="proof7649">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H0</span> <span class="id">r</span>) <span class="kwd">as</span> [<span class="id">A</span> | [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_undef_regs">agree_regs_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">rl</span> <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) (<span class="id"><a href="Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7650')">Proof.</div>
<div class="proofscript" id="proof7650">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation under assignment of stack slot </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_slot">agree_regs_set_slot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7651')">Proof.</div>
<div class="proofscript" id="proof7651">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by increasing memory injections </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_inject_incr">agree_regs_inject_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">j</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt; <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>' -&gt; <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7652')">Proof.</div>
<div class="proofscript" id="proof7652">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">stacking</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at function entry. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_call_regs">agree_regs_call_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="LTL.html#call_regs">call_regs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7653')">Proof.</div>
<div class="proofscript" id="proof7653">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="LTL.html#call_regs">call_regs</a></span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_locs</span></span> </h2>
<br/>
<div class="doc">Preservation under assignment of machine register. </div>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_reg">agree_locs_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">r</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7654')">Proof.</div>
<div class="proofscript" id="proof7654">
&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7655')">Proof.</div>
<div class="proofscript" id="proof7655">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_pair">agree_locs_set_pair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">p</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="AST.html#forall_rpair">forall_rpair</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id"><a href="stacking_proof.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7656')">Proof.</div>
<div class="proofscript" id="proof7656">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_res">agree_locs_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">res</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> (<span class="id"><a href="AST.html#params_of_builtin_res">params_of_builtin_res</a></span> <span class="id"><a href="stacking_proof.html#res">res</a></span>) -&gt; <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="stacking_proof.html#res">res</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7657')">Proof.</div>
<div class="proofscript" id="proof7657">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">IHres2</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_undef_regs">agree_locs_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">regs</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#regs">regs</a></span> -&gt; <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#regs">regs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7658')">Proof.</div>
<div class="proofscript" id="proof7658">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">regs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_undef_locs_1">agree_locs_undef_locs_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">regs</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#regs">regs</a></span> -&gt; <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#regs">regs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7659')">Proof.</div>
<div class="proofscript" id="proof7659">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_regs">agree_locs_undef_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_undef_locs">agree_locs_undef_locs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">regs</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#regs">regs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#regs">regs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7660')">Proof.</div>
<div class="proofscript" id="proof7660">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs_1">agree_locs_undef_locs_1</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn</span>:<span class="id">CS</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">regs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>. <span class="id">exists</span> <span class="id">r</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by assignment to local slot </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_slot">agree_locs_set_slot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Lineartyping.html#slot_writable">slot_writable</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7661')">Proof.</div>
<div class="proofscript" id="proof7661">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="id">left</span>. <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at return points (when <span class="bracket"><span class="id">ls</span></span> is changed but not <span class="bracket"><span class="id">ls0</span></span>). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_return">agree_locs_return</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id">ls</span>' <span class="id"><a href="stacking_proof.html#ls">ls</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id">ls</span>' <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7662')">Proof.</div>
<div class="proofscript" id="proof7662">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">tauto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at tailcalls (when <span class="bracket"><span class="id">ls0</span></span> is changed but not <span class="bracket"><span class="id">ls</span></span>). </div>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_tailcall">agree_locs_tailcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls0</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id">ls0</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id">ls0</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7663')">Proof.</div>
<div class="proofscript" id="proof7663">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">tauto</span>.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_callee_save</span></span>. </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_callee_save_return_regs">agree_callee_save_return_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> <span class="id"><a href="stacking_proof.html#ls2">ls2</a></span>) <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7664')">Proof.</div>
<div class="proofscript" id="proof7664">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="LTL.html#return_regs">return_regs</a></span>. <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_callee_save_set_result">agree_callee_save_set_result</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg</span> <span class="id">v</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> <span class="id"><a href="stacking_proof.html#ls2">ls2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="Locations.html#Locmap.setpair">Locmap.setpair</a></span> (<span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span>) <span class="id"><a href="stacking_proof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7665')">Proof.</div>
<div class="proofscript" id="proof7665">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gpo">Locmap.gpo</a></span>. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id"><a href="Locations.html#Loc.diff">Loc.diff</a></span> <span class="id">l</span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Conventions1.html#loc_result_caller_save">loc_result_caller_save</a></span> <span class="id">sg</span>). <span class="tactic">destruct</span> (<span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of destroyed registers. </h2>
<span class="kwd">Definition</span> <span class="id"><a name="no_callee_saves">no_callee_saves</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Machregs.html#mreg">mreg</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_op_caller_save">destroyed_by_op_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span>, <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_op">destroyed_by_op</a></span> <span class="id"><a href="stacking_proof.html#op">op</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7666')">Proof.</div>
<div class="proofscript" id="proof7666">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_load_caller_save">destroyed_by_load_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span>, <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id"><a href="stacking_proof.html#addr">addr</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7667')">Proof.</div>
<div class="proofscript" id="proof7667">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_store_caller_save">destroyed_by_store_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span>, <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id"><a href="stacking_proof.html#addr">addr</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7668')">Proof.</div>
<div class="proofscript" id="proof7668">
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="Machregs.html#destroyed_by_store">destroyed_by_store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span>, <span class="id"><a href="Machregs.html#destroyed_by_store">destroyed_by_store</a></span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_cond_caller_save">destroyed_by_cond_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cond</span>, <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_cond">destroyed_by_cond</a></span> <span class="id"><a href="stacking_proof.html#cond">cond</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7669')">Proof.</div>
<div class="proofscript" id="proof7669">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">cond</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_jumptable_caller_save">destroyed_by_jumptable_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> <span class="id"><a href="Machregs.html#destroyed_by_jumptable">destroyed_by_jumptable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7670')">Proof.</div>
<div class="proofscript" id="proof7670">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_setstack_caller_save">destroyed_by_setstack_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7671')">Proof.</div>
<div class="proofscript" id="proof7671">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_at_function_entry_caller_save">destroyed_at_function_entry_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#no_callee_saves">no_callee_saves</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7672')">Proof.</div>
<div class="proofscript" id="proof7672">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">destroyed_by_op_caller_save</span> <span class="id">destroyed_by_load_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_by_store_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_by_cond_caller_save</span> <span class="id">destroyed_by_jumptable_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_at_function_entry_caller_save</span>: <span class="id">stacking</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_setstack_function_entry">destroyed_by_setstack_function_entry</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7673')">Proof.</div>
<div class="proofscript" id="proof7673">
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>; <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="transl_destroyed_by_op">transl_destroyed_by_op</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">e</span>, <span class="id"><a href="Machregs.html#destroyed_by_op">destroyed_by_op</a></span> (<span class="id">transl_op</span> <span class="id"><a href="stacking_proof.html#e">e</a></span> <span class="id"><a href="stacking_proof.html#op">op</a></span>) = <span class="id"><a href="Machregs.html#destroyed_by_op">destroyed_by_op</a></span> <span class="id"><a href="stacking_proof.html#op">op</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7674')">Proof.</div>
<div class="proofscript" id="proof7674">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="transl_destroyed_by_load">transl_destroyed_by_load</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">e</span>, <span class="id"><a href="Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> (<span class="id">transl_addr</span> <span class="id"><a href="stacking_proof.html#e">e</a></span> <span class="id"><a href="stacking_proof.html#addr">addr</a></span>) = <span class="id"><a href="Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id"><a href="stacking_proof.html#addr">addr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7675')">Proof.</div>
<div class="proofscript" id="proof7675">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="transl_destroyed_by_store">transl_destroyed_by_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">e</span>, <span class="id"><a href="Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> (<span class="id">transl_addr</span> <span class="id"><a href="stacking_proof.html#e">e</a></span> <span class="id"><a href="stacking_proof.html#addr">addr</a></span>) = <span class="id"><a href="Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id"><a href="stacking_proof.html#addr">addr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7676')">Proof.</div>
<div class="proofscript" id="proof7676">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<h1> Correctness of saving and restoring of callee-save registers </h1>
<br/>
<div class="doc">The following lemmas show the correctness of the register saving
  code generated by <span class="bracket"><span class="id">save_callee_save</span></span>: after this code has executed,
  the register save areas of the current frame do contain the
  values of the callee-save registers used by the function. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE">SAVE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span>: <span class="id"><a href="Linear.html#locset">locset</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef">ls_temp_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) -&gt; <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls">wt_ls</a></span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="save_callee_save_rec_correct">save_callee_save_rec_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">l</span> <span class="id">pos</span> <span class="id">rs</span> <span class="id">lf</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> -&gt; <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> (<span class="id"><a href="Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span>) ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">m</span>', <span class="id">exists</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">star</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">save_callee_save_rec</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#fp">fp</a></span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="stacking_proof.html#pos">pos</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id">rs</span>'<br/>
<div class="doc">add properties about fp: simply contained in sp. </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> <span class="id">b</span> <span class="id">_</span> =&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> &lt;&gt; <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7677')">Proof.</div>
<div class="proofscript" id="proof7677">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">l</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">P</span>; <span class="tactic">intros</span> <span class="id">CS</span> <span class="id">SEP</span> <span class="id">AG</span>.<br/>
- <span class="id">exists</span> <span class="id">rs</span>, <span class="id">m</span>, <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_pure">sep_pure</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_drop">sep_drop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_refl">Mem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
- <span class="tactic">set</span> (<span class="id">ty</span> := <span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">sz</span> := <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">pos1</span> := <span class="id"><a href="Coqlib.html#align">align</a></span> <span class="id">pos</span> <span class="id">sz</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SZPOS</span>: <span class="id">sz</span> &gt; 0) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="AST.html#typesize_pos">AST.typesize_pos</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SZREC</span>: <span class="id">pos1</span> + <span class="id">sz</span> &lt;= <span class="id"><a href="Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id">l</span> (<span class="id">pos1</span> + <span class="id">sz</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Bounds.html#size_callee_save_area_rec_incr">size_callee_save_area_rec_incr</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">POS1</span>: <span class="id">pos</span> &lt;= <span class="id">pos1</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#align_le">align_le</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">AL1</span>: (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) | <span class="id">pos1</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">pos1</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_trans">Zdivide_trans</a></span> <span class="kwd">with</span> <span class="id">sz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sz</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#size_type_chunk">size_type_chunk</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#align_size_chunk_divides">align_size_chunk_divides</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#align_divides">align_divides</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#range_drop_left">range_drop_left</a></span> <span class="kwd">with</span> (<span class="id">mid</span> := <span class="id">pos1</span>) <span class="kwd">in</span> <span class="id">SEP</span>; [ | <span class="tactic">omega</span> ].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#range_split">range_split</a></span> <span class="kwd">with</span> (<span class="id">mid</span> := <span class="id">pos1</span> + <span class="id">sz</span>) <span class="kwd">in</span> <span class="id">SEP</span>; [ | <span class="tactic">omega</span> ].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sz</span> <span class="tactic">at</span> 1 <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#size_type_chunk">size_type_chunk</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#range_contains">range_contains</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#contains_set_stack">contains_set_stack</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">r</span>)) <span class="id">v</span>') (<span class="id">rs</span> <span class="id">r</span>)).<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#load_result_inject">load_result_inject</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls">wt_ls</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m1</span> &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">rs1</span> := <span class="id"><a href="Mach.html#undef_regs">undef_regs</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="id">rs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">AG1</span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id">rs1</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">rs1</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r0</span> (<span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef">ls_temp_undef</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Mach.html#undef_regs_other">undef_regs_other</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">AG</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHl</span> (<span class="id">pos1</span> + <span class="id">sz</span>) <span class="id">rs1</span> <span class="id">lf</span> <span class="id">m1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m2</span> &amp; <span class="id">fp2</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs2</span>, <span class="id">m2</span>. <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">exact</span> <span class="id">STORE</span>. <span class="tactic">auto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">C</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">STORE</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H</span>; <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="id">cbn</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#store_fp">FMemOpFP.store_fp</a></span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span>, <span class="id"><a href="Footprint.html#Locs.blocks">Locs.blocks</a></span>, <span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> 1. <span class="id">Locs.unfolds</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">FMemOpFP.range_locset</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE">SAVE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="LTL_undef_regs_same">LTL_undef_regs_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">ls</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> -&gt; <span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7678')">Proof.</div>
<div class="proofscript" id="proof7678">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">a</span>) (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">r</span>)). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">a</span>) (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">r</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="LTL_undef_regs_others">LTL_undef_regs_others</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">ls</span>, ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> -&gt; <span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7679')">Proof.</div>
<div class="proofscript" id="proof7679">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">intuition</span>. <span class="tactic">red</span>. <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">rl</span> <span class="id">ls</span>, <span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) = <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7680')">Proof.</div>
<div class="proofscript" id="proof7680">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="undef_regs_type">undef_regs_type</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">l</span> <span class="id">rl</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> -&gt; <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="stacking_proof.html#rl">rl</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7681')">Proof.</div>
<div class="proofscript" id="proof7681">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">a</span>) <span class="id">l</span>). <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">a</span>) <span class="id">l</span>); <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="save_callee_save_correct">save_callee_save_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">rs</span> <span class="id">sp</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">k</span> <span class="id">lf</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) (<span class="id"><a href="Bounds.html#size_callee_save_area">size_callee_save_area</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>)) ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ls1</span> := <span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="LTL.html#call_regs">LTL.call_regs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs1</span> := <span class="id"><a href="Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">m</span>', <span class="id">exists</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">star</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">save_callee_save</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) <span class="id"><a href="stacking_proof.html#rs1">rs1</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#fp">fp</a></span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> <span class="id">rs</span>'<br/>
<div class="doc">add properties about fp: simply contained in sp. </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> <span class="id">b</span> <span class="id">_</span> =&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> &lt;&gt; <span class="id"><a href="stacking_proof.html#sp">sp</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7682')">Proof.</div>
<div class="proofscript" id="proof7682">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">P</span>; <span class="tactic">intros</span> <span class="id">SEP</span> <span class="id">TY</span> <span class="id">AGCS</span> <span class="id">AG</span>; <span class="tactic">intros</span> <span class="id">ls1</span> <span class="id">rs1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#save_callee_save_rec_correct">save_callee_save_rec_correct</a></span> <span class="id">j</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">sp</span> <span class="id">ls1</span>).<br/>
- <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">ls1</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#LTL_undef_regs_same">LTL_undef_regs_same</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#destroyed_by_setstack_function_entry">destroyed_by_setstack_function_entry</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">ls1</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#undef_regs_type">undef_regs_type</a></span>. <span class="tactic">apply</span> <span class="id">TY</span>. <br/>
- <span class="tactic">exact</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span>).<br/>
- <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
- <span class="id">instantiate</span> (1 := <span class="id">rs1</span>). <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_call_regs">agree_regs_call_regs</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">clear</span> <span class="id">SEP</span>. <span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">m</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">EXEC</span> &amp; <span class="id">SEP</span> &amp; <span class="id">PERMS</span> &amp; <span class="id">AG</span>' &amp; <span class="id">UNCHG</span> &amp; <span class="id">FP_sp</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">m</span>'. <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="stacking_proof.html#contains_callee_saves_exten">contains_callee_saves_exten</a></span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">ls1</span>). <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ls1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#LTL_undef_regs_others">LTL_undef_regs_others</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="LTL.html#call_regs">call_regs</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">AGCS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span>  (<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#destroyed_at_function_entry_caller_save">destroyed_at_function_entry_caller_save</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>. <span class="id">exists</span> <span class="id">r</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">PERMS</span>. <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">AG</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">UNCHG</span>. <span class="tactic">exact</span> <span class="id">FP_sp</span>.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollary of the previous lemmas, we obtain the following
  correctness theorem for the execution of a function prologue
  (allocation of the frame + saving of the link and return address +
  saving of the used callee-save registers). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">alloc_parallel_rule_2</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>) (<span class="id">ge</span>: <span class="id"><a href="Globalenvs.html#Genv.t">Genv.t</a></span> <span class="id"><a href="stacking_proof.html#F">F</a></span> <span class="id"><a href="stacking_proof.html#V">V</a></span>) <span class="id">m1</span> <span class="id">sz1</span> <span class="id">m1</span>' <span class="id">b1</span> <span class="id">m2</span> <span class="id">sz2</span> <span class="id">m2</span>' <span class="id">b2</span> <span class="id">P</span> <span class="id">j</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m2">m2</a></span> |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m1">m1</a></span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#ge">ge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="stacking_proof.html#m1">m1</a></span> 0 <span class="id"><a href="stacking_proof.html#sz1">sz1</a></span> = (<span class="id">m1</span>', <span class="id"><a href="stacking_proof.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="stacking_proof.html#m2">m2</a></span> 0 <span class="id"><a href="stacking_proof.html#sz2">sz2</a></span> = (<span class="id">m2</span>', <span class="id"><a href="stacking_proof.html#b2">b2</a></span>) -&gt;<br/>
&nbsp;&nbsp;(8 | <span class="id"><a href="stacking_proof.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#lo">lo</a></span> = <span class="id"><a href="stacking_proof.html#delta">delta</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#hi">hi</a></span> = <span class="id"><a href="stacking_proof.html#delta">delta</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmax">Zmax</a></span> 0 <span class="id"><a href="stacking_proof.html#sz1">sz1</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="stacking_proof.html#sz2">sz2</a></span> &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="stacking_proof.html#delta">delta</a></span> -&gt; <span class="id"><a href="stacking_proof.html#hi">hi</a></span> &lt;= <span class="id"><a href="stacking_proof.html#sz2">sz2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m2</span>' |= <span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#b2">b2</a></span> 0 <span class="id"><a href="stacking_proof.html#lo">lo</a></span> ** <span class="id"><a href="Separation.html#range">range</a></span> <span class="id"><a href="stacking_proof.html#b2">b2</a></span> <span class="id"><a href="stacking_proof.html#hi">hi</a></span> <span class="id"><a href="stacking_proof.html#sz2">sz2</a></span> ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m1</span>' ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#ge">ge</a></span> <span class="id">j</span>' ** <span class="id"><a href="stacking_proof.html#P">P</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="stacking_proof.html#b2">b2</a></span>, <span class="id"><a href="stacking_proof.html#delta">delta</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="stacking_proof.html#b">b</a></span> &lt;&gt; <span class="id"><a href="stacking_proof.html#b1">b1</a></span> -&gt; <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7683')">Proof.</div>
<div class="proofscript" id="proof7683">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">j1</span> := <span class="kwd">fun</span> <span class="id">b</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> <span class="id">b1</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b2</span>, <span class="id">delta</span>) <span class="kwd">else</span> <span class="id">j</span> <span class="id"><a href="stacking_proof.html#b">b</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id">j</span> <span class="id">j1</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">j1</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id">b1</span>); <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="id">eelim</span> <span class="id"><a href="Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>. <span class="id">eexact</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.valid_block_inject_1">Mem.valid_block_inject_1</a></span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">eexact</span> <span class="id">H</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Y</span>: <span class="id"><a href="Events.html#inject_separated">inject_separated</a></span> <span class="id">j</span> <span class="id">j1</span> <span class="id">m1</span> <span class="id">m2</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">j1</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <br/>
&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H9</span>; <span class="tactic">clear</span> <span class="id">H9</span>; <span class="tactic">subst</span> <span class="id">b3</span> <span class="id">delta0</span> <span class="id">b0</span>. <span class="tactic">split</span>; <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_incr">globalenv_inject_incr</a></span> <span class="kwd">with</span> (<span class="id">j</span>' := <span class="id">j1</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">X</span> <span class="id">Y</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#alloc_parallel_rule">alloc_parallel_rule</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap4">sep_swap4</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap4">sep_swap4</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#globalenv_inject_incr">globalenv_inject_incr</a></span> <span class="kwd">with</span> <span class="id">j1</span> <span class="id">m1</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">j1</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">rewrite</span> <span class="id">D</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">j1</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b1</span>). <span class="tactic">congruence</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H9</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_prologue_correct">function_prologue_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls1</span> <span class="id">rs</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">m1</span>' <span class="id">m2</span> <span class="id">sp</span> <span class="id">parent</span> <span class="id">ra</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">k</span> <span class="id">lf</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> = <span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="LTL.html#call_regs">LTL.call_regs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#rs1">rs1</a></span> = <span class="id"><a href="Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="stacking_proof.html#m1">m1</a></span> 0 <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) = (<span class="id"><a href="stacking_proof.html#m2">m2</a></span>, <span class="id"><a href="stacking_proof.html#sp">sp</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="AST.html#Tptr">Tptr</a></span> -&gt; <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="stacking_proof.html#ra">ra</a></span> <span class="id"><a href="AST.html#Tptr">Tptr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">m1</span>' |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m1">m1</a></span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>', <span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">m2</span>', <span class="id">exists</span> <span class="id">sp</span>', <span class="id">exists</span> <span class="id">m3</span>', <span class="id">exists</span> <span class="id">m4</span>', <span class="id">exists</span> <span class="id">m5</span>', <span class="id">exists</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m1</span>' 0 <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_stacksize">fn_stacksize</a></span>) = (<span class="id">m2</span>', <span class="id">sp</span>')<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id">m2</span>' (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="AST.html#Tptr">Tptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_link_ofs">fn_link_ofs</a></span>) <span class="id"><a href="stacking_proof.html#parent">parent</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m3</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id">m3</span>' (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="AST.html#Tptr">Tptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>) <span class="id"><a href="stacking_proof.html#ra">ra</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m4</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#star">star</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">save_callee_save</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) <span class="id"><a href="stacking_proof.html#rs1">rs1</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id">m4</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#fp">fp</a></span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id">m5</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> <span class="id">rs</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">m5</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id">j</span>' <span class="id">sp</span>' <span class="id"><a href="stacking_proof.html#ls1">ls1</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#parent">parent</a></span> <span class="id"><a href="stacking_proof.html#ra">ra</a></span> ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#m2">m2</a></span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>' ** <span class="id"><a href="stacking_proof.html#P">P</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span>))<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>'<br/>
<div class="doc">add properties about fp: simply contained in sp. </div>
&nbsp;&nbsp;/\ <span class="id"><a href="InjRels.html#sep_inject">sep_inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> <span class="id">b</span> <span class="id">_</span> =&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span>' <span class="id"><a href="stacking_proof.html#b">b</a></span>) <span class="id">m1</span>' <span class="id">m5</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id">sp</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7684')">Proof.</div>
<div class="proofscript" id="proof7684">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">P</span>; <span class="tactic">intros</span> <span class="id">AGREGS</span> <span class="id">AGCS</span> <span class="id">WTREGS</span> <span class="id">LS1</span> <span class="id">RS1</span> <span class="id">ALLOC</span> <span class="id">TYPAR</span> <span class="id">TYRA</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#fn_stacksize">fn_stacksize</a></span>, <span class="id"><a href="Mach.html#fn_link_ofs">fn_link_ofs</a></span>, <span class="id"><a href="Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>.<br/>
&nbsp;Stack&nbsp;layout&nbsp;info&nbsp;*)</span><span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="stacking_proof.html#b">b</a></span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Stacklayout.html#frame_env_range">frame_env_range</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="Stacklayout.html#frame_env_aligned">frame_env_aligned</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>). <span class="tactic">replace</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">with</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">LAYOUT1</span> <span class="id">LAYOUT2</span>.<br/>
&nbsp;Allocation&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m1</span>' 0 (<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>)) <span class="kwd">as</span> [<span class="id">m2</span>' <span class="id">sp</span>'] <span class="id">eqn</span>:<span class="id">ALLOC</span>'.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">alloc_parallel_rule_2</span>'.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">ALLOC</span>. <span class="id">eexact</span> <span class="id">ALLOC</span>'. <br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>). <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> + <span class="id"><a href="Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_comm">Z.max_comm</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#bound_stack_data_pos">bound_stack_data_pos</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="stacking_proof.html#size_no_overflow">size_no_overflow</a></span>) <span class="id">LAYOUT1</span>. <br/>
&nbsp;&nbsp;<span class="tactic">clear</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">LAYOUT1</span>. <span class="tactic">subst</span> <span class="id">b</span> <span class="id">fe</span>. <span class="tactic">omega</span>. <br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">SEP</span> <span class="id">into</span> <span class="id">SEPOLD</span>. <span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">SEP</span> &amp; <span class="id">INCR</span> &amp; <span class="id">SAME</span> &amp; <span class="id">SEPINJ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;Remember&nbsp;the&nbsp;freeable&nbsp;permissions&nbsp;using&nbsp;a&nbsp;mconj&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SEPCONJ</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m2</span>' |= <span class="id"><a href="Separation.html#mconj">mconj</a></span> (<span class="id"><a href="Separation.html#range">range</a></span> <span class="id">sp</span>' 0 (<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>) ** <span class="id"><a href="Separation.html#range">range</a></span> <span class="id">sp</span>' (<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> + <span class="id"><a href="Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Separation.html#range">range</a></span> <span class="id">sp</span>' 0 (<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>) ** <span class="id"><a href="Separation.html#range">range</a></span> <span class="id">sp</span>' (<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> + <span class="id"><a href="Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m2</span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>' ** <span class="id">P</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_intro">mconj_intro</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">assumption</span>. }<br/>
&nbsp;Dividing&nbsp;up&nbsp;the&nbsp;frame&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="Stacklayout.html#frame_env_separated">frame_env_separated</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">replace</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">with</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="kwd">in</span> <span class="id">SEP</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;Store&nbsp;of&nbsp;parent&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="Separation.html#range_contains">range_contains</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span>) <span class="kwd">in</span> <span class="id">SEP</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#contains_set_stack">contains_set_stack</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id">v</span>' = <span class="id">parent</span>) <span class="id">parent</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">m2</span>' <span class="id"><a href="AST.html#Tptr">Tptr</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.load_result_same">Val.load_result_same</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m3</span>' &amp; <span class="id">STORE_PARENT</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;Store&nbsp;of&nbsp;return&nbsp;address&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap4">sep_swap4</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="Separation.html#range_contains">range_contains</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span>) <span class="kwd">in</span> <span class="id">SEP</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#contains_set_stack">contains_set_stack</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id">v</span>' = <span class="id">ra</span>) <span class="id">ra</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">m3</span>' <span class="id"><a href="AST.html#Tptr">Tptr</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.load_result_same">Val.load_result_same</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m4</span>' &amp; <span class="id">STORE_RETADDR</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap4">sep_swap4</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;Saving&nbsp;callee-save&nbsp;registers&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap5">sep_swap5</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#save_callee_save_correct">save_callee_save_correct</a></span> <span class="id">j</span>' <span class="id">ls</span> <span class="id">ls0</span> <span class="id">rs</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_inject_incr">agree_regs_inject_incr</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="LTL.html#call_regs">call_regs</a></span> <span class="id">ls</span>)) <span class="kwd">with</span> <span class="id">ls1</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id">rs</span>) <span class="kwd">with</span> <span class="id">rs1</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m5</span>' &amp; <span class="id">fp</span> &amp; <span class="id">SAVE_CS</span> &amp; <span class="id">SEP</span> &amp; <span class="id">PERMS</span> &amp; <span class="id">AGREGS</span>' &amp; <span class="id">UNCHG</span> &amp; <span class="id">FP_sp</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap5">sep_swap5</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;Materializing&nbsp;the&nbsp;Local&nbsp;and&nbsp;Outgoing&nbsp;locations&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#initial_locations">initial_locations</a></span> <span class="id">j</span>'). <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">tauto</span>. <br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="kwd">Local</span>). <span class="id">instantiate</span> (1 := <span class="id">ls1</span>). <br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">LS1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#initial_locations">initial_locations</a></span> <span class="id">j</span>'). <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">tauto</span>. <br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span>). <span class="id">instantiate</span> (1 := <span class="id">ls1</span>). <br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">LS1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;Now&nbsp;we&nbsp;frame&nbsp;this&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SEPFINAL</span>: <span class="id">m5</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id">j</span>' <span class="id">sp</span>' <span class="id">ls1</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">ra</span> ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m2</span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>' ** <span class="id">P</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#frame_mconj">frame_mconj</a></span>. <span class="id">eexact</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m2</span>' <span class="id">sp</span>' <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m5</span>' <span class="id">sp</span>' <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PERMS</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">STORE_PARENT</span>, <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE_PARENT</span>, <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_preserved">sep_preserved</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="Separation.html#range_preserved">range_preserved</a></span> <span class="kwd">with</span> <span class="id">m2</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="Separation.html#range_preserved">range_preserved</a></span> <span class="kwd">with</span> <span class="id">m2</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;Conclusions&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>', <span class="id">rs2</span>, <span class="id">m2</span>', <span class="id">sp</span>', <span class="id">m3</span>', <span class="id">m4</span>', <span class="id">m5</span>', <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">STORE_PARENT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eexact</span> <span class="id">SAVE_CS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">AGREGS</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">LS1</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>; [|<span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="LTL.html#call_regs">call_regs</a></span>. <span class="tactic">apply</span> <span class="id">AGCS</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="LTL.html#call_regs">call_regs</a></span>. <span class="tactic">apply</span> <span class="id">AGCS</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">SEPFINAL</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">SAME</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">INCR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span> <span class="id">b1</span> <span class="id">b1</span>' <span class="id">bimg</span> <span class="id">ofs1</span> <span class="id">ofs1</span>' <span class="id">INJ1</span> <span class="id">INJ1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b1</span>' <span class="id">sp</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>'. <span class="tactic">rewrite</span> <span class="id">SAME</span> <span class="kwd">in</span> <span class="id">INJ1</span>'. <span class="id">inv</span> <span class="id">INJ1</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span> <span class="kwd">in</span> <span class="id">ALLOC</span>'. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEPOLD</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEPOLD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.mi_mappedblocks">Mem.mi_mappedblocks</a></span> <span class="kwd">in</span> <span class="id">INJ1</span>; <span class="tactic">eauto</span>. <span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">ALLOC</span>'. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">SEPINJ</span> <span class="kwd">in</span> <span class="id">n</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ALLOC</span>') <span class="kwd">as</span> <span class="id">SPFRESH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span> <span class="id">m4</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span> <span class="id">m3</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span> <span class="id">m2</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> <span class="id">STORE_PARENT</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE_PARENT</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> <span class="id">STORE_RETADDR</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE_RETADDR</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_implies">Mem.unchanged_on_implies</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The following lemmas show the correctness of the register reloading
  code generated by <span class="bracket"><span class="id">reload_callee_save</span></span>: after this code has executed,
  all callee-save registers contain the same values they had at
  function entry. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE">RESTORE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span>: <span class="id"><a href="Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span>: <span class="id"><a href="Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_unused">agree_unused</a></span> (<span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) (<span class="id">rs</span>: <span class="id"><a href="Mach.html#regset">regset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="restore_callee_save_rec_correct">restore_callee_save_rec_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">rs</span> <span class="id">k</span> <span class="id">lf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> -&gt; <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">star</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">restore_callee_save_rec</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#fp">fp</a></span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#r">r</a></span>))<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>) -&gt; <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id">rs</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7685')">Proof.</div>
<div class="proofscript" id="proof7685">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">l</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>, <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">star_refl</a></span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
- <span class="comment">(*&nbsp;inductive&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ty</span> := <span class="id"><a href="Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">sz</span> := <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ofs1</span> := <span class="id"><a href="Coqlib.html#align">align</a></span> <span class="id">ofs</span> <span class="id">sz</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SZPOS</span>: <span class="id">sz</span> &gt; 0) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="AST.html#typesize_pos">AST.typesize_pos</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">OFSLE</span>: <span class="id">ofs</span> &lt;= <span class="id">ofs1</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#align_le">align_le</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">BOUND</span>: <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id">r</span>) <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#contains_get_stack">contains_get_stack</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">LOAD</span> &amp; <span class="id">SPEC</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHl</span> (<span class="id">ofs1</span> + <span class="id">sz</span>) (<span class="id">rs</span>#<span class="id">r</span> &lt;- <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Mach.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>'. <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">star_step</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">exact</span> <span class="id">LOAD</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r0</span> <span class="id">l</span>). <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">r</span> = <span class="id">r0</span>) <span class="tactic">by</span> <span class="tactic">tauto</span>. <span class="tactic">subst</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Mach.html#Regmap.gss">Regmap.gss</a></span>. <span class="tactic">exact</span> <span class="id">SPEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">tauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Mach.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H3</span>; <span class="tactic">clear</span>; <span class="id">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span>, <span class="id"><a href="FMemOpFP.html#load_fp">FMemOpFP.load_fp</a></span>, <span class="id"><a href="FMemOpFP.html#range_locset">FMemOpFP.range_locset</a></span>, <span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span>, <span class="id"><a href="Footprint.html#Locs.blocks">Locs.blocks</a></span>. <span class="id">Locs.unfolds</span>. <span class="tactic">intros</span> (<span class="id">ofs</span>' &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">red_boolean_true</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE">RESTORE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="restore_callee_save_correct">restore_callee_save_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">pa</span> <span class="id">ra</span> <span class="id">P</span> <span class="id">rs</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">lf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#pa">pa</a></span> <span class="id"><a href="stacking_proof.html#ra">ra</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">star</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">restore_callee_save</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#fp">fp</a></span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)) (<span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#r">r</a></span>))<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id">rs</span>' <span class="id"><a href="stacking_proof.html#r">r</a></span> = <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#r">r</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7686')">Proof.</div>
<div class="proofscript" id="proof7686">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick5">sep_pick5</a></span> <span class="kwd">in</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#restore_callee_save_rec_correct">restore_callee_save_rec_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">fp</span>  &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eexact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r</span> (<span class="id"><a href="Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">C</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> (<span class="id"><a href="Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollary, we obtain the following correctness result for
  the execution of a function epilogue (reloading of used callee-save
  registers + reloading of the link and return address + freeing
  of the frame). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_epilogue_correct">function_epilogue_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">sp</span>' <span class="id">ls</span> <span class="id">ls0</span> <span class="id">pa</span> <span class="id">ra</span> <span class="id">P</span> <span class="id">m</span> <span class="id">rs</span> <span class="id">sp</span> <span class="id">m1</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">lf</span>,<br/>
&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">sp</span>' <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#pa">pa</a></span> <span class="id"><a href="stacking_proof.html#ra">ra</a></span> ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> 0 <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs1</span>, <span class="id">exists</span> <span class="id">m1</span>', <span class="id">exists</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id">m</span>' (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="AST.html#Tptr">Tptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_link_ofs">fn_link_ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#pa">pa</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id">m</span>' (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="AST.html#Tptr">Tptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#ra">ra</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>' <span class="id">sp</span>' 0 <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_stacksize">fn_stacksize</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#star">star</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">restore_callee_save</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#fp">fp</a></span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#k">k</a></span> <span class="id"><a href="stacking_proof.html#rs1">rs1</a></span> <span class="id"><a href="stacking_proof.html#lf">lf</a></span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="id"><a href="LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#rs1">rs1</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">m1</span>' |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m1">m1</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id">sp</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7687')">Proof.</div>
<div class="proofscript" id="proof7687">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">lf</span>; <span class="tactic">intros</span> <span class="id">SEP</span> <span class="id">AGR</span> <span class="id">AGL</span> <span class="id">INJ</span> <span class="id">FREE</span>.<br/>
&nbsp;Can&nbsp;free&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#free_parallel_rule">free_parallel_rule</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">FREE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_comm">Z.max_comm</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">m1</span>' &amp; <span class="id">FREE</span>' &amp; <span class="id">SEP</span>').<br/>
&nbsp;Reloading&nbsp;the&nbsp;callee-save&nbsp;registers&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#restore_callee_save_correct">restore_callee_save_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">rs</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">AGL</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">agree_unused_reg0</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">AGR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">fp</span> &amp; <span class="id">LOAD_CS</span> &amp; <span class="id">CS</span> &amp; <span class="id">NCS</span> &amp; <span class="id">HFP</span>).<br/>
&nbsp;Reloading&nbsp;the&nbsp;back&nbsp;link&nbsp;and&nbsp;return&nbsp;address&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">apply</span> <span class="id"><a href="Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#hasvalue_get_stack">hasvalue_get_stack</a></span> <span class="id"><a href="AST.html#Tptr">Tptr</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">intros</span> <span class="id">LOAD_LINK</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#hasvalue_get_stack">hasvalue_get_stack</a></span> <span class="id"><a href="AST.html#Tptr">Tptr</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_pick4">sep_pick4</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">intros</span> <span class="id">LOAD_RETADDR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>.<br/>
&nbsp;Conclusions&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">m1</span>', <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id"><a href="LTL.html#return_regs">return_regs</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn</span>:<span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">CS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NCS</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">AGR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id"><a href="LTL.html#return_regs">return_regs</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.FRAME_PROPERTIES">FRAME_PROPERTIES</a></span>.<br/>
<br/>
<h1> Call stack invariants </h1>
<br/>
<div class="doc">This is the memory assertion that captures the contents of the stack frames
  mentioned in the call stacks. </div>
<br/>
<br/>
<div class="doc">TODO:
    since we made additional load_frame, need a new assertion relating load_frame and stack frames. 
    Partly done.. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="stack_contents">stack_contents</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>) (<span class="id">f0</span>: <span class="id"><a href="Linear.html#function">Linear.function</a></span>) (<span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>) (<span class="id">sp0</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">tyl0</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="AST.html#typ">typ</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Linear.html#stackframe">Linear.stackframe</a></span>) (<span class="id">cs</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Mach.html#stackframe">Mach.stackframe</a></span>) : <span class="id"><a href="Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>, <span class="id">cs</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span>) <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id">f</span> <span class="id">_</span> <span class="id">ls</span> <span class="id">c</span> :: <span class="id">cs</span>, <span class="id"><a href="Mach.html#Stackframe">Mach.Stackframe</a></span> <span class="id">fb</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id">_</span>) <span class="id">ra</span> <span class="id">c</span>' :: <span class="id">cs</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">sp</span>' <span class="id">ls</span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>) (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>') (<span class="id"><a href="Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_stacks</span></span> captures additional properties (not related to memory)
  of the Linear and Mach call stacks. </div>
<br/>
<div class="doc">TODO:
    we permit initial function to have arbitrary signature, thus might invalidate tailcall_possible.
    how do we specify sg in match_stacks? </div>
<br/>
<div class="doc">generic lemma, should be put in loadframe.v </div>
<span class="kwd">Lemma</span> <span class="id"><a name="arg_len_rec_val">arg_len_rec_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#args_len_rec">loadframe.args_len_rec</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#z">z</a></span> = <span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7688')">Proof.</div>
<div class="proofscript" id="proof7688">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">induction</span> <span class="id">args0</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tyl0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tyl0</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id"><a href="val_casted.html#val_has_type_func">val_has_type_func</a></span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#args_len_rec">loadframe.args_len_rec</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHargs0</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">subst</span> <span class="id">z0</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tyl_length_non_neg">tyl_length_non_neg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> &gt;= 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7689')">Proof.</div>
<div class="proofscript" id="proof7689">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span>[|<span class="id">a</span> <span class="id">h</span>']; <span class="tactic">simpl</span>; [| <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">a</span>)]; <span class="tactic">omega</span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="stack_contains_match_stacks_args_agree_rec">stack_contains_match_stacks_args_agree_rec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> 0 (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span>) <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AST.html#sig_args">sig_args</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span>) = <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span>)) <span class="id"><a href="stacking_proof.html#args0">args0</a></span> (<span class="id"><a href="Locations.html#Locmap.init">Locmap.init</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>) = <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="stacking_proof.html#n">n</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">headN</span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> - <span class="id"><a href="stacking_proof.html#n">n</a></span>)%<span class="id">nat</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tyl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id"><a href="stacking_proof.html#headN">headN</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id"><a href="stacking_proof.html#headN">headN</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">headn</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id"><a href="stacking_proof.html#headN">headN</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ofs</span> := <span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> <span class="id"><a href="stacking_proof.html#headn">headn</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">args</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#agree_args_contains_aux">loadframe.agree_args_contains_aux</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id">args</span>' <span class="id"><a href="stacking_proof.html#tyl">tyl</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#args">args</a></span> <span class="id">args</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7690')">Proof.</div>
<div class="proofscript" id="proof7690">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">until</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">args0</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> ((?&amp;?)&amp;?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span> <span class="id">H1</span>. <span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">tyl0</span>; <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">args0</span>; <span class="tactic">destruct</span> <span class="id">tyl0</span>; <span class="tactic">intro</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">simpl</span>. <span class="id">erewrite</span> <span class="id">IHargs0</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span> <span class="id">headN</span>. <span class="tactic">subst</span> <span class="id">tyl</span> <span class="id">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="stacking_proof.html#A">A</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>) <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_0_r">Nat.sub_0_r</a></span>, <span class="id">H5</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H3</span>, <span class="id">H5</span>. <span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n</span>&lt;=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="id">specialize</span> (<span class="id">IHn</span> <span class="id">H5</span>); <span class="tactic">clear</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="stacking_proof.html#A">A</a></span>) <span class="id">n</span>, <span class="id"><a href="stacking_proof.html#n">n</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>, <span class="id"><a href="stacking_proof.html#l">l</a></span> = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id"><a href="stacking_proof.html#n">n</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>) ++ <span class="id"><a href="stacking_proof.html#a">a</a></span> :: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id"><a href="stacking_proof.html#n">n</a></span> + 1) <span class="id"><a href="stacking_proof.html#l">l</a></span>))%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">n</span> <span class="id">l</span>) <span class="kwd">as</span> <span class="id">h</span>. <span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id">n</span>+1) <span class="id">l</span>)%<span class="id">nat</span> <span class="kwd">as</span> <span class="id">t</span>. <span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id">n</span> <span class="id">l</span>)%<span class="id">nat</span> <span class="kwd">as</span> <span class="id">t</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_skipn">firstn_skipn</a></span> (<span class="id">n</span>+1)%<span class="id">nat</span> <span class="id">l</span>). <span class="tactic">rewrite</span> &lt;- <span class="id">Heqt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_skipn">firstn_skipn</a></span> (<span class="id">n</span>)%<span class="id">nat</span> <span class="id">l</span>). <span class="tactic">rewrite</span> &lt;- <span class="id">Heqh</span>, &lt;- <span class="id">Heqt</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">n</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">h</span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_app_2">firstn_app_2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">exists</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> 1 <span class="id">t</span>' = <span class="id"><a href="stacking_proof.html#a">a</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>). <span class="tactic">intros</span> [<span class="id">a</span> ?]. <span class="id">exists</span> <span class="id">a</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">t</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id">n</span> <span class="id">l</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">Heqh</span> <span class="id">Heqt</span>. <span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">n</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">n</span> <span class="id">H</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_skipn">firstn_skipn</a></span> <span class="id">n</span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">n</span> <span class="id">l</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id">n</span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id">n</span> <span class="id">l</span>) &gt; 0)%<span class="id">nat</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> <span class="id">n</span> <span class="id">l</span>) <span class="id">eqn</span>:?; [<span class="id">contradiction</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">Heqh</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span>; <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H6</span> <span class="id">_</span> <span class="id">tyl0</span> <span class="id">headN</span>). <span class="tactic">subst</span> <span class="id">headN</span>; <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">ty</span> <span class="id">Htyl0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H6</span> <span class="id">_</span> <span class="id">args0</span> <span class="id">headN</span>). <span class="tactic">subst</span> <span class="id">headN</span>; <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">v</span> <span class="id">Hargs0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">tyl</span> <span class="kwd">with</span> (<span class="id">ty</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>) <span class="id">tyl0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">args</span> <span class="kwd">with</span> (<span class="id">v</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>) <span class="id">args0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#agree_args_contains_aux">loadframe.agree_args_contains_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#load_stack">loadframe.load_stack</a></span>, <span class="id"><a href="Mach.html#load_stack">Mach.load_stack</a></span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">_</span> &amp; <span class="id">_</span> &amp; ? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_l">Z.add_0_l</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id">headn</span>) <span class="kwd">as</span> <span class="id">ofsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="stacking_proof.html#tyl_length_non_neg">tyl_length_non_neg</a></span> <span class="id">headn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ofsn</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id">ty</span> &lt;= <span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id">tyl0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Htyl0</span>. <span class="tactic">subst</span> <span class="id">ofsn</span> <span class="id">headn</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">headN</span> <span class="id">tyl0</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id">headN</span>+1) <span class="id">tyl0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">l</span> <span class="id">l0</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="stacking_proof.html#tyl_length_non_neg">tyl_length_non_neg</a></span> <span class="id">l0</span>); <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHn</span> <span class="kwd">as</span> [<span class="id">args</span>' [<span class="id">AGREE</span>' <span class="id">INJLIST</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id">v</span> <span class="id">ty</span> /\ <span class="id">v</span> &lt;&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span>) <span class="kwd">as</span> [? ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">H3</span> <span class="id">H0</span> <span class="id">Htyl0</span> <span class="id">Hargs0</span>; <span class="tactic">clear</span>. <span class="tactic">generalize</span> <span class="id">headN</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">n</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">n</span> <span class="id">tyl0</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">n</span> <span class="id">args0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_dec">le_dec</a></span> <span class="id">n</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">args0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_all2">firstn_all2</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_all2">firstn_all2</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#wd_args">wd_args</a></span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span>. <span class="tactic">intros</span> ((? &amp; ?) &amp; ?) ? ? .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="val_casted.html#val_has_type_list_func_charact">val_has_type_list_func_charact</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Htyl0</span>, <span class="id">Hargs0</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Hargs0</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="val_casted.html#has_type_list_tail">has_type_list_tail</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="val_casted.html#vals_defined_tail">vals_defined_tail</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>, <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="tactic">tauto</span>| <span class="tactic">intro</span>; <span class="tactic">subst</span>; <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="val_casted.html#wd_args_set_arguments_get_agree">wd_args_set_arguments_get_agree</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f0</span>) <span class="id">args0</span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f0</span>)) <span class="id">ls0</span>) <span class="kwd">as</span> <span class="id">Hls0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">Hls0</span>. <span class="id">specialize</span> (<span class="id">Hls0</span> <span class="id">H0</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">H2</span> <span class="id">headN</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Tlong">Tlong</a></span> =&gt; <span class="id"><a href="AST.html#Twolong">Twolong</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> (<span class="id">ofsn</span> + 1) <span class="id"><a href="AST.html#Tint">Tint</a></span>) (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">ofsn</span> <span class="id"><a href="AST.html#Tint">Tint</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="AST.html#One">One</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">ofsn</span> <span class="id">ty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Hls0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="tactic">inversion</span> <span class="id">C</span>; <span class="tactic">clear</span> <span class="id">C</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Htyl0</span>. <span class="tactic">generalize</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">Htyl0</span> <span class="id">Heqofsn</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">assert</span> (<span class="id">headN</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span>)%<span class="id">nat</span> <span class="tactic">by</span> (<span class="tactic">subst</span> <span class="id">headN</span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_0_r_reverse">Zplus_0_r_reverse</a></span> (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id">headn</span>)) <span class="kwd">in</span> <span class="id">Heqofsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">headN</span> <span class="id">headn</span>. <span class="tactic">generalize</span> <span class="id">H</span> <span class="id">Htyl0</span> <span class="id">Heqofsn</span>; <span class="tactic">clear</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span>)%<span class="id">nat</span>. <span class="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tyl0</span>. <span class="tactic">intros</span> <span class="id">until</span> 1. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id">IHtyl0</span>; <span class="tactic">clear</span> <span class="id">IHtyl0</span>; [<span class="tactic">omega</span>|<span class="tactic">congruence</span>|<span class="tactic">omega</span>]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">Hargs_v</span>' &amp; <span class="id">Val_v</span>'); <span class="tactic">clear</span> <span class="id">Hls0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">v</span> = <span class="id">v</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">Hargs_v</span>' <span class="id">Hargs0</span> <span class="id">H3</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">headN</span>. <span class="tactic">rewrite</span> <span class="id">Hargs0</span>, &lt;-<span class="id">H3</span> <span class="kwd">in</span> <span class="id">Hargs_v</span>'. <span class="tactic">clear</span> <span class="id">Hargs0</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">args0</span> - (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span>) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">args0</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span> <span class="id">Hargs_v</span>'. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">args0</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span>)%<span class="id">nat</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_app2">nth_error_app2</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_diag">Nat.sub_diag</a></span> <span class="kwd">in</span> <span class="id">Hargs_v</span>'; <span class="tactic">auto</span>. <span class="tactic">inversion</span> <span class="id">Hargs_v</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ty</span> = <span class="id"><a href="AST.html#Tlong">Tlong</a></span> \/ <span class="id">ty</span> &lt;&gt; <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="kwd">as</span> [<span class="id">Case_long</span> | <span class="id">Case_normal</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span>. <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">auto</span>; <span class="id">right</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>. }<br/>
&nbsp;Tlong&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">ty</span>. <span class="tactic">simpl</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H8</span> (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id">headn</span>) <span class="id"><a href="AST.html#Tint">Tint</a></span>); <span class="tactic">try</span> (<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">omega</span>; <span class="tactic">fail</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqofsn</span>. <span class="tactic">intros</span> (<span class="id">vlo</span> &amp; <span class="id">LOAD2</span> &amp; <span class="id">INJ2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H8</span> (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id">headn</span> + 1) <span class="id"><a href="AST.html#Tint">Tint</a></span>); <span class="tactic">try</span> (<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">omega</span>; <span class="tactic">fail</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Heqofsn</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_add_distr_l">Z.mul_add_distr_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_1_r">Z.mul_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">vhi</span> &amp; <span class="id">LOAD1</span> &amp; <span class="id">INJ1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v</span>'::<span class="id">args</span>'). <span class="tactic">destruct</span> <span class="id">v</span>'; <span class="tactic">inversion</span> <span class="id">H11</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="loadframe.html#tyl_length_agree">loadframe.tyl_length_agree</a></span> <span class="id">tyl0</span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span> <span class="kwd">in</span> <span class="id">H13</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (0 &lt;= <span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> <span class="id">headn</span> + 4 &lt; <span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> <span class="id">tyl0</span>). <span class="tactic">rewrite</span> &lt;- <span class="id">H13</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">loadframe.red_ptr</span>.<br/>
&nbsp;Vhi&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">ofs</span> <span class="id">headn</span>. <span class="id">loadframe.red_ptr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqofsn</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_l">Z.add_0_l</a></span>, <span class="id"><a href="loadframe.html#tyl_length_agree">loadframe.tyl_length_agree</a></span> <span class="kwd">in</span> <span class="id">LOAD1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LOAD1</span>. <span class="tactic">rewrite</span> <span class="id">LOAD1</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">INJ1</span> <span class="id">INJ2</span> <span class="id">Val_v</span>'; <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span>, <span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">ls0</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> (<span class="id">ofsn</span> + 1) <span class="id"><a href="AST.html#Tint">Tint</a></span>)) (<span class="id">ls0</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">ofsn</span> <span class="id"><a href="AST.html#Tint">Tint</a></span>)). <span class="tactic">clear</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">vhi0</span> <span class="id">vlo0</span> <span class="id">INJhi</span> <span class="id">INJlo</span> [<span class="id">Heqhi</span> <span class="id">Heqlo</span>]. <span class="tactic">subst</span>; <span class="id">inv</span> <span class="id">INJhi</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;Vlo&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">ofs</span> <span class="id">headn</span>. <span class="id">loadframe.red_ptr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">headN</span> <span class="id">tyl0</span>) &lt; 4 * <span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id">tyl0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- <span class="id">context</span>[<span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> ?<span class="id">x</span>] =&gt; <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="loadframe.html#tyl_bytes_non_neg">loadframe.tyl_bytes_non_neg</a></span> <span class="id">x</span>); <span class="tactic">omega</span> <span class="kwd">end</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">loadframe.red_ptr</span>. <span class="tactic">rewrite</span> <span class="id">Heqofsn</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_l">Z.add_0_l</a></span>, <span class="id"><a href="loadframe.html#tyl_length_agree">loadframe.tyl_length_agree</a></span> <span class="kwd">in</span> <span class="id">LOAD2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LOAD2</span>. <span class="tactic">rewrite</span> <span class="id">LOAD2</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">INJ1</span> <span class="id">INJ2</span> <span class="id">Val_v</span>'; <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span>, <span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">ls0</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> (<span class="id">ofsn</span> + 1) <span class="id"><a href="AST.html#Tint">Tint</a></span>)) (<span class="id">ls0</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">ofsn</span> <span class="id"><a href="AST.html#Tint">Tint</a></span>)). <span class="tactic">clear</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">vhi0</span> <span class="id">vlo0</span> <span class="id">INJhi</span> <span class="id">INJlo</span> [<span class="id">Heqhi</span> <span class="id">Heqlo</span>]. <span class="tactic">subst</span>; <span class="id">inv</span> <span class="id">INJlo</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">AGREE</span>'. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> <span class="id">headn</span> + <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span> = (<span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>) <span class="id">tyl0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">OFS</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">OFS</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">ofs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">headn</span> ++ <span class="id"><a href="AST.html#Tlong">Tlong</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>) <span class="id">tyl0</span>). <span class="tactic">intro</span> <span class="id">A</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="loadframe.html#tyl_bytes_app">loadframe.tyl_bytes_app</a></span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H5</span>. <span class="tactic">subst</span> <span class="id">headn</span> <span class="id">headN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span>)%<span class="id">nat</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span>)%<span class="id">nat</span> <span class="id">Htyl0</span> <span class="id">H15</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span> <span class="id">n</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id">n</span> + 1) <span class="id">tyl0</span>)%<span class="id">nat</span>. <span class="tactic">intros</span> <span class="id">l</span> <span class="id">Htyl0</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">n</span> <span class="id">tyl0</span>) = <span class="id">n</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">n</span> <span class="id">tyl0</span>) <span class="id">H0</span> <span class="id">H</span> <span class="id">Htyl0</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">Htyl0</span>. <span class="tactic">clear</span> <span class="id">Htyl0</span> <span class="id">H0</span> <span class="id">tyl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">n</span>. <span class="tactic">induction</span> <span class="id">l0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> (<span class="id">l0</span> ++ <span class="id"><a href="AST.html#Tlong">Tlong</a></span> :: <span class="id">l</span>) <span class="id">eqn</span>:<span class="id">C</span>. <span class="tactic">destruct</span> <span class="id">l0</span>; <span class="id">inv</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">IHl0</span>. <span class="tactic">auto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Htyl0</span>. <span class="tactic">subst</span> <span class="id">headn</span>. <span class="tactic">clear</span>. <span class="tactic">rewrite</span> <span class="id"><a href="loadframe.html#tyl_bytes_app">loadframe.tyl_bytes_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span>; <span class="id">fold</span> <span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="AST.html#typesize">AST.typesize</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="loadframe.html#tyl_bytes_non_neg">loadframe.tyl_bytes_non_neg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">headN</span> <span class="id">tyl0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="loadframe.html#tyl_bytes_non_neg">loadframe.tyl_bytes_non_neg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id">headN</span> + 1) <span class="id">tyl0</span>)). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;not&nbsp;Tlong&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H8</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">try</span> (<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v0</span> &amp; <span class="id">LOAD</span> &amp; <span class="id">INJ</span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_l">Z.add_0_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span> <span class="kwd">in</span> <span class="id">LOAD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofsn</span> * 4).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ls0</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">ofsn</span> <span class="id">ty</span>) = <span class="id">v</span>') <span class="kwd">as</span> <span class="id">Val_v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">auto</span>. <span class="id">contradiction</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Htriv</span>: <span class="id">ofsn</span> * 4 + <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span> = (<span class="id"><a href="loadframe.html#tyl_bytes">loadframe.tyl_bytes</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>) <span class="id">tyl0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">ofsn</span>. <span class="tactic">rewrite</span> <span class="id"><a href="loadframe.html#tyl_length_agree">loadframe.tyl_length_agree</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Htyl0</span> <span class="tactic">at</span> 2. <span class="tactic">subst</span> <span class="id">headn</span> <span class="id">headN</span>. <span class="tactic">generalize</span> <span class="id">H5</span> <span class="id">H4</span>. <span class="tactic">clear</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#skipn">skipn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span> + 1) <span class="id">tyl0</span>). <span class="tactic">intro</span> <span class="id">l</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H5</span>. <span class="tactic">clear</span> <span class="id">H5</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">Datatypes.S</a></span> <span class="id">n</span>)%<span class="id">nat</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_length_le">firstn_length_le</a></span> <span class="id">tyl0</span>). <span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>)%<span class="id">nat</span>). <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>)%<span class="id">nat</span>, (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">tyl0</span> - <span class="id">n</span>) <span class="id">tyl0</span>). <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_1_r">Nat.add_1_r</a></span>, &lt;- <span class="id">H</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_app_2">firstn_app_2</a></span>, <span class="id"><a href="loadframe.html#tyl_bytes_app">loadframe.tyl_bytes_app</a></span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">ofsn</span> * 4 &lt;= <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">ofsn</span> <span class="id">headn</span>. <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">generalize</span> <span class="id">H10</span> <span class="id">H</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Val_v</span>'. <span class="id">exists</span> (<span class="id">v0</span> :: <span class="id">args</span>'). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">contradiction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">split</span>; [<span class="tactic">auto</span>; <span class="tactic">simpl</span>; <span class="id">loadframe.red_ptr</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">auto</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Htriv</span>; <span class="tactic">auto</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">ofsn</span> <span class="id">ofs</span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#tyl_length_agree">loadframe.tyl_length_agree</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_skipn">firstn_skipn</a></span> <span class="id">headN</span> <span class="id">args0</span>). <span class="tactic">eapply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_inv_head">app_inv_head</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">headN</span> <span class="id">args0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">headn</span> <span class="id">args</span> <span class="id">headN</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_1_r">Nat.add_1_r</a></span>, <span class="id">H5</span> <span class="kwd">in</span> <span class="id">Hargs0</span>. <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn_skipn">firstn_skipn</a></span> <span class="id">headN</span> <span class="id">tyl0</span>). <span class="tactic">eapply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_inv_head">app_inv_head</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#firstn">firstn</a></span> <span class="id">headN</span> <span class="id">tyl0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">headn</span> <span class="id">tyl</span> <span class="id">headN</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_1_r">Nat.add_1_r</a></span>, <span class="id">H5</span> <span class="kwd">in</span> <span class="id">Htyl0</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stack_contains_match_stacks_args_agree">stack_contains_match_stacks_args_agree</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> 0 (<span class="id"><a href="loadframe.html#tyl_length">loadframe.tyl_length</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span>) <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AST.html#sig_args">sig_args</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span>) = <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span>)) <span class="id"><a href="stacking_proof.html#args0">args0</a></span> (<span class="id"><a href="Locations.html#Locmap.init">Locmap.init</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>) = <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">args</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#agree_args_contains">loadframe.agree_args_contains</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">args</span>' <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id">args</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7691')">Proof.</div>
<div class="proofscript" id="proof7691">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#agree_args_contains">loadframe.agree_args_contains</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">ls0</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#stack_contains_match_stacks_args_agree_rec">stack_contains_match_stacks_args_agree_rec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_diag">Nat.sub_diag</a></span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
<div class="doc">stacks are local </div>
<span class="kwd">Inductive</span> <span class="id"><a name="stacks_local">stacks_local</a></span> (<span class="id">mu</span>: <span class="id"><a href="Injections.html#Mu">Injections.Mu</a></span>) (<span class="id">sp0</span>: <span class="id"><a href="Values.html#block">block</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Mach.html#stackframe">stackframe</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="stacks_local_loadframe">stacks_local_loadframe</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span> <span class="id">sp0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id">mu</span> <span class="id">sp0</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
| <span class="id"><a name="stacks_local_cons">stacks_local_cons</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fb</span> <span class="id">sp</span> <span class="id">ra</span> <span class="id">c</span> <span class="id">cs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id">mu</span> <span class="id">sp0</span> <span class="id">cs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id">mu</span> <span class="id">sp0</span> (<span class="id"><a href="Mach.html#Stackframe">Stackframe</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ra">ra</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> :: <span class="id">cs</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_stacks">match_stacks</a></span> (<span class="id">j</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f0</span>: <span class="id"><a href="Linear.html#function">Linear.function</a></span>) (<span class="id">ls0</span>: <span class="id"><a href="Linear.html#locset">locset</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sp0</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">args0</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Values.html#val">val</a></span>) (<span class="id">tyl0</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="AST.html#typ">typ</a></span>) (<span class="id">sigres0</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="AST.html#typ">typ</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Linear.html#stackframe">Linear.stackframe</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Mach.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="AST.html#signature">signature</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="match_stacks_empty">match_stacks_empty</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg</span> <span class="id">args0_src</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SG_TAILCALL</span>: <span class="id"><a href="stacking_proof.html#sg">sg</a></span> = (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f0</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WDARGS0</span>: <span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="id"><a href="stacking_proof.html#args0_src">args0_src</a></span> <span class="id">tyl0</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGSREL</span>: <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id">j</span> <span class="id"><a href="stacking_proof.html#args0_src">args0_src</a></span> <span class="id">args0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGSVAL</span>: <span class="id">ls0</span> = <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#args0_src">args0_src</a></span> (<span class="id"><a href="Locations.html#Locmap.init">Locmap.init</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGSTYP</span>: <span class="id"><a href="AST.html#sig_args">sig_args</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f0</span>) = <span class="id">tyl0</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AST.html#sig_res">sig_res</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f0</span>) = <span class="id">sigres0</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span><br/>
| <span class="id"><a name="match_stacks_cons">match_stacks_cons</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">sp</span>' <span class="id">ra</span> <span class="id">c</span>' <span class="id">cs</span>' <span class="id">sg</span> <span class="id">trf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> (<span class="id"><a href="Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FINDF</span>: <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#trf">trf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRF</span>: <span class="id">transf_function</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#trf">trf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRC</span>: <span class="id">transl_code</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>)) <span class="id"><a href="stacking_proof.html#c">c</a></span> = <span class="id">c</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: <span class="id">j</span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', (<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TY_RA</span>: <span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="stacking_proof.html#ra">ra</a></span> <span class="id"><a href="AST.html#Tptr">Tptr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGL</span>: <span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id">ls0</span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGS</span>: <span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>) <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> :: <span class="id"><a href="stacking_proof.html#cs">cs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach.html#Stackframe">Stackframe</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#ra">ra</a></span> <span class="id">c</span>' :: <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#sg">sg</a></span>.<br/>
<br/>
<div class="doc">Invariance with respect to change of memory injection. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stack_contents_change_meminj">stack_contents_change_meminj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">j</span>', <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">tyl0</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7692')">Proof.</div>
<div class="proofscript" id="proof7692">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cs</span> <span class="kwd">as</span> [ | [] <span class="id">cs</span>]; <span class="tactic">destruct</span> <span class="id">cs</span>' <span class="kwd">as</span> [ | [] <span class="id">cs</span>']; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="kwd">with</span> (<span class="id">j</span>:=<span class="id">j</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sp1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_contents_incr">frame_contents_incr</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">apply</span> <span class="id">IHcs</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_change_meminj">match_stacks_change_meminj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">j</span>', <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg">sg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id">j</span>' <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg">sg</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7693')">Proof.</div>
<div class="proofscript" id="proof7693">
&nbsp;&nbsp;<span class="tactic">induction</span> 2; <span class="tactic">intros</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance with respect to change of signature. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_change_sig">match_stacks_change_sig</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg1</span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg">sg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="stacking_proof.html#sg1">sg1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg1">sg1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7694')">Proof.</div>
<div class="proofscript" id="proof7694">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">elim</span> (<span class="id">H0</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
Qed.</div>
<br/>
<div class="doc">Typing properties of <span class="bracket"><span class="id">match_stacks</span></span>. </div>
<br/>
<div class="doc">replace parent_sp into parent_sp0 </div>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_type_sp">match_stacks_type_sp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg">sg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>') <span class="id"><a href="AST.html#Tptr">Tptr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7695')">Proof.</div>
<div class="proofscript" id="proof7695">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span>; <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.Vptr_has_type">Val.Vptr_has_type</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_type_retaddr">match_stacks_type_retaddr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">f0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#f0">f0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg">sg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>') <span class="id"><a href="AST.html#Tptr">Tptr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7696')">Proof.</div>
<div class="proofscript" id="proof7696">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#parent_ra">parent_ra</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.Vnullptr_has_type">Val.Vnullptr_has_type</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Syntactic properties of the translation </h1>
<br/>
<div class="doc">Preservation of code labels through the translation. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.LABELS">LABELS</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="find_label_save_callee_save">find_label_save_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> (<span class="id">save_callee_save_rec</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) = <span class="id"><a href="Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7697')">Proof.</div>
<div class="proofscript" id="proof7697">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="find_label_restore_callee_save">find_label_restore_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> (<span class="id">restore_callee_save_rec</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>) = <span class="id"><a href="Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7698')">Proof.</div>
<div class="proofscript" id="proof7698">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_code_eq">transl_code_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">i</span> <span class="id">c</span>, <span class="id">transl_code</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> (<span class="id"><a href="stacking_proof.html#i">i</a></span> :: <span class="id"><a href="stacking_proof.html#c">c</a></span>) = <span class="id">transl_instr</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> <span class="id"><a href="stacking_proof.html#i">i</a></span> (<span class="id">transl_code</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7699')">Proof.</div>
<div class="proofscript" id="proof7699">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_code</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#list_fold_right_eq">list_fold_right_eq</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_label_transl_code">find_label_transl_code</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">lbl</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> (<span class="id">transl_code</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#option_map">option_map</a></span> (<span class="id">transl_code</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span>) (<span class="id"><a href="Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7700')">Proof.</div>
<div class="proofscript" id="proof7700">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_code_eq">transl_code_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">unfold</span> <span class="id">transl_instr</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">restore_callee_save</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#find_label_restore_callee_save">find_label_restore_callee_save</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">lbl</span> <span class="id">l</span>). <span class="tactic">reflexivity</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">restore_callee_save</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#find_label_restore_callee_save">find_label_restore_callee_save</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_find_label">transl_find_label</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span> <span class="id">lbl</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id">transf_function</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>.(<span class="id"><a href="Linear.html#fn_code">Linear.fn_code</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>.(<span class="id"><a href="Mach.html#fn_code">Mach.fn_code</a></span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">transl_code</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>)) <span class="id"><a href="stacking_proof.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7701')">Proof.</div>
<div class="proofscript" id="proof7701">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>).  <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_body</span>. <span class="tactic">unfold</span> <span class="id">save_callee_save</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#find_label_save_callee_save">find_label_save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#find_label_transl_code">find_label_transl_code</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.LABELS">LABELS</a></span>.<br/>
<br/>
<div class="doc">Code tail property for Linear executions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_label_tail">find_label_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">c</span> <span class="id">c</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="stacking_proof.html#lbl">lbl</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">c</span>' -&gt; <span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id">c</span>' <span class="id"><a href="stacking_proof.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7702')">Proof.</div>
<div class="proofscript" id="proof7702">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">c</span>'. <span class="tactic">case</span> (<span class="id"><a href="Linear.html#is_label">Linear.is_label</a></span> <span class="id">lbl</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">c</span>'. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Code tail property for translations </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_save_callee_save">is_tail_save_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> (<span class="id">save_callee_save_rec</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7703')">Proof.</div>
<div class="proofscript" id="proof7703">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> (<span class="id">restore_callee_save_rec</span> <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7704')">Proof.</div>
<div class="proofscript" id="proof7704">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_transl_instr">is_tail_transl_instr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">i</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span> (<span class="id">transl_instr</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> <span class="id"><a href="stacking_proof.html#i">i</a></span> <span class="id"><a href="stacking_proof.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7705')">Proof.</div>
<div class="proofscript" id="proof7705">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">unfold</span> <span class="id">transl_instr</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">restore_callee_save</span>.  <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#is_tail_trans">is_tail_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">restore_callee_save</span>.  <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#is_tail_trans">is_tail_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_transl_code">is_tail_transl_code</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">c1</span> <span class="id">c2</span>, <span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#c1">c1</a></span> <span class="id"><a href="stacking_proof.html#c2">c2</a></span> -&gt; <span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> (<span class="id">transl_code</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> <span class="id"><a href="stacking_proof.html#c1">c1</a></span>) (<span class="id">transl_code</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span> <span class="id"><a href="stacking_proof.html#c2">c2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7706')">Proof.</div>
<div class="proofscript" id="proof7706">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_code_eq">transl_code_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#is_tail_transl_instr">is_tail_transl_instr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_transf_function">is_tail_transf_function</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id">transf_function</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> (<span class="id"><a href="Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> (<span class="id">transl_code</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>)) <span class="id"><a href="stacking_proof.html#c">c</a></span>) (<span class="id"><a href="Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7707')">Proof.</div>
<div class="proofscript" id="proof7707">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_body</span>, <span class="id">save_callee_save</span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#is_tail_trans">is_tail_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#is_tail_save_callee_save">is_tail_save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#is_tail_transl_code">is_tail_transl_code</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">TODO: move to one of the above sections </div>
<span class="kwd">Lemma</span> <span class="id"><a name="store_args_rec_contains_locations">store_args_rec_contains_locations</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">args</span> <span class="id">args</span>' <span class="id">m</span> <span class="id">sp</span> <span class="id">z</span> <span class="id">tyl</span> <span class="id">m</span>' <span class="id">bound</span> <span class="id">rs</span> <span class="id">P</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#args">args</a></span> <span class="id">args</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id"><a href="stacking_proof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Conventions1.html#size_arguments_32">size_arguments_32</a></span> <span class="id"><a href="stacking_proof.html#tyl">tyl</a></span> <span class="id"><a href="stacking_proof.html#z">z</a></span> &lt;= <span class="id"><a href="stacking_proof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_rec">loadframe.store_args_rec</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (4 * <span class="id"><a href="stacking_proof.html#z">z</a></span>) <span class="id">args</span>' <span class="id"><a href="stacking_proof.html#tyl">tyl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> 0 <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> ** <span class="id"><a href="stacking_proof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> 0 <span class="id"><a href="stacking_proof.html#bound">bound</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="id"><a href="stacking_proof.html#tyl">tyl</a></span> <span class="id"><a href="stacking_proof.html#z">z</a></span>) <span class="id"><a href="stacking_proof.html#args">args</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>) ** <span class="id"><a href="stacking_proof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7708')">Proof.</div>
<div class="proofscript" id="proof7708">
&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">args</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">tyl</span>; [|<span class="tactic">discriminate</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">tyl</span>. <span class="tactic">discriminate</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">t</span> = <span class="id"><a href="AST.html#Tlong">Tlong</a></span> \/ <span class="id">t</span> &lt;&gt; <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="kwd">as</span> [<span class="id">HT</span>|<span class="id">HT</span>] <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">auto</span>; <span class="id">right</span>; <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;* <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Values.html#Val.hiword_inject">Val.hiword_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Values.html#Val.loword_inject">Val.loword_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">INJLO</span> <span class="id">INJHI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#set_location">set_location</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">INJHI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">H3</span>. <span class="id">instantiate</span> (1:=<span class="id">z</span> + 1). <span class="tactic">omega</span>. <span class="id">instantiate</span> (1:=<span class="id"><a href="AST.html#Tint">Tint</a></span>). <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Conventions1.html#size_arguments_32">size_arguments_32</a></span> <span class="id">tyl</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>);[<span class="tactic">simpl</span>;<span class="tactic">omega</span>|<span class="tactic">apply</span> <span class="id"><a href="Conventions1.html#size_arguments_32_above">size_arguments_32_above</a></span>] |<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">m</span>'0 &amp; <span class="id">STOREHI</span> &amp; <span class="id">SEP</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#set_location">set_location</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">INJLO</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">SEP</span>'. <span class="id">instantiate</span> (1:=<span class="id">z</span>). <span class="tactic">omega</span>. <span class="id">instantiate</span> (1:=<span class="id"><a href="AST.html#Tint">Tint</a></span>). <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Conventions1.html#size_arguments_32">size_arguments_32</a></span> <span class="id">tyl</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>);[<span class="tactic">simpl</span>;<span class="tactic">omega</span>|<span class="tactic">apply</span> <span class="id"><a href="Conventions1.html#size_arguments_32_above">size_arguments_32_above</a></span>] |<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">m</span>'1 &amp; <span class="id">STORELO</span> &amp; <span class="id">SEP</span>'').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">STOREARGS</span>': <span class="id"><a href="loadframe.html#store_args_rec">loadframe.store_args_rec</a></span> <span class="id">m</span>'1 (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4 * <span class="id">z</span> + <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="id">vl</span>' <span class="id">tyl</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">IHargs</span>. <span class="tactic">destruct</span> <span class="id">v</span>'; <span class="tactic">try</span> (<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">discriminate</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>. <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args_rec">loadframe.store_args_rec</a></span> <span class="tactic">at</span> 2. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack">loadframe.store_stack</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> <span class="kwd">in</span> *. <span class="tactic">replace</span> (0 + 4 * <span class="id">z</span> + 4) <span class="kwd">with</span> (0 + 4 * (<span class="id">z</span> + 1)) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="kwd">in</span> <span class="id">STOREHI</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="kwd">in</span> <span class="id">STORELO</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">STOREHI</span>, <span class="id">STORELO</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">IHargs</span> <span class="id">vl</span>' <span class="id">m</span>'1 <span class="id">sp</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="id">tyl</span> <span class="id">m</span>' <span class="id">bound</span>) <span class="kwd">in</span> <span class="id">SEP</span>''; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="val_casted.html#set_arguments_reorder">set_arguments_reorder</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span> <span class="id">a</span> <span class="id">tyl</span> <span class="id">args</span> <span class="id">z</span> <span class="id">z</span> <span class="id">rs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="tactic">at</span> 1, <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="tactic">at</span> 1 <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="tactic">at</span> 1, <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="tactic">at</span> 1. <span class="id">fold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="tactic">at</span> 2, <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="tactic">at</span> 2. <span class="tactic">rewrite</span> <span class="id"><a href="val_casted.html#locmap_set_reorder">locmap_set_reorder</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">right</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>. <span class="tactic">omega</span>. <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#typesize_typesize">typesize_typesize</a></span> <span class="kwd">in</span> <span class="id">STOREARGS</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_add_distr_l">Z.mul_add_distr_l</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id">TALIGN</span>: <span class="id"><a href="Locations.html#typealign">typealign</a></span> <span class="id">t</span> = 1) <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SIZEPOS</span>: <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id">t</span> &gt; 0) <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#set_location">set_location</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1:= <span class="id">t</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Conventions1.html#size_arguments_32">size_arguments_32</a></span> <span class="id">tyl</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id">t</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="Conventions1.html#size_arguments_32_above">size_arguments_32_above</a></span>| <span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">TALIGN</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">m</span>'0 &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">STOREARGS</span>': <span class="id"><a href="loadframe.html#store_args_rec">loadframe.store_args_rec</a></span> <span class="id">m</span>'0 (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (4 * <span class="id">z</span> + <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id">t</span>) <span class="id">vl</span>' <span class="id">tyl</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">IHargs</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>. <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args_rec">loadframe.store_args_rec</a></span> <span class="tactic">at</span> 2. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack">loadframe.store_stack</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">STORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">auto</span>; <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">OFSABOVE</span>: 0 &lt;= <span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id">t</span>) <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (4 * <span class="id">z</span> + <span class="id"><a href="AST.html#typesize">AST.typesize</a></span> <span class="id">t</span>) <span class="kwd">with</span> (4 * (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id">t</span>)) <span class="kwd">in</span> <span class="id">STOREARGS</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#typesize_typesize">typesize_typesize</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHargs</span> <span class="id">vl</span>' <span class="id">m</span>'0 <span class="id">sp</span> (<span class="id">z</span> + <span class="id"><a href="Locations.html#typesize">typesize</a></span> <span class="id">t</span>) <span class="id">tyl</span> <span class="id">m</span>' <span class="id">bound</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">z</span> <span class="id">t</span>) <span class="id">a</span> <span class="id">rs</span>) <span class="id">P</span> <span class="id">H8</span> <span class="id">OFSABOVE</span> <span class="id">H1</span> <span class="id">STOREARGS</span>' <span class="id">SEP</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="val_casted.html#set_arguments_reorder">set_arguments_reorder</a></span> <span class="id">t</span> <span class="id">a</span> <span class="id">tyl</span> <span class="id">args</span> <span class="id">z</span> <span class="id">z</span> <span class="id">rs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="tactic">at</span> 1, <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="tactic">at</span> 1 <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="tactic">at</span> 1, <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="tactic">at</span> 1. <span class="id">fold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> <span class="tactic">at</span> 2, <span class="id"><a href="Conventions1.html#loc_arguments_32">loc_arguments_32</a></span> <span class="tactic">at</span> 2. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">auto</span>. <span class="id">contradiction</span>. <span class="tactic">omega</span>. <br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<h1> Semantic preservation </h1>
<br/>
<div class="doc">Preservation / translation of global symbols and functions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="symbols_preserved">symbols_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="AST.html#ident">ident</a></span>), <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#s">s</a></span> = <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7709')">Proof.</div>
<div class="proofscript" id="proof7709">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>. <span class="id">exploit</span> <span class="id"><a href="CUAST.html#match_cu_match_genv">match_cu_match_genv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_ptr_translated">function_ptr_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span> /\ <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7710')">Proof.</div>
<div class="proofscript" id="proof7710">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>, <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="CUAST.html#match_cu_match_genv">match_cu_match_genv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">_</span> <span class="id">_</span> <span class="id">MATCH</span>]. <span class="id">specialize</span> (<span class="id">MATCH</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MATCH</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_translated">functions_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span> /\ <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7711')">Proof.</div>
<div class="proofscript" id="proof7711">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Integers.html#Ptrofs.eq_dec">Ptrofs.eq_dec</a></span>; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="senv_preserved">senv_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7712')">Proof.</div>
<div class="proofscript" id="proof7712">
 <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>. <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_cu_senv_preserved">match_cu_senv_preserved</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ge_match">ge_match</a></span>: <span class="id"><a href="LDSim_local.html#ge_match_strict">ge_match_strict</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7713')">Proof.</div>
<div class="proofscript" id="proof7713">
 <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>. <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_cu_ge_match_strict">match_cu_ge_match_strict</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sig_preserved">sig_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span> -&gt; <span class="id"><a href="Mach.html#funsig">Mach.funsig</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span> = <span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7714')">Proof.</div>
<div class="proofscript" id="proof7714">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">tf</span>; <span class="tactic">unfold</span> <span class="id">transf_fundef</span>, <span class="id"><a href="AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">EQ</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_function_translated">find_function_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">ros</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#m">m</a></span> |= <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Linear.html#find_function">Linear.find_function</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#ros">ros</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">bf</span>, <span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#ros">ros</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#bf">bf</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#bf">bf</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7715')">Proof.</div>
<div class="proofscript" id="proof7715">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">f</span>; <span class="tactic">intros</span> <span class="id">AG</span> [<span class="id">bound</span> [<span class="id">_</span> [?????]]] <span class="id">FF</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">FF</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_inv">Genv.find_funct_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">b</span> <span class="id">EQ</span>]. <span class="tactic">rewrite</span> <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">FF</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_find_funct_ptr">Genv.find_funct_find_funct_ptr</a></span> <span class="kwd">in</span> <span class="id">FF</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tf</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>; <span class="id">exists</span> <span class="id">tf</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">AG</span> <span class="id">m0</span>). <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">intro</span> <span class="id">INJ</span>. <span class="id">inv</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DOMAIN</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">FUNCTIONS</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">i</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:?; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tf</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>; <span class="id">exists</span> <span class="id">tf</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of the arguments to an external call. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS">EXTERNAL_ARGUMENTS</a></span>.<br/>
<div class="doc">loader information </div>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.ls0">ls0</a></span>: <span class="id"><a href="Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.f0">f0</a></span>: <span class="id"><a href="Linear.html#function">Linear.function</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span>: <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.args0">args0</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Values.html#val">val</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.tyl0">tyl0</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="AST.html#typ">typ</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.sigres0">sigres0</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="AST.html#typ">typ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Linear.html#stackframe">Linear.stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">cs</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>: <span class="id"><a href="AST.html#signature">signature</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.bound">bound</a></span> <span class="id">bound</span>': <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.MS">MS</a></span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.f0">f0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.args0">args0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>: <span class="id"><a href="Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span>: <span class="id"><a href="Mach.html#regset">regset</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.AGR">AGR</a></span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.AGCS">AGCS</a></span>: <span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id">m</span>': <span class="id"><a href="Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.SEP">SEP</a></span>: <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.f0">f0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span> <span class="id">cs</span>'.<br/>
<br/>
<div class="doc">when there's an external call with empty call-stack, 
    then this call must be a tailcall. </div>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.TAILCALL">TAILCALL</a></span>: <span class="id">cs</span>' &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> \/ <span class="id"><a href="Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_argument">transl_external_argument</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> (<span class="id"><a href="AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="Mach.html#extcall_arg">extcall_arg</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span> <span class="id">cs</span>') <span class="id"><a href="stacking_proof.html#l">l</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> /\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7716')">Proof.</div>
<div class="proofscript" id="proof7716">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Conventions1.html#loc_argument_acceptable">loc_argument_acceptable</a></span> <span class="id">l</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span> <span class="kwd">with</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
- <span class="id">exists</span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">r</span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.MS">MS</a></span>.<br/>
+ <span class="tactic">destruct</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.TAILCALL">TAILCALL</a></span> <span class="kwd">as</span> [<span class="id">C</span> | <span class="id">TAILCALL</span>']; [<span class="id">contradiction</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">TAILCALL</span>' <span class="id">_</span> <span class="id">H</span>).<br/>
+ <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id">f</span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span>, <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#zle_true">zle_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>) <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span>) <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#frame_get_outgoing">frame_get_outgoing</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">AGCS</span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.AGCS">AGCS</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_argument_2">transl_external_argument_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="Mach.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span> <span class="id">cs</span>') <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> /\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7717')">Proof.</div>
<div class="proofscript" id="proof7717">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span> <span class="kwd">as</span> [<span class="id">l</span> | <span class="id">l1</span> <span class="id">l2</span>].<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="stacking_proof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">eapply</span> <span class="id"><a href="AST.html#in_regs_of_rpairs">in_regs_of_rpairs</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="stacking_proof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l1</span>) <span class="kwd">as</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>). <span class="tactic">eapply</span> <span class="id"><a href="AST.html#in_regs_of_rpairs">in_regs_of_rpairs</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="stacking_proof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l2</span>) <span class="kwd">as</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>). <span class="tactic">eapply</span> <span class="id"><a href="AST.html#in_regs_of_rpairs">in_regs_of_rpairs</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>); <span class="tactic">split</span>. <br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_arguments_rec">transl_external_arguments_rec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">locs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id"><a href="stacking_proof.html#locs">locs</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Mach.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span> <span class="id">cs</span>')) <span class="id"><a href="stacking_proof.html#locs">locs</a></span> <span class="id"><a href="stacking_proof.html#vl">vl</a></span><br/>
&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>) <span class="id"><a href="stacking_proof.html#locs">locs</a></span>) <span class="id"><a href="stacking_proof.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7718')">Proof.</div>
<div class="proofscript" id="proof7718">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">locs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Values.html#val">val</a></span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_external_argument_2">transl_external_argument_2</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">intros</span> [<span class="id">v</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlocs</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v</span> :: <span class="id">vl</span>); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_arguments">transl_external_arguments</a></span>:<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#extcall_arguments">extcall_arguments</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sp0">sp0</a></span> <span class="id">cs</span>') <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span> <span class="id"><a href="stacking_proof.html#vl">vl</a></span><br/>
&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>) (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>)) <span class="id"><a href="stacking_proof.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7719')">Proof.</div>
<div class="proofscript" id="proof7719">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#extcall_arguments">extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#transl_external_arguments_rec">transl_external_arguments_rec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.EXTERNAL_ARGUMENTS">EXTERNAL_ARGUMENTS</a></span>.<br/>
<br/>
<div class="doc">TODO: this should be a general purposed lemma, move to another file? </div>
<span class="kwd">Lemma</span> <span class="id"><a name="loadv_fp_match">loadv_fp_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">j</span> <span class="id">chunk</span> <span class="id">a</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)) <span class="id"><a href="stacking_proof.html#j">j</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InjRels.html#sep_inject">sep_inject</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)) <span class="id"><a href="stacking_proof.html#j">j</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#a">a</a></span> &lt;&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> (<span class="id"><a href="MemOpFP.html#loadv_fp">MemOpFP.loadv_fp</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="MemOpFP.html#loadv_fp">MemOpFP.loadv_fp</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id">a</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7720')">Proof.</div>
<div class="proofscript" id="proof7720">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#loadv_fp">FMemOpFP.loadv_fp</a></span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#emp_loc_match">FMemOpFP.emp_loc_match</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_reads">FP.ge_reads</a></span>, <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>. <span class="id">exists</span> <span class="id">b1</span>.<br/>
&nbsp;&nbsp;<span class="id">Locs.unfolds</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">FMemOpFP.range_locset</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">b</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>, <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; [|<span class="tactic">congruence</span>]. <span class="tactic">subst</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">b</span>' <span class="id">INJ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span>) <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, 0)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b1</span>) <span class="id">eqn</span>:?;[|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inject_block">Bset.inject_block</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H5</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span> <span class="kwd">in</span> <span class="id">l0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span> <span class="kwd">in</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>, <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="storev_fp_match">storev_fp_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">j</span> <span class="id">chunk</span> <span class="id">a</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)) <span class="id"><a href="stacking_proof.html#j">j</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InjRels.html#sep_inject">sep_inject</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)) <span class="id"><a href="stacking_proof.html#j">j</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span> <span class="id">a</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#a">a</a></span> &lt;&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> (<span class="id"><a href="MemOpFP.html#storev_fp">MemOpFP.storev_fp</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="MemOpFP.html#storev_fp">MemOpFP.storev_fp</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> <span class="id">a</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7721')">Proof.</div>
<div class="proofscript" id="proof7721">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#store_fp">FMemOpFP.store_fp</a></span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#emp_loc_match">FMemOpFP.emp_loc_match</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#Locs.locs_union_emp">Locs.locs_union_emp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>. <span class="id">exists</span> <span class="id">b1</span>.<br/>
&nbsp;&nbsp;<span class="id">Locs.unfolds</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">FMemOpFP.range_locset</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">b2</span> <span class="id">b</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>, <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; [|<span class="tactic">congruence</span>]. <span class="tactic">subst</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">b</span>' <span class="id">INJ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span>) <span class="id">b</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>, 0)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H6</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b1</span>) <span class="id">eqn</span>:?;[|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inject_block">Bset.inject_block</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H5</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span> <span class="kwd">in</span> <span class="id">l0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span> <span class="kwd">in</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>, <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="loadv_fp_belongsto">loadv_fp_belongsto</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">sp</span> <span class="id">ofs</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#loadv_fp">MemOpFP.loadv_fp</a></span> <span class="id"><a href="stacking_proof.html#chunk">chunk</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) = <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7722')">Proof.</div>
<div class="proofscript" id="proof7722">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span>, <span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span>, <span class="id"><a href="Footprint.html#Locs.blocks">Locs.blocks</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">Locs.unfolds</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">FMemOpFP.range_locset</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; <span class="tactic">auto</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="load_stack_fp_belongsto">load_stack_fp_belongsto</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">ty</span> <span class="id">ofs</span> <span class="id">ofs</span>' <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#load_stack_fp">loadframe.load_stack_fp</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> <span class="id">ofs</span>' = <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7723')">Proof.</div>
<div class="proofscript" id="proof7723">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#load_stack_fp">loadframe.load_stack_fp</a></span>. <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#loadv_fp_belongsto">loadv_fp_belongsto</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of the arguments to a builtin. </div>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS">BUILTIN_ARGUMENTS</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span>: <span class="id"><a href="Linear.html#function">Linear.function</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> := <span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span> := <span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.tf">tf</a></span>: <span class="id"><a href="Mach.html#function">Mach.function</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.TRANSF_F">TRANSF_F</a></span>: <span class="id">transf_function</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.tf">tf</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id">m</span>': <span class="id"><a href="Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.ls0">ls0</a></span>: <span class="id"><a href="Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span>: <span class="id"><a href="Mach.html#regset">regset</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id">sp</span>': <span class="id"><a href="Values.html#block">block</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.parent">parent</a></span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.retaddr">retaddr</a></span>: <span class="id"><a href="Values.html#val">val</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.INJ">INJ</a></span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>.(<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span>)).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.AGR">AGR</a></span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.SEP">SEP</a></span>: <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id">sp</span>' <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.parent">parent</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.retaddr">retaddr</a></span> ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_builtin_arg_correct">transl_builtin_arg_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> (<span class="id"><a href="AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>) -&gt; <span class="id"><a href="Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>) -&gt; <span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id">transl_builtin_arg</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>) <span class="id">v</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7724')">Proof.</div>
<div class="proofscript" id="proof7724">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SYMB</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">ofs</span>, <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> (<span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#id">id</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) (<span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#id">id</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">G</span>: <span class="id"><a href="Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.SEP">SEP</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">G</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">r</span> | [] <span class="id">ofs</span> <span class="id">ty</span>]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> (<span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> <span class="id">r</span>); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#frame_get_local">frame_get_local</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="tactic">set</span> (<span class="id">ofs</span>' := <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ofs</span>').<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>. <br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>); <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_builtin_args_correct">transl_builtin_args_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="stacking_proof.html#al">al</a></span> <span class="id"><a href="stacking_proof.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> (<span class="id"><a href="AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#al">al</a></span>) -&gt; <span class="id"><a href="Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#al">al</a></span>) -&gt; <span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id">transl_builtin_arg</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>) <span class="id"><a href="stacking_proof.html#al">al</a></span>) <span class="id">vl</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="stacking_proof.html#vl">vl</a></span> <span class="id">vl</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7725')">Proof.</div>
<div class="proofscript" id="proof7725">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
- <span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Values.html#val">val</a></span>); <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_builtin_arg_correct">transl_builtin_arg_correct</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlist_forall2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="tactic">intros</span> (<span class="id">vl</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>'::<span class="id">vl</span>'); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>: <span class="id"><a href="Injections.html#Mu">Injections.Mu</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.BSETINJ">BSETINJ</a></span>: <span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.INJINCR">INJINCR</a></span>: <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>)) <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.SEPINJ">SEPINJ</a></span> : <span class="id"><a href="InjRels.html#sep_inject">sep_inject</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>)) <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.SYMBS">SYMBS</a></span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">bid</span>, <span class="id"><a href="Globalenvs.html#Senv.find_symbol">Senv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#bid">bid</a></span> -&gt; (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span>) <span class="id"><a href="stacking_proof.html#bid">bid</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.STACKLOCAL">STACKLOCAL</a></span>: ~ (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span> <span class="id">sp</span>').<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_builtin_arg_fp_match">transl_builtin_arg_fp_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_arg_fp">MemOpFP.eval_builtin_arg_fp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#a">a</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> (<span class="id"><a href="AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>) -&gt; <span class="id"><a href="Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>) -&gt; <span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>', <span class="id"><a href="MemOpFP.html#eval_builtin_arg_fp">MemOpFP.eval_builtin_arg_fp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">transl_builtin_arg</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span> <span class="id"><a href="stacking_proof.html#a">a</a></span>) <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7726')">Proof.</div>
<div class="proofscript" id="proof7726">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SYMB</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">ofs</span>, <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> (<span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#id">id</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) (<span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#id">id</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">G</span>: <span class="id"><a href="Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.SEP">SEP</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">G</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="stacking_proof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">v</span> <span class="id">EVAL</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>; <span class="tactic">split</span>; [<span class="id">constructor</span>|<span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>']; <span class="tactic">fail</span>).<br/>
- <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">r</span> | [] <span class="id">ofs</span> <span class="id">ty</span>]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'.<br/>
&nbsp;&nbsp;+ <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#loadv_fp_belongsto">loadv_fp_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'.    <br/>
- <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#loadv_fp_belongsto">loadv_fp_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
- <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#loadv_fp_match">loadv_fp_match</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">EVAL</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">discriminate</span>.<br/>
- <span class="id">inv</span> <span class="id">EVAL</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_builtin_arg_correct">transl_builtin_arg_correct</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H4</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_builtin_arg_correct">transl_builtin_arg_correct</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H6</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">vlo</span>' [<span class="id">EVAL2</span> <span class="id">_</span>]] [<span class="id">vhi</span>' [<span class="id">EVAL1</span> <span class="id">_</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_builtin_arg_fp1</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_builtin_arg_fp2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">fp2</span>' [<span class="id">EVALFP2</span> <span class="id">MATCH2</span>]] [<span class="id">fp1</span>' [<span class="id">EVALFP1</span> <span class="id">MATCH1</span>]].<br/>
&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_builtin_args_fp_match">transl_builtin_args_fp_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_args_fp">MemOpFP.eval_builtin_args_fp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#al">al</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">vl</span>, <span class="id"><a href="Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="stacking_proof.html#al">al</a></span> <span class="id"><a href="stacking_proof.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> (<span class="id"><a href="AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#al">al</a></span>) -&gt; <span class="id"><a href="Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="stacking_proof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) (<span class="id"><a href="AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="stacking_proof.html#al">al</a></span>) -&gt; <span class="id"><a href="Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="stacking_proof.html#sl">sl</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span> <span class="id"><a href="stacking_proof.html#ty">ty</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_args_fp">MemOpFP.eval_builtin_args_fp</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id">transl_builtin_arg</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>) <span class="id"><a href="stacking_proof.html#al">al</a></span>) <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS.mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7727')">Proof.</div>
<div class="proofscript" id="proof7727">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">vl</span> <span class="id">EVAL</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
- <span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'.<br/>
- <span class="id">inv</span> <span class="id">EVAL</span>. <span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_builtin_arg_fp_match">transl_builtin_arg_fp_match</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="tactic">intros</span> (<span class="id">fp1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHeval_builtin_args_fp</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="tactic">intros</span> (<span class="id">fp</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.BUILTIN_ARGUMENTS">BUILTIN_ARGUMENTS</a></span>.<br/>
<div class="doc">We don't need this since we do not support builtin functions </div>
<br/>
<div class="doc">The proof of semantic preservation relies on simulation diagrams
  of the following form:
<pre>
           st1 --------------- st2
            |                   |
           t|                  +|t
            |                   |
            v                   v
           st1'--------------- st2'</pre>
  Matching between source and target states is defined by <span class="bracket"><span class="id">match_states</span></span>
  below.  It implies:
<ul>
<li>
 Satisfaction of the separation logic assertions that describe the contents 
  of memory.  This is a separating conjunction of facts about:
<ul>
<li>
 the current stack frame
</li>
<li>
 the frames in the call stack
</li>
<li>
 the injection from the Linear memory state into the Mach memory state
</li>
<li>
 the preservation of the global environment.
</li>
</ul>
 Agreement between, on the Linear side, the location sets <span class="bracket"><span class="id">ls</span></span>
  and <span class="bracket"><span class="id">parent_locset</span> <span class="id">s</span></span> of the current function and its caller,
  and on the Mach side the register set <span class="bracket"><span class="id">rs</span></span>.
</li>
<li>
 The Linear code <span class="bracket"><span class="id">c</span></span> is a suffix of the code of the
  function <span class="bracket"><span class="id">f</span></span> being executed.
</li>
<li>
 Well-typedness of <span class="bracket"><span class="id">f</span></span>.
</li>
</ul>
</div>
<br/>
<br/>
<div class="doc">New:
    match_states matching not only stack/memory but also footprints and mu </div>
<br/>
<div class="doc">index := nat, since we don't have one to zero step case. </div>
<br/>
<div class="doc">already included in stack_contents and match_stacks </div>
<div class="doc">TODO: we might need additional information about wd_args... 
Inductive match_load_frame : load_frame -&gt; loadframe.load_frame -&gt; mem -&gt; Prop :=
| match_lf_intro:
    forall ls0 fd0 sp0 args0 typl0 sigres0 m,
      (* 1. args in ls0 = args0 </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ls0</span> = <span class="id">set_arguments</span> (<span class="id">loc_arguments</span> (<span class="id">Linear.fn_sig</span> <span class="id">fd0</span>)) <span class="id">args0</span> (<span class="id">Locmap.init</span> <span class="id">Vundef</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sig_args</span> (<span class="id">Linear.fn_sig</span> <span class="id">fd0</span>) = <span class="id">typl0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sig_res</span> (<span class="id">Linear.fn_sig</span> <span class="id">fd0</span>) = <span class="id">sigres0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">loadframe.agree_args_contains</span> <span class="id">m</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">typl0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_load_frame</span> (<span class="id">mk_load_frame</span> <span class="id">ls0</span> <span class="id">fd0</span>) (<span class="id">loadframe.mk_load_frame</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">typl0</span> <span class="id">sigres0</span>) <span class="id">m</span>.<br/>
&nbsp;*)<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="proper_stack_bottom">proper_stack_bottom</a></span> (<span class="id">current_fd</span>: <span class="id"><a href="Linear.html#fundef">Linear.fundef</a></span>) (<span class="id">f0</span>: <span class="id"><a href="Linear.html#function">Linear.function</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Linear.html#stackframe">Linear.stackframe</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="proper_nil">proper_nil</a></span>:<br/>
<div class="doc">it is the initial function executing or <span class="bracket"><span class="id">f0</span></span> is tailcall possible </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">current_fd</span> = (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id">f0</span>) \/ <span class="id"><a href="Conventions.html#tailcall_possible">tailcall_possible</a></span> (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id">current_fd</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> <span class="id">current_fd</span> <span class="id">f0</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
| <span class="id"><a name="proper_cons">proper_cons</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">v</span> <span class="id">ls</span> <span class="id">c</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>) <span class="id">f0</span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> <span class="id">current_fd</span> <span class="id">f0</span> (<span class="id"><a href="Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> :: <span class="id"><a href="stacking_proof.html#cs">cs</a></span>).<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="MATCH_STATE">MATCH_STATE</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="Injections.html#Mu">Injections.Mu</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Linear_local.html#core">Linear_local.core</a></span> * <span class="id"><a href="Memory.html#mem">mem</a></span> -&gt; <span class="id"><a href="Mach_local.html#core">Mach_local.core</a></span> * <span class="id"><a href="Memory.html#mem">mem</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="MATCH_STATE_intro">MATCH_STATE_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">c</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">fb</span> <span class="id">sp</span>' <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">tf</span> <span class="id">ls0</span> <span class="id">fd0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">mu</span> <span class="id">n</span> <span class="id">fp</span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id"><a href="Lineartyping_local.html#wt_core">wt_core</a></span> (<span class="id"><a href="Linear_local.html#Core_State">Linear_local.Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#c">c</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKB</span>: <span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>) <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#f">f</a></span>.(<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRANSL</span>: <span class="id">transf_function</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGLOCS</span>: <span class="id"><a href="stacking_proof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJSP</span>: <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> (<span class="id"><a href="Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id">sp</span>' <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>) (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>') (<span class="id"><a href="Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span>)<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SPLOCAL</span>: ~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKLOCAL</span>: <span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGMU</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RCPRESV</span>: <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#MATCH_STATE">MATCH_STATE</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="stacking_proof.html#n">n</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#Core_State">Linear_local.Core_State</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="stacking_proof.html#c">c</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>), <span class="id"><a href="stacking_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#fb">fb</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">transl_code</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>)) <span class="id"><a href="stacking_proof.html#c">c</a></span>) <span class="id"><a href="stacking_proof.html#rs">rs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span>), <span class="id">m</span>')<br/>
| <span class="id"><a name="MATCH_STATE_call_internal">MATCH_STATE_call_internal</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">f</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">fb</span> <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">tf</span> <span class="id">ls0</span> <span class="id">fd0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">mu</span> <span class="id">n</span> <span class="id">fp</span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id"><a href="Lineartyping_local.html#wt_core">wt_core</a></span> (<span class="id"><a href="Linear_local.html#Core_Callstate">Linear_local.Core_Callstate</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKB</span>: <span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRANSL</span>: <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGLOCS</span>: <span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span>)<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKLOCAL</span>: <span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGMU</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RCPRESV</span>: <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#MATCH_STATE">MATCH_STATE</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="stacking_proof.html#n">n</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#Core_Callstate">Linear_local.Core_Callstate</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>), <span class="id"><a href="stacking_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_Callstate">Core_Callstate</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#fb">fb</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> (<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span>), <span class="id">m</span>')<br/>
| <span class="id"><a name="MATCH_STATE_return">MATCH_STATE_return</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">sg</span> <span class="id">ls0</span> <span class="id">fd0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">mu</span> <span class="id">n</span> <span class="id">fp</span> <span class="id">fp</span>' <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id"><a href="Lineartyping_local.html#wt_core">wt_core</a></span> (<span class="id"><a href="Linear_local.html#Core_Returnstate">Linear_local.Core_Returnstate</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKB</span>: <span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>)      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#sg">sg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGLOCS</span>: <span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span>)<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKLOCAL</span>: <span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGMU</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RCPRESV</span>: <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#MATCH_STATE">MATCH_STATE</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="stacking_proof.html#n">n</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#Core_Returnstate">Linear_local.Core_Returnstate</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>), <span class="id"><a href="stacking_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_Returnstate">Core_Returnstate</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#rs">rs</a></span> (<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span>), <span class="id">m</span>')<br/>
| <span class="id"><a name="MATCH_STATE_call_external">MATCH_STATE_call_external</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">f</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">fb</span> <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">tf</span> <span class="id">callee</span> <span class="id">args</span> <span class="id">ls0</span> <span class="id">fd0</span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">mu</span> <span class="id">b</span> <span class="id">n</span> <span class="id">fp</span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id"><a href="Lineartyping_local.html#wt_core">wt_core</a></span> (<span class="id"><a href="Linear_local.html#Core_Callstate">Linear_local.Core_Callstate</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKB</span>: <span class="id"><a href="stacking_proof.html#proper_stack_bottom">proper_stack_bottom</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>' (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRANSL</span>: <span class="id">transf_fundef</span> <span class="id"><a href="stacking_proof.html#f">f</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="stacking_proof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGLOCS</span>: <span class="id"><a href="stacking_proof.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span>)<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKLOCAL</span>: <span class="id"><a href="stacking_proof.html#stacks_local">stacks_local</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>')<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTFUN</span>: <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="AST.html#External">External</a></span> <span class="id"><a href="stacking_proof.html#callee">callee</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAILCALL</span>: <span class="id">cs</span>' &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> \/ <span class="id"><a href="Conventions.html#tailcall_possible">tailcall_possible</a></span> (<span class="id"><a href="AST.html#ef_sig">ef_sig</a></span> <span class="id"><a href="stacking_proof.html#callee">callee</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTARG</span>: <span class="id"><a href="Mach.html#extcall_arguments">extcall_arguments</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id">cs</span>') (<span class="id"><a href="AST.html#ef_sig">ef_sig</a></span> <span class="id"><a href="stacking_proof.html#callee">callee</a></span>) <span class="id"><a href="stacking_proof.html#args">args</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGINJ</span>: <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> (<span class="kwd">fun</span> <span class="id">p</span> : <span class="id"><a href="AST.html#rpair">rpair</a></span> <span class="id"><a href="Locations.html#loc">loc</a></span> =&gt; <span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span>) ## (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> (<span class="id"><a href="AST.html#ef_sig">ef_sig</a></span> <span class="id"><a href="stacking_proof.html#callee">callee</a></span>)) <span class="id"><a href="stacking_proof.html#args">args</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGMU</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RCPRESV</span>: <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPMATCH</span>: <span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#MATCH_STATE">MATCH_STATE</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> <span class="id"><a href="stacking_proof.html#n">n</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> <span class="id">fp</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#Core_Callstate">Linear_local.Core_Callstate</a></span> <span class="id"><a href="stacking_proof.html#cs">cs</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#ls">ls</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>), <span class="id"><a href="stacking_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_CallstateOut">Core_CallstateOut</a></span> <span class="id">cs</span>' <span class="id"><a href="stacking_proof.html#fb">fb</a></span> <span class="id"><a href="stacking_proof.html#callee">callee</a></span> <span class="id"><a href="stacking_proof.html#args">args</a></span> <span class="id"><a href="stacking_proof.html#rs">rs</a></span> (<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span>), <span class="id">m</span>')<br/>
<br/>
| <span class="id"><a name="MATCH_STATE_init">MATCH_STATE_init</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fd0</span> <span class="id">ls0</span> <span class="id">m</span> <span class="id">fb</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">tf</span> <span class="id">sp0</span>  <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span> <span class="id">mu</span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">WT</span>: <span class="id"><a href="Lineartyping_local.html#wt_core">wt_core</a></span> (<span class="id"><a href="Linear_local.html#Core_CallstateIn">Linear_local.Core_CallstateIn</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>)))      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#sp0">sp0</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRANSL</span>: <span class="id">transf_fundef</span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>) = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<div class="doc">NEW: </div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGMU</span>: <span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Rcpresv</span>: <span class="id"><a href="MemClosures_local.html#unmapped_closed">MemClosures_local.unmapped_closed</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking_proof.html#MATCH_STATE">MATCH_STATE</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="stacking_proof.html#n">n</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#Core_CallstateIn">Linear_local.Core_CallstateIn</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>) <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id"><a href="stacking_proof.html#ls0">ls0</a></span> <span class="id"><a href="stacking_proof.html#fd0">fd0</a></span>), <span class="id"><a href="stacking_proof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach_local.html#Core_CallstateIn">Core_CallstateIn</a></span> <span class="id"><a href="stacking_proof.html#fb">fb</a></span> <span class="id"><a href="stacking_proof.html#args0">args0</a></span> <span class="id"><a href="stacking_proof.html#tyl0">tyl0</a></span> <span class="id"><a href="stacking_proof.html#sigres0">sigres0</a></span>, <span class="id">m</span>')<br/>
.<br/>
<br/>
<br/>
<br/>
<div class="doc">FOOTPRINT LEMMAS </div>
<span class="kwd">Lemma</span> <span class="id"><a name="shared_valid">shared_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id"><a href="stacking_proof.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7728')">Proof.</div>
<div class="proofscript" id="proof7728">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">proper_mu_inject</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">b0</span> <span class="id">INJ</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">INJ</span>'.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id">mi_mappedblocks</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_not_shared">alloc_not_shared</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m</span>' <span class="id"><a href="stacking_proof.html#lo">lo</a></span> <span class="id"><a href="stacking_proof.html#hi">hi</a></span> = (<span class="id">m</span>'', <span class="id"><a href="stacking_proof.html#stk">stk</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#stk">stk</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7729')">Proof.</div>
<div class="proofscript" id="proof7729">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#shared_valid">shared_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_fp_not_shared">alloc_fp_not_shared</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">lo</span> <span class="id">hi</span> <span class="id">fp</span> <span class="id">fp0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InjRels.html#proper_mu">proper_mu</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#mu">mu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#alloc_fp">MemOpFP.alloc_fp</a></span> <span class="id">m</span>' <span class="id"><a href="stacking_proof.html#lo">lo</a></span> <span class="id"><a href="stacking_proof.html#hi">hi</a></span> = <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Injections.FPMatch</span>' <span class="id"><a href="stacking_proof.html#mu">mu</a></span> <span class="id"><a href="stacking_proof.html#fp0">fp0</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7730')">Proof.</div>
<div class="proofscript" id="proof7730">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">fp</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m</span>' <span class="id">lo</span> <span class="id">hi</span>) <span class="kwd">as</span> [<span class="id">m</span>'' <span class="id">stk</span>] <span class="id">eqn</span>:<span class="id">ALLOC</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">STK</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#emp_loc_match">FMemOpFP.emp_loc_match</a></span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="MemOpFP.html#alloc_fp_loc">MemOpFP.alloc_fp_loc</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#alloc_not_shared">alloc_not_shared</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>; <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_stack_fp_belongsto">store_stack_fp_belongsto</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">ty</span> <span class="id">ofs</span> <span class="id">ofs</span>' <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_stack_fp">loadframe.store_stack_fp</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) <span class="id"><a href="stacking_proof.html#ty">ty</a></span> <span class="id">ofs</span>' = <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7731')">Proof.</div>
<div class="proofscript" id="proof7731">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack_fp">loadframe.store_stack_fp</a></span>. <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">fp</span>.<br/>
&nbsp;&nbsp;&nbsp;unfold&nbsp;FMemOpFP.loadv_fp&nbsp;in&nbsp;H0.&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span>, <span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span>, <span class="id"><a href="Footprint.html#Locs.blocks">Locs.blocks</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">Locs.unfolds</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="Footprint.html#Locs.belongsto">Locs.belongsto</a></span> (<span class="id"><a href="FMemOpFP.html#range_locset">FMemOpFP.range_locset</a></span> <span class="id">sp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> <span class="id">ofs</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> (<span class="id"><a href="AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span> <span class="id">x</span>) <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">FMemOpFP.range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">Locs.unfolds</span>. <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_args_fp_belongsto">store_args_fp_belongsto</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">tyl</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#tyl">tyl</a></span> = <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7732')">Proof.</div>
<div class="proofscript" id="proof7732">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span>. <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">fp</span>. <span class="id">revert</span> <span class="id">H0</span>. <span class="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tyl</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">eauto</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="stacking_proof.html#store_stack_fp_belongsto">store_stack_fp_belongsto</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="stacking_proof.html#store_stack_fp_belongsto">store_stack_fp_belongsto</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="free_fp_belongsto">free_fp_belongsto</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#free_fp">MemOpFP.free_fp</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#lo">lo</a></span> <span class="id"><a href="stacking_proof.html#hi">hi</a></span> = <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7733')">Proof.</div>
<div class="proofscript" id="proof7733">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span>, <span class="id"><a href="Footprint.html#Locs.blocks">Locs.blocks</a></span>, <span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">fp</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#Locs.emp_union_locs">Locs.emp_union_locs</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">FMemOpFP.range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extcall_arguments_fp_exists">extcall_arguments_fp_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">sg</span>, <span class="id">exists</span> <span class="id">fp</span>, <span class="id"><a href="Mach_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7734')">Proof.</div>
<div class="proofscript" id="proof7734">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span> <span class="id">sg</span>). <span class="id">revert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id">sg</span>). <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">l</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>. <span class="id">eexists</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHl</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#in_app">in_app</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">destruct</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">pos</span> <span class="id">ty</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_introl">or_introl</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="id">contradiction</span>. <br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">rhi</span>, <span class="id">rlo</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> (<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;1-3:<span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">sl0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Locations.html#S">S</a></span> <span class="kwd">Local</span> ?<span class="id">x</span> ?<span class="id">y</span>] =&gt; <span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id">x</span> <span class="id">y</span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Incoming">Incoming</a></span> ?<span class="id">x</span> ?<span class="id">y</span>] =&gt; <span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Incoming">Incoming</a></span> <span class="id">x</span> <span class="id">y</span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extcall_arguments_fp_belongsto">extcall_arguments_fp_belongsto</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">ofs</span> <span class="id">sg</span> <span class="id">fp</span>, <span class="id"><a href="Mach_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id"><a href="stacking_proof.html#sp">sp</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>) <span class="id"><a href="stacking_proof.html#sg">sg</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> <span class="id"><a href="stacking_proof.html#fp">fp</a></span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id"><a href="stacking_proof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7735')">Proof.</div>
<div class="proofscript" id="proof7735">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span>. <span class="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.emp_union_fp">FP.emp_union_fp</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#load_stack_fp_belongsto">load_stack_fp_belongsto</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.emp_union_fp">FP.emp_union_fp</a></span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#load_stack_fp_belongsto">load_stack_fp_belongsto</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#load_stack_fp_belongsto">load_stack_fp_belongsto</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.union_belongsto">FP.union_belongsto</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#load_stack_fp_belongsto">load_stack_fp_belongsto</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Ltac</span> <span class="id">resolve_local_fps</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">Injections.FPMatch</span>' ?<span class="id">mu</span> ?<span class="id">fp</span> ?<span class="id">fp</span>' |- <span class="id">Injections.FPMatch</span>' ?<span class="id">mu</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp</span> <span class="id">_</span>) (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> ?<span class="id">fp</span>' <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; [<span class="tactic">auto</span>|<span class="id">resolve_local_fps</span>]<br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_union_T</span>'; <span class="id">resolve_local_fps</span><br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'<br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="loadframe.html#load_stack_fp">loadframe.load_stack_fp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exploit</span> <span class="id">load_stack_fp_belongsto</span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="loadframe.html#store_stack_fp">loadframe.store_stack_fp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exploit</span> <span class="id">store_stack_fp_belongsto</span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exploit</span> <span class="id">store_args_fp_belongsto</span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: (<span class="id"><a href="Mach_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span> <span class="id">_</span> <span class="id">_</span> ?<span class="id">fp</span>) |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> ?<span class="id">fp</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exploit</span> <span class="id">extcall_arguments_fp_belongsto</span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="FMemOpFP.html#free_fp">FMemOpFP.free_fp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exploit</span> <span class="id">free_fp_belongsto</span>; <span class="tactic">eauto</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="MemOpFP.html#alloc_fp">MemOpFP.alloc_fp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#alloc_fp_not_shared">alloc_fp_not_shared</a></span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Footprint.html#FP.blocks">FP.blocks</a></span> ?<span class="id">fp</span> <span class="id"><a href="stacking_proof.html#b">b</a></span> -&gt; <span class="id"><a href="stacking_proof.html#b">b</a></span> = <span class="id">_</span> |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> <span class="id">_</span> ?<span class="id">fp</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Injections.html#fp_match_local_block">Injections.fp_match_local_block</a></span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">H</span>'; <span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H</span>'; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">Injections.FPMatch</span>' <span class="id">_</span> ?<span class="id">x</span> ?<span class="id">y</span> |- <span class="id">Injections.FPMatch</span>' <span class="id">_</span> ?<span class="id">x</span> ?<span class="id">y</span> =&gt; <span class="id">eassumption</span>    <br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="val_inject_length">val_inject_length</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">vl1</span> <span class="id">vl2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="stacking_proof.html#j">j</a></span> <span class="id"><a href="stacking_proof.html#vl1">vl1</a></span> <span class="id"><a href="stacking_proof.html#vl2">vl2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="stacking_proof.html#vl1">vl1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="stacking_proof.html#vl2">vl2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7736')">Proof.</div>
<div class="proofscript" id="proof7736">
 <span class="tactic">clear</span>; <span class="tactic">induction</span> <span class="id">vl1</span>; <span class="tactic">intros</span> <span class="id">vl2</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="TRANSF_local_ldsim">TRANSF_local_ldsim</a></span>:<br/>
&nbsp;&nbsp;@<span class="id"><a href="LDSim_local.html#local_ldsim">local_ldsim</a></span> <span class="id"><a href="Linear_local.html#Linear_IS">Linear_IS</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.Mach_IS">Mach_IS</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7737')">Proof.</div>
<div class="proofscript" id="proof7737">
&nbsp;&nbsp;<span class="tactic">eapply</span> (@<span class="id"><a href="LDSim_local.html#Local_ldsim">Local_ldsim</a></span> <span class="id"><a href="Linear_local.html#Linear_IS">Linear_IS</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.Mach_IS">Mach_IS</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt">Nat.lt</a></span> <span class="id"><a href="stacking_proof.html#MATCH_STATE">MATCH_STATE</a></span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;index&nbsp;wf&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_wf_0">Nat.lt_wf_0</a></span>.<br/>
&nbsp;wd_mu&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;inj&nbsp;ge&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_ge_init_inj">proper_mu_ge_init_inj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;ge&nbsp;match&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#ge_match">ge_match</a></span>.<br/>
&nbsp;initial&nbsp;call&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">mu</span> <span class="id">fid</span> <span class="id">args</span> <span class="id">args</span>' <span class="id">score</span> <span class="id">GE_INIT_INJ</span> <span class="id">INJID</span> <span class="id">GARG</span> <span class="id">ARGREL</span> <span class="id">INITCORE</span>.<br/>
&nbsp;this&nbsp;should&nbsp;be&nbsp;a&nbsp;property&nbsp;derived&nbsp;from&nbsp;TRANSF?&nbsp;*)</span>&nbsp;by&nbsp;properties&nbsp;of&nbsp;init_core_local&nbsp;?&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Lineartyping_local.html#wt_initial_state">wt_initial_state</a></span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#wt_prog">wt_prog</a></span>.  <span class="tactic">intro</span> <span class="id">WT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ARGINJ</span>: <span class="id"><a href="Values.html#Val.inject_list">Val.inject_list</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span>)) <span class="id">args</span> <span class="id">args</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">ARGREL</span>; <span class="tactic">clear</span>. <span class="tactic">auto</span>. } <span class="comment">(*&nbsp;induction&nbsp;1;&nbsp;eauto.&nbsp;constructor;&nbsp;auto.&nbsp;inv&nbsp;H;&nbsp;eauto.&nbsp;}&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#init_core_local">init_core_local</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Linear_local.html#init_core">Linear_local.init_core</a></span>, <span class="id"><a href="Mach_local.html#init_core">init_core</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#generic_init_core">generic_init_core</a></span> <span class="kwd">in</span> <span class="id">INITCORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HTG</span>, <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HSG</span> <span class="kwd">in</span> <span class="id">INITCORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">fid</span>) <span class="id">eqn</span>: <span class="id">FIND</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">b</span>) <span class="id">eqn</span>: <span class="id">FINDB</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tf</span> &amp; <span class="id">FINDB</span>' &amp; <span class="id">TRANSL</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">FINDB</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Linear_local.html#fundef_init">Linear_local.fundef_init</a></span> <span class="kwd">in</span> <span class="id">INITCORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">tfd</span>, <span class="id">tf</span> = <span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#tfd">tfd</a></span>)  <span class="kwd">as</span> [<span class="id">tfd</span> <span class="id">INTERNAL</span>] <span class="tactic">by</span> (<span class="id">monadInv</span> <span class="id">TRANSL</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#fundef_init">fundef_init</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span>;[|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="id">args</span> (<span class="id"><a href="AST.html#sig_args">sig_args</a></span> (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id">f</span>)))) <span class="id">eqn</span>: <span class="id">WDARGS</span>; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="val_casted.html#wd_args_inject">wd_args_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">sm0</span> <span class="id">tm0</span> <span class="id">INITSM</span> <span class="id">INITTM</span> <span class="id">MEMINITINJ</span> <span class="id">sm</span> <span class="id">tm</span> [<span class="id">HRELY</span> <span class="id">LRELY</span> <span class="id">MINJ</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 0%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INITCORE</span>; <span class="tactic">clear</span> <span class="id">INITCORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2:= (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span>, <span class="id"><a href="Separation.html#minjection">minjection</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="LDSimDefs_local.html#LDefs.Inv">LDefs.Inv</a></span> <span class="kwd">in</span> <span class="id">MINJ</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">simpl</span>. <span class="id">exists</span> (<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">LRELY</span>. <span class="tactic">apply</span> (<span class="id"><a href="Coqlib.html#Ple_trans">Ple_trans</a></span> <span class="id">_</span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">tm0</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITTM</span>. <span class="tactic">rewrite</span> <span class="id">dom_match</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">rewrite</span> <span class="id">EQNEXT</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">GE_INIT_INJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span>. <span class="id">inv</span> <span class="id">mu_inject</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">mu_shared_tgt</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b00</span> &amp; <span class="id">INJ0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMINITINJ</span>. <span class="id">exploit</span> <span class="id">inj_inject_id</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ0</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>. <span class="tactic">intro</span> <span class="id">INJ0</span>'. <span class="id">inv</span> <span class="id">INJ0</span>'. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ0</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span>. <span class="id">inv</span> <span class="id">mu_inject</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">mu_shared_tgt</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b00</span> &amp; <span class="id">INJ0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMINITINJ</span>. <span class="id">exploit</span> <span class="id">inj_inject_id</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ0</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>. <span class="tactic">intro</span> <span class="id">INJ0</span>'. <span class="id">inv</span> <span class="id">INJ0</span>'. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b1</span>) <span class="id">eqn</span>: <span class="id">INJ1</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_injective">Bset.inj_injective</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">wd_mu_init</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">b0</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Globalenvs.html#Genv.genv_symb_range">Genv.genv_symb_range</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_ptr_translated">function_ptr_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="Globalenvs.html#Genv.genv_defs_range">Genv.genv_defs_range</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_var_info">Genv.find_var_info</a></span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#PRESERVATION.S_EQ">S_EQ</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="Globalenvs.html#Genv.genv_defs_range">Genv.genv_defs_range</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Separation.html#disjoint_footprint">disjoint_footprint</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">GE_INIT_INJ</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? ? ?; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="MemClosures_local.html#reach_closed_unmapped_closed">MemClosures_local.reach_closed_unmapped_closed</a></span>. <span class="id">inv</span> <span class="id">LRELY</span>. <span class="tactic">auto</span>.<br/>
&nbsp;tau&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">exists</span> <span class="id">i</span>. <span class="id">revert</span> <span class="id">H</span>. <span class="id">revert</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Lcore</span> <span class="id">Lm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">H0</span> <span class="kwd">as</span> <span class="id">HWTC</span>. <span class="tactic">intros</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">MATCH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Lineartyping_local.html#step_type_preservation">step_type_preservation</a></span> <span class="kwd">in</span> <span class="id">HWTC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2. <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Linear_local.html#init_genv">Linear_local.init_genv</a></span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#wt_prog">wt_prog</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2. <span class="id">inv</span> <span class="id">MATCH</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">MATCH</span>; <span class="tactic">clear</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">MATCH</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">Hfp0</span> <span class="id">Lfp0</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">MS</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">MS</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_code_eq">transl_code_eq</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#function_is_within_bounds">function_is_within_bounds</a></span> <span class="id">f</span> <span class="id">_</span> (<span class="id"><a href="Coqlib.html#is_tail_in">is_tail_in</a></span> <span class="id">TAIL</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">BOUND</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">BOUND</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_instr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lgetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">BOUND</span> <span class="kwd">as</span> [<span class="id">BOUND1</span> <span class="id">BOUND2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Lineartyping_local.html#wt_core_getstack">wt_core_getstack</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="LTL.html#destroyed_by_getstack">destroyed_by_getstack</a></span>; <span class="tactic">destruct</span> <span class="id">sl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Lgetstack,&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#frame_get_local">frame_get_local</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Mach_local.html#exec_Mgetstack">exec_Mgetstack</a></span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Lgetstack,&nbsp;incoming&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>:<span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">SV</span>. <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Conventions.html#incoming_slot_in_parameters">incoming_slot_in_parameters</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">IN_ARGS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">STACKS</span>; <span class="tactic">clear</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="comment">(*&nbsp;1.&nbsp;s&nbsp;=&nbsp;nil&nbsp;-&gt;&nbsp;not&nbsp;tailcall&nbsp;possible&nbsp;or&nbsp;it&nbsp;is&nbsp;the&nbsp;initial&nbsp;function&nbsp;f0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">SG_TAILCALL</span> <span class="kwd">as</span> [<span class="id">SG_TAILCALL</span>|<span class="id">SG_TAILCALL</span>]; [|<span class="tactic">elim</span> (<span class="id">SG_TAILCALL</span> <span class="id">_</span> <span class="id">IN_ARGS</span>)].<br/>
<div class="doc">TODO: need to prove save_arguments -&gt; frame_contents...  at initial call </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s</span> <span class="id">cs</span>'. <span class="tactic">inversion</span> <span class="id">STACKB</span>. <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">INITF0</span>|<span class="id">C</span>]; [|<span class="tactic">elim</span> (<span class="id">C</span> <span class="id">_</span> <span class="id">IN_ARGS</span>)]. <span class="id">inv</span> <span class="id">INITF0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="Mach.html#load_stack">load_stack</a></span> <span class="id">Lm</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp1</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ty</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (0 + 4 * <span class="id">ofs</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="stacking_proof.html#v">v</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> ((<span class="id"><a href="val_casted.html#set_arguments">set_arguments</a></span> (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">fd0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">args0_src</span> (<span class="id"><a href="Locations.html#Locmap.init">Locmap.init</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>)) (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">ofs</span> <span class="id">ty</span>)) <span class="id"><a href="stacking_proof.html#v">v</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [? ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id">m</span>:=<span class="id"><a href="Conventions1.html#size_arguments">size_arguments</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">fd0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Conventions1.html#loc_arguments_bounded">loc_arguments_bounded</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Conventions1.html#size_arguments">size_arguments</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="loadframe.html#tyl_length_size_arguments_32">loadframe.tyl_length_size_arguments_32</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">destruct</span> <span class="id">ARGSTYP</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span>  (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mgetparam">exec_Mgetparam</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#fn_link_ofs">fn_link_ofs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#frame_get_parent">frame_get_parent</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="stacking_proof.html#agree_incoming">agree_incoming</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="comment">(*&nbsp;2.&nbsp;non-nil&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s</span> <span class="id">cs</span>'. <span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#frame_get_outgoing">frame_get_outgoing</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">ARGS</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#slot_outgoing_argument_valid">slot_outgoing_argument_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mgetparam">exec_Mgetparam</a></span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">tG</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#fn_link_ofs">fn_link_ofs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#frame_get_parent">frame_get_parent</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">inv</span> <span class="id">STACKLOCAL</span>; <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="stacking_proof.html#agree_incoming">agree_incoming</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Lgetstack,&nbsp;outgoing&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#frame_get_outgoing">frame_get_outgoing</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Mach_local.html#exec_Mgetstack">exec_Mgetstack</a></span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lsetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Lineartyping_local.html#wt_core_setstack">wt_core_setstack</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">SV</span> &amp; <span class="id">SW</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ofs</span>' := <span class="kwd">match</span> <span class="id">sl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">Local</span> =&gt; <span class="id">offset_local</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Locations.html#Incoming">Incoming</a></span> =&gt; 0 <span class="comment">(*&nbsp;dummy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> =&gt; <span class="id">offset_arg</span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#frame_undef_regs">frame_undef_regs</a></span> <span class="kwd">with</span> (<span class="id">rl</span> := <span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id">exists</span> <span class="id">Lm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Mach.html#store_stack">store_stack</a></span> <span class="id">Lm</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ty</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>') (<span class="id">rs0</span> <span class="id">src</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">Lm</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Lm</span>' |= <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id">j</span> <span class="id">sp</span>' (<span class="id"><a href="Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id">rs</span> (<span class="id"><a href="Locations.html#R">R</a></span> <span class="id">src</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="LTL.html#undef_regs">LTL.undef_regs</a></span> (<span class="id"><a href="Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="id">rs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id">ls0</span> <span class="id">s</span>) (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id">sp1</span> <span class="id">cs</span>') (<span class="id"><a href="Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">fd0</span> <span class="id">ls0</span> <span class="id">sp1</span> <span class="id">tyl0</span> <span class="id">s</span> <span class="id">cs</span>' ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">ofs</span>'; <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#frame_set_local">frame_set_local</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#frame_set_outgoing">frame_set_outgoing</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">rename</span> <span class="id">SEP</span> <span class="id">into</span> <span class="id">SEPOLD</span>; <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">Lm</span>' &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">fp</span>' := <span class="id"><a href="loadframe.html#store_stack_fp">loadframe.store_stack_fp</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>)<span class="id">ty</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">fp</span>', <span class="id">_</span>, <span class="id">Lm</span>'. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">STORE</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">STORE</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">fp</span>'. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_slot">agree_regs_set_slot</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_slot">agree_locs_set_slot</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#destroyed_by_setstack_caller_save">destroyed_by_setstack_caller_save</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEPOLD</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEPOLD</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">RCPRESV</span>. <span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_refl">Mem.unchanged_on_refl</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">exact</span> <span class="id">STORE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fp</span>'. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lop&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Op.html#eval_operation">eval_operation</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">transl_op</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">op</span>) <span class="id">rs0</span>##<span class="id">args</span> <span class="id">Lm</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">v</span> <span class="id">v</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op.html#eval_operation_inject">eval_operation_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id"><a href="Op.html#eval_operation_preserved">eval_operation_preserved</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span>) <span class="kwd">in</span> <span class="id">A</span>; [|<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">SEP</span> <span class="kwd">as</span> <span class="id">C</span>. <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_drop">sep_drop</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span> <span class="kwd">in</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">SEP</span> <span class="kwd">as</span> <span class="id">D</span>. <span class="tactic">do</span> 2 <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_drop">sep_drop</a></span> <span class="kwd">in</span> <span class="id">D</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">D</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="Op_fp.html#eval_operation_fp_inject">Op_fp.eval_operation_fp_inject</a></span> <span class="id">C</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">INJSP</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>. <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id">D</span>. <span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">exact</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">fp</span>' &amp; <span class="id">EVALFP</span>' &amp; <span class="id">FPINJ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id"><a href="Op_fp.html#eval_operation_fp_preserved">Op_fp.eval_operation_fp_preserved</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span>) <span class="kwd">in</span> <span class="id">EVALFP</span>'; [|<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (@<span class="id"><a href="Op_fp.html#fp_inject_fp_match">Op_fp.fp_inject_fp_match</a></span> <span class="id">mu</span> <span class="id">j</span> <span class="id">fp</span> <span class="id">fp</span>') <span class="kwd">in</span> <span class="id">FPINJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Mach_local.html#exec_Mop">exec_Mop</a></span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">exact</span> <span class="id">EVALFP</span>'. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">STEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fp</span>'. <span class="id">eexists</span>. <span class="id">exists</span> <span class="id">Lm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#step_local">step_local</a></span>. <span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">tG</span>. <span class="tactic">exact</span> <span class="id">STEP</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_destroyed_by_op">transl_destroyed_by_op</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#destroyed_by_op_caller_save">destroyed_by_op_caller_save</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_reg">frame_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_undef_regs">frame_undef_regs</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_sep_inject">proper_mu_sep_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lload&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transl_addr</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">addr</span>) <span class="id">rs0</span>##<span class="id">args</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">a</span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op.html#eval_addressing_inject">eval_addressing_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">a</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">C</span> <span class="id">D</span>]].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Injections.fp_match_union</span>'. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="stacking_proof.html#loadv_fp_match">loadv_fp_match</a></span> <span class="id">mu</span> <span class="id">j</span> <span class="id">chunk</span> <span class="id">a</span> <span class="id">a</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_sep_inject">proper_mu_sep_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">B</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">inversion</span> <span class="id">H0</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">FPMATCH</span>'. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="MemOpFP.html#loadv_fp">MemOpFP.loadv_fp</a></span> <span class="id">chunk</span> <span class="id">a</span>'), <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">a</span>'). <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>. <span class="tactic">exact</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">C</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_destroyed_by_load">transl_destroyed_by_load</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#destroyed_by_load_caller_save">destroyed_by_load_caller_save</a></span>. <span class="tactic">auto</span>. <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lstore&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transl_addr</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">addr</span>) <span class="id">rs0</span>##<span class="id">args</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">a</span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op.html#eval_addressing_inject">eval_addressing_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">a</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#storev_parallel_rule">storev_parallel_rule</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">AGREGS</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rename</span> <span class="id">SEP</span> <span class="id">into</span> <span class="id">SEPOLD</span>; <span class="tactic">intros</span> (<span class="id">m1</span>' &amp; <span class="id">C</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Injections.fp_match_union</span>'. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="stacking_proof.html#storev_fp_match">storev_fp_match</a></span> <span class="id">mu</span> <span class="id">j</span> <span class="id">chunk</span> <span class="id">a</span> <span class="id">a</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_sep_inject">proper_mu_sep_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">B</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">inversion</span> <span class="id">H0</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">FPMATCH</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="FMemOpFP.html#storev_fp">FMemOpFP.storev_fp</a></span> <span class="id">chunk</span> <span class="id">a</span>'), <span class="id">_</span>, <span class="id">m1</span>'. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">a</span>'). <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>, &lt;- <span class="id">HTG</span>. <span class="tactic">apply</span> <span class="id"><a href="Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">C</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_destroyed_by_store">transl_destroyed_by_store</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#destroyed_by_store_caller_save">destroyed_by_store_caller_save</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#frame_undef_regs">frame_undef_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">B</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>, <span class="id">C</span>, <span class="id">SEPOLD</span>. <span class="tactic">destruct</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#store_val_inject_unmapped_closed_preserved">MemClosures_local.store_val_inject_unmapped_closed_preserved</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs1</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">delta</span>))) <span class="kwd">with</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs1</span> + <span class="id">delta</span>) <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.mi_representable">Mem.mi_representable</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1:= <span class="id">ofs1</span>). <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span>. <span class="tactic">exact</span> <span class="id">H0</span>. <span class="tactic">intros</span> [<span class="id">RANGE</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_implies">Mem.perm_implies</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">eapply</span> <span class="id">RANGE</span>. <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">intros</span> [<span class="id">GE</span> <span class="id">RANGE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_unsigned">Ptrofs.add_unsigned</a></span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range_2">Ptrofs.unsigned_range_2</a></span> <span class="id">ofs1</span>). <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range_2">Ptrofs.unsigned_range_2</a></span> <span class="id">ofs1</span>). <span class="tactic">omega</span>. <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lcall&nbsp;internal/external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#find_function_translated">find_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id">HSG</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">bf</span> [<span class="id">tf</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#is_tail_transf_function">is_tail_transf_function</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">IST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#transl_code_eq">transl_code_eq</a></span> <span class="kwd">in</span> <span class="id">IST</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IST</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.return_address_offset_exists">return_address_offset_exists</a></span>. <span class="id">eexact</span> <span class="id">IST</span>. <span class="tactic">intros</span> [<span class="id">ra</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tf</span>' <span class="kwd">as</span> [<span class="id">tf</span>'|<span class="id">ef</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;internal&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>; <span class="tactic">subst</span> <span class="id">tG</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.Vptr_has_type">Val.Vptr_has_type</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Conventions1.html#size_arguments">size_arguments</a></span> (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id">f</span>')); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Conventions1.html#loc_arguments_bounded">loc_arguments_bounded</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;external&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
<div class="doc">build match_stacks at call point like regular internal call </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">STACKS</span>': <span class="id"><a href="stacking_proof.html#match_stacks">match_stacks</a></span> <span class="id">j</span> <span class="id">fd0</span> <span class="id">ls0</span> <span class="id">sp1</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id">f</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp0</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">rs</span> <span class="id">b</span> :: <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Mach.html#Stackframe">Stackframe</a></span> <span class="id">fb</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">fb</span> <span class="id">ra</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transl_code</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">b</span>) :: <span class="id">cs</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id">f</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#is_tail_cons">is_tail_cons</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#is_tail_refl">is_tail_refl</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AST.html#Tptr">Tptr</a></span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="Conventions1.html#size_arguments">size_arguments</a></span> (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id">f</span>')); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Conventions1.html#loc_arguments_bounded">loc_arguments_bounded</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_external_arguments">transl_external_arguments</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">STACKS</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">AGREGS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">intro</span> <span class="id">Contra</span>; <span class="id">inv</span> <span class="id">Contra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">ARGS</span> <span class="id">VINJ</span>]].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="stacking_proof.html#extcall_arguments_fp_exists">extcall_arguments_fp_exists</a></span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id">f</span>')) <span class="kwd">as</span> [<span class="id">fp</span>' <span class="id">EXTARGFP</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mcall_external">exec_Mcall_external</a></span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="id">f</span>' (<span class="id"><a href="AST.html#External">External</a></span> <span class="id">ef</span>')) <span class="kwd">in</span> <span class="id">ARGS</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ARGS</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="id">f</span>' (<span class="id"><a href="AST.html#External">External</a></span> <span class="id">ef</span>')) <span class="kwd">in</span> <span class="id">EXTARGFP</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">EXTARGFP</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">intro</span> <span class="id">CONTRA</span>; <span class="id">inv</span> <span class="id">CONTRA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ARGS</span>|- * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="id">f</span>' (<span class="id"><a href="AST.html#External">External</a></span> <span class="id">ef</span>')) <span class="kwd">in</span> <span class="id">ARGS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="id">f</span>' (<span class="id"><a href="AST.html#External">External</a></span> <span class="id">ef</span>')) <span class="kwd">in</span> <span class="id">VINJ</span>; <span class="tactic">auto</span>.    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Ltailcall&nbsp;internal/external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">fd0</span> <span class="id">rs0</span> <span class="id">sp0</span> <span class="id">_</span> <span class="id">s</span> <span class="id">cs</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_epilogue_correct">function_epilogue_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">rename</span> <span class="id">SEP</span> <span class="id">into</span> <span class="id">SEPOLD</span>. <span class="tactic">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m1</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span> &amp; <span class="id">S</span> &amp; <span class="id">T</span> &amp; <span class="id">U</span> &amp; <span class="id">SEP</span> &amp; <span class="id">STACKFP</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#find_function_translated">find_function_translated</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id">HSG</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">bf</span> [<span class="id">tf</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">TAILCALL</span>: <span class="id"><a href="Conventions.html#tailcall_possible">tailcall_possible</a></span> (<span class="id"><a href="Linear.html#funsig">Linear.funsig</a></span> <span class="id">f</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Conventions.html#zero_size_arguments_tailcall_possible">zero_size_arguments_tailcall_possible</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Lineartyping_local.html#wt_core_tailcall">wt_core_tailcall</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SPLOCALSRC</span>: ~ <span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id">mu</span> <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">AGMU</span> <span class="id">INJSP</span> <span class="id">SPLOCAL</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id">SPLOCAL</span>. <span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">stk</span>' <span class="id">INJ</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ</span>'. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">INJSP</span> <span class="kwd">in</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id">Bset.inj_range</span>'; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">proper_mu_inject</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tf</span>' <span class="kwd">as</span> [<span class="id">tfd</span>' | <span class="id">ef</span>'].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="comment">(*&nbsp;internal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">m1</span>'. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#plus_right">plus_right</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">HTG</span>. <span class="id">eexact</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;-<span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKB</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#match_stacks_change_sig">match_stacks_change_sig</a></span> <span class="kwd">with</span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEPOLD</span>; <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.free_unchanged_on">Mem.free_unchanged_on</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.free_unchanged_on">Mem.free_unchanged_on</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="comment">(*&nbsp;external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_external_arguments">transl_external_arguments</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#match_stacks_change_sig">match_stacks_change_sig</a></span> <span class="kwd">with</span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_callee_save_return_regs">agree_callee_save_return_regs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">ARGS</span> <span class="id">VINJ</span>]]. <span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="kwd">in</span> <span class="id">ARGS</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ARGS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="stacking_proof.html#extcall_arguments_fp_exists">extcall_arguments_fp_exists</a></span> (<span class="id"><a href="Mach_local.html#parent_sp0">parent_sp0</a></span> <span class="id">sp0</span> <span class="id">cs</span>') (<span class="id"><a href="AST.html#ef_sig">ef_sig</a></span> <span class="id">ef</span>')) <span class="kwd">as</span> [<span class="id">fp</span>'' <span class="id">ARGSFP</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">m1</span>'. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#plus_right">plus_right</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">HTG</span>. <span class="id">eexact</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#Mach_exec_Mtailcall_external">Mach_exec_Mtailcall_external</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;-<span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="kwd">in</span> <span class="id">TAILCALL</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#tailcall_possible_extcall_arguments">tailcall_possible_extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="kwd">in</span> <span class="id">TAILCALL</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#tailcall_possible_extcall_arguments_fp">tailcall_possible_extcall_arguments_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="kwd">in</span> <span class="id">TAILCALL</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">inv</span> <span class="id">STACKLOCAL</span>; <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKB</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#match_stacks_change_sig">match_stacks_change_sig</a></span> <span class="kwd">with</span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="kwd">in</span> <span class="id">TAILCALL</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#sig_preserved">sig_preserved</a></span> <span class="kwd">in</span> <span class="id">VINJ</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEPOLD</span>; <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.free_unchanged_on">Mem.free_unchanged_on</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.free_unchanged_on">Mem.free_unchanged_on</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>; <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lbuiltin&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">BOUND</span> <span class="kwd">as</span> [<span class="id">BND1</span> <span class="id">BND2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">HSG</span> <span class="kwd">in</span> <span class="id">H</span>, <span class="id">H0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_builtin_args_correct">transl_builtin_args_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Lineartyping_local.html#wt_core_builtin">wt_core_builtin</a></span>; <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id">BND2</span>. <span class="tactic">intros</span> [<span class="id">vargs</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#transl_builtin_args_fp_match">transl_builtin_args_fp_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Lineartyping_local.html#wt_core_builtin">wt_core_builtin</a></span>; <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id">BND2</span>. <span class="tactic">intros</span> [<span class="id">fp</span>' [<span class="id">P</span>' <span class="id">Q</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="helpers.html#i64ext_inject">helpers.i64ext_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">HSG</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">HSG</span>. <span class="tactic">intros</span> [<span class="id">res</span>' [<span class="id">EC</span> <span class="id">RES</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">fp</span>', <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Events.html#eval_builtin_args_preserved">eval_builtin_args_preserved</a></span> <span class="kwd">with</span> (<span class="id">ge1</span> := <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span>); <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemOpFP.html#eval_builtin_args_fp_preserved">MemOpFP.eval_builtin_args_fp_preserved</a></span> <span class="kwd">with</span> (<span class="id">ge1</span> := <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span>); <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id"><a href="stacking_proof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Events.html#external_call_symbols_preserved">external_call_symbols_preserved</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#senv_preserved">senv_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#MATCH_STATE_intro">MATCH_STATE_intro</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_res">agree_regs_set_res</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_set_res">agree_locs_set_res</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_regs">agree_locs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_set_res">frame_set_res</a></span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_undef_regs">frame_undef_regs</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Llabel&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>; <span class="tactic">apply</span> <span class="id"><a href="Mach_local.html#exec_Mlabel">exec_Mlabel</a></span>. <span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lgoto&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mgoto">exec_Mgoto</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#transl_find_label">transl_find_label</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#find_label_tail">find_label_tail</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lcond&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Op_fp.html#eval_condition_fp_inject">Op_fp.eval_condition_fp_inject</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">fp</span>' &amp; <span class="id">OPFP</span> &amp; <span class="id">FPINJ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op_fp.html#fp_inject_fp_match">Op_fp.fp_inject_fp_match</a></span> <span class="kwd">in</span> <span class="id">FPINJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mcond_true">exec_Mcond_true</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op.html#eval_condition_inject">eval_condition_inject</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m</span>). <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#transl_find_label">transl_find_label</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#find_label_tail">find_label_tail</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_sep_inject">proper_mu_sep_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lcond&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Op_fp.html#eval_condition_fp_inject">Op_fp.eval_condition_fp_inject</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">fp</span>' &amp; <span class="id">OPFP</span> &amp; <span class="id">FPINJ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op_fp.html#fp_inject_fp_match">Op_fp.fp_inject_fp_match</a></span> <span class="kwd">in</span> <span class="id">FPINJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mcond_false">exec_Mcond_false</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Op.html#eval_condition_inject">eval_condition_inject</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m</span>). <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_sep_inject">proper_mu_sep_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject">proper_mu_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Ljumbtable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">rs0</span> <span class="id">arg</span> = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> (<span class="id">AGREGS</span> <span class="id">arg</span>). <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">intro</span> <span class="id">IJ</span>; <span class="id">inv</span> <span class="id">IJ</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_Mjumptable">exec_Mjumptable</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#transl_find_label">transl_find_label</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#destroyed_by_jumptable_caller_save">destroyed_by_jumptable_caller_save</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#find_label_tail">find_label_tail</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_undef_regs">frame_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="id">resolve_local_fps</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Lreturn&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">cs</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_epilogue_correct">function_epilogue_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">m1</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">I</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">m1</span>'. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#plus_right">plus_right</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>. <span class="id">eexact</span> <span class="id">D</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>). <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">Injections.fp_match_union</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>; <span class="tactic">exact</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SPLOCALSRC</span>: ~ <span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id">mu</span> <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">AGMU</span> <span class="id">INJSP</span> <span class="id">SPLOCAL</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id">SPLOCAL</span>. <span class="id">exploit</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">stk</span>' <span class="id">INJ</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ</span>'. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">INJSP</span> <span class="kwd">in</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id">Bset.inj_range</span>'; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">proper_mu_inject</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.free_unchanged_on">Mem.free_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.free_unchanged_on">Mem.free_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;internal&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">TRANSL</span>. <span class="tactic">unfold</span> <span class="id">transf_fundef</span>, <span class="id"><a href="AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">transf_function</span> <span class="id">f</span>) <span class="kwd">as</span> [<span class="id">tfn</span>|] <span class="id">eqn</span>:<span class="id">TRANSL</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">inversion</span> <span class="id">EQ</span>; <span class="tactic">clear</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="stacking_proof.html#function_prologue_correct">function_prologue_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="Lineartyping_local.html#wt_core_callstate_wt_regs">wt_core_callstate_wt_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#match_stacks_type_sp">match_stacks_type_sp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#match_stacks_type_retaddr">match_stacks_type_retaddr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">SEP</span> <span class="id">into</span> <span class="id">SEP_old</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">rs</span>' &amp; <span class="id">m2</span>' &amp; <span class="id">sp</span>' &amp; <span class="id">m3</span>' &amp; <span class="id">m4</span>' &amp; <span class="id">m5</span>' &amp; <span class="id">fp</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">SEP</span> &amp; <span class="id">J</span> &amp; <span class="id">K</span> &amp; <span class="id">K</span>' &amp; <span class="id">K</span>'' &amp; <span class="id">L</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP_old</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="stacking_proof.html#alloc_not_shared">alloc_not_shared</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">AGMU</span> <span class="id">SEP_old</span> <span class="id">A</span>) <span class="kwd">as</span> <span class="id">SPLOCAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Separation.html#sep_comm">sep_comm</a></span> (<span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#plus_left">plus_left</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>, (<span class="id"><a href="stacking_proof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="tactic">unfold</span> <span class="id"><a href="Mach.html#fn_code">fn_code</a></span>. <span class="tactic">unfold</span> <span class="id">transl_body</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">D</span>. <span class="id">traceEq</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#MATCH_STATE_intro">MATCH_STATE_intro</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>'); <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#match_stacks_change_meminj">match_stacks_change_meminj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#stack_contents_change_meminj">stack_contents_change_meminj</a></span>; <span class="tactic">eauto</span>.<br/>
<div class="doc">TODO: function_prologue_correct should strengthen the "K: inject_incr j j'" part to
          inject_incr j j' /\ sep... /\ unchanged_on ... </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">inv</span> <span class="id">AGMU</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? ? . <span class="tactic">apply</span> <span class="id">K</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? ? ? ? ? ? ? . <span class="tactic">eapply</span> <span class="id">proper_mu_sep_inject</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP_old</span>; <span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_implies">Mem.unchanged_on_implies</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;extcall:&nbsp;not&nbsp;possible&nbsp;case&nbsp;*)</span><br/>
&nbsp;contradiction&nbsp;by:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transf_fundef&nbsp;(Internal&nbsp;f)&nbsp;=&nbsp;OK&nbsp;tf&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genv.find_funct_ptr&nbsp;tge&nbsp;fb&nbsp;=&nbsp;Some&nbsp;tf,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genv.find_funct_ptr&nbsp;tge&nbsp;fb&nbsp;=&nbsp;Some&nbsp;(External&nbsp;callee)&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">FIND</span> <span class="kwd">in</span> <span class="id">EXTFUN</span>. <span class="id">inv</span> <span class="id">EXTFUN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">generalize</span> <span class="id">TRANSL</span>; <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="id">monadInv</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;dummy&nbsp;step,&nbsp;marshalling&nbsp;arguments&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="loadframe.html#args_len_rec_exists">loadframe.args_len_rec_exists</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">z</span> &amp; <span class="id">ARGLEN</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="loadframe.html#args_len_rec_inject">loadframe.args_len_rec_inject</a></span> <span class="kwd">in</span> <span class="id">ARGLEN</span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2. <span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="kwd">in</span> <span class="id">WDARGS0</span>. <span class="id">InvBooleans</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">Lm</span> 0 (4 * <span class="id">z</span>)) <span class="kwd">as</span> [<span class="id">m</span>' <span class="id">sp0</span>'] <span class="id">eqn</span>:? .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="loadframe.html#store_args_exists">loadframe.store_args_exists</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="val_casted.html#wd_args_inject">wd_args_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">m</span>'' &amp; <span class="id">STOREARGS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m</span>''|= <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="id">j</span> <span class="id">sp0</span>'  <span class="id"><a href="Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> <span class="id">z</span> <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span> <span class="id">rs0</span> **<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(**&nbsp;TODO:&nbsp;store_args&nbsp;-&gt;&nbsp;stack&nbsp;contains&nbsp;corresponding&nbsp;vars&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Separation.html#alloc_rule">alloc_rule</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_bound">loadframe.args_len_rec_bound</a></span> <span class="kwd">in</span> <span class="id">ARGLEN</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#val_inject_length">val_inject_length</a></span> <span class="kwd">in</span> <span class="id">ARGSREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#wd_args">wd_args</a></span> <span class="kwd">in</span> <span class="id">WDARGS0</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>. <span class="tactic">generalize</span> <span class="id">l</span> <span class="id">ARGLEN</span> <span class="id">ARGSREL</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span>, <span class="id"><a href="Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>, <span class="id"><a href="Integers.html#Int.modulus">Int.modulus</a></span>, <span class="id"><a href="Integers.html#Int.wordsize">Int.wordsize</a></span>, <span class="id"><a href="Integers.html#Ptrofs.wordsize">Ptrofs.wordsize</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Integers.html#Wordsize_32.wordsize">Wordsize_32.wordsize</a></span>, <span class="id"><a href="Integers.html#Wordsize_Ptrofs.wordsize">Wordsize_Ptrofs.wordsize</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>;[<span class="id">inv</span> <span class="id">C</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zcomplements.html#Zlength_correct">Zlength_correct</a></span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">ARGSREL</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">ARGSREL</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">WDARGS0</span>; <span class="id">InvBooleans</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">ALLOCSEP</span>. <span class="tactic">replace</span> (4 * <span class="id">z</span>) <span class="kwd">with</span> (0 + 4 * <span class="id">z</span>) <span class="kwd">in</span> <span class="id">ALLOCSEP</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="stacking_proof.html#initial_locations">initial_locations</a></span> <span class="id">j</span> <span class="id">sp0</span>' 0 <span class="id">z</span>). <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">instantiate</span> (2:= <span class="id"><a href="Locations.html#Locmap.init">Locmap.init</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>). <span class="tactic">unfold</span> <span class="id"><a href="Locations.html#Locmap.init">Locmap.init</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id"><a href="Locations.html#Outgoing">Outgoing</a></span>). <span class="tactic">clear</span> <span class="id">ALLOCSEP</span>; <span class="tactic">intros</span> <span class="id">ALLOCSEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span> ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>) <span class="id">ALLOCSEP</span> <span class="id">STOREARGS</span> <span class="id">ARGLEN</span> <span class="id">WDARGS0</span> <span class="id">ARGSREL</span> <span class="id">ARGSVAL</span> <span class="id">ARGSTYP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intro</span> <span class="id">P</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">ARGSTYP</span> <span class="kwd">as</span> [<span class="id">ARGSTYP</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">rs0</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#store_args_rec_contains_locations">store_args_rec_contains_locations</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">ARGSTYP</span>, <span class="id"><a href="loadframe.html#tyl_length_size_arguments_32">loadframe.tyl_length_size_arguments_32</a></span>, &lt;- <span class="id"><a href="stacking_proof.html#arg_len_rec_val">arg_len_rec_val</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args">loadframe.store_args</a></span> <span class="kwd">in</span> <span class="id">STOREARGS</span>. <span class="tactic">rewrite</span> <span class="id">ARGSTYP</span>. <span class="tactic">replace</span> (4*0) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">tfd</span>, <span class="id">tf</span> = <span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="stacking_proof.html#tfd">tfd</a></span>) <span class="kwd">as</span> [<span class="id">tfd</span> <span class="id">INTERNAL</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">monadInv</span> <span class="id">TRANSL</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="stacking_proof.html#alloc_not_shared">alloc_not_shared</a></span> <span class="id">mu</span> <span class="id">j</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">AGMU</span> (<span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">SEP</span>) <span class="id">Heqp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">SPLOCAL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">resolve_local_fps</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">INTERNAL</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">INTERNAL</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">rs0</span>. <span class="tactic">intro</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="stacking_proof.html#set_arguments_no_mreg">set_arguments_no_mreg</a></span>. <span class="id">cbv</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">rs0</span>. <span class="tactic">simpl</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="stacking_proof.html#arg_len_rec_val">arg_len_rec_val</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="id">inv</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unchanged_on_unmapped_closed_preserved">MemClosures_local.unchanged_on_unmapped_closed_preserved</a></span>; <span class="tactic">try</span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_refl">Mem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_implies">Mem.unchanged_on_implies</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="loadframe.html#store_args_unchanged_on">loadframe.store_args_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">resolve_local_fps</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick1">sep_pick1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;impossible&nbsp;case&nbsp;*)</span> <span class="id">monadInv</span> <span class="id">TRANSL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;external&nbsp;call:&nbsp;i64ext&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HSG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HTG</span>: <span class="id"><a href="stacking_proof.html#PRESERVATION.tge">tge</a></span> = <span class="id"><a href="stacking_proof.html#PRESERVATION.tG">tG</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">HSG</span> <span class="id">HTG</span>. <span class="tactic">rewrite</span> <span class="id">FIND</span> <span class="kwd">in</span> <span class="id">EXTFUN</span>. <span class="id">inv</span> <span class="id">EXTFUN</span>. <span class="id">monadInv</span> <span class="id">TRANSL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="helpers.html#i64ext_inject">helpers.i64ext_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">do</span> 2 <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_drop">sep_drop</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">HSG</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">res</span>' [<span class="id">EC</span> <span class="id">RES</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>, <span class="id">_</span>, <span class="id">Lm</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Mach_local.html#exec_function_external">exec_function_external</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id">HSG</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id">HTG</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Events.html#external_call_symbols_preserved">external_call_symbols_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="stacking_proof.html#senv_preserved">senv_preserved</a></span>. <span class="tactic">rewrite</span> <span class="id">HSG</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_pair">agree_regs_set_pair</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_callee_save_set_result">agree_callee_save_set_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">destruct</span> <span class="id">cs</span>'; <span class="id">inv</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Mach_local.html#Core_State">Core_State</a></span> <span class="id">cs</span>' <span class="id">fb</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id">transl_code</span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rs1</span> (<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span>)), <span class="id">Lm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#plus_one">plus_one</a></span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKB</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_locs_return">agree_locs_return</a></span> <span class="kwd">with</span> <span class="id">rs0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#frame_contents_exten">frame_contents_exten</a></span> <span class="kwd">with</span> <span class="id">rs0</span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id">ls0</span> <span class="id">s</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>; <span class="tactic">auto</span>.<br/>
&nbsp;at_external&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">f</span> <span class="id">sg</span> <span class="id">argSrc</span> <span class="id">MATCH</span> <span class="id">ATEXT</span> <span class="id">MEMCLOSURE</span> <span class="id">GARGS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#at_external_local">at_external_local</a></span> <span class="kwd">in</span> <span class="id">ATEXT</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ATEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Linear_local.html#at_external">Linear_local.at_external</a></span> <span class="kwd">in</span> <span class="id">ATEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MATCH</span>; <span class="tactic">try</span> (<span class="id">inv</span> <span class="id">ATEXT</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f0</span> <span class="kwd">as</span> [|<span class="id">e</span>]; [<span class="tactic">discriminate</span>|<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f0</span> <span class="kwd">as</span> [|<span class="id">e</span>]; [<span class="tactic">discriminate</span>|<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#at_external_local">at_external_local</a></span>. <span class="tactic">simpl</span>. <span class="id">exists</span> 0%<span class="id">nat</span>, <span class="id">args</span>. <span class="tactic">rewrite</span> <span class="id">FIND</span> <span class="kwd">in</span> <span class="id">EXTFUN</span>. <span class="tactic">inversion</span> <span class="id">EXTFUN</span>; <span class="tactic">subst</span> <span class="id">tf</span>; <span class="tactic">clear</span> <span class="id">EXTFUN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">callee</span> = <span class="id"><a href="AST.html#EF_external">EF_external</a></span> <span class="id">name</span> <span class="id">sg0</span>) <span class="tactic">by</span> (<span class="id">monadInv</span> <span class="id">TRANSL</span>; <span class="tactic">auto</span>). <span class="tactic">subst</span> <span class="id">callee</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">DEFINED</span>: <span class="id"><a href="val_casted.html#vals_defined">vals_defined</a></span> <span class="id">argSrc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">GARGS</span>. <span class="tactic">clear</span>. <span class="tactic">induction</span> <span class="id">argSrc</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">GARGS</span>. <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CUAST.html#invert_symbol_from_string">invert_symbol_from_string</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sG">sG</a></span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">FINDNAME</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CUAST.html#match_genvs_invert_symbol_from_string_preserved">match_genvs_invert_symbol_from_string_preserved</a></span> <span class="kwd">in</span> <span class="id">FINDNAME</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">FINDNAME</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#init_genv">init_genv</a></span>, <span class="id"><a href="Linear_local.html#init_genv">Linear_local.init_genv</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">subst</span> <span class="id">sG</span>; <span class="tactic">destruct</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">subst</span> <span class="id">tG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">ATEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ARGINJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">AGMU</span> (<span class="kwd">fun</span> <span class="id">p</span> : <span class="id"><a href="AST.html#rpair">rpair</a></span> <span class="id"><a href="Locations.html#loc">loc</a></span> =&gt; <span class="id"><a href="Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="stacking_proof.html#p">p</a></span> <span class="id">ls</span>) ## (<span class="id"><a href="Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id">sg</span>) <span class="id">args</span> <span class="id">ARGINJ</span> <span class="id">GARGS</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ARGINJ</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">ARGINJ</span>. <span class="id">inv</span> <span class="id">GARGS</span>. <span class="id">exploit</span> (<span class="id">IHl</span> <span class="id">vl</span>'); <span class="tactic">auto</span>. <span class="tactic">clear</span> <span class="id">IHl</span>; <span class="tactic">intro</span> <span class="id">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">clear</span> <span class="id">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="id">constructor</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="id">inv</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unmapped_closed_reach_closed_preserved_by_injection">MemClosures_local.unmapped_closed_reach_closed_preserved_by_injection</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#sep_inject_rc_inject">MemClosures_local.sep_inject_rc_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="LDSimDefs_local.html#LDefs.Inv">LDefs.Inv</a></span>. <span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">eapply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#sep_inject_rc_inject">MemClosures_local.sep_inject_rc_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Injections.fp_match_emp</span>'.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="CUAST.html#match_cu_match_genv">match_cu_match_genv</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.GE_INIT">GE_INIT</a></span>; <span class="id">inv</span> <span class="id"><a href="stacking_proof.html#PRESERVATION.TGE_INIT">TGE_INIT</a></span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">f1</span>; <span class="tactic">destruct</span> <span class="id">f2</span>; <span class="id">monadInv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;after_external&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">oresSrc</span> <span class="id">Hcore</span>' <span class="id">oresTgt</span> <span class="id">MATCH</span> <span class="id">GRES</span> <span class="id">AFTEXT</span> <span class="id">ORESREL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#after_external_local">after_external_local</a></span> <span class="kwd">in</span> <span class="id">AFTEXT</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">AFTEXT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Linear_local.html#after_external">Linear_local.after_external</a></span> <span class="kwd">in</span> <span class="id">AFTEXT</span>. <span class="id">inv</span> <span class="id">MATCH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">FIND</span> <span class="kwd">in</span> <span class="id">EXTFUN</span>; <span class="id">inv</span> <span class="id">EXTFUN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="id">inv</span> <span class="id">AFTEXT</span>. <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">callee</span> = <span class="id"><a href="AST.html#EF_external">EF_external</a></span> <span class="id">name</span> <span class="id">sg</span>) <span class="tactic">by</span> (<span class="id">monadInv</span> <span class="id">TRANSL</span>; <span class="tactic">auto</span>). <span class="tactic">subst</span> <span class="id">callee</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#after_external_local">after_external_local</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="kwd">match</span> <span class="id">oresTgt</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Mach_local.html#Core_Returnstate">Core_Returnstate</a></span> <span class="id">cs</span>' (<span class="id"><a href="Mach.html#set_pair">set_pair</a></span> (<span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>) <span class="id">v</span> <span class="id">rs</span>) (<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Mach_local.html#Core_Returnstate">Core_Returnstate</a></span> <span class="id">cs</span>' (<span class="id"><a href="Mach.html#set_pair">set_pair</a></span> (<span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>) <span class="id"><a href="Values.html#Vundef">Vundef</a></span> <span class="id">rs</span>) (<span class="id"><a href="loadframe.html#mk_load_frame">loadframe.mk_load_frame</a></span> <span class="id">sp0</span> <span class="id">args0</span> <span class="id">tyl0</span> <span class="id">sigres0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hcore</span>' =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">oresSrc</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; (<span class="id"><a href="Linear_local.html#Core_Returnstate">Linear_local.Core_Returnstate</a></span> <span class="id">cs</span> (<span class="id"><a href="Locations.html#Locmap.setpair">Locmap.setpair</a></span> (<span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>) <span class="id">v</span> <span class="id">ls</span>) (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id">ls0</span> <span class="id">fd0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; (<span class="id"><a href="Linear_local.html#Core_Returnstate">Linear_local.Core_Returnstate</a></span> <span class="id">cs</span> (<span class="id"><a href="Locations.html#Locmap.setpair">Locmap.setpair</a></span> (<span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>) <span class="id"><a href="Values.html#Vundef">Vundef</a></span> <span class="id">ls</span>) (<span class="id"><a href="Linear_local.html#mk_load_frame">mk_load_frame</a></span> <span class="id">ls0</span> <span class="id">fd0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">oresSrc</span>; <span class="tactic">destruct</span> (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>); <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="val_casted.html#val_has_type_func">val_has_type_func</a></span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">Hcore</span>'. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> <span class="id">oresSrc</span>; <span class="tactic">destruct</span> <span class="id">oresTgt</span>; <span class="tactic">destruct</span> (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> <span class="id">sg</span>); <span class="id">inv</span> <span class="id">ORESREL</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="val_casted.html#val_has_type_func">val_has_type_func</a></span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">auto</span>. <span class="tactic">exact</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>. <span class="tactic">exact</span> <span class="id"><a href="AST.html#Tint">Tint</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exists</span> 0%<span class="id">nat</span>. <span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">HTCORE</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SEP</span>': <span class="id">Lm</span>' |= <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">fd0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">tyl0</span> <span class="id">cs</span> <span class="id">cs</span>' ** <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">Hm</span>' ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">SEP</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">split</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span> |- * . <span class="id">inv</span> <span class="id">AGMU</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#sep_inject_rely_inject">MemClosures_local.sep_inject_rely_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Separation.html#m_invar">m_invar</a></span> <span class="kwd">with</span> (<span class="id">m0</span> := <span class="id">Lm</span>). <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> <span class="id">H</span> <span class="id">STACKLOCAL</span>; <span class="tactic">clear</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">cs</span>. <span class="tactic">induction</span> <span class="id">cs</span>'; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_implies">Mem.unchanged_on_implies</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">cs</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id">H3</span> <span class="kwd">as</span> <span class="id">STACKLOCAL</span>'. <span class="tactic">destruct</span> <span class="id">cs</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">IHcs</span>' <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="id">contradiction</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">IHcs</span>' <span class="id">cs</span>) <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">clear</span> <span class="id">IHcs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_implies">Mem.unchanged_on_implies</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">b</span> <span class="id">ofs</span> =&gt; <span class="id"><a href="Separation.html#m_footprint">m_footprint</a></span> (<span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">fd0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">tyl0</span> <span class="id">cs</span> <span class="id">cs</span>' ** <span class="id"><a href="Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="stacking_proof.html#PRESERVATION.sge">sge</a></span> <span class="id">j</span>) <span class="id"><a href="stacking_proof.html#b">b</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ ~ <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span>) <span class="id"><a href="stacking_proof.html#b">b</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">clear</span> <span class="id">H0</span> <span class="id">H4</span> <span class="id">H5</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">s</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H0</span> <span class="id">H2</span>; <span class="tactic">clear</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>); <span class="tactic">clear</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> <span class="id">b0</span>)). <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id">b0</span>). <span class="tactic">clear</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id">ls0</span> <span class="id">cs</span>). <span class="tactic">clear</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="Separation.html#m_footprint">m_footprint</a></span> (<span class="id">_</span> ** <span class="id">_</span>) <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">unfold</span> <span class="id">contains_callee_save</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">b</span> = <span class="id">_</span> /\ <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">b</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l0</span> <span class="id">sp</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">j</span> <span class="id">z</span> <span class="id">H</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="Separation.html#contains">contains</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="Separation.html#range">range</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Separation.html#range">range</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">left</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">right</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> <span class="id">C</span> <span class="id">H</span> <span class="id">AGMU</span> <span class="id">STACKLOCAL</span> <span class="id">A</span>. <span class="tactic">simpl</span>. <span class="tactic">clear</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intros</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">INJFP</span> <span class="id">STACKFP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">C</span> <span class="id">b</span> <span class="id">ofs</span>). <span class="tactic">unfold</span> <span class="id"><a href="Separation.html#minjection">minjection</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">INJFP</span> <span class="kwd">as</span> (<span class="id">b0</span> &amp; <span class="id">delta</span> &amp; <span class="id">INJ</span> &amp; <span class="id">PERM</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Separation.html#m_footprint">m_footprint</a></span> (<span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">fd0</span> <span class="id">ls0</span> <span class="id">sp0</span> <span class="id">tyl0</span> <span class="id">cs</span> <span class="id">cs</span>') <span class="id">b</span> <span class="id">ofs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">cs</span>' <span class="id">cs</span> <span class="id">H</span> <span class="id">STACKLOCAL</span>. <span class="tactic">clear</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cs</span>'; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="tactic">destruct</span> <span class="id">cs</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">s</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKLOCAL</span>. <span class="tactic">destruct</span> <span class="id">cs</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">s</span>. <span class="id">fold</span> <span class="id"><a href="stacking_proof.html#stack_contents">stack_contents</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#frame_contents_1">frame_contents_1</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H0</span> <span class="id">H3</span>; <span class="tactic">clear</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>); <span class="tactic">clear</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span> (<span class="id"><a href="Stacklayout.html#make_env">make_env</a></span> <span class="id">b0</span>)). <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id">b0</span>). <span class="tactic">clear</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Linear_local.html#parent_locset0">parent_locset0</a></span> <span class="id">ls0</span> <span class="id">cs</span>). <span class="tactic">clear</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">FP</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="stacking_proof.html#contains_locations">contains_locations</a></span> <span class="kwd">in</span> <span class="id">FP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">FP</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Separation.html#hasvalue">hasvalue</a></span>, <span class="id"><a href="Separation.html#contains">contains</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> ;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l0</span> <span class="id">sp</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">j</span> <span class="id">z</span> <span class="id">H</span> <span class="id">H0</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="Separation.html#contains">contains</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="stacking_proof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="Separation.html#range">range</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Separation.html#range">range</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">IHcs</span>' <span class="id">cs</span>); <span class="tactic">auto</span>.         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">destruct</span> <span class="id">STACKFP</span>; [|<span class="id">contradiction</span>]. <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span> <span class="kwd">in</span> <span class="id">PERM</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">C</span>. <span class="id">exists</span> <span class="id">b0</span>, <span class="id">delta</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">INJ</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Bset.inj_range</span>' <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">proper_mu_inject</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#plt">plt</a></span> <span class="id">b0</span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">Hm</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.mi_freeblocks">Mem.mi_freeblocks</a></span> <span class="kwd">in</span> <span class="id">n</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">oresSrc</span>; <span class="tactic">destruct</span> <span class="id">oresTgt</span>; <span class="tactic">try</span> (<span class="id">inv</span> <span class="id">ORESREL</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;wt_core&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Lineartyping.html#wt_setpair">wt_setpair</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="val_casted.html#val_has_type_funcP">val_has_type_funcP</a></span>. <span class="tactic">destruct</span> <span class="id">sg</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HTCORE</span>'|-* . <span class="tactic">unfold</span> <span class="id"><a href="AST.html#proj_sig_res">proj_sig_res</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sig_res</span>;[|<span class="tactic">discriminate</span>]. <span class="tactic">destruct</span> <span class="id"><a href="val_casted.html#val_has_type_func">val_has_type_func</a></span> <span class="id">eqn</span>:?; <span class="id">inv</span> <span class="id">HTCORE</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_pair">agree_regs_set_pair</a></span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">ORESREL</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="InjRels.html#proper_mu_inject_incr">proper_mu_inject_incr</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_callee_save_set_result">agree_callee_save_set_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#reach_closed_unmapped_closed">MemClosures_local.reach_closed_unmapped_closed</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;wt_core&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">WT</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Lineartyping.html#wt_setpair">wt_setpair</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_regs_set_pair">agree_regs_set_pair</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#agree_callee_save_set_result">agree_callee_save_set_result</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#reach_closed_unmapped_closed">MemClosures_local.reach_closed_unmapped_closed</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;halt&nbsp;*)</span>&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">i</span> <span class="id">mu</span> <span class="id">Hfp</span> <span class="id">Lfp</span> <span class="id">Hcore</span> <span class="id">Hm</span> <span class="id">Lcore</span> <span class="id">Lm</span> <span class="id">resSrc</span> <span class="id">MATCH</span> <span class="id">HALT</span> <span class="id">HRC</span> <span class="id">GRES</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="IS_local.html#halt_local">halt_local</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HALT</span> |- * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Mach_local.html#halted">halted</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="Linear_local.html#halted">Linear_local.halted</a></span> <span class="kwd">in</span> <span class="id">HALT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MATCH</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKS</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">resSrc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> {| <span class="id"><a href="AST.html#mksignature">sig_args</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>; <span class="id">sig_res</span> := <span class="id">sigres0</span>; <span class="id">sig_cc</span> := <span class="id"><a href="AST.html#cc_default">cc_default</a></span> |} <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#One">One</a></span> <span class="id">r</span> =&gt; <span class="id">rs</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Twolong">Twolong</a></span> <span class="id">r1</span> <span class="id">r2</span> =&gt; <span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span> (<span class="id">rs</span> <span class="id">r1</span>) (<span class="id">rs</span> <span class="id">r2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">HALT</span>. <span class="tactic">unfold</span> <span class="id"><a href="val_casted.html#get_result">get_result</a></span>. <span class="tactic">destruct</span> <span class="id">ARGSTYP</span>. <span class="tactic">unfold</span> <span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Conventions1.html#loc_result_32">loc_result_32</a></span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="AST.html#sig_res">sig_res</a></span> (<span class="id"><a href="Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">fd0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">AGREGS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">AGREGS</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">constructor</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">GRES</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">GRES</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">GRES</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">proper_mu_inject_incr</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#unmapped_closed_reach_closed_preserved_by_injection">MemClosures_local.unmapped_closed_reach_closed_preserved_by_injection</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_src_valid">MemClosures_local.inject_shared_src_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#inject_shared_tgt_valid">MemClosures_local.inject_shared_tgt_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#sep_inject_rc_inject">MemClosures_local.sep_inject_rc_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">AGMU</span>. <span class="tactic">apply</span> <span class="id"><a href="Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures_local.html#sep_inject_rc_inject">MemClosures_local.sep_inject_rc_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="tactic">exact</span> 1%<span class="id">positive</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="stacking_proof.html#PRESERVATION">PRESERVATION</a></span>.      <br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_local_ldsim">transf_local_ldsim</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">return_address_offset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXISTSOFS</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">c</span>, <span class="id"><a href="Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="Mach.html#Mcall">Mcall</a></span> <span class="id"><a href="stacking_proof.html#sg">sg</a></span> <span class="id"><a href="stacking_proof.html#ros">ros</a></span>::<span class="id"><a href="stacking_proof.html#c">c</a></span>) (<span class="id"><a href="Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ofs</span>, <span class="id"><a href="stacking_proof.html#return_address_offset">return_address_offset</a></span> <span class="id"><a href="stacking_proof.html#f">f</a></span> <span class="id"><a href="stacking_proof.html#c">c</a></span> <span class="id"><a href="stacking_proof.html#ofs">ofs</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">scu</span> <span class="id">tcu</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="stacking.html#transf_program">stacking.transf_program</a></span> <span class="id"><a href="stacking_proof.html#scu">scu</a></span> = <span class="id"><a href="Errors.html#OK">OK</a></span> <span class="id"><a href="stacking_proof.html#tcu">tcu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">tG</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span> <span class="id"><a href="Linear_local.html#Linear_IS">Linear_IS</a></span> <span class="id"><a href="stacking_proof.html#scu">scu</a></span> <span class="id"><a href="stacking_proof.html#sge">sge</a></span> <span class="id"><a href="stacking_proof.html#sG">sG</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="IS_local.html#init_genv_local">init_genv_local</a></span> (<span class="id"><a href="Mach_local.html#Mach_IS">Mach_IS</a></span> <span class="id"><a href="stacking_proof.html#return_address_offset">return_address_offset</a></span>) <span class="id"><a href="stacking_proof.html#tcu">tcu</a></span> <span class="id"><a href="stacking_proof.html#tge">tge</a></span> <span class="id"><a href="stacking_proof.html#tG">tG</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="stacking_proof.html#sge">sge</a></span> = <span class="id"><a href="Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="stacking_proof.html#tge">tge</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSim_local.html#local_ldsim">local_ldsim</a></span> <span class="id"><a href="stacking_proof.html#sG">sG</a></span> <span class="id"><a href="stacking_proof.html#tG">tG</a></span> <span class="id"><a href="stacking_proof.html#sge">sge</a></span> <span class="id"><a href="stacking_proof.html#tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof7738')">Proof.</div>
<div class="proofscript" id="proof7738">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="stacking_proof.html#TRANSF_local_ldsim">TRANSF_local_ldsim</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="stacking_proof.html#transf_program_match">transf_program_match</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
