<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SimplExprproof</title>
<meta name="description" content="Documentation of Coq module SimplExprproof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module SimplExprproof</h1>
<div class="coq">
<br/>
<div class="doc">Correctness proof for expression simplification. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Coqlib</span> <span class="id">Maps</span> <span class="id">Errors</span> <span class="id">Integers</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">AST</span> <span class="id">Linking</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Values</span> <span class="id">Memory</span> <span class="id">Events</span> <span class="id">Globalenvs</span> <span class="id">Smallstep</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Ctypes</span> <span class="id">Cop</span> <span class="id">Csyntax</span> <span class="id">Csem</span> <span class="id">Cstrategy</span> <span class="id">Clight</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">SimplExpr</span> <span class="id">SimplExprspec</span>.<br/>
<br/>
<h2> Relational specification of the translation. </h2>
<br/>
<span class="kwd">Definition</span> <span class="id">match_prog</span> (<span class="id">p</span>: <span class="id">Csyntax.program</span>) (<span class="id">tp</span>: <span class="id">Clight.program</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_program</span> (<span class="kwd">fun</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id">tr_fundef</span> <span class="id">f</span> <span class="id">tf</span>) <span class="id">eq</span> <span class="id">p</span> <span class="id">tp</span><br/>
&nbsp;/\ <span class="id">prog_types</span> <span class="id">tp</span> = <span class="id">prog_types</span> <span class="id">p</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">transf_program_match</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">tp</span>, <span class="id">transl_program</span> <span class="id">p</span> = <span class="id">OK</span> <span class="id">tp</span> -&gt; <span class="id">match_prog</span> <span class="id">p</span> <span class="id">tp</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4319')">Proof.</div>
<div class="proofscript" id="proof4319">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_program</span>; <span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">program_of_program</span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_transform_partial_program_contextual</span>. <span class="id">eexact</span> <span class="id">EQ</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">transl_fundef_spec</span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<h2> Semantic preservation </h2>
<br/>
<span class="kwd">Section</span> <span class="id">PRESERVATION</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">prog</span>: <span class="id">Csyntax.program</span>.<br/>
<span class="kwd">Variable</span> <span class="id">tprog</span>: <span class="id">Clight.program</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id">TRANSL</span>: <span class="id">match_prog</span> <span class="id">prog</span> <span class="id">tprog</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">ge</span> := <span class="id">Csem.globalenv</span> <span class="id">prog</span>.<br/>
<span class="kwd">Let</span> <span class="id">tge</span> := <span class="id">Clight.globalenv</span> <span class="id">tprog</span>.<br/>
<br/>
<div class="doc">Invariance properties. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">comp_env_preserved</span>:<br/>
&nbsp;&nbsp;<span class="id">Clight.genv_cenv</span> <span class="id">tge</span> = <span class="id">Csem.genv_cenv</span> <span class="id">ge</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4320')">Proof.</div>
<div class="proofscript" id="proof4320">
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">TRANSL</span>. <span class="tactic">generalize</span> (<span class="id">prog_comp_env_eq</span> <span class="id">tprog</span>) (<span class="id">prog_comp_env_eq</span> <span class="id">prog</span>). <br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">symbols_preserved</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id">ident</span>), <span class="id">Genv.find_symbol</span> <span class="id">tge</span> <span class="id">s</span> = <span class="id">Genv.find_symbol</span> <span class="id">ge</span> <span class="id">s</span>.<br/>
<span class="kwd">Proof</span> (<span class="id">Genv.find_symbol_match</span> (<span class="id">proj1</span> <span class="id">TRANSL</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">senv_preserved</span>:<br/>
&nbsp;&nbsp;<span class="id">Senv.equiv</span> <span class="id">ge</span> <span class="id">tge</span>.<br/>
<span class="kwd">Proof</span> (<span class="id">Genv.senv_match</span> (<span class="id">proj1</span> <span class="id">TRANSL</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">function_ptr_translated</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">Genv.find_funct_ptr</span> <span class="id">ge</span> <span class="id">b</span> = <span class="id">Some</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id">Genv.find_funct_ptr</span> <span class="id">tge</span> <span class="id">b</span> = <span class="id">Some</span> <span class="id">tf</span> /\ <span class="id">tr_fundef</span> <span class="id">f</span> <span class="id">tf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4321')">Proof.</div>
<div class="proofscript" id="proof4321">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">Genv.find_funct_ptr_match</span> (<span class="id">proj1</span> <span class="id">TRANSL</span>)) <span class="kwd">as</span> (<span class="id">ctx</span> &amp; <span class="id">tf</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">functions_translated</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">Genv.find_funct</span> <span class="id">ge</span> <span class="id">v</span> = <span class="id">Some</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id">Genv.find_funct</span> <span class="id">tge</span> <span class="id">v</span> = <span class="id">Some</span> <span class="id">tf</span> /\ <span class="id">tr_fundef</span> <span class="id">f</span> <span class="id">tf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4322')">Proof.</div>
<div class="proofscript" id="proof4322">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id">Genv.find_funct_match</span> (<span class="id">proj1</span> <span class="id">TRANSL</span>)) <span class="kwd">as</span> (<span class="id">ctx</span> &amp; <span class="id">tf</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">type_of_fundef_preserved</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id">tr_fundef</span> <span class="id">f</span> <span class="id">tf</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">type_of_fundef</span> <span class="id">tf</span> = <span class="id">Csyntax.type_of_fundef</span> <span class="id">f</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4323')">Proof.</div>
<div class="proofscript" id="proof4323">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id">type_of_function</span>, <span class="id">Csyntax.type_of_function</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">function_return_preserved</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id">tr_function</span> <span class="id">f</span> <span class="id">tf</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fn_return</span> <span class="id">tf</span> = <span class="id">Csyntax.fn_return</span> <span class="id">f</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4324')">Proof.</div>
<div class="proofscript" id="proof4324">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Translation of simple expressions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple_nil</span>:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>, <span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">dst</span> = <span class="id">For_val</span> \/ <span class="id">dst</span> = <span class="id">For_effects</span> -&gt; <span class="id">simple</span> <span class="id">r</span> = <span class="id">true</span> -&gt; <span class="id">sl</span> = <span class="id">nil</span>)<br/>
/\(<span class="kwd">forall</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span>, <span class="id">tr_exprlist</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">simplelist</span> <span class="id">rl</span> = <span class="id">true</span> -&gt; <span class="id">sl</span> = <span class="id">nil</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4325')">Proof.</div>
<div class="proofscript" id="proof4325">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="kwd">forall</span> <span class="id">dst</span> <span class="id">a</span>, <span class="id">dst</span> = <span class="id">For_val</span> \/ <span class="id">dst</span> = <span class="id">For_effects</span> -&gt; <span class="id">final</span> <span class="id">dst</span> <span class="id">a</span> = <span class="id">nil</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">dst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_exprlist</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">andb_prop</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H6</span>). <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">chunk_for_volatile_type</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">type_is_volatile</span> (<span class="id">Csyntax.typeof</span> <span class="id">e1</span>)); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">andb_prop</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H7</span>). <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">andb_prop</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H6</span>). <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple_expr_nil</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>, <span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">dst</span> = <span class="id">For_val</span> \/ <span class="id">dst</span> = <span class="id">For_effects</span> -&gt; <span class="id">simple</span> <span class="id">r</span> = <span class="id">true</span> -&gt; <span class="id">sl</span> = <span class="id">nil</span>.<br/>
<span class="kwd">Proof</span> (<span class="id">proj1</span> <span class="id">tr_simple_nil</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple_exprlist_nil</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span>, <span class="id">tr_exprlist</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">simplelist</span> <span class="id">rl</span> = <span class="id">true</span> -&gt; <span class="id">sl</span> = <span class="id">nil</span>.<br/>
<span class="kwd">Proof</span> (<span class="id">proj2</span> <span class="id">tr_simple_nil</span>).<br/>
<br/>
<div class="doc">Translation of <span class="bracket"><span class="id">deref_loc</span></span> and <span class="bracket"><span class="id">assign_loc</span></span> operations. </div>
<br/>
<span class="kwd">Remark</span> <span class="id">deref_loc_translated</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id">Csem.deref_loc</span> <span class="id">ge</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">chunk_for_volatile_type</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">t</span> = <span class="id">E0</span> /\ <span class="id">Clight.deref_loc</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">chunk</span> =&gt; <span class="id">volatile_load</span> <span class="id">tge</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4326')">Proof.</div>
<div class="proofscript" id="proof4326">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">chunk_for_volatile_type</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;By_value,&nbsp;not&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">deref_loc_value</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;By_value,&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id">volatile_load_preserved</span> <span class="kwd">with</span> (<span class="id">ge1</span> := <span class="id">ge</span>); <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">senv_preserved</span>.<br/>
&nbsp;By&nbsp;reference&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">destruct</span> (<span class="id">type_is_volatile</span> <span class="id">ty</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">eapply</span> <span class="id">deref_loc_reference</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;By&nbsp;copy&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">destruct</span> (<span class="id">type_is_volatile</span> <span class="id">ty</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">eapply</span> <span class="id">deref_loc_copy</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id">assign_loc_translated</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">t</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id">Csem.assign_loc</span> <span class="id">ge</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">t</span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">chunk_for_volatile_type</span> <span class="id">ty</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">t</span> = <span class="id">E0</span> /\ <span class="id">Clight.assign_loc</span> <span class="id">tge</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">chunk</span> =&gt; <span class="id">volatile_store</span> <span class="id">tge</span> <span class="id">chunk</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">t</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4327')">Proof.</div>
<div class="proofscript" id="proof4327">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">chunk_for_volatile_type</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;By_value,&nbsp;not&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">assign_loc_value</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;By_value,&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id">volatile_store_preserved</span> <span class="kwd">with</span> (<span class="id">ge1</span> := <span class="id">ge</span>); <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">senv_preserved</span>.<br/>
&nbsp;By&nbsp;copy&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">comp_env_preserved</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">type_is_volatile</span> <span class="id">ty</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">eapply</span> <span class="id">assign_loc_copy</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Evaluation of simple expressions and of their translation </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple</span>:<br/>
&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">m</span>,<br/>
&nbsp;(<span class="kwd">forall</span> <span class="id">r</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_simple_rvalue</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">r</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">dst</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">For_val</span> =&gt; <span class="id">sl</span> = <span class="id">nil</span> /\ <span class="id">Csyntax.typeof</span> <span class="id">r</span> = <span class="id">typeof</span> <span class="id">a</span> /\ <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span><br/>
&nbsp;&nbsp;| <span class="id">For_effects</span> =&gt; <span class="id">sl</span> = <span class="id">nil</span><br/>
&nbsp;&nbsp;| <span class="id">For_set</span> <span class="id">sd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>, <span class="id">sl</span> = <span class="id">do_set</span> <span class="id">sd</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Csyntax.typeof</span> <span class="id">r</span> = <span class="id">typeof</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">b</span> <span class="id">v</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
/\<br/>
&nbsp;(<span class="kwd">forall</span> <span class="id">l</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_simple_lvalue</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">l</span> <span class="id">b</span> <span class="id">ofs</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">For_val</span> <span class="id">l</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sl</span> = <span class="id">nil</span> /\ <span class="id">Csyntax.typeof</span> <span class="id">l</span> = <span class="id">typeof</span> <span class="id">a</span> /\ <span class="id">eval_lvalue</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ofs</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4328')">Proof.</div>
<div class="proofscript" id="proof4328">
<span class="id">Opaque</span> <span class="id">makeif</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">eval_simple_rvalue_lvalue_ind</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span>); <span class="tactic">intros</span> <span class="id">until</span> <span class="id">tmps</span>; <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;rvalof&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">eval_Elvalue</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">deref_loc_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">chunk_for_volatile_type</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;addrof&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> (<span class="id">Eaddrof</span> <span class="id">a1</span> <span class="id">ty</span>) (<span class="id">Vptr</span> <span class="id">b</span> <span class="id">ofs</span>)). <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;unop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> (<span class="id">Eunop</span> <span class="id">op</span> <span class="id">a1</span> <span class="id">ty</span>) <span class="id">v</span>). <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;binop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">D</span> [<span class="id">E</span> <span class="id">F</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl1</span> <span class="id">sl2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> (<span class="id">Ebinop</span> <span class="id">op</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">ty</span>) <span class="id">v</span>). <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;cast&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> (<span class="id">Ecast</span> <span class="id">a1</span> <span class="id">ty</span>) <span class="id">v</span>). <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;sizeof&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">comp_env_preserved</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">Esizeof</span> <span class="id">ty1</span> <span class="id">ty</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;alignof&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">comp_env_preserved</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">Ealignof</span> <span class="id">ty1</span> <span class="id">ty</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;var&nbsp;local&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">eval_Evar_local</span>; <span class="tactic">auto</span>.<br/>
&nbsp;var&nbsp;global&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">eval_Evar_global</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">symbols_preserved</span>; <span class="tactic">auto</span>.<br/>
&nbsp;deref&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span> <span class="id">sl1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;field&nbsp;struct&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">comp_env_preserved</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span> <span class="id">sl1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">B</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id">eval_Efield_struct</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;field&nbsp;union&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">comp_env_preserved</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span> <span class="id">sl1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">B</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id">eval_Efield_union</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple_rvalue</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">m</span> <span class="id">r</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_simple_rvalue</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">r</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">dst</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">For_val</span> =&gt; <span class="id">sl</span> = <span class="id">nil</span> /\ <span class="id">Csyntax.typeof</span> <span class="id">r</span> = <span class="id">typeof</span> <span class="id">a</span> /\ <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span><br/>
&nbsp;&nbsp;| <span class="id">For_effects</span> =&gt; <span class="id">sl</span> = <span class="id">nil</span><br/>
&nbsp;&nbsp;| <span class="id">For_set</span> <span class="id">sd</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>, <span class="id">sl</span> = <span class="id">do_set</span> <span class="id">sd</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Csyntax.typeof</span> <span class="id">r</span> = <span class="id">typeof</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">b</span> <span class="id">v</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4329')">Proof.</div>
<div class="proofscript" id="proof4329">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">m</span>. <span class="tactic">exact</span> (<span class="id">proj1</span> (<span class="id">tr_simple</span> <span class="id">e</span> <span class="id">m</span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple_lvalue</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">m</span> <span class="id">l</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_simple_lvalue</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">l</span> <span class="id">b</span> <span class="id">ofs</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">For_val</span> <span class="id">l</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sl</span> = <span class="id">nil</span> /\ <span class="id">Csyntax.typeof</span> <span class="id">l</span> = <span class="id">typeof</span> <span class="id">a</span> /\ <span class="id">eval_lvalue</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ofs</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4330')">Proof.</div>
<div class="proofscript" id="proof4330">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">e</span> <span class="id">m</span>. <span class="tactic">exact</span> (<span class="id">proj2</span> (<span class="id">tr_simple</span> <span class="id">e</span> <span class="id">m</span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_simple_exprlist</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_exprlist</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">m</span> <span class="id">tyl</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_simple_list</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">rl</span> <span class="id">tyl</span> <span class="id">vl</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sl</span> = <span class="id">nil</span> /\ <span class="id">eval_exprlist</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">al</span> <span class="id">tyl</span> <span class="id">vl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4331')">Proof.</div>
<div class="proofscript" id="proof4331">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtr_exprlist</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">D</span> <span class="id">E</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Commutation between the translation of expressions and left contexts. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">typeof_context</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">C</span>, <span class="id">leftcontext</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e1</span> <span class="id">e2</span>, <span class="id">Csyntax.typeof</span> <span class="id">e1</span> = <span class="id">Csyntax.typeof</span> <span class="id">e2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Csyntax.typeof</span> (<span class="id">C</span> <span class="id">e1</span>) = <span class="id">Csyntax.typeof</span> (<span class="id">C</span> <span class="id">e2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4332')">Proof.</div>
<div class="proofscript" id="proof4332">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Scheme</span> <span class="id">leftcontext_ind2</span> := <span class="id">Minimality</span> <span class="kwd">for</span> <span class="id">leftcontext</span> <span class="kwd">Sort</span> <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;<span class="kwd">with</span> <span class="id">leftcontextlist_ind2</span> := <span class="id">Minimality</span> <span class="kwd">for</span> <span class="id">leftcontextlist</span> <span class="kwd">Sort</span> <span class="kwd">Prop</span>.<br/>
<span class="id">Combined</span> <span class="kwd">Scheme</span> <span class="id">leftcontext_leftcontextlist_ind</span> <span class="id">from</span> <span class="id">leftcontext_ind2</span>, <span class="id">leftcontextlist_ind2</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_expr_leftcontext_rec</span>:<br/>
&nbsp;(<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">from</span> <span class="id">to</span> <span class="id">C</span>, <span class="id">leftcontext</span> <span class="id">from</span> <span class="id">to</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">e</span> <span class="id">dst</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> (<span class="id">C</span> <span class="id">e</span>) <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">dst</span>', <span class="id">exists</span> <span class="id">sl1</span>, <span class="id">exists</span> <span class="id">sl2</span>, <span class="id">exists</span> <span class="id">a</span>', <span class="id">exists</span> <span class="id">tmp</span>',<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span>' <span class="id">e</span> <span class="id">sl1</span> <span class="id">a</span>' <span class="id">tmp</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">sl</span> = <span class="id">sl1</span> ++ <span class="id">sl2</span><br/>
&nbsp;&nbsp;/\ <span class="id">incl</span> <span class="id">tmp</span>' <span class="id">tmps</span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">le</span>' <span class="id">e</span>' <span class="id">sl3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span>' <span class="id">dst</span>' <span class="id">e</span>' <span class="id">sl3</span> <span class="id">a</span>' <span class="id">tmp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span>, ~<span class="id">In</span> <span class="id">id</span> <span class="id">tmp</span>' -&gt; <span class="id">le</span>'!<span class="id">id</span> = <span class="id">le</span>!<span class="id">id</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Csyntax.typeof</span> <span class="id">e</span>' = <span class="id">Csyntax.typeof</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span>' <span class="id">dst</span> (<span class="id">C</span> <span class="id">e</span>') (<span class="id">sl3</span> ++ <span class="id">sl2</span>) <span class="id">a</span> <span class="id">tmps</span>)<br/>
&nbsp;) /\ (<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">from</span> <span class="id">C</span>, <span class="id">leftcontextlist</span> <span class="id">from</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">e</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_exprlist</span> <span class="id">le</span> (<span class="id">C</span> <span class="id">e</span>) <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">dst</span>', <span class="id">exists</span> <span class="id">sl1</span>, <span class="id">exists</span> <span class="id">sl2</span>, <span class="id">exists</span> <span class="id">a</span>', <span class="id">exists</span> <span class="id">tmp</span>',<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span>' <span class="id">e</span> <span class="id">sl1</span> <span class="id">a</span>' <span class="id">tmp</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">sl</span> = <span class="id">sl1</span> ++ <span class="id">sl2</span><br/>
&nbsp;&nbsp;/\ <span class="id">incl</span> <span class="id">tmp</span>' <span class="id">tmps</span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">le</span>' <span class="id">e</span>' <span class="id">sl3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span>' <span class="id">dst</span>' <span class="id">e</span>' <span class="id">sl3</span> <span class="id">a</span>' <span class="id">tmp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span>, ~<span class="id">In</span> <span class="id">id</span> <span class="id">tmp</span>' -&gt; <span class="id">le</span>'!<span class="id">id</span> = <span class="id">le</span>!<span class="id">id</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Csyntax.typeof</span> <span class="id">e</span>' = <span class="id">Csyntax.typeof</span> <span class="id">e</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_exprlist</span> <span class="id">le</span>' (<span class="id">C</span> <span class="id">e</span>') (<span class="id">sl3</span> ++ <span class="id">sl2</span>) <span class="id">a</span> <span class="id">tmps</span>)<br/>
).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4333')">Proof.</div>
<div class="proofscript" id="proof4333">
<br/>
<span class="kwd">Ltac</span> <span class="id">TR</span> :=<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">econstructor</span>; <span class="id">econstructor</span>; <span class="id">econstructor</span>; <span class="id">econstructor</span>;<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">eauto</span> | <span class="tactic">split</span>; [<span class="id">idtac</span> | <span class="tactic">split</span>]].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">NOTIN</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H1</span>: <span class="id">In</span> ?<span class="id">x</span> ?<span class="id">l</span>, <span class="id">H2</span>: <span class="id">list_disjoint</span> ?<span class="id">l</span> <span class="id">_</span> |- ~<span class="id">In</span> ?<span class="id">x</span> <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">elim</span> (<span class="id">H2</span> <span class="id">x</span> <span class="id">x</span>); <span class="tactic">auto</span>; <span class="tactic">fail</span><br/>
&nbsp;&nbsp;| [ <span class="id">H1</span>: <span class="id">In</span> ?<span class="id">x</span> ?<span class="id">l</span>, <span class="id">H2</span>: <span class="id">list_disjoint</span> <span class="id">_</span> ?<span class="id">l</span> |- ~<span class="id">In</span> ?<span class="id">x</span> <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">elim</span> (<span class="id">H2</span> <span class="id">x</span> <span class="id">x</span>); <span class="tactic">auto</span>; <span class="tactic">fail</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">UNCHANGED</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: (<span class="kwd">forall</span> (<span class="id">id</span>: <span class="id">ident</span>), ~<span class="id">In</span> <span class="id">id</span> <span class="id">_</span> -&gt; ?<span class="id">le</span>' ! <span class="id">id</span> = ?<span class="id">le</span> ! <span class="id">id</span>) |-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">id</span>: <span class="id">ident</span>), <span class="id">In</span> <span class="id">id</span> <span class="id">_</span> -&gt; ?<span class="id">le</span>' ! <span class="id">id</span> = ?<span class="id">le</span> ! <span class="id">id</span>) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">NOTIN</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
generalize&nbsp;compat_dest_change;&nbsp;intro&nbsp;CDC.*)</span>&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">leftcontext_leftcontextlist_ind</span>; <span class="tactic">intros</span>.<br/>
<br/>
&nbsp;base&nbsp;*)</span>&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_nil_end</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_nil_end</span>; <span class="tactic">auto</span>.<br/>
&nbsp;deref&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;field&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;rvalof&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;addrof&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;unop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;binop&nbsp;left&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;binop&nbsp;right&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl2</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span> ++ <span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl3</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;cast&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;seqand&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;seqor&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;condition&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="tactic">eapply</span> <span class="id">tr_condition_effects</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="tactic">eapply</span> <span class="id">tr_condition_set</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;assign&nbsp;left&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;assign&nbsp;right&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl2</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span> ++ <span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ (<span class="id">sl3</span> ++ <span class="id">sl2</span>')). <span class="tactic">rewrite</span> <span class="id">app_ass</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl2</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span> ++ <span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ (<span class="id">sl3</span> ++ <span class="id">sl2</span>')). <span class="tactic">rewrite</span> <span class="id">app_ass</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;assignop&nbsp;left&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">eapply</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;assignop&nbsp;right&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl2</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl0</span> ++ <span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl0</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl2</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl0</span> ++ <span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl0</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;postincr&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">eapply</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">typeof_context</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;call&nbsp;left&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_exprlist_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_exprlist_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;call&nbsp;right&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>.<br/>
destruct&nbsp;dst';&nbsp;constructor||contradiction.*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span>++<span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl3</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>.<br/>
destruct&nbsp;dst';&nbsp;constructor||contradiction.*)</span>&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span>++<span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl3</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;builtin&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span>++<span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl3</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">change</span> (<span class="id">sl3</span>++<span class="id">sl2</span>') <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl3</span> ++ <span class="id">sl2</span>'). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;comma&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>; <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;paren&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;cons&nbsp;left&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl1</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_ass</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_exprlist_invariant</span>; <span class="tactic">eauto</span>.  <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;cons&nbsp;right&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sl1</span> = <span class="id">nil</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id">tr_simple_expr_nil</span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span>' [<span class="id">sl2</span>' [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">TR</span>. <span class="tactic">subst</span> <span class="id">sl2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> <span class="id">sl3</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl3</span>). <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span>; <span class="tactic">eauto</span>. <span class="id">UNCHANGED</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">tr_expr_leftcontext</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">C</span> <span class="id">le</span> <span class="id">r</span> <span class="id">dst</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">leftcontext</span> <span class="id">RV</span> <span class="id">RV</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> (<span class="id">C</span> <span class="id">r</span>) <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">dst</span>', <span class="id">exists</span> <span class="id">sl1</span>, <span class="id">exists</span> <span class="id">sl2</span>, <span class="id">exists</span> <span class="id">a</span>', <span class="id">exists</span> <span class="id">tmp</span>',<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span>' <span class="id">r</span> <span class="id">sl1</span> <span class="id">a</span>' <span class="id">tmp</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">sl</span> = <span class="id">sl1</span> ++ <span class="id">sl2</span><br/>
&nbsp;&nbsp;/\ <span class="id">incl</span> <span class="id">tmp</span>' <span class="id">tmps</span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">le</span>' <span class="id">r</span>' <span class="id">sl3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span>' <span class="id">dst</span>' <span class="id">r</span>' <span class="id">sl3</span> <span class="id">a</span>' <span class="id">tmp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span>, ~<span class="id">In</span> <span class="id">id</span> <span class="id">tmp</span>' -&gt; <span class="id">le</span>'!<span class="id">id</span> = <span class="id">le</span>!<span class="id">id</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Csyntax.typeof</span> <span class="id">r</span>' = <span class="id">Csyntax.typeof</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span>' <span class="id">dst</span> (<span class="id">C</span> <span class="id">r</span>') (<span class="id">sl3</span> ++ <span class="id">sl2</span>) <span class="id">a</span> <span class="id">tmps</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4334')">Proof.</div>
<div class="proofscript" id="proof4334">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> (<span class="id">proj1</span> <span class="id">tr_expr_leftcontext_rec</span>); <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">tr_top_leftcontext</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">dst</span> <span class="id">rtop</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">dst</span> <span class="id">rtop</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">C</span>,<br/>
&nbsp;&nbsp;<span class="id">rtop</span> = <span class="id">C</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">leftcontext</span> <span class="id">RV</span> <span class="id">RV</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">dst</span>', <span class="id">exists</span> <span class="id">sl1</span>, <span class="id">exists</span> <span class="id">sl2</span>, <span class="id">exists</span> <span class="id">a</span>', <span class="id">exists</span> <span class="id">tmp</span>',<br/>
&nbsp;&nbsp;<span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">dst</span>' <span class="id">r</span> <span class="id">sl1</span> <span class="id">a</span>' <span class="id">tmp</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">sl</span> = <span class="id">sl1</span> ++ <span class="id">sl2</span><br/>
&nbsp;&nbsp;/\ <span class="id">incl</span> <span class="id">tmp</span>' <span class="id">tmps</span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">le</span>' <span class="id">m</span>' <span class="id">r</span>' <span class="id">sl3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span>' <span class="id">dst</span>' <span class="id">r</span>' <span class="id">sl3</span> <span class="id">a</span>' <span class="id">tmp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span>, ~<span class="id">In</span> <span class="id">id</span> <span class="id">tmp</span>' -&gt; <span class="id">le</span>'!<span class="id">id</span> = <span class="id">le</span>!<span class="id">id</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Csyntax.typeof</span> <span class="id">r</span>' = <span class="id">Csyntax.typeof</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span>' <span class="id">m</span>' <span class="id">dst</span> (<span class="id">C</span> <span class="id">r</span>') (<span class="id">sl3</span> ++ <span class="id">sl2</span>) <span class="id">a</span> <span class="id">tmps</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4335')">Proof.</div>
<div class="proofscript" id="proof4335">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;val&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">For_val</span>; <span class="id">econstructor</span>; <span class="id">econstructor</span>; <span class="id">econstructor</span>; <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">tr_top_val_val</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">instantiate</span> (1 := <span class="id">nil</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">incl_refl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">app_nil_end</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;base&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">r</span>. <span class="id">exploit</span> <span class="id">tr_expr_leftcontext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">dst</span>'; <span class="id">exists</span> <span class="id">sl1</span>; <span class="id">exists</span> <span class="id">sl2</span>; <span class="id">exists</span> <span class="id">a</span>'; <span class="id">exists</span> <span class="id">tmp</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">tr_top_base</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">tr_top_base</span>. <span class="tactic">apply</span> <span class="id">S</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Semantics of smart constructors </div>
<br/>
<span class="kwd">Remark</span> <span class="id">sem_cast_deterministic</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">ty</span> <span class="id">ty</span>' <span class="id">m1</span> <span class="id">v1</span> <span class="id">m2</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id">sem_cast</span> <span class="id">v</span> <span class="id">ty</span> <span class="id">ty</span>' <span class="id">m1</span> = <span class="id">Some</span> <span class="id">v1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sem_cast</span> <span class="id">v</span> <span class="id">ty</span> <span class="id">ty</span>' <span class="id">m2</span> = <span class="id">Some</span> <span class="id">v2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">v1</span> = <span class="id">v2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4336')">Proof.</div>
<div class="proofscript" id="proof4336">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sem_cast</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id">classify_cast</span> <span class="id">ty</span> <span class="id">ty</span>'); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Archi.ptr64</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Mem.weak_valid_pointer</span> <span class="id">m1</span> <span class="id">b</span> (<span class="id">Ptrofs.unsigned</span> <span class="id">i</span>)); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Mem.weak_valid_pointer</span> <span class="id">m2</span> <span class="id">b</span> (<span class="id">Ptrofs.unsigned</span> <span class="id">i</span>)); <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">negb</span> <span class="id">Archi.ptr64</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Mem.weak_valid_pointer</span> <span class="id">m1</span> <span class="id">b</span> (<span class="id">Ptrofs.unsigned</span> <span class="id">i</span>)); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Mem.weak_valid_pointer</span> <span class="id">m2</span> <span class="id">b</span> (<span class="id">Ptrofs.unsigned</span> <span class="id">i</span>)); <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eval_simpl_expr_sound</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">eval_simpl_expr</span> <span class="id">a</span> <span class="kwd">with</span> <span class="id">Some</span> <span class="id">v</span>' =&gt; <span class="id">v</span>' = <span class="id">v</span> | <span class="id">None</span> =&gt; <span class="id">True</span> <span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4337')">Proof.</div>
<div class="proofscript" id="proof4337">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">eval_simpl_expr</span> <span class="id">a</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">sem_cast</span> <span class="id">v1</span> (<span class="id">typeof</span> <span class="id">a</span>) <span class="id">ty</span> <span class="id">Mem.empty</span>) <span class="kwd">as</span> [<span class="id">v</span>'|] <span class="id">eqn</span>:<span class="id">C</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">sem_cast_deterministic</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">static_bool_val_sound</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">t</span> <span class="id">m</span> <span class="id">b</span>, <span class="id">bool_val</span> <span class="id">v</span> <span class="id">t</span> <span class="id">Mem.empty</span> = <span class="id">Some</span> <span class="id">b</span> -&gt; <span class="id">bool_val</span> <span class="id">v</span> <span class="id">t</span> <span class="id">m</span> = <span class="id">Some</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4338')">Proof.</div>
<div class="proofscript" id="proof4338">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id">Mem.weak_valid_pointer</span> <span class="id">Mem.empty</span> <span class="id">b</span> <span class="id">ofs</span> = <span class="id">false</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">Mem.weak_valid_pointer</span>, <span class="id">Mem.valid_pointer</span>, <span class="id">proj_sumbool</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id">pred_dec_false</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">Mem.perm_empty</span>). <span class="tactic">auto</span>. }  <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">b</span>; <span class="tactic">unfold</span> <span class="id">bool_val</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">classify_bool</span> <span class="id">t</span>); <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">destruct</span> <span class="id">Archi.ptr64</span> <span class="id">eqn</span>:<span class="id">SF</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">A</span>; <span class="tactic">congruence</span>.<br/>
- <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">A</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">step_makeif</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">v1</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">bool_val</span> <span class="id">v1</span> (<span class="id">typeof</span> <span class="id">a</span>) <span class="id">m</span> = <span class="id">Some</span> <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">star</span> <span class="id">step1</span> <span class="id">tge</span> (<span class="id">State</span> <span class="id">f</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span>) <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">E0</span> (<span class="id">State</span> <span class="id">f</span> (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">s1</span> <span class="kwd">else</span> <span class="id">s2</span>) <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4339')">Proof.</div>
<div class="proofscript" id="proof4339">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">functional</span> <span class="tactic">induction</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span>).<br/>
- <span class="id">exploit</span> <span class="id">eval_simpl_expr_sound</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">e0</span>. <span class="tactic">intro</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">bool_val</span> <span class="id">v1</span> (<span class="id">typeof</span> <span class="id">a</span>) <span class="id">m</span> = <span class="id">Some</span> <span class="id">true</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">static_bool_val_sound</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">b</span> <span class="kwd">with</span> <span class="id">true</span> <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="id">constructor</span>.<br/>
- <span class="id">exploit</span> <span class="id">eval_simpl_expr_sound</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">e0</span>. <span class="tactic">intro</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">v</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">bool_val</span> <span class="id">v1</span> (<span class="id">typeof</span> <span class="id">a</span>) <span class="id">m</span> = <span class="id">Some</span> <span class="id">false</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">static_bool_val_sound</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">b</span> <span class="kwd">with</span> <span class="id">false</span> <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="id">constructor</span>.<br/>
- <span class="tactic">apply</span> <span class="id">star_one</span>. <span class="tactic">eapply</span> <span class="id">step_ifthenelse</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">star_one</span>. <span class="tactic">eapply</span> <span class="id">step_ifthenelse</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">step_make_set</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">a</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span> <span class="id">e</span> <span class="id">le</span> <span class="id">f</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id">Csem.deref_loc</span> <span class="id">ge</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_lvalue</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ofs</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">typeof</span> <span class="id">a</span> = <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">step1</span> <span class="id">tge</span> (<span class="id">State</span> <span class="id">f</span> (<span class="id">make_set</span> <span class="id">id</span> <span class="id">a</span>) <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> (<span class="id">State</span> <span class="id">f</span> <span class="id">Sskip</span> <span class="id">k</span> <span class="id">e</span> (<span class="id">PTree.set</span> <span class="id">id</span> <span class="id">v</span> <span class="id">le</span>) <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4340')">Proof.</div>
<div class="proofscript" id="proof4340">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">deref_loc_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">make_set</span>. <span class="tactic">destruct</span> (<span class="id">chunk_for_volatile_type</span> (<span class="id">typeof</span> <span class="id">a</span>)) <span class="kwd">as</span> [<span class="id">chunk</span>|].<br/>
&nbsp;volatile&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> (<span class="id">PTree.set</span> <span class="id">id</span> <span class="id">v</span> <span class="id">le</span>) <span class="kwd">with</span> (<span class="id">set_opttemp</span> (<span class="id">Some</span> <span class="id">id</span>) <span class="id">v</span> <span class="id">le</span>). <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id">sem_cast</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;nonvolatile&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">subst</span> <span class="id">t</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id">eval_Elvalue</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">step_make_assign</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span> <span class="id">m</span>' <span class="id">v2</span> <span class="id">e</span> <span class="id">le</span> <span class="id">f</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id">Csem.assign_loc</span> <span class="id">ge</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">t</span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_lvalue</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a1</span> <span class="id">b</span> <span class="id">ofs</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a2</span> <span class="id">v2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sem_cast</span> <span class="id">v2</span> (<span class="id">typeof</span> <span class="id">a2</span>) <span class="id">ty</span> <span class="id">m</span> = <span class="id">Some</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">typeof</span> <span class="id">a1</span> = <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">step1</span> <span class="id">tge</span> (<span class="id">State</span> <span class="id">f</span> (<span class="id">make_assign</span> <span class="id">a1</span> <span class="id">a2</span>) <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> (<span class="id">State</span> <span class="id">f</span> <span class="id">Sskip</span> <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4341')">Proof.</div>
<div class="proofscript" id="proof4341">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">assign_loc_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">make_assign</span>. <span class="tactic">destruct</span> (<span class="id">chunk_for_volatile_type</span> (<span class="id">typeof</span> <span class="id">a1</span>)) <span class="kwd">as</span> [<span class="id">chunk</span>|].<br/>
&nbsp;volatile&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> <span class="id">le</span> <span class="kwd">with</span> (<span class="id">set_opttemp</span> <span class="id">None</span> <span class="id">Vundef</span> <span class="id">le</span>) <span class="tactic">at</span> 2. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id">sem_cast</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;nonvolatile&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">subst</span> <span class="id">t</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">Kseqlist</span> (<span class="id">sl</span>: <span class="id">list</span> <span class="id">statement</span>) (<span class="id">k</span>: <span class="id">cont</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">sl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">k</span><br/>
&nbsp;&nbsp;| <span class="id">s</span> :: <span class="id">l</span> =&gt; <span class="id">Kseq</span> <span class="id">s</span> (<span class="id">Kseqlist</span> <span class="id">l</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id">Kseqlist_app</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl1</span> <span class="id">sl2</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id">Kseqlist</span> (<span class="id">sl1</span> ++ <span class="id">sl2</span>) <span class="id">k</span> = <span class="id">Kseqlist</span> <span class="id">sl1</span> (<span class="id">Kseqlist</span> <span class="id">sl2</span> <span class="id">k</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4342')">Proof.</div>
<div class="proofscript" id="proof4342">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">push_seq</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">sl</span> <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;<span class="id">star</span> <span class="id">step1</span> <span class="id">tge</span> (<span class="id">State</span> <span class="id">f</span> (<span class="id">makeseq</span> <span class="id">sl</span>) <span class="id">k</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">E0</span> (<span class="id">State</span> <span class="id">f</span> <span class="id">Sskip</span> (<span class="id">Kseqlist</span> <span class="id">sl</span> <span class="id">k</span>) <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4343')">Proof.</div>
<div class="proofscript" id="proof4343">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">makeseq</span>. <span class="tactic">generalize</span> <span class="id">Sskip</span>. <span class="id">revert</span> <span class="id">sl</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">star_refl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_right</span>. <span class="tactic">apply</span> <span class="id">IHsl</span>. <span class="id">constructor</span>. <span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">step_tr_rvalof</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span> <span class="id">e</span> <span class="id">le</span> <span class="id">a</span> <span class="id">sl</span> <span class="id">a</span>' <span class="id">tmp</span> <span class="id">f</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id">Csem.deref_loc</span> <span class="id">ge</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">t</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_lvalue</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ofs</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">tr_rvalof</span> <span class="id">ty</span> <span class="id">a</span> <span class="id">sl</span> <span class="id">a</span>' <span class="id">tmp</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">typeof</span> <span class="id">a</span> = <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">le</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">star</span> <span class="id">step1</span> <span class="id">tge</span> (<span class="id">State</span> <span class="id">f</span> <span class="id">Sskip</span> (<span class="id">Kseqlist</span> <span class="id">sl</span> <span class="id">k</span>) <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> (<span class="id">State</span> <span class="id">f</span> <span class="id">Sskip</span> <span class="id">k</span> <span class="id">e</span> <span class="id">le</span>' <span class="id">m</span>)<br/>
&nbsp;&nbsp;/\ <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span>' <span class="id">m</span> <span class="id">a</span>' <span class="id">v</span><br/>
&nbsp;&nbsp;/\ <span class="id">typeof</span> <span class="id">a</span>' = <span class="id">typeof</span> <span class="id">a</span><br/>
&nbsp;&nbsp;/\ <span class="kwd">forall</span> <span class="id">x</span>, ~<span class="id">In</span> <span class="id">x</span> <span class="id">tmp</span> -&gt; <span class="id">le</span>'!<span class="id">x</span> = <span class="id">le</span>!<span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4344')">Proof.</div>
<div class="proofscript" id="proof4344">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;not&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">deref_loc_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id">chunk_for_volatile_type</span>; <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">subst</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">le</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">eval_Elvalue</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exists</span> (<span class="id">PTree.set</span> <span class="id">t0</span> <span class="id">v</span> <span class="id">le</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">star_two</span>. <span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id">step_make_set</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Matching between continuations </div>
<br/>
<span class="kwd">Inductive</span> <span class="id">match_cont</span> : <span class="id">Csem.cont</span> -&gt; <span class="id">cont</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">match_Kstop</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">Csem.Kstop</span> <span class="id">Kstop</span><br/>
&nbsp;&nbsp;| <span class="id">match_Kseq</span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">k</span> <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kseq</span> <span class="id">s</span> <span class="id">k</span>) (<span class="id">Kseq</span> <span class="id">ts</span> <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kwhile2</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kwhile2</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kloop1</span> (<span class="id">Ssequence</span> <span class="id">s</span>' <span class="id">ts</span>) <span class="id">Sskip</span> <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kdowhile1</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kdowhile1</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kloop1</span> <span class="id">ts</span> <span class="id">s</span>' <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kfor3</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s3</span> <span class="id">s</span> <span class="id">k</span> <span class="id">ts3</span> <span class="id">s</span>' <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s3</span> <span class="id">ts3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kfor3</span> <span class="id">r</span> <span class="id">s3</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kloop1</span> (<span class="id">Ssequence</span> <span class="id">s</span>' <span class="id">ts</span>) <span class="id">ts3</span> <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kfor4</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s3</span> <span class="id">s</span> <span class="id">k</span> <span class="id">ts3</span> <span class="id">s</span>' <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s3</span> <span class="id">ts3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kfor4</span> <span class="id">r</span> <span class="id">s3</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kloop2</span> (<span class="id">Ssequence</span> <span class="id">s</span>' <span class="id">ts</span>) <span class="id">ts3</span> <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kswitch2</span>: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kswitch2</span> <span class="id">k</span>) (<span class="id">Kswitch</span> <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kcall</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">e</span> <span class="id">C</span> <span class="id">ty</span> <span class="id">k</span> <span class="id">optid</span> <span class="id">tf</span> <span class="id">le</span> <span class="id">sl</span> <span class="id">tk</span> <span class="id">a</span> <span class="kwd">dest</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_function</span> <span class="id">f</span> <span class="id">tf</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">leftcontext</span> <span class="id">RV</span> <span class="id">RV</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">v</span> <span class="id">m</span>, <span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> (<span class="id">set_opttemp</span> <span class="id">optid</span> <span class="id">v</span> <span class="id">le</span>) <span class="id">m</span> <span class="kwd">dest</span> (<span class="id">C</span> (<span class="id">Csyntax.Eval</span> <span class="id">v</span> <span class="id">ty</span>)) <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="kwd">dest</span> <span class="id">a</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.Kcall</span> <span class="id">f</span> <span class="id">e</span> <span class="id">C</span> <span class="id">ty</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kcall</span> <span class="id">optid</span> <span class="id">tf</span> <span class="id">e</span> <span class="id">le</span> (<span class="id">Kseqlist</span> <span class="id">sl</span> <span class="id">tk</span>))<br/>
<br/>
<span class="kwd">with</span> <span class="id">match_cont_exp</span> : <span class="id">destination</span> -&gt; <span class="id">expr</span> -&gt; <span class="id">Csem.cont</span> -&gt; <span class="id">cont</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">match_Kdo</span>: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">a</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_effects</span> <span class="id">a</span> (<span class="id">Csem.Kdo</span> <span class="id">k</span>) <span class="id">tk</span><br/>
&nbsp;&nbsp;| <span class="id">match_Kifthenelse_1</span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span> <span class="id">ts1</span> <span class="id">ts2</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s1</span> <span class="id">ts1</span> -&gt; <span class="id">tr_stmt</span> <span class="id">s2</span> <span class="id">ts2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_val</span> <span class="id">a</span> (<span class="id">Csem.Kifthenelse</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">k</span>) (<span class="id">Kseq</span> (<span class="id">Sifthenelse</span> <span class="id">a</span> <span class="id">ts1</span> <span class="id">ts2</span>) <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kwhile1</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">a</span> <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_val</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Csem.Kwhile1</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kseq</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">Sskip</span> <span class="id">Sbreak</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kseq</span> <span class="id">ts</span> (<span class="id">Kloop1</span> (<span class="id">Ssequence</span> <span class="id">s</span>' <span class="id">ts</span>) <span class="id">Sskip</span> <span class="id">tk</span>)))<br/>
&nbsp;&nbsp;| <span class="id">match_Kdowhile2</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">a</span> <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_val</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Csem.Kdowhile2</span> <span class="id">r</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kseq</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">Sskip</span> <span class="id">Sbreak</span>) (<span class="id">Kloop2</span> <span class="id">ts</span> <span class="id">s</span>' <span class="id">tk</span>))<br/>
&nbsp;&nbsp;| <span class="id">match_Kfor2</span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">s3</span> <span class="id">s</span> <span class="id">k</span> <span class="id">s</span>' <span class="id">a</span> <span class="id">ts3</span> <span class="id">ts</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s3</span> <span class="id">ts3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_val</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Csem.Kfor2</span> <span class="id">r</span> <span class="id">s3</span> <span class="id">s</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kseq</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">Sskip</span> <span class="id">Sbreak</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Kseq</span> <span class="id">ts</span> (<span class="id">Kloop1</span> (<span class="id">Ssequence</span> <span class="id">s</span>' <span class="id">ts</span>) <span class="id">ts3</span> <span class="id">tk</span>)))<br/>
&nbsp;&nbsp;| <span class="id">match_Kswitch1</span>: <span class="kwd">forall</span> <span class="id">ls</span> <span class="id">k</span> <span class="id">a</span> <span class="id">tls</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_lblstmts</span> <span class="id">ls</span> <span class="id">tls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_val</span> <span class="id">a</span> (<span class="id">Csem.Kswitch1</span> <span class="id">ls</span> <span class="id">k</span>) (<span class="id">Kseq</span> (<span class="id">Sswitch</span> <span class="id">a</span> <span class="id">tls</span>) <span class="id">tk</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_Kreturn</span>: <span class="kwd">forall</span> <span class="id">k</span> <span class="id">a</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="id">For_val</span> <span class="id">a</span> (<span class="id">Csem.Kreturn</span> <span class="id">k</span>) (<span class="id">Kseq</span> (<span class="id">Sreturn</span> (<span class="id">Some</span> <span class="id">a</span>)) <span class="id">tk</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">match_cont_call</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">match_cont</span> (<span class="id">Csem.call_cont</span> <span class="id">k</span>) (<span class="id">call_cont</span> <span class="id">tk</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4345')">Proof.</div>
<div class="proofscript" id="proof4345">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Matching between states </div>
<br/>
<span class="kwd">Inductive</span> <span class="id">match_states</span>: <span class="id">Csem.state</span> -&gt; <span class="id">state</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">match_exprstates</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">r</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span> <span class="id">tf</span> <span class="id">sl</span> <span class="id">tk</span> <span class="id">le</span> <span class="kwd">dest</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_function</span> <span class="id">f</span> <span class="id">tf</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="kwd">dest</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont_exp</span> <span class="kwd">dest</span> <span class="id">a</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> (<span class="id">Csem.ExprState</span> <span class="id">f</span> <span class="id">r</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">State</span> <span class="id">tf</span> <span class="id">Sskip</span> (<span class="id">Kseqlist</span> <span class="id">sl</span> <span class="id">tk</span>) <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_regularstates</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">s</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span> <span class="id">tf</span> <span class="id">ts</span> <span class="id">tk</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_function</span> <span class="id">f</span> <span class="id">tf</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> (<span class="id">Csem.State</span> <span class="id">f</span> <span class="id">s</span> <span class="id">k</span> <span class="id">e</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">State</span> <span class="id">tf</span> <span class="id">ts</span> <span class="id">tk</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_callstates</span>: <span class="kwd">forall</span> <span class="id">fd</span> <span class="id">args</span> <span class="id">k</span> <span class="id">m</span> <span class="id">tfd</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_fundef</span> <span class="id">fd</span> <span class="id">tfd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> (<span class="id">Csem.Callstate</span> <span class="id">fd</span> <span class="id">args</span> <span class="id">k</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Callstate</span> <span class="id">tfd</span> <span class="id">args</span> <span class="id">tk</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_returnstates</span>: <span class="kwd">forall</span> <span class="id">res</span> <span class="id">k</span> <span class="id">m</span> <span class="id">tk</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> (<span class="id">Csem.Returnstate</span> <span class="id">res</span> <span class="id">k</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Returnstate</span> <span class="id">res</span> <span class="id">tk</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;| <span class="id">match_stuckstate</span>: <span class="kwd">forall</span> <span class="id">S</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_states</span> <span class="id">Csem.Stuckstate</span> <span class="id">S</span>.<br/>
<br/>
<div class="doc">Additional results on translation of statements </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_select_switch</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">ls</span> <span class="id">tls</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_lblstmts</span> <span class="id">ls</span> <span class="id">tls</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">tr_lblstmts</span> (<span class="id">Csem.select_switch</span> <span class="id">n</span> <span class="id">ls</span>) (<span class="id">select_switch</span> <span class="id">n</span> <span class="id">tls</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4346')">Proof.</div>
<div class="proofscript" id="proof4346">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">DFL</span>: <span class="kwd">forall</span> <span class="id">ls</span> <span class="id">tls</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_lblstmts</span> <span class="id">ls</span> <span class="id">tls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_lblstmts</span> (<span class="id">Csem.select_switch_default</span> <span class="id">ls</span>) (<span class="id">select_switch_default</span> <span class="id">tls</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> 1; <span class="tactic">simpl</span>. <span class="id">constructor</span>. <span class="tactic">destruct</span> <span class="id">c</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">CASE</span>: <span class="kwd">forall</span> <span class="id">n</span> <span class="id">ls</span> <span class="id">tls</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr_lblstmts</span> <span class="id">ls</span> <span class="id">tls</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">Csem.select_switch_case</span> <span class="id">n</span> <span class="id">ls</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">select_switch_case</span> <span class="id">n</span> <span class="id">tls</span> = <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">ls</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tls</span>', <span class="id">select_switch_case</span> <span class="id">n</span> <span class="id">tls</span> = <span class="id">Some</span> <span class="id">tls</span>' /\ <span class="id">tr_lblstmts</span> <span class="id">ls</span>' <span class="id">tls</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">c</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id">zeq</span> <span class="id">z</span> <span class="id">n</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">Csem.select_switch</span>, <span class="id">select_switch</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">CASE</span> <span class="id">n</span> <span class="id">ls</span> <span class="id">tls</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.select_switch_case</span> <span class="id">n</span> <span class="id">ls</span>) <span class="kwd">as</span> [<span class="id">ls</span>'|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">CASE</span> <span class="kwd">as</span> [<span class="id">tls</span>' [<span class="id">P</span> <span class="id">Q</span>]]. <span class="tactic">rewrite</span> <span class="id">P</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">CASE</span>. <span class="tactic">apply</span> <span class="id">DFL</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_seq_of_labeled_statement</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">tls</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_lblstmts</span> <span class="id">ls</span> <span class="id">tls</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">tr_stmt</span> (<span class="id">Csem.seq_of_labeled_statement</span> <span class="id">ls</span>) (<span class="id">seq_of_labeled_statement</span> <span class="id">tls</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4347')">Proof.</div>
<div class="proofscript" id="proof4347">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Commutation between translation and the "find label" operation. </div>
<br/>
<span class="kwd">Section</span> <span class="id">FIND_LABEL</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">lbl</span>: <span class="id">label</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">nolabel</span> (<span class="id">s</span>: <span class="id">statement</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">nolabel_list</span> (<span class="id">sl</span>: <span class="id">list</span> <span class="id">statement</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">sl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;| <span class="id">s1</span> :: <span class="id">sl</span>' =&gt; <span class="id">nolabel</span> <span class="id">s1</span> /\ <span class="id">nolabel_list</span> <span class="id">sl</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">nolabel_list_app</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl2</span> <span class="id">sl1</span>, <span class="id">nolabel_list</span> <span class="id">sl1</span> -&gt; <span class="id">nolabel_list</span> <span class="id">sl2</span> -&gt; <span class="id">nolabel_list</span> (<span class="id">sl1</span> ++ <span class="id">sl2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4348')">Proof.</div>
<div class="proofscript" id="proof4348">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sl1</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">makeseq_nolabel</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl</span>, <span class="id">nolabel_list</span> <span class="id">sl</span> -&gt; <span class="id">nolabel</span> (<span class="id">makeseq</span> <span class="id">sl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4349')">Proof.</div>
<div class="proofscript" id="proof4349">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">s</span>, <span class="id">nolabel</span> <span class="id">s</span> -&gt; <span class="id">nolabel_list</span> <span class="id">sl</span> -&gt; <span class="id">nolabel</span> (<span class="id">makeseq_rec</span> <span class="id">s</span> <span class="id">sl</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id">IHsl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">makeseq</span>. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">makeif_nolabel</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span>, <span class="id">nolabel</span> <span class="id">s1</span> -&gt; <span class="id">nolabel</span> <span class="id">s2</span> -&gt; <span class="id">nolabel</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4350')">Proof.</div>
<div class="proofscript" id="proof4350">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">functional</span> <span class="tactic">induction</span> (<span class="id">makeif</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">make_set_nolabel</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">a</span>, <span class="id">nolabel</span> (<span class="id">make_set</span> <span class="id">t</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4351')">Proof.</div>
<div class="proofscript" id="proof4351">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">make_set</span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">chunk_for_volatile_type</span> (<span class="id">typeof</span> <span class="id">a</span>)); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">make_assign_nolabel</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">nolabel</span> (<span class="id">make_assign</span> <span class="id">l</span> <span class="id">r</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4352')">Proof.</div>
<div class="proofscript" id="proof4352">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">make_assign</span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">chunk_for_volatile_type</span> (<span class="id">typeof</span> <span class="id">l</span>)); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_rvalof_nolabel</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">a</span> <span class="id">sl</span> <span class="id">a</span>' <span class="id">tmp</span>, <span class="id">tr_rvalof</span> <span class="id">ty</span> <span class="id">a</span> <span class="id">sl</span> <span class="id">a</span>' <span class="id">tmp</span> -&gt; <span class="id">nolabel_list</span> <span class="id">sl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4353')">Proof.</div>
<div class="proofscript" id="proof4353">
&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">make_set_nolabel</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nolabel_do_set</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sd</span> <span class="id">a</span>, <span class="id">nolabel_list</span> (<span class="id">do_set</span> <span class="id">sd</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4354')">Proof.</div>
<div class="proofscript" id="proof4354">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sd</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nolabel_final</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">dst</span> <span class="id">a</span>, <span class="id">nolabel_list</span> (<span class="id">final</span> <span class="id">dst</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4355')">Proof.</div>
<div class="proofscript" id="proof4355">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">nolabel_do_set</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">NoLabelTac</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel_list</span> <span class="id">nil</span> ] =&gt; <span class="tactic">exact</span> <span class="id">I</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel_list</span> (<span class="id">final</span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id">nolabel_final</span> <br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel_list</span> (<span class="id">_</span> :: <span class="id">_</span>) ] =&gt; <span class="tactic">simpl</span>; <span class="tactic">split</span>; <span class="id">NoLabelTac</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel_list</span> (<span class="id">_</span> ++ <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id">nolabel_list_app</span>; <span class="id">NoLabelTac</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id">_</span> -&gt; <span class="id">nolabel_list</span> ?<span class="id">x</span> |- <span class="id">nolabel_list</span> ?<span class="id">x</span> ] =&gt; <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">NoLabelTac</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel</span> (<span class="id">makeseq</span> <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id">makeseq_nolabel</span>; <span class="id">NoLabelTac</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel</span> (<span class="id">makeif</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id">makeif_nolabel</span>; <span class="id">NoLabelTac</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel</span> (<span class="id">make_set</span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id">make_set_nolabel</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel</span> (<span class="id">make_assign</span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id">make_assign_nolabel</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">nolabel</span> <span class="id">_</span> ] =&gt; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| [ |- <span class="id">_</span> /\ <span class="id">_</span> ] =&gt; <span class="tactic">split</span>; <span class="id">NoLabelTac</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_find_label_expr</span>:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>, <span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt; <span class="id">nolabel_list</span> <span class="id">sl</span>)<br/>
/\(<span class="kwd">forall</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span>, <span class="id">tr_exprlist</span> <span class="id">le</span> <span class="id">rl</span> <span class="id">sl</span> <span class="id">al</span> <span class="id">tmps</span> -&gt; <span class="id">nolabel_list</span> <span class="id">sl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4356')">Proof.</div>
<div class="proofscript" id="proof4356">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_exprlist</span>; <span class="tactic">intros</span>; <span class="id">NoLabelTac</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nolabel_do_set</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_rvalof_nolabel</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nolabel_do_set</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nolabel_do_set</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_rvalof_nolabel</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_rvalof_nolabel</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_rvalof_nolabel</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_find_label_top</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">dst</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt; <span class="id">nolabel_list</span> <span class="id">sl</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4357')">Proof.</div>
<div class="proofscript" id="proof4357">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">NoLabelTac</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">proj1</span> <span class="id">tr_find_label_expr</span>); <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_find_label_expression</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span> <span class="id">a</span>, <span class="id">tr_expression</span> <span class="id">r</span> <span class="id">s</span> <span class="id">a</span> -&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4358')">Proof.</div>
<div class="proofscript" id="proof4358">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">nolabel</span> (<span class="id">makeseq</span> <span class="id">sl</span>)). <span class="tactic">apply</span> <span class="id">makeseq_nolabel</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_find_label_top</span> <span class="kwd">with</span> (<span class="id">e</span> := <span class="id">empty_env</span>) (<span class="id">le</span> := <span class="id">PTree.empty</span> <span class="id">val</span>) (<span class="id">m</span> := <span class="id">Mem.empty</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_find_label_expr_stmt</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>, <span class="id">tr_expr_stmt</span> <span class="id">r</span> <span class="id">s</span> -&gt; <span class="kwd">forall</span> <span class="id">k</span>, <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4359')">Proof.</div>
<div class="proofscript" id="proof4359">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">nolabel</span> (<span class="id">makeseq</span> <span class="id">sl</span>)). <span class="tactic">apply</span> <span class="id">makeseq_nolabel</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_find_label_top</span> <span class="kwd">with</span> (<span class="id">e</span> := <span class="id">empty_env</span>) (<span class="id">le</span> := <span class="id">PTree.empty</span> <span class="id">val</span>) (<span class="id">m</span> := <span class="id">Mem.empty</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_find_label_if</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_if</span> <span class="id">r</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, <span class="id">find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4360')">Proof.</div>
<div class="proofscript" id="proof4360">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">nolabel</span> (<span class="id">makeseq</span> (<span class="id">sl</span> ++ <span class="id">makeif</span> <span class="id">a</span> <span class="id">Sskip</span> <span class="id">Sbreak</span> :: <span class="id">nil</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">makeseq_nolabel</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nolabel_list_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_find_label_top</span> <span class="kwd">with</span> (<span class="id">e</span> := <span class="id">empty_env</span>) (<span class="id">le</span> := <span class="id">PTree.empty</span> <span class="id">val</span>) (<span class="id">m</span> := <span class="id">Mem.empty</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">makeif_nolabel</span>. <span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_find_label</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">k</span> <span class="id">ts</span> <span class="id">tk</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">tr_stmt</span> <span class="id">s</span> <span class="id">ts</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MC</span>: <span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span>),<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">ts</span> <span class="id">tk</span> = <span class="id">None</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ts</span>', <span class="id">exists</span> <span class="id">tk</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label</span> <span class="id">lbl</span> <span class="id">ts</span> <span class="id">tk</span> = <span class="id">Some</span> (<span class="id">ts</span>', <span class="id">tk</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">tr_stmt</span> <span class="id">s</span>' <span class="id">ts</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">match_cont</span> <span class="id">k</span>' <span class="id">tk</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span><br/>
<span class="kwd">with</span> <span class="id">tr_find_label_ls</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">k</span> <span class="id">ts</span> <span class="id">tk</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TR</span>: <span class="id">tr_lblstmts</span> <span class="id">s</span> <span class="id">ts</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MC</span>: <span class="id">match_cont</span> <span class="id">k</span> <span class="id">tk</span>),<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">Csem.find_label_ls</span> <span class="id">lbl</span> <span class="id">s</span> <span class="id">k</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">None</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">ts</span> <span class="id">tk</span> = <span class="id">None</span><br/>
&nbsp;&nbsp;| <span class="id">Some</span> (<span class="id">s</span>', <span class="id">k</span>') =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ts</span>', <span class="id">exists</span> <span class="id">tk</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_label_ls</span> <span class="id">lbl</span> <span class="id">ts</span> <span class="id">tk</span> = <span class="id">Some</span> (<span class="id">ts</span>', <span class="id">tk</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">tr_stmt</span> <span class="id">s</span>' <span class="id">ts</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">match_cont</span> <span class="id">k</span>' <span class="id">tk</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4361')">Proof.</div>
<div class="proofscript" id="proof4361">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">TR</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">TR</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_find_label_expr_stmt</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs1</span> (<span class="id">Csem.Kseq</span> <span class="id">s2</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s1</span> (<span class="id">Csem.Kseq</span> <span class="id">s2</span> <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">eapply</span> <span class="id">IHs2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;if&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">s</span>' <span class="id">into</span> <span class="id">sr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_expression</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs1</span> <span class="id">k</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s1</span> <span class="id">k</span>) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">eapply</span> <span class="id">IHs2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;while&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">s</span>' <span class="id">into</span> <span class="id">sr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_if</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs</span> (<span class="id">Kwhile2</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s</span> (<span class="id">Kwhile2</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">auto</span>.<br/>
&nbsp;dowhile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">s</span>' <span class="id">into</span> <span class="id">sr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_if</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs</span> (<span class="id">Kdowhile1</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s</span> (<span class="id">Kdowhile1</span> <span class="id">e</span> <span class="id">s</span> <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">s</span>' <span class="id">into</span> <span class="id">sr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_if</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H4</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs3</span> (<span class="id">Csem.Kfor3</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s3</span> (<span class="id">Csem.Kfor3</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs2</span> (<span class="id">Csem.Kfor4</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;for&nbsp;not&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">s</span>' <span class="id">into</span> <span class="id">sr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_if</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs1</span> (<span class="id">Csem.Kseq</span> (<span class="id">Csyntax.Sfor</span> <span class="id">Csyntax.Sskip</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span>) <span class="id">k</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Csem.Kseq</span> (<span class="id">Csyntax.Sfor</span> <span class="id">Csyntax.Sskip</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span>) <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs3</span> (<span class="id">Csem.Kfor3</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s3</span> (<span class="id">Csem.Kfor3</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>'' <span class="id">k</span>''] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>'. <span class="tactic">rewrite</span> <span class="id">EQ</span>'.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHs2</span> (<span class="id">Csem.Kfor4</span> <span class="id">e</span> <span class="id">s2</span> <span class="id">s3</span> <span class="id">k</span>)); <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;break,&nbsp;continue,&nbsp;return&nbsp;0&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;return&nbsp;1&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_expression</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;switch&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">tr_find_label_expression</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>). <span class="tactic">apply</span> <span class="id">tr_find_label_ls</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;labeled&nbsp;stmt&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">ident_eq</span> <span class="id">lbl</span> <span class="id">l</span>). <span class="id">exists</span> <span class="id">ts0</span>; <span class="id">exists</span> <span class="id">tk</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">IHs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;goto&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">TR</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">TR</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;nil&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">tr_find_label</span> <span class="id">s</span> (<span class="id">Csem.Kseq</span> (<span class="id">Csem.seq_of_labeled_statement</span> <span class="id">s0</span>) <span class="id">k</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_seq_of_labeled_statement</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">Csem.find_label</span> <span class="id">lbl</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Csem.Kseq</span> (<span class="id">Csem.seq_of_labeled_statement</span> <span class="id">s0</span>) <span class="id">k</span>)) <span class="kwd">as</span> [[<span class="id">s</span>' <span class="id">k</span>'] | ].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">ts</span>'; <span class="id">exists</span> <span class="id">tk</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">eapply</span> <span class="id">IHs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">FIND_LABEL</span>.<br/>
<br/>
<div class="doc">Anti-stuttering measure </div>
<br/>
<div class="doc">There are some stuttering steps in the translation:
<ul>
<li>
 The execution of <span class="bracket"><span class="id">Sdo</span> <span class="id">a</span></span> where <span class="bracket"><span class="id">a</span></span> is side-effect free,
  which is three transitions in the source:
<pre>
    Sdo a, k  ---&gt;  a, Kdo k ---&gt; rval v, Kdo k ---&gt; Sskip, k</pre>
  but the translation, which is <span class="bracket"><span class="id">Sskip</span></span>, makes no transitions.
</li>
<li>
 The reduction <span class="bracket"><span class="id">Ecomma</span> (<span class="kwd">Eval</span> <span class="id">v</span>) <span class="id">r2</span> --&gt; <span class="id">r2</span></span>.
</li>
<li>
 The reduction <span class="bracket"><span class="id">Eparen</span> (<span class="kwd">Eval</span> <span class="id">v</span>) --&gt; <span class="kwd">Eval</span> <span class="id">v</span></span> in a <span class="bracket"><span class="id">For_effects</span></span> context.
</li>
</ul>
The following measure decreases for these stuttering steps. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">esize</span> (<span class="id">a</span>: <span class="id">Csyntax.expr</span>) : <span class="id">nat</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eloc</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Evar</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ederef</span> <span class="id">r1</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Efield</span> <span class="id">l1</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eval</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">O</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Evalof</span> <span class="id">l1</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eaddrof</span> <span class="id">l1</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eunop</span> <span class="id">_</span> <span class="id">r1</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ebinop</span> <span class="id">_</span> <span class="id">r1</span> <span class="id">r2</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span> + <span class="id">esize</span> <span class="id">r2</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ecast</span> <span class="id">r1</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eseqand</span> <span class="id">r1</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eseqor</span> <span class="id">r1</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Econdition</span> <span class="id">r1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Esizeof</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ealignof</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eassign</span> <span class="id">l1</span> <span class="id">r2</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">l1</span> + <span class="id">esize</span> <span class="id">r2</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eassignop</span> <span class="id">_</span> <span class="id">l1</span> <span class="id">r2</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">l1</span> + <span class="id">esize</span> <span class="id">r2</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Epostincr</span> <span class="id">_</span> <span class="id">l1</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">l1</span>)<br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ecomma</span> <span class="id">r1</span> <span class="id">r2</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span> + <span class="id">esize</span> <span class="id">r2</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ecall</span> <span class="id">r1</span> <span class="id">rl2</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span> + <span class="id">esizelist</span> <span class="id">rl2</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Ebuiltin</span> <span class="id">ef</span> <span class="id">_</span> <span class="id">rl</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esizelist</span> <span class="id">rl</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Eparen</span> <span class="id">r1</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">S</span>(<span class="id">esize</span> <span class="id">r1</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">esizelist</span> (<span class="id">el</span>: <span class="id">Csyntax.exprlist</span>) : <span class="id">nat</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">el</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Enil</span> =&gt; <span class="id">O</span><br/>
&nbsp;&nbsp;| <span class="id">Csyntax.Econs</span> <span class="id">r1</span> <span class="id">rl2</span> =&gt; (<span class="id">esize</span> <span class="id">r1</span> + <span class="id">esizelist</span> <span class="id">rl2</span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="kwd">measure</span> (<span class="id">st</span>: <span class="id">Csem.state</span>) : <span class="id">nat</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">st</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">Csem.ExprState</span> <span class="id">_</span> <span class="id">r</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; (<span class="id">esize</span> <span class="id">r</span> + 1)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csem.State</span> <span class="id">_</span> <span class="id">Csyntax.Sskip</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csem.State</span> <span class="id">_</span> (<span class="id">Csyntax.Sdo</span> <span class="id">r</span>) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; (<span class="id">esize</span> <span class="id">r</span> + 2)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">Csem.State</span> <span class="id">_</span> (<span class="id">Csyntax.Sifthenelse</span> <span class="id">r</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; (<span class="id">esize</span> <span class="id">r</span> + 2)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">leftcontext_size</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">from</span> <span class="id">to</span> <span class="id">C</span>,<br/>
&nbsp;&nbsp;<span class="id">leftcontext</span> <span class="id">from</span> <span class="id">to</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e1</span> <span class="id">e2</span>,<br/>
&nbsp;&nbsp;(<span class="id">esize</span> <span class="id">e1</span> &lt; <span class="id">esize</span> <span class="id">e2</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">esize</span> (<span class="id">C</span> <span class="id">e1</span>) &lt; <span class="id">esize</span> (<span class="id">C</span> <span class="id">e2</span>))%<span class="id">nat</span><br/>
<span class="kwd">with</span> <span class="id">leftcontextlist_size</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">from</span> <span class="id">C</span>,<br/>
&nbsp;&nbsp;<span class="id">leftcontextlist</span> <span class="id">from</span> <span class="id">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e1</span> <span class="id">e2</span>,<br/>
&nbsp;&nbsp;(<span class="id">esize</span> <span class="id">e1</span> &lt; <span class="id">esize</span> <span class="id">e2</span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">esizelist</span> (<span class="id">C</span> <span class="id">e1</span>) &lt; <span class="id">esizelist</span> (<span class="id">C</span> <span class="id">e2</span>))%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4362')">Proof.</div>
<div class="proofscript" id="proof4362">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">leftcontextlist_size</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">leftcontextlist_size</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>. <span class="id">exploit</span> <span class="id">leftcontext_size</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Forward simulation for expressions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_val_gen</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">dst</span> <span class="id">v</span> <span class="id">ty</span> <span class="id">a</span> <span class="id">tmp</span>,<br/>
&nbsp;&nbsp;<span class="id">typeof</span> <span class="id">a</span> = <span class="id">ty</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span>' <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span>, <span class="id">In</span> <span class="id">id</span> <span class="id">tmp</span> -&gt; <span class="id">le</span>'!<span class="id">id</span> = <span class="id">le</span>!<span class="id">id</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span>' <span class="id">m</span> <span class="id">a</span> <span class="id">v</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">tr_expr</span> <span class="id">le</span> <span class="id">dst</span> (<span class="id">Csyntax.Eval</span> <span class="id">v</span> <span class="id">ty</span>) (<span class="id">final</span> <span class="id">dst</span> <span class="id">a</span>) <span class="id">a</span> <span class="id">tmp</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4363')">Proof.</div>
<div class="proofscript" id="proof4363">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">dst</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">estep_simulation</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span>, <span class="id">Cstrategy.estep</span> <span class="id">ge</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span>' (<span class="id">MS</span>: <span class="id">match_states</span> <span class="id">S1</span> <span class="id">S1</span>'),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">S2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">plus</span> <span class="id">step1</span> <span class="id">tge</span> <span class="id">S1</span>' <span class="id">t</span> <span class="id">S2</span>' \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">star</span> <span class="id">step1</span> <span class="id">tge</span> <span class="id">S1</span>' <span class="id">t</span> <span class="id">S2</span>' /\ <span class="kwd">measure</span> <span class="id">S2</span> &lt; <span class="kwd">measure</span> <span class="id">S1</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;/\ <span class="id">match_states</span> <span class="id">S2</span> <span class="id">S2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4364')">Proof.</div>
<div class="proofscript" id="proof4364">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">MS</span>.<br/>
&nbsp;expr&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">tr_expr</span> <span class="id">le</span> <span class="kwd">dest</span> <span class="id">r</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H9</span>. <span class="id">contradiction</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="kwd">dest</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]]. <span class="tactic">subst</span> <span class="id">sl</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>. <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>; (<span class="id">contradiction</span> || <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">tmps</span>). <span class="tactic">apply</span> <span class="id">tr_top_val_val</span>; <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">SL1</span>. <span class="tactic">subst</span> <span class="id">sl</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>. <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>; (<span class="id">contradiction</span> || <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">tmps</span>). <span class="tactic">apply</span> <span class="id">tr_top_base</span>. <span class="id">constructor</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;rval&nbsp;volatile&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]]. <span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id">step_make_set</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id">final</span> <span class="id">dst</span>' (<span class="id">Etempvar</span> <span class="id">t0</span> (<span class="id">Csyntax.typeof</span> <span class="id">l</span>)) ++ <span class="id">sl2</span>) <span class="kwd">with</span> (<span class="id">nil</span> ++ (<span class="id">final</span> <span class="id">dst</span>' (<span class="id">Etempvar</span> <span class="id">t0</span> (<span class="id">Csyntax.typeof</span> <span class="id">l</span>)) ++ <span class="id">sl2</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_val_gen</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H5</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">elim</span> <span class="id">H5</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;seqand&nbsp;true&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_paren_val</span> <span class="kwd">with</span> (<span class="id">a1</span> := <span class="id">a2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_paren_effects</span> <span class="kwd">with</span> (<span class="id">a1</span> := <span class="id">a2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_paren_set</span> <span class="kwd">with</span> (<span class="id">a1</span> := <span class="id">a2</span>) (<span class="id">t</span> := <span class="id">sd_temp</span> <span class="id">sd</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;seqand&nbsp;false&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">star_one</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;seqor&nbsp;true&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">star_one</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;seqand&nbsp;false&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;val&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_paren_val</span> <span class="kwd">with</span> (<span class="id">a1</span> := <span class="id">a2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_paren_effects</span> <span class="kwd">with</span> (<span class="id">a1</span> := <span class="id">a2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="tactic">apply</span> <span class="id">tr_paren_set</span> <span class="kwd">with</span> (<span class="id">a1</span> := <span class="id">a2</span>) (<span class="id">t</span> := <span class="id">sd_temp</span> <span class="id">sd</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;condition&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_exprstates</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp3</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> [<span class="id">TY</span> <span class="id">EV</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">true</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">false</span>) (<span class="id">v1</span> := <span class="id">v</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">tr_expr_monotone</span> <span class="kwd">with</span> <span class="id">tmp3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;assign&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">star_one</span>. <span class="tactic">eapply</span> <span class="id">step_make_assign</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">TY2</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span>' := <span class="id">PTree.set</span> <span class="id">t0</span> <span class="id">v</span>' <span class="id">le</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_left</span>. <span class="id">constructor</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TY2</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">star_one</span>. <span class="tactic">eapply</span> <span class="id">step_make_assign</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">cast_idempotent</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_val_gen</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;assignop&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H15</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">step_tr_rvalof</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">le</span>' [<span class="id">EXEC</span> [<span class="id">EV3</span> [<span class="id">TY3</span> <span class="id">INV</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span> := <span class="id">le</span>) (<span class="id">le</span>' := <span class="id">le</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INV</span>. <span class="id">NOTIN</span>. <span class="tactic">intros</span> [? [? <span class="id">EV1</span>']].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span> := <span class="id">le</span>) (<span class="id">le</span>' := <span class="id">le</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INV</span>. <span class="id">NOTIN</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">star_plus_trans</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="tactic">simpl</span>. <span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id">step_make_assign</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">EV3</span>. <span class="id">eexact</span> <span class="id">EV2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">TY3</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">TY2</span>; <span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">step_tr_rvalof</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">le</span>' [<span class="id">EXEC</span> [<span class="id">EV3</span> [<span class="id">TY3</span> <span class="id">INV</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span> := <span class="id">le</span>) (<span class="id">le</span>' := <span class="id">le</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INV</span>. <span class="id">NOTIN</span>. <span class="tactic">intros</span> [? [? <span class="id">EV1</span>']].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span> := <span class="id">le</span>) (<span class="id">le</span>' := <span class="id">le</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INV</span>. <span class="id">NOTIN</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span> := <span class="id">le</span>) (<span class="id">le</span>' := <span class="id">PTree.set</span> <span class="id">t</span> <span class="id">v4</span> <span class="id">le</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gso</span>. <span class="tactic">apply</span> <span class="id">INV</span>. <span class="id">NOTIN</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [? [? <span class="id">EV1</span>'']].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_plus_trans</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_four</span>. <span class="id">econstructor</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">EV3</span>. <span class="id">eexact</span> <span class="id">EV2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">TY3</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">TY2</span>; <span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id">step_make_assign</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">cast_idempotent</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_val_gen</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">PTree.gso</span>. <span class="tactic">apply</span> <span class="id">INV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H10</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;assignop&nbsp;stuck&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">step_tr_rvalof</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">le</span>' [<span class="id">EXEC</span> [<span class="id">EV3</span> [<span class="id">TY3</span> <span class="id">INV</span>]]]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">step_tr_rvalof</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">le</span>' [<span class="id">EXEC</span> [<span class="id">EV3</span> [<span class="id">TY3</span> <span class="id">INV</span>]]]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>. <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;postincr&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">step_tr_rvalof</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">le</span>' [<span class="id">EXEC</span> [<span class="id">EV3</span> [<span class="id">TY3</span> <span class="id">INV</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span> := <span class="id">le</span>) (<span class="id">le</span>' := <span class="id">le</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INV</span>. <span class="id">NOTIN</span>. <span class="tactic">intros</span> [? [? <span class="id">EV1</span>']].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_plus_trans</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="tactic">simpl</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">step_make_assign</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_incrdecr</span>. <span class="tactic">destruct</span> <span class="id">id</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">TY3</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">TY3</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">id</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_invariant</span> <span class="kwd">with</span> (<span class="id">le</span>' := <span class="id">PTree.set</span> <span class="id">t</span> <span class="id">v1</span> <span class="id">le</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">SL2</span> [<span class="id">TY2</span> <span class="id">EV2</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_four</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">step_make_set</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">step_make_assign</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">transl_incrdecr</span>. <span class="tactic">destruct</span> <span class="id">id</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">id</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_val_gen</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;postincr&nbsp;stuck&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">step_tr_rvalof</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">le</span>' [<span class="id">EXEC</span> [<span class="id">EV3</span> [<span class="id">TY3</span> <span class="id">INV</span>]]]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">app_ass</span>; <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_lvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id">step_make_set</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;comma&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">intro</span> <span class="id">SL1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl0</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">plus_lt_compat_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">leftcontext_size</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">tr_expr_monotone</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;paren&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">b</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sl1</span>; <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">star_one</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">final</span> <span class="id">For_val</span> (<span class="id">Etempvar</span> <span class="id">t</span> (<span class="id">Csyntax.typeof</span> <span class="id">r</span>)) ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">plus_lt_compat_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">leftcontext_size</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> <span class="id">A</span>. <span class="tactic">subst</span> <span class="id">sl1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;set&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> [<span class="id">b</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]]]. <span class="tactic">subst</span> <span class="id">sl1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">star_one</span>. <span class="id">econstructor</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">S</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;call&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_exprlist</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> <span class="id">EV2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">functions_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tfd</span> [<span class="id">J</span> <span class="id">K</span>]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.  <span class="tactic">apply</span> <span class="id">star_one</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">type_of_fundef_preserved</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_rvalue</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL1</span> [<span class="id">TY1</span> <span class="id">EV1</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_exprlist</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL2</span> <span class="id">EV2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">functions_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tfd</span> [<span class="id">J</span> <span class="id">K</span>]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.  <span class="tactic">apply</span> <span class="id">star_one</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TY1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">type_of_fundef_preserved</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dst</span>'; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H5</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H5</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;builtin&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_leftcontext</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">dst</span>' [<span class="id">sl1</span> [<span class="id">sl2</span> [<span class="id">a</span>' [<span class="id">tmp</span>' [<span class="id">P</span> [<span class="id">Q</span> [<span class="id">R</span> <span class="id">S</span>]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">P</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;for&nbsp;effects&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_exprlist</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> <span class="id">EV</span>].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.  <span class="tactic">apply</span> <span class="id">star_one</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">external_call_symbols_preserved</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">senv_preserved</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;for&nbsp;value&nbsp;*)</span>&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_simple_exprlist</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">SL</span> <span class="id">EV</span>].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="id">Kseqlist</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">star_one</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">external_call_symbols_preserved</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">senv_preserved</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">sl2</span> <span class="kwd">with</span> (<span class="id">nil</span> ++ <span class="id">sl2</span>). <span class="tactic">apply</span> <span class="id">S</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_val_gen</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">PTree.gss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">PTree.gso</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Forward simulation for statements. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id">tr_top_val_for_val_inv</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">v</span> <span class="id">ty</span> <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span>,<br/>
&nbsp;&nbsp;<span class="id">tr_top</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">For_val</span> (<span class="id">Csyntax.Eval</span> <span class="id">v</span> <span class="id">ty</span>) <span class="id">sl</span> <span class="id">a</span> <span class="id">tmps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">sl</span> = <span class="id">nil</span> /\ <span class="id">typeof</span> <span class="id">a</span> = <span class="id">ty</span> /\ <span class="id">eval_expr</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">le</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4365')">Proof.</div>
<div class="proofscript" id="proof4365">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">alloc_variables_preserved</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">m</span> <span class="id">params</span> <span class="id">e</span>' <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id">Csem.alloc_variables</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">params</span> <span class="id">e</span>' <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">alloc_variables</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">params</span> <span class="id">e</span>' <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4366')">Proof.</div>
<div class="proofscript" id="proof4366">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">bind_parameters_preserved</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">m</span> <span class="id">params</span> <span class="id">args</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id">Csem.bind_parameters</span> <span class="id">ge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">params</span> <span class="id">args</span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">bind_parameters</span> <span class="id">tge</span> <span class="id">e</span> <span class="id">m</span> <span class="id">params</span> <span class="id">args</span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4367')">Proof.</div>
<div class="proofscript" id="proof4367">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
- <span class="tactic">eapply</span> <span class="id">assign_loc_value</span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id">assign_loc_value</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id">comp_env_preserved</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id">assign_loc_copy</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">blocks_of_env_preserved</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>, <span class="id">blocks_of_env</span> <span class="id">tge</span> <span class="id">e</span> = <span class="id">Csem.blocks_of_env</span> <span class="id">ge</span> <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4368')">Proof.</div>
<div class="proofscript" id="proof4368">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id">blocks_of_env</span>, <span class="id">Csem.blocks_of_env</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">block_of_binding</span>, <span class="id">Csem.block_of_binding</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">comp_env_preserved</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">sstep_simulation</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span>, <span class="id">Csem.sstep</span> <span class="id">ge</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span>' (<span class="id">MS</span>: <span class="id">match_states</span> <span class="id">S1</span> <span class="id">S1</span>'),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">S2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">plus</span> <span class="id">step1</span> <span class="id">tge</span> <span class="id">S1</span>' <span class="id">t</span> <span class="id">S2</span>' \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">star</span> <span class="id">step1</span> <span class="id">tge</span> <span class="id">S1</span>' <span class="id">t</span> <span class="id">S2</span>' /\ <span class="kwd">measure</span> <span class="id">S2</span> &lt; <span class="kwd">measure</span> <span class="id">S1</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;/\ <span class="id">match_states</span> <span class="id">S2</span> <span class="id">S2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4369')">Proof.</div>
<div class="proofscript" id="proof4369">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">MS</span>.<br/>
&nbsp;do&nbsp;1&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;do&nbsp;2&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id">star_refl</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;skip&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H7</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;continue&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H7</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;break&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>; <span class="id">inv</span> <span class="id">H7</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
<br/>
&nbsp;ifthenelse&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;ifthenelse&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">step_ifthenelse</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">b</span>); <span class="tactic">auto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;while&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>. <span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>.  <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;while&nbsp;false&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">false</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_two</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">step_break_loop1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;while&nbsp;true&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_right</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">true</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;skip-or-continue&nbsp;while&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ts</span> = <span class="id">Sskip</span> \/ <span class="id">ts</span> = <span class="id">Scontinue</span>). <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">s0</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="tactic">apply</span> <span class="id">step_skip_or_continue_loop1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">step_skip_loop2</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;break&nbsp;while&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_break_loop1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
<br/>
&nbsp;dowhile&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_loop</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;skip_or_continue&nbsp;dowhile&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ts</span> = <span class="id">Sskip</span> \/ <span class="id">ts</span> = <span class="id">Scontinue</span>). <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">s0</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="tactic">apply</span> <span class="id">step_skip_or_continue_loop1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;dowhile&nbsp;false&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_right</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">false</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;dowhile&nbsp;true&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_right</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">true</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;break&nbsp;dowhile&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_break_loop1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
<br/>
&nbsp;for&nbsp;start&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;for&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="tactic">apply</span> <span class="id">step_loop</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">push_seq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Kseqlist_app</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;for&nbsp;false&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_trans</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">false</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_two</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">step_break_loop1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;for&nbsp;true&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">star_right</span>. <span class="tactic">apply</span> <span class="id">step_makeif</span> <span class="kwd">with</span> (<span class="id">v1</span> := <span class="id">v</span>) (<span class="id">b</span> := <span class="id">true</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;skip_or_continue&nbsp;for3&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ts</span> = <span class="id">Sskip</span> \/ <span class="id">ts</span> = <span class="id">Scontinue</span>). <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">x</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_skip_or_continue_loop1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;break&nbsp;for3&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_break_loop1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;skip&nbsp;for4&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
<br/>
<br/>
&nbsp;return&nbsp;none&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">blocks_of_env_preserved</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">match_cont_call</span>; <span class="tactic">auto</span>.<br/>
&nbsp;return&nbsp;some&nbsp;1&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;return&nbsp;some&nbsp;2&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H9</span>. <span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="id">constructor</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">function_return_preserved</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">blocks_of_env_preserved</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">match_cont_call</span>; <span class="tactic">auto</span>.<br/>
&nbsp;skip&nbsp;return&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">is_call_cont</span> <span class="id">tk</span>). <span class="id">inv</span> <span class="id">H9</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_skip_call</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">blocks_of_env_preserved</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;switch&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eapply</span> <span class="id">plus_left</span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id">push_seq</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;expr&nbsp;switch&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">exploit</span> <span class="id">tr_top_val_for_val_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eapply</span> <span class="id">plus_two</span>. <span class="id">constructor</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">tr_seq_of_labeled_statement</span>. <span class="tactic">apply</span> <span class="id">tr_select_switch</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;skip-or-break&nbsp;switch&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ts</span> = <span class="id">Sskip</span> \/ <span class="id">ts</span> = <span class="id">Sbreak</span>). <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">x</span>; <span class="id">inv</span> <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_skip_break_switch</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
<br/>
&nbsp;continue&nbsp;switch&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">apply</span> <span class="id">step_continue_switch</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
<br/>
&nbsp;label&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;goto&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H6</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">tr_find_label</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">match_cont_call</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">lbl</span>). <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">ts</span>' [<span class="id">tk</span>' [<span class="id">P</span> [<span class="id">Q</span> <span class="id">R</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;internal&nbsp;function&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>. <span class="tactic">inversion</span> <span class="id">H3</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="tactic">eapply</span> <span class="id">step_internal_function</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>; <span class="tactic">rewrite</span> <span class="id">H7</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>; <span class="tactic">rewrite</span> <span class="id">H7</span>. <span class="tactic">eapply</span> <span class="id">alloc_variables_preserved</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>. <span class="tactic">eapply</span> <span class="id">bind_parameters_preserved</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;external&nbsp;function&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">external_call_symbols_preserved</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">senv_preserved</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;return&nbsp;*)</span>&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id">plus_one</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Semantic preservation </div>
<br/>
<span class="kwd">Theorem</span> <span class="id">simulation</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span>, <span class="id">Cstrategy.step</span> <span class="id">ge</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span>' (<span class="id">MS</span>: <span class="id">match_states</span> <span class="id">S1</span> <span class="id">S1</span>'),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">S2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">plus</span> <span class="id">step1</span> <span class="id">tge</span> <span class="id">S1</span>' <span class="id">t</span> <span class="id">S2</span>' \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">star</span> <span class="id">step1</span> <span class="id">tge</span> <span class="id">S1</span>' <span class="id">t</span> <span class="id">S2</span>' /\ <span class="kwd">measure</span> <span class="id">S2</span> &lt; <span class="kwd">measure</span> <span class="id">S1</span>)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;/\ <span class="id">match_states</span> <span class="id">S2</span> <span class="id">S2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4370')">Proof.</div>
<div class="proofscript" id="proof4370">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span> <span class="id">STEP</span>. <span class="tactic">destruct</span> <span class="id">STEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">estep_simulation</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sstep_simulation</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">transl_initial_states</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span>,<br/>
&nbsp;&nbsp;<span class="id">Csem.initial_state</span> <span class="id">prog</span> <span class="id">S</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">S</span>', <span class="id">Clight.initial_state</span> <span class="id">tprog</span> <span class="id">S</span>' /\ <span class="id">match_states</span> <span class="id">S</span> <span class="id">S</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4371')">Proof.</div>
<div class="proofscript" id="proof4371">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">function_ptr_translated</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tf</span> [<span class="id">FIND</span> <span class="id">TR</span>]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id">Genv.init_mem_match</span> (<span class="id">proj1</span> <span class="id">TRANSL</span>)); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">prog_main</span> <span class="id">tprog</span>) <span class="kwd">with</span> (<span class="id">prog_main</span> <span class="id">prog</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">symbols_preserved</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">TRANSL</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">FIND</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id">type_of_fundef_preserved</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">transl_final_states</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span> <span class="id">S</span>' <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id">match_states</span> <span class="id">S</span> <span class="id">S</span>' -&gt; <span class="id">Csem.final_state</span> <span class="id">S</span> <span class="id">r</span> -&gt; <span class="id">Clight.final_state</span> <span class="id">S</span>' <span class="id">r</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4372')">Proof.</div>
<div class="proofscript" id="proof4372">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">transl_program_correct</span>:<br/>
&nbsp;&nbsp;<span class="id">forward_simulation</span> (<span class="id">Cstrategy.semantics</span> <span class="id">prog</span>) (<span class="id">Clight.semantics1</span> <span class="id">tprog</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4373')">Proof.</div>
<div class="proofscript" id="proof4373">
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">forward_simulation_star_wf</span> <span class="kwd">with</span> (<span class="id">order</span> := <span class="id">ltof</span> <span class="id">_</span> <span class="kwd">measure</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">senv_preserved</span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">transl_initial_states</span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">transl_final_states</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">well_founded_ltof</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">simulation</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">PRESERVATION</span>.<br/>
<br/>
<h2> Commutation with linking </h2>
<br/>
<span class="kwd">Instance</span> <span class="id">TransfSimplExprLink</span> : <span class="id">TransfLink</span> <span class="id">match_prog</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4374')">Proof.</div>
<div class="proofscript" id="proof4374">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">Ctypes.link_match_program</span>; <span class="tactic">eauto</span>. <br/>
- <span class="tactic">intros</span>.<br/>
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id">Linker_fundef</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id">link_fundef</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ef</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="id">exists</span> (<span class="id">Internal</span> <span class="id">tf</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ef</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="id">exists</span> (<span class="id">Internal</span> <span class="id">tf</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">external_function_eq</span> <span class="id">ef</span> <span class="id">ef0</span> &amp;&amp; <span class="id">typelist_eq</span> <span class="id">targs</span> <span class="id">targs0</span> &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">type_eq</span> <span class="id">tres</span> <span class="id">tres0</span> &amp;&amp; <span class="id">calling_convention_eq</span> <span class="id">cconv</span> <span class="id">cconv0</span>); <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">External</span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cconv</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
