<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module LDSimDefs_local</title>
<meta name="description" content="Documentation of Coq module LDSimDefs_local" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module LDSimDefs_local</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Maps.html">Maps</a></span> <span class="id"><a href="Errors.html">Errors</a></span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Blockset.html">Blockset</a></span> <span class="id"><a href="Memory.html">Memory</a></span> <span class="id"><a href="Footprint.html">Footprint</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="IS_local.html">IS_local</a></span> <span class="id"><a href="Injections.html">Injections</a></span> <span class="id"><a href="MemClosures_local.html">MemClosures_local</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="LDSimDefs.html">LDSimDefs</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="LDefs">LDefs</a></span>.<br/>
<div class="doc">For local LDSim, we need to define counter part for:
      - <span class="bracket"><span class="id">HfpG</span></span>, <span class="bracket"><span class="id">LfpG</span></span>: FPMatch
      - <span class="bracket"><span class="id">HG</span></span>, <span class="bracket"><span class="id">LG</span></span>: reach_closed, rc &amp; FPMatch &amp; Inv
      - <span class="bracket"><span class="id">HLRely</span></span>: <span class="bracket"><span class="id">Inv</span></span> &amp; 
   </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="LDefs.Inv">Inv</a></span> <span class="id">mu</span> <span class="id">sm</span> <span class="id">tm</span> : <span class="kwd">Prop</span> := <span class="id"><a href="Memory.html#Mem.inject">Mem.inject</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>)) <span class="id"><a href="LDSimDefs_local.html#sm">sm</a></span> <span class="id"><a href="LDSimDefs_local.html#tm">tm</a></span>.<br/>
<br/>
<div class="doc">LG mu fpSrc sm fpTgt tm </div>
<div class="doc"><span class="bracket"><span class="id">FPMatch</span> <span class="id">mu</span> <span class="id">fpSrc</span> <span class="id">fpTgt</span></span> /\ 
    <span class="bracket"><span class="id">reach_closed</span> <span class="id">tm</span> (<span class="id">SharedTgt</span> <span class="id">mu</span>)</span> /\
    <span class="bracket"><span class="id">Inv</span> <span class="id">mu</span> <span class="id">sm</span> <span class="id">tm</span></span> </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="LDefs.unchg_local">unchg_local</a></span> (<span class="id">B</span>:<span class="id"><a href="Blockset.html#Bset.t">Bset.t</a></span>) (<span class="id">m</span> <span class="id">m</span>' : <span class="id"><a href="Memory.html#mem">mem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="kwd">fun</span> (<span class="id">b</span>: <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">_</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) =&gt; ~ <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> <span class="id"><a href="LDSimDefs_local.html#B">B</a></span> <span class="id"><a href="LDSimDefs_local.html#b">b</a></span>) <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>'.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="LDefs.Rely">Rely</a></span> <span class="id">Shared</span> <span class="id">m</span> <span class="id">m</span>' : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="LDefs.RELY">RELY</a></span>: <span class="kwd">forall</span> (<span class="id">EQNEXT</span>: <span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>' = <span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.unchg_local">unchg_local</a></span> <span class="id">Shared</span> <span class="id">m</span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemClosures_local.html#reach_closed">reach_closed</a></span> <span class="id">m</span>' <span class="id">Shared</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#Rely">Rely</a></span> <span class="id">Shared</span> <span class="id">m</span> <span class="id">m</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="LDefs.Rely_trans">Rely_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">Shared</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.Rely">Rely</a></span> <span class="id"><a href="LDSimDefs_local.html#Shared">Shared</a></span> <span class="id"><a href="LDSimDefs_local.html#m1">m1</a></span> <span class="id"><a href="LDSimDefs_local.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.Rely">Rely</a></span> <span class="id"><a href="LDSimDefs_local.html#Shared">Shared</a></span> <span class="id"><a href="LDSimDefs_local.html#m2">m2</a></span> <span class="id"><a href="LDSimDefs_local.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.Rely">Rely</a></span> <span class="id"><a href="LDSimDefs_local.html#Shared">Shared</a></span> <span class="id"><a href="LDSimDefs_local.html#m1">m1</a></span> <span class="id"><a href="LDSimDefs_local.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6569')">Proof.</div>
<div class="proofscript" id="proof6569">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="LDSimDefs_local.html#LDefs.unchg_local">unchg_local</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="LDefs.HLRely">HLRely</a></span> <span class="id">mu</span> <span class="id">sm</span> <span class="id">sm</span>' <span class="id">tm</span> <span class="id">tm</span>' : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="LDefs.HLR">HLR</a></span>: <span class="id"><a href="LDSimDefs_local.html#LDefs.Rely">Rely</a></span> (<span class="id"><a href="Injections.html#SharedSrc">SharedSrc</a></span> <span class="id">mu</span>) <span class="id">sm</span> <span class="id">sm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.Rely">Rely</a></span> (<span class="id"><a href="Injections.html#SharedTgt">SharedTgt</a></span> <span class="id">mu</span>) <span class="id">tm</span> <span class="id">tm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.Inv">Inv</a></span> <span class="id">mu</span> <span class="id">sm</span>' <span class="id">tm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#HLRely">HLRely</a></span> <span class="id">mu</span> <span class="id">sm</span> <span class="id">sm</span>' <span class="id">tm</span> <span class="id">tm</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="LDefs.HLRely_trans">HLRely_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">sm1</span> <span class="id">sm2</span> <span class="id">sm3</span> <span class="id">tm1</span> <span class="id">tm2</span> <span class="id">tm3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.HLRely">HLRely</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span> <span class="id"><a href="LDSimDefs_local.html#sm1">sm1</a></span> <span class="id"><a href="LDSimDefs_local.html#sm2">sm2</a></span> <span class="id"><a href="LDSimDefs_local.html#tm1">tm1</a></span> <span class="id"><a href="LDSimDefs_local.html#tm2">tm2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.HLRely">HLRely</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span> <span class="id"><a href="LDSimDefs_local.html#sm2">sm2</a></span> <span class="id"><a href="LDSimDefs_local.html#sm3">sm3</a></span> <span class="id"><a href="LDSimDefs_local.html#tm2">tm2</a></span> <span class="id"><a href="LDSimDefs_local.html#tm3">tm3</a></span> -&gt;    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#LDefs.HLRely">HLRely</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span> <span class="id"><a href="LDSimDefs_local.html#sm1">sm1</a></span> <span class="id"><a href="LDSimDefs_local.html#sm3">sm3</a></span> <span class="id"><a href="LDSimDefs_local.html#tm1">tm1</a></span> <span class="id"><a href="LDSimDefs_local.html#tm3">tm3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6570')">Proof.</div>
<div class="proofscript" id="proof6570">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#LDefs.Rely_trans">Rely_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LDSimDefs_local.html#LDefs.Rely_trans">Rely_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="LDSimDefs_local.html#LDefs">LDefs</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bset_eq_Rely_local">bset_eq_Rely_local</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bs</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">bs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#Rely">LDefs.Rely</a></span> <span class="id"><a href="LDSimDefs_local.html#bs">bs</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="LDSimDefs_local.html#bs">bs</a></span> <span class="id"><a href="LDSimDefs_local.html#b">b</a></span> &lt;-&gt; <span class="id">bs</span>' <span class="id"><a href="LDSimDefs_local.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#Rely">LDefs.Rely</a></span> <span class="id">bs</span>' <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6571')">Proof.</div>
<div class="proofscript" id="proof6571">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="MemClosures_local.html#bset_eq_reach_closed_local">bset_eq_reach_closed_local</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<br/>
<div class="doc">LEMMAS about Mem.extends </div>
<span class="kwd">Lemma</span> <span class="id"><a name="inject_implies_extends">inject_implies_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DOMTOTAL</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id"><a href="LDSimDefs_local.html#b">b</a></span> -&gt; <span class="id">exists</span> <span class="id">b</span>' <span class="id">ofs</span>', <span class="id"><a href="LDSimDefs_local.html#j">j</a></span> <span class="id"><a href="LDSimDefs_local.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b</span>', <span class="id">ofs</span>')),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="LDSimDefs_local.html#j">j</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="LDSimDefs_local.html#j">j</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> = <span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6572')">Proof.</div>
<div class="proofscript" id="proof6572">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">DOMTOTAL</span> <span class="id">mi_inj</span> <span class="id">H0</span>; <span class="tactic">clear</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">mi_inj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">DOMTOTAL</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> (? &amp; ? &amp; <span class="id">A</span>). <span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">apply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="id">inv</span> <span class="id">A</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#memval_inject_incr">memval_inject_incr</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_memval</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">DOMTOTAL</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ? &amp; <span class="id">A</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">apply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">A</span>; <span class="id">inv</span> <span class="id">A</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_0_r_reverse">Zplus_0_r_reverse</a></span> <span class="id">ofs</span>) <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">mi_perm_inv</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">DOMTOTAL</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> (? &amp; ? &amp; <span class="id">A</span>). <span class="tactic">rewrite</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">A</span>; <span class="id">inv</span> <span class="id">A</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extends_rely_extends">extends_rely_extends</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">m1</span> <span class="id">m1</span>' <span class="id">m2</span> <span class="id">m2</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="LDSimDefs_local.html#m1">m1</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>)) <span class="id"><a href="Values.html#inject_id">inject_id</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LDSimDefs_local.html#HLRely">LDefs.HLRely</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span> <span class="id"><a href="LDSimDefs_local.html#m1">m1</a></span> <span class="id"><a href="LDSimDefs_local.html#m2">m2</a></span> <span class="id">m1</span>' <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="LDSimDefs_local.html#m2">m2</a></span> <span class="id">m2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6573')">Proof.</div>
<div class="proofscript" id="proof6573">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m2</span> = <span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m2</span>' = <span class="id"><a href="Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">mext_perm_inv</span>; <span class="id">inv</span> <span class="id">mext_inj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.mi_inj">Mem.mi_inj</a></span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b2</span>) <span class="id">eqn</span>:<span class="id">DOM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">DOM</span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">DOM</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm</span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">inv</span> <span class="id">H0</span>;<span class="tactic">eauto</span>]. <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H9</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="tactic">rewrite</span> &lt;-<span class="id">mext_next</span>, &lt;- <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span>) <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b1</span>' <span class="id">ofs</span>']|] <span class="id">eqn</span>:<span class="id">DOM</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Memdata.html#memval_inject_incr">memval_inject_incr</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">mi_memval0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DOM</span>. <span class="tactic">apply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="id">inv</span> <span class="id">DOM</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span> <span class="id">b2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span> <span class="kwd">in</span> <span class="id">H9</span>; [|<span class="id">inv</span> <span class="id">H0</span>;<span class="tactic">eauto</span>]. <span class="tactic">destruct</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H9</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id">mu</span> <span class="id">b1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">DOM</span>; <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_contents">Mem.unchanged_on_contents</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id"><a href="Memory.html#Mem.unchanged_on_contents">Mem.unchanged_on_contents</a></span> <span class="id">_</span> <span class="id">m1</span>' <span class="id">m2</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_memval</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mi_perm</span>. <span class="tactic">reflexivity</span>. <span class="id">erewrite</span>  <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span>  <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span>) <span class="id">b</span>) <span class="kwd">as</span> [[<span class="id">b</span>' <span class="id">ofs</span>']|] <span class="id">eqn</span>:<span class="id">DOM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">eapply</span> <span class="id">mi_perm_inv</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="id">inv</span> <span class="id">DOM</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span> <span class="kwd">in</span> <span class="id">H10</span>; [|<span class="id">inv</span> <span class="id">H0</span>;<span class="tactic">eauto</span>]. <span class="tactic">destruct</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H10</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id">mu</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">DOM</span>; <span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">DOM</span>. <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">erewrite</span> &lt;- (<span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span> <span class="id">_</span> <span class="id">m1</span> <span class="id">m2</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">mext_perm_inv</span>. <span class="id">erewrite</span> <span class="id"><a href="Memory.html#Mem.unchanged_on_perm">Mem.unchanged_on_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extends_reach_closed_implies_inject">extends_reach_closed_implies_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">m</span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) <span class="id"><a href="LDSimDefs_local.html#b">b</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id"><a href="LDSimDefs_local.html#b">b</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VALID</span>': <span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span> (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) <span class="id"><a href="LDSimDefs_local.html#b">b</a></span> -&gt; <span class="id"><a href="Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id"><a href="LDSimDefs_local.html#b">b</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>)) <span class="id"><a href="Values.html#inject_id">inject_id</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemClosures_local.html#reach_closed">reach_closed</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memory.html#Mem.inject">Mem.inject</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>)) <span class="id"><a href="LDSimDefs_local.html#m">m</a></span> <span class="id">m</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6574')">Proof.</div>
<div class="proofscript" id="proof6574">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">mu</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">VALID</span> <span class="id">VALID</span>' <span class="id">BINJ</span> <span class="id">INCR</span> <span class="id">RC</span> <span class="id">EXT</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Memory.html#Mem.mext_inj">Mem.mext_inj</a></span> <span class="kwd">in</span> <span class="id">EXT</span>; <span class="id">inv</span> <span class="id">EXT</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">mi_memval</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">constructor</span>. <span class="id">inv</span> <span class="id">H4</span>; <span class="tactic">try</span> <span class="id">constructor</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b1</span>) <span class="id">eqn</span>:<span class="id">INJ</span>; <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">rewrite</span> <span class="id">INJ</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">RC</span>. <span class="id">exploit</span> (<span class="id">reachable_closure</span> <span class="id">b3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">instantiate</span> (1:= (<span class="id">b1</span>, <span class="id">ofs1</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>). <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Bset.inj_dom</span>'; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">BINJ</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_dom">Bset.inj_dom</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">INCR</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">INJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">Bset.inj_dom</span>' <span class="kwd">in</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">BINJ</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">INJ</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">VALID</span>'. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id">mu</span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">INJ</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Bset.inj_range</span>'; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">BINJ</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="Memory.html#Mem.meminj_no_overlap">Mem.meminj_no_overlap</a></span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Integers.Ptrofs.unsigned_range</a></span> <span class="id">ofs</span>). <span class="tactic">unfold</span> <span class="id"><a href="Integers.html#Ptrofs.max_unsigned">Integers.Ptrofs.max_unsigned</a></span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">EXT</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">INCR</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">eauto</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locs_match_id">locs_match_id</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>)) <span class="id"><a href="Values.html#inject_id">inject_id</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Injections.html#LocMatch">Injections.LocMatch</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span> <span class="id"><a href="LDSimDefs_local.html#ls">ls</a></span> <span class="id"><a href="LDSimDefs_local.html#ls">ls</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6575')">Proof.</div>
<div class="proofscript" id="proof6575">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_range">Bset.inj_range</a></span> <span class="kwd">in</span> <span class="id">H1</span>; [|<span class="id">inv</span> <span class="id">H</span>;<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>. <span class="id">exploit</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fp_match_id">fp_match_id</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mu</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html#Bset.inject">Bset.inject</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) (<span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> (<span class="id"><a href="Blockset.html#Bset.inj_to_meminj">Bset.inj_to_meminj</a></span> (<span class="id"><a href="Injections.html#inj">Injections.inj</a></span> <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span>)) <span class="id"><a href="Values.html#inject_id">inject_id</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Injections.FPMatch</span>' <span class="id"><a href="LDSimDefs_local.html#mu">mu</a></span> <span class="id"><a href="LDSimDefs_local.html#fp">fp</a></span> <span class="id"><a href="LDSimDefs_local.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6576')">Proof.</div>
<div class="proofscript" id="proof6576">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">fp</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_cmps">FP.ge_cmps</a></span>, <span class="id"><a href="Footprint.html#FP.ge_reads">FP.ge_reads</a></span>, <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="Injections.html#locs_match_union_S">Injections.locs_match_union_S</a></span>; <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="LDSimDefs_local.html#locs_match_id">locs_match_id</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
