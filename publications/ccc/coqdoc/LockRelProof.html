<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module LockRelProof</title>
<meta name="description" content="Documentation of Coq module LockRelProof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module LockRelProof</h1>
<div class="coq">
<div class="doc">We prove that the implementation of function unlock and its corresponding 
specification satisfy the object simulation in this file. </div>
<span class="id">From</span> <span class="id">mathcomp.ssreflect</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">fintype</span> <span class="id">ssrnat</span>.                <br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Maps.html">Maps</a></span> <span class="id"><a href="Axioms.html">Axioms</a></span>.  <br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span> <span class="id"><a href="Integers.html">Integers</a></span> <span class="id"><a href="Floats.html">Floats</a></span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Events.html">Events</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Locations.html">Locations</a></span> <span class="id"><a href="Stacklayout.html">Stacklayout</a></span> <span class="id"><a href="Conventions.html">Conventions</a></span>.<br/>
&nbsp;<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Asm.html">Asm</a></span>. <br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CUAST.html">CUAST</a></span> <span class="id"><a href="FMemOpFP.html">FMemOpFP</a></span> <span class="id"><a href="ValFP.html">ValFP</a></span> <span class="id"><a href="Op_fp.html">Op_fp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span> <span class="id"><a href="val_casted.html">val_casted</a></span> <span class="id"><a href="helpers.html">helpers</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="GMemory.html">GMemory</a></span> <span class="id"><a href="FMemory.html">FMemory</a></span> <span class="id"><a href="TSOMem.html">TSOMem</a></span> <span class="id"><a href="MemAux.html">MemAux</a></span>. <br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="GAST.html">GAST</a></span> <span class="id"><a href="GlobDefs.html">GlobDefs</a></span> <span class="id"><a href="ETrace.html">ETrace</a></span> <span class="id"><a href="Blockset.html">Blockset</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="loadframe.html">loadframe</a></span>. <br/>
&nbsp;<br/>
<span class="kwd">Require</span> <span class="id"><a href="CminorLang.html">CminorLang</a></span>. <br/>
<span class="kwd">Require</span> <span class="id"><a href="SpecLang.html">SpecLang</a></span>. <br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="ASM_local.html">ASM_local</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AsmLang.html">AsmLang</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AsmTSO.html">AsmTSO</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Coq.Lists.Streams</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="RGRels.html">RGRels</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="LibTactics.html">LibTactics</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="code.html">code</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="ObjectSim.html">ObjectSim</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="TSOGlobSem.html">TSOGlobSem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="InvRG.html">InvRG</a></span>. <br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AuxTacLemmas.html">AuxTacLemmas</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="TSOMemLemmas.html">TSOMemLemmas</a></span> <span class="id"><a href="MemLemmas.html">MemLemmas</a></span> <span class="id"><a href="FMemLemmas.html">FMemLemmas</a></span>.  <br/>
<br/>
<h1> Lemmas about lock release </h1>
<span class="kwd">Lemma</span> <span class="id"><a name="tso_lock_release_init_state">tso_lock_release_init_state</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tge</span> <span class="id">tc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hinit_core</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> = <span class="id"><a href="AsmTSO.html#init_core">init_core</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fb</span>, <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fb</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> = <span class="id"><a href="ASM_local.html#fundef_init">fundef_init</a></span> <span class="id">fb</span> (<span class="id"><a href="ASM_local.html#fn_sig">fn_sig</a></span> <span class="id"><a href="code.html#lock_release_tso_fnbody">lock_release_tso_fnbody</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9946')">Proof.</div>
<div class="proofscript" id="proof9946">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Himp_init</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">init_core</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">ASM_local.init_core</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id">tge</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>) <span class="id">eqn</span>:<span class="id">Hfind_symb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hinit_core</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Genv.find_funct_ptr</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Genv.find_def</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H10</span> <span class="kwd">in</span> <span class="id">Hinit_core</span>.<br/>
&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="spec_lock_release_init_state">spec_lock_release_init_state</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">sc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsc_init</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#sc">sc</a></span> = <span class="id"><a href="SpecLang.html#init_core">SpecLang.init_core</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">fb</span>, <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">fb</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#sc">sc</a></span> = <span class="id"><a href="SpecLang.html#fundef_init">SpecLang.fundef_init</a></span> (<span class="id"><a href="AST.html#Internal">Internal</a></span> <span class="id"><a href="code.html#lock_release_fnbody">lock_release_fnbody</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9947')">Proof.</div>
<div class="proofscript" id="proof9947">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H0</span> <span class="id">H</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SpecLang.html#init_core">SpecLang.init_core</a></span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#generic_init_core">generic_init_core</a></span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SpecLang.html#F">SpecLang.F</a></span>, <span class="id"><a href="SpecLang.html#V">SpecLang.V</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H10</span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SpecLang.html#F">SpecLang.F</a></span>, <span class="id"><a href="SpecLang.html#V">SpecLang.V</a></span>  <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H11</span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lock_release_core_init_match">lock_release_core_init_match</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tge</span> <span class="id">tc</span> <span class="id">sge</span> <span class="id">sG</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htso_init_genv</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init_genv</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hinit_core</span> : <span class="id"><a href="AsmTSO.html#init_core">init_core</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span>),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">sc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#init_core">InteractionSemantics.init_core</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sc</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9948')">Proof.</div>
<div class="proofscript" id="proof9948">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_init_genv</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="SpecLang.html#init_core">SpecLang.init_core</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#generic_init_core">generic_init_core</a></span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">SpecLang.F</span>, <span class="id">SpecLang.V</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H11</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lock_release_core_init_match</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tge</span> <span class="id">sc</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">args</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htso_init_genv</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init_genv</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init_core</span> : <span class="id"><a href="InteractionSemantics.html#init_core">InteractionSemantics.init_core</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="LockRelProof.html#args">args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#sc">sc</a></span>),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#init_core">init_core</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="LockRelProof.html#args">args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tc</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9949')">Proof.</div>
<div class="proofscript" id="proof9949">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htso_init_genv</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#init_core">init_core</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#init_core">ASM_local.init_core</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#fundef_init">fundef_init</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">H6</span>. <br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_init_genv</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H3</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H13</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">H5</span> <span class="id">H6</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hspec_init_core</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">SpecLang.init_core</span>.<br/>
&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">generic_init_core</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hspec_init_core</span> <span class="id">H12</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">SpecLang.F</span>, <span class="id">SpecLang.V</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H12</span> <span class="kwd">in</span> <span class="id">Hspec_init_core</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Genv.find_funct_ptr</span>, <span class="id">Genv.find_def</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hspec_init_core</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H13</span> <span class="kwd">in</span> <span class="id">Hspec_init_core</span>.<br/>
&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">args</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_no_extcall</span></span> holds in function unlock </div>
<span class="kwd">Lemma</span> <span class="id"><a name="lock_release_no_external">lock_release_no_external</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tm</span> <span class="id">sge</span> <span class="id">tge</span> <span class="id">sG</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlock_rel_match_state</span> : <span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id"><a href="LockRelProof.html#sm">sm</a></span>) (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id"><a href="LockRelProof.html#tm">tm</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#at_external">at_external</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9950')">Proof.</div>
<div class="proofscript" id="proof9950">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hlock_rel_match_state</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;init&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LockRelProof.html#tso_lock_release_init_state">tso_lock_release_init_state</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">fb</span> [<span class="id">Hfb</span> <span class="id">Hinit_state</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">fundef_init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hinit_state</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_halt</span></span> holds in function unlock </div>
<span class="kwd">Lemma</span> <span class="id"><a name="unlock_ret_val_eq">unlock_ret_val_eq</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">tge</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tm</span> <span class="id">rv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhalt</span> : <span class="id"><a href="AsmTSO.html#halt">halt</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#rv">rv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hunlock_match_state</span> : <span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id"><a href="LockRelProof.html#sm">sm</a></span>) (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id"><a href="LockRelProof.html#tm">tm</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SpecLang.html#halt">SpecLang.halt</a></span> <span class="id"><a href="LockRelProof.html#sc">sc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#rv">rv</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9951')">Proof.</div>
<div class="proofscript" id="proof9951">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hunlock_match_state</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hhalt</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : ?<span class="id">rs</span> <span class="id">_</span> = <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hhalt</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hhalt</span>; <span class="id">tryfalse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LockRelProof.html#tso_lock_release_init_state">tso_lock_release_init_state</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">fb</span> [<span class="id">Hfind_symb</span> <span class="id">Hfunc_init</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">fundef_init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hfunc_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hhalt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">Hhalt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Conventions1.html#loc_result">loc_result</a></span> <span class="kwd">in</span> <span class="id">Hhalt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?;<span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hhalt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H7</span> <span class="kwd">in</span> <span class="id">Hhalt</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<div class="doc">The initial step of function unlock satisfies <span class="bracket"><span class="id">Go</span></span> </div>
<span class="kwd">Lemma</span> <span class="id"><a name="unlock_init_step_satify_Gobj">unlock_init_step_satify_Gobj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tc</span>' <span class="id">tm</span> <span class="id">tm</span>' <span class="id">b</span>' <span class="id">gm</span>' <span class="id">fp</span> <span class="id">fl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hge_equiv</span> : <span class="id"><a href="TSOGlobSem.html#genv_match">genv_match</a></span> (<span class="id"><a href="InteractionSemantics.html#F">InteractionSemantics.F</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#V">InteractionSemantics.V</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span>) <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hno_conflict</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>' <span class="id">blk</span> <span class="id">n</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span>' &lt;&gt; <span class="id"><a href="LockRelProof.html#t">t</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> <span class="id"><a href="LockRelProof.html#blk">blk</a></span> <span class="id"><a href="LockRelProof.html#lo">lo</a></span> <span class="id"><a href="LockRelProof.html#hi">hi</a></span>) (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id">t</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LockRelProof.html#blk">blk</a></span> &lt;&gt; <span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#n">n</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hrel_tm_gm_vb</span> : <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htsostep</span> : <span class="id"><a href="AsmTSO.html#tsostep">tsostep</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span>, <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span>) <span class="id"><a href="LockRelProof.html#fp">fp</a></span> <span class="id">tc</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span>', <span class="id">gm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htm</span> : <span class="id">tm</span>' = (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> (<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> <span class="id">b</span>' (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span>)) <span class="id">gm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htc_init</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> = <span class="id"><a href="AsmTSO.html#init_core">init_core</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsc_init</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="LockRelProof.html#sc">sc</a></span> = <span class="id"><a href="SpecLang.html#init_core">SpecLang.init_core</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hobj_inv</span> : <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">FP</span> <span class="id">sc</span>' <span class="id">sm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">InteractionSemantics.star</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LockRelProof.html#sc">sc</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id">FP</span> <span class="id">sc</span>' <span class="id">sm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id">sm</span>' <span class="id">tm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InvRG.html#obj_match_state">obj_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id">sc</span>', <span class="id">sm</span>') (<span class="id">tc</span>', <span class="id">tm</span>') /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> <span class="id">tm</span>' <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> /\ <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="id">sm</span>' <span class="id">tm</span>' <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#obj_fp">obj_fp</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id">sm</span>' <span class="id"><a href="LockRelProof.html#fp">fp</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">FP</span>' <span class="id">sc</span>'' <span class="id">sm</span>'', ~ <span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sc</span>' <span class="id">sm</span>' <span class="id">FP</span>' <span class="id">sc</span>'' <span class="id">sm</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#at_external">InteractionSemantics.at_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id">sc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ores</span>, <span class="id"><a href="InteractionSemantics.html#after_external">InteractionSemantics.after_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc</span>' <span class="id"><a href="LockRelProof.html#ores">ores</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#halt">InteractionSemantics.halt</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9952')">Proof.</div>
<div class="proofscript" id="proof9952">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LockRelProof.html#tso_lock_release_init_state">tso_lock_release_init_state</a></span> <span class="kwd">in</span> <span class="id">Htc_init</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htc_init</span> <span class="kwd">as</span> [<span class="id">fb</span> [<span class="id">Hfind_symb</span> <span class="id">Hf_init</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#fundef_init">fundef_init</a></span> <span class="kwd">in</span> <span class="id">Hf_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hf_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hf_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LockRelProof.html#spec_lock_release_init_state">spec_lock_release_init_state</a></span> <span class="kwd">in</span> <span class="id">Hsc_init</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsc_init</span> <span class="kwd">as</span> [<span class="id">fb</span>' [<span class="id">Hfind_symb</span>' <span class="id">Hsc_init</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hsc_init</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hsc_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hsc_init</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Htsostep</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> [<span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span>] |- <span class="id">_</span> =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H1</span> : <span class="id">context</span> [<span class="id"><a href="loadframe.html#args_len_rec">args_len_rec</a></span>],<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span> : <span class="id">context</span> [<span class="id"><a href="TSOMem.html#tsoalloc">tsoalloc</a></span>], <span class="id">H3</span> : <span class="id">context</span> [<span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H1</span> <span class="id">to</span> <span class="id">Hargs_len</span>, <span class="id">H2</span> <span class="id">to</span> <span class="id">Htsoalloc</span>, <span class="id">H3</span> <span class="id">to</span> <span class="id">Hstore_args</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hargs_len</span>, <span class="id">Htsoalloc</span>, <span class="id">Hstore_args</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hargs_len</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Htsoalloc</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_args_fmem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstore_args</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstore_args</span>; <span class="tactic">subst</span> <span class="id">tsofm</span>'.<br/>
&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H1</span> : <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">_</span> = <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H1</span> <span class="id">to</span> <span class="id">Hm_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsoalloc</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hembed_same_block</span> : <span class="id"><a href="TSOMemLemmas.html#rel_tm_gm_vb_impl_alloc_same_block">rel_tm_gm_vb_impl_alloc_same_block</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hm_eq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hembed_same_block</span> <span class="kwd">as</span> [<span class="id">fsm</span> [<span class="id">Hspec_embed_ex</span> <span class="id">Hnextblock_eq</span>]].<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hmem_alloc</span> : <span class="id"><a href="TSOMemLemmas.html#embed_alloc_succ">embed_alloc_succ</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmem_alloc</span> <span class="kwd">as</span> [<span class="id">fsm</span>' <span class="id">Hmem_alloc</span>].<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">_</span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">renames</span> <span class="id">H</span> <span class="id">to</span> <span class="id">Hmem_freels</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hmem_freels</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmem_freels</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">fsm</span>'); <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hobj_inv</span>' : <span class="id"><a href="MemLemmas.html#obj_inv_alloc_stable">obj_inv_alloc_stable</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hobj_inv</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HGalloc</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InvRG.html#G_alloc">G_alloc</a></span> <span class="id">tge</span> <span class="id">t</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fsm</span>) <span class="id">tm</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fsm</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span> <span class="id">t</span> ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>') 0 0 :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm</span> |}).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#G_alloc">G_alloc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fsm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#Mem_alloc_gm_alloc">Mem_alloc_gm_alloc</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span> <span class="kwd">in</span> <span class="id">Htsoalloc</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Htsoalloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Ht</span> : <span class="id"><a href="TSOMemLemmas.html#tsoalloc_append">tsoalloc_append</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">Hnextblock_eq</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#mem_strip_gm_vb_eq">mem_strip_gm_vb_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#next_block_not_in_validblock">next_block_not_in_validblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="TSOMemLemmas.html#next_block_not_in_validblock">next_block_not_in_validblock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">fm</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>') (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> <span class="id">gm</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H8</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#mem_strip_gm_vb_eq">mem_strip_gm_vb_eq</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hnot_in_vb</span> : <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#not_in_apply_bf_vb_not_in_orign">not_in_apply_bf_vb_not_in_orign</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hunbuffer_safe</span> : <span class="id">Hobj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemLemmas.html#obj_inv_impl_unbuffer_safe">obj_inv_impl_unbuffer_safe</a></span> <span class="kwd">in</span> <span class="id">Hunbuffer_safe</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm_eq</span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">t</span> <span class="id">lo</span> <span class="id">hi</span>, ~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>') <span class="id"><a href="LockRelProof.html#lo">lo</a></span> <span class="id"><a href="LockRelProof.html#hi">hi</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span> <span class="id"><a href="LockRelProof.html#t">t</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hunbuffer_safe</span> <span class="id">Hno_conflict</span> <span class="id">H0</span> <span class="id">H5</span> <span class="id">H8</span> <span class="id">Hm_eq</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">t</span> <span class="id">t0</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_not_in_vb_not_alloc_in_bf">apply_buffer_not_in_vb_not_alloc_in_bf</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hno_conflict</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hrel_tm_gm_vb</span> <span class="id">Hnextblock_eq</span> <span class="id">Hmem_freels</span> <span class="id">Hunbuffer_safe</span> <span class="id">H1</span> <span class="id">H0</span> <span class="id">H5</span> <span class="id">Hm_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">t</span> <span class="id">t</span>') <span class="id">eqn</span>:?; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hin</span>; <span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ofs</span> <span class="id">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm_eq</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_block_not_alloc_and_invb_not_in_buffer">unbuffer_safe_block_not_alloc_and_invb_not_in_buffer</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hnextblock_eq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hnextblock_eq</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [<span class="id">ofs</span> <span class="id">Hin</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_block_not_alloc_and_invb_not_in_buffer">unbuffer_safe_block_not_alloc_and_invb_not_in_buffer</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hnextblock_eq</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;G&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">right</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_label_match">unlock_label_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">rs0</span>.<br/>
&nbsp;&nbsp;<span class="id">Pregmap_elim</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Himp_init</span> <span class="id">Hfind_symb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Himp_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id"><a href="code.html#lock_release_ident">lock_release_ident</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H9</span> <span class="id">H10</span> <span class="id">Hfind_symb</span>.<br/>
&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H9</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H10</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hno_conflict</span> <span class="id">H5</span> <span class="id">H8</span> <span class="id">Hmem_alloc</span> <span class="id">Hm_eq</span> <span class="id">HGalloc</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tm_alloc_not_fl</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_not_eq_get">tupdate_not_eq_get</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hrel_tm_gm_vb</span> <span class="id">Hm_eq</span> <span class="id">Hmem_alloc</span> <span class="id">Hnextblock_eq</span> <span class="id">HGalloc</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">rel_tm_gm_vb</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_b_get">tupdate_b_get</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">gm</span>' [<span class="id">Happly_buf1</span> <span class="id">Happly_buf2</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm_eq</span> <span class="kwd">in</span> <span class="id">Happly_buf1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hrel_tm_gm_vb</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_validblocks">Mem.alloc_validblocks</a></span> <span class="kwd">in</span> <span class="id">Hmem_alloc</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hmem_alloc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Happly_buf2</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Happly_buf2</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RGRels.html#obj_alloc_fp">obj_alloc_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsoalloc_fp</span>, <span class="id">uncheck_alloc_fp</span>, <span class="id">store_args_fp</span>, <span class="id">FP.locs</span>, <span class="id">FP.union</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">G_alloc</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HGalloc</span> <span class="kwd">as</span> (<span class="id">b</span>' &amp; <span class="id">HGalloc</span>).<br/>
&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">HGalloc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">b</span>' = <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fsm</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H1</span> <span class="id">Hmem_alloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Transparent</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Mem.alloc</span>, <span class="id">alloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">Hmem_alloc</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Locs.belongsto</span>, <span class="id">Locs.union</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="id">ex_match2</span>; <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">Hnextblock_eq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hmem_alloc</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Mem.alloc</span>; <span class="id">inv</span> <span class="id">Hmem_alloc</span>; <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H4</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">alloc</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">fsm</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">unused_mem</span>, <span class="id">Mem.nextblock</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> 0 <span class="id">ofs</span>') <span class="id">eqn</span>:?; <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span>' 0) <span class="id">eqn</span>:?; <span class="id">tryfalse</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_tau</span></span> holds in function unlock </div>
<span class="kwd">Lemma</span> <span class="id"><a name="unlock_step_satisfy_Gobj">unlock_step_satisfy_Gobj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tc</span>' <span class="id">tm</span> <span class="id">tm</span>' <span class="id">b</span>' <span class="id">gm</span>' <span class="id">fp</span> <span class="id">fl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hge_equiv</span> : <span class="id"><a href="TSOGlobSem.html#genv_match">genv_match</a></span> (<span class="id"><a href="InteractionSemantics.html#F">InteractionSemantics.F</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#V">InteractionSemantics.V</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span>) <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htsostep</span> : <span class="id"><a href="AsmTSO.html#tsostep">tsostep</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span>, <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span>) <span class="id"><a href="LockRelProof.html#fp">fp</a></span> <span class="id">tc</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span>', <span class="id">gm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hno_conflict</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>' <span class="id">blk</span> <span class="id">n</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span>' &lt;&gt; <span class="id"><a href="LockRelProof.html#t">t</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> <span class="id"><a href="LockRelProof.html#blk">blk</a></span> <span class="id"><a href="LockRelProof.html#lo">lo</a></span> <span class="id"><a href="LockRelProof.html#hi">hi</a></span>) (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id">t</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LockRelProof.html#blk">blk</a></span> &lt;&gt; <span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#n">n</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hrel_tm_gm_vb</span> : <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlock_rel_match_state</span> : <span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id"><a href="LockRelProof.html#sm">sm</a></span>) (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id"><a href="LockRelProof.html#tm">tm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htm</span> : <span class="id">tm</span>' = (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> (<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> <span class="id">b</span>' (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span>)) <span class="id">gm</span>')),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">FP</span> <span class="id">sc</span>' <span class="id">sm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">InteractionSemantics.star</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span>) <span class="id"><a href="LockRelProof.html#sc">sc</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id">FP</span> <span class="id">sc</span>' <span class="id">sm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InvRG.html#Gobj">Gobj</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id">sm</span>' <span class="id">tm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InvRG.html#obj_match_state">obj_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id">sc</span>', <span class="id">sm</span>') (<span class="id">tc</span>', <span class="id">tm</span>') /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> <span class="id">tm</span>' <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> /\ <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="id">sm</span>' <span class="id">tm</span>' <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#obj_fp">obj_fp</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id">sm</span>' <span class="id"><a href="LockRelProof.html#fp">fp</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">FP</span>' <span class="id">sc</span>'' <span class="id">sm</span>'', ~ <span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sc</span>' <span class="id">sm</span>' <span class="id">FP</span>' <span class="id">sc</span>'' <span class="id">sm</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#at_external">InteractionSemantics.at_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id">sc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ores</span>, <span class="id"><a href="InteractionSemantics.html#after_external">InteractionSemantics.after_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc</span>' <span class="id"><a href="LockRelProof.html#ores">ores</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#halt">InteractionSemantics.halt</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">FP1</span> <span class="id">sc_ent</span> <span class="id">sm1</span> <span class="id">sc_ent</span>' <span class="id">FP2</span> <span class="id">sc_ext</span> <span class="id">sm</span>' <span class="id">sc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">InteractionSemantics.star</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span>) <span class="id"><a href="LockRelProof.html#sc">sc</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id">FP1</span> <span class="id">sc_ent</span> <span class="id">sm1</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#at_external">InteractionSemantics.at_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id">sc_ent</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="GAST.html#ent_atom">ent_atom</a></span>, <span class="id"><a href="GAST.html#ent_atom_sg">ent_atom_sg</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#after_external">InteractionSemantics.after_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc_ent</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sc_ent</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#star">InteractionSemantics.star</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sc_ent</span>' <span class="id">sm1</span> <span class="id">FP2</span> <span class="id">sc_ext</span> <span class="id">sm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#at_external">InteractionSemantics.at_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id">sc_ext</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="GAST.html#ext_atom">ext_atom</a></span>, <span class="id"><a href="GAST.html#ext_atom_sg">ext_atom_sg</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#after_external">InteractionSemantics.after_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc_ext</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sc</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InvRG.html#Gobj">Gobj</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id">sm</span>' <span class="id">tm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InvRG.html#obj_match_state">obj_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id">sc</span>', <span class="id">sm</span>') (<span class="id">tc</span>', <span class="id">tm</span>') /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> <span class="id">tm</span>' <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> /\ <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="id">sm</span>' <span class="id">tm</span>' <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#obj_fp">obj_fp</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id">sm</span>' <span class="id"><a href="LockRelProof.html#fp">fp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">FP</span>' <span class="id">sc</span>' <span class="id">sm</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="InteractionSemantics.html#step">InteractionSemantics.step</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id">sc_ext</span> <span class="id">sm</span>' <span class="id">FP</span>' <span class="id">sc</span>' <span class="id">sm</span>'')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#at_external">InteractionSemantics.at_external</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span> <span class="id">sc_ext</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ores</span>, <span class="id"><a href="InteractionSemantics.html#after_external">InteractionSemantics.after_external</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc_ext</span> <span class="id"><a href="LockRelProof.html#ores">ores</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#halt">InteractionSemantics.halt</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id">sc_ext</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9953')">Proof.</div>
<div class="proofscript" id="proof9953">
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">interaction_sem_exec</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">try</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span> | <span class="id">idtac</span>].<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">solve_mem_strip</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_same_eq">tupdate_same_eq</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> ?<span class="id">tm</span>) <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">_</span> = <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>. <br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hlock_rel_match_state</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">init step match  </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="LockRelProof.html#unlock_init_step_satify_Gobj">unlock_init_step_satify_Gobj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock release : unlock label </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
<br/>
&nbsp;G&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Id">Id</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;match_state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#get_lock_addr_match">get_lock_addr_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim_next_intr</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">solve_mem_strip</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call_elim</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock release : mov $L R8 </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;G&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Id">Id</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">H_lock_addr</span> : <span class="id"><a href="MemLemmas.html#get_lock_ident_from_ge">get_lock_ident_from_ge</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H_lock_addr</span> <span class="kwd">as</span> [<span class="id">L</span> <span class="id">H_lock_addr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#mov_one_match">mov_one_match</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim_next_intr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Asm.html#nextinstr_nf">nextinstr_nf</a></span>, <span class="id"><a href="Asm.html#nextinstr">nextinstr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pregmap_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H_lock_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_lock_addr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">solve_mem_strip</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call_elim</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock release : mov 1 R9 </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;G&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Id">Id</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_step_match">unlock_step_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim_next_intr</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_m_unchange_objinv1</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">solve_mem_strip</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call_elim</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock release : mov R9 <span class="bracket"><span class="id">R8</span></span> </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">external_call_elim</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H1</span> : <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span> : <span class="id"><a href="AsmTSO.html#exec_instr_TSO">exec_instr_TSO</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H3</span> : <span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">IR</a></span> <span class="id"><a href="Asm.html#RCX">RCX</a></span>) = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H1</span> <span class="id">to</span> <span class="id">Hembed</span>, <span class="id">H2</span> <span class="id">to</span> <span class="id">Hexec_instr_tso</span>, <span class="id">H3</span> <span class="id">to</span> <span class="id">HR8</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">lets Hunbuffer_safe : lock_rel_unbuffer_safe ___; eauto.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hspec_embed</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id">exists</span> <span class="id">fsm</span>, <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">sm</span> <span class="id">fl</span> <span class="id">fsm</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hspec_embed</span> <span class="kwd">as</span> [<span class="id">Hspec_embed_ex</span> | <span class="id">Hspec_embed_nex</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hspec_embed_ex</span> <span class="kwd">as</span> [<span class="id">fsm</span> <span class="id">Hspec_embed_ex</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">exec_instr_TSO</span>, <span class="id">exec_store_TSO</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">eval_addrmode</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hexec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR8</span> <span class="kwd">in</span> <span class="id">Hexec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hexec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqb</span> <span class="kwd">in</span> <span class="id">Hexec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span> : <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.add">Int.add</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht</span> <span class="kwd">in</span> <span class="id">Hexec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">Hobj_inv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">Hobj_inv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hobj_inv</span>' : <span class="id">Hobj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="kwd">in</span> <span class="id">Hobj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobj_inv</span> <span class="kwd">as</span> [<span class="id">L</span>' [<span class="id">Hfind_symb</span>' [<span class="id">Hst</span> [<span class="id">Hstore</span> <span class="id">Hstore_tsom</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> [<span class="id">Hst</span> | <span class="id">Hst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">lock_st</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> [<span class="id">Hload_specm</span> [<span class="id">Hnot_in</span> <span class="id">Hload_tsomem</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sG</span> = <span class="id">sge</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_init</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">H_L_addr</span> : <span class="id"><a href="MemLemmas.html#ogenv_match_L_addr_eq">ogenv_match_L_addr_eq</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H_L_addr</span> <span class="kwd">as</span> [<span class="id">L</span>'' [<span class="id">H_L_tsoaddr</span> <span class="id">H_L_spec</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">_</span> = <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id">_</span> <span class="id"><a href="code.html#lock_L_ident">lock_L_ident</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_L_tsoaddr</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span> <span class="id">L</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">H_L_tsoaddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H_L_tsoaddr</span>; <span class="tactic">subst</span> <span class="id">L</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hstore</span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore</span> <span class="kwd">as</span> [<span class="id">M</span>' <span class="id">Hstore</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hstore_spec_m</span> : <span class="id"><a href="TSOMemLemmas.html#store_gm_store_spec_m">store_gm_store_spec_m</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_spec_m</span> <span class="kwd">as</span> [<span class="id">fsm</span>' [<span class="id">Hstore_spec_m</span> <span class="id">Hembed1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 8 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#unlock_spec_fn">unlock_spec_fn</a></span>.<br/>
&nbsp;<br/>
&nbsp;spec&nbsp;program&nbsp;execute&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec_p_exec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SpecLang.html#EntAtomstep">SpecLang.EntAtomstep</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;At&nbsp;EntAtom&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;After&nbsp;EntAtom&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.  <br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
<br/>
&nbsp;load&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#load_gm_load_spec_m">load_gm_load_spec_m</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := (<span class="kwd">fun</span> <span class="id">r</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">r</span>' <span class="id"><a href="code.html#r">r</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> <span class="kwd">else</span> <span class="id">te</span> <span class="id">r</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
<br/>
&nbsp;assgin&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := (<span class="kwd">fun</span> <span class="id">r</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">r</span>' <span class="id"><a href="code.html#x">x</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">r</span>' <span class="id"><a href="code.html#r">r</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> <span class="kwd">else</span> <span class="id">te</span> <span class="id">r</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
<br/>
&nbsp;assert&nbsp;(r&nbsp;==&nbsp;0)&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
<br/>
&nbsp;store&nbsp;x&nbsp;L&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">interaction_sem_exec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id"><a href="code.html#x">x</a></span> <span class="id"><a href="code.html#x">x</a></span>) <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed1</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SpecLang.html#ExtAtomstep">SpecLang.ExtAtomstep</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;At&nbsp;ExtAtom&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;After&nbsp;ExtAtom&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">IR</a></span> <span class="id"><a href="Asm.html#RDX">RDX</a></span>) = <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">HR9</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR9</span> <span class="kwd">in</span> <span class="id">Hexec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOMem.html#tsostorev">tsostorev</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span> <span class="id">t</span>; <span class="id">fmemory</span> := <span class="id">fm</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">L</span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)) (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>)) <span class="id">eqn</span>:<span class="id">Hstore_tso</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hexec_instr_tso</span>; <span class="tactic">subst</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hobj_inv</span>'' : <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="id">tge</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fsm</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tsofm</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tsofm</span>') |}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#unlock_st">unlock_st</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#store_v_load_eq_spec_m">store_v_load_eq_spec_m</a></span> <span class="kwd">in</span> <span class="id">Hstore_spec_m</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#load_spec_m_load_gm">load_spec_m_load_gm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">t</span>, (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span> <span class="id">t</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.          <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hstore_tso</span> <span class="id">Hnot_in</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostorev</span>, <span class="id">tsostore</span>, <span class="id">buffer_insert</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hstore_tso</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_b_get">tupdate_b_get</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hnot_in</span> <span class="id">Hstore_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Htid_neq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostorev</span>, <span class="id">tsostore</span>, <span class="id">buffer_insert</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hstore_tso</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_not_eq_get">tupdate_not_eq_get</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hnot_in</span> <span class="id">t</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H_in_buffer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">Hnot_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hnot_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">H_in_buffer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hnot_in</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">Hnot_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">load_tsomem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span> <span class="id">TSOMem.tso_buffers</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#tso_store_not_imm">tso_store_not_imm</a></span> ; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hload_tsomem</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hstore</span> <span class="id">Hembed1</span> <span class="id">Hstore_tsom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed1</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#gm_store_succ_store_again">gm_store_succ_store_again</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hstore_tso</span> <span class="id">Hembed1</span> <span class="id">Hstore_tsom</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tsom</span> <span class="kwd">as</span> [<span class="id">Hstore_tsom</span> [<span class="id">Hunbuffer</span> <span class="id">Hobj_mem</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hstore_tsom</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tsom</span> <span class="kwd">as</span> [<span class="id">tm</span>' <span class="id">Hstore_tsom</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostorev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstore_tso</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm</span>) <span class="id">L</span> 0 (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>)) <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tsom</span> <span class="kwd">as</span> [<span class="id">Hstore_tsom</span> <span class="id">Hother</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hstore_tsom</span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_storev_still">unbuffer_safe_storev_still</a></span> <span class="kwd">with</span> (<span class="id">v</span>' := <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hstore_tsom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tsom</span> <span class="kwd">as</span> [<span class="id">bm</span>' <span class="id">Hstore_tsom</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_tsomem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">Hother</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tsom</span> <span class="kwd">as</span> [<span class="id">Hstore_tsom</span> [<span class="id">Hunbuffer_safe</span>' [<span class="id">Hobj_mem</span> <span class="id">Hperm</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#speclang_store_impl_obj_mem">speclang_store_impl_obj_mem</a></span> <span class="kwd">with</span> (<span class="id">n</span> := <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hstore_tsom</span> <span class="id">Hstore_tso</span> <span class="id">Hfind_symb</span>' <span class="id">Hembed</span> <span class="id">Hstore_spec_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">Hstore_tsom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H2</span> <span class="id">to</span> <span class="id">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hperm</span> <span class="kwd">in</span> <span class="id">Hrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostorev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstore_tso</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H4</span> <span class="kwd">with</span> (<span class="id">ofs</span> := <span class="id">ofs</span>) (<span class="id">k</span> := <span class="id">k</span>) (<span class="id">p</span> := <span class="id">p</span>) <span class="kwd">in</span> <span class="id">Hrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hrange</span> <span class="kwd">as</span> [<span class="id">Hrange</span> <span class="id">Hrange1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hrange</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hstore_spec_m</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">GMem.perm</span>, <span class="id">Memperm.perm_order</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOMemLemmas.html#Mem_GMem_access_eq">Mem_GMem_access_eq</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">fsm</span>') !! <span class="id">L</span> <span class="id">ofs</span> <span class="id">k</span>) <span class="id">eqn</span>:?; <span class="id">simpls</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#speclang_not_change_perm">speclang_not_change_perm</a></span> <span class="kwd">in</span> <span class="id">Hstore_spec_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_spec_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqo</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span> <span class="id">Hrange1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostorev</span>, <span class="id">tsostore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hstore_tso</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#G_unlock">G_unlock</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;unlock&nbsp;succ&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#unlock_succ">unlock_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#SpecLang_store_store_gm">SpecLang_store_store_gm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hembed</span> <span class="id">Hstore_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#tsostorev_append_bf">tsostorev_append_bf</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_set_ret_val_match">unlock_set_ret_val_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim_next_intr</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>; <span class="id">inv</span> <span class="id">Hembed1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hrel_tm_gm_vb</span> <span class="id">Hno_conflict</span> <span class="id">Hstore_tso</span> <span class="id">Hstore_spec_m</span> <span class="id">H0</span> <span class="id">HR8</span> <span class="id">Hobj_inv</span>' <span class="id">Hfind_symb</span>' <span class="id">H_L_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tsostorev</span>, <span class="id">tsostore</span>; <span class="id">inv</span> <span class="id">Hstore_tso</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">tm_alloc_not_fl</span>; <span class="tactic">eauto</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Htid_neq</span> <span class="id">Hin_buf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_not_eq_get">tupdate_not_eq_get</a></span> <span class="kwd">in</span> <span class="id">Hin_buf</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">rel_tm_gm_vb</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_b_get">tupdate_b_get</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hget_block</span> <span class="id">Happly_buffer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">Happly_buffer</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Happly_buffer</span> <span class="kwd">as</span> [<span class="id">gm</span>'' [<span class="id">Happly_buf1</span> <span class="id">Happly_buf2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">Happly_buf1</span>; <span class="tactic">eapply</span> <span class="id">Hrel_tm_gm_vb</span> <span class="kwd">in</span> <span class="id">Happly_buf1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id">gm</span>'' <span class="id">L</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0))) <span class="id">eqn</span>:<span class="id">Hstore</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Happly_buf2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#store_vb_eq">store_vb_eq</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span> <span class="kwd">in</span> <span class="id">Happly_buf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#speclang_store_vb_eq">speclang_store_vb_eq</a></span> <span class="kwd">in</span> <span class="id">Hstore_spec_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hstore_spec_m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">Hin_vb</span>; <span class="tactic">eauto</span>; <span class="tactic">eapply</span> <span class="id">Happly_buf1</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#exec_store_fp">exec_store_fp</a></span>, <span class="id"><a href="FMemOpFP.html#storev_fp">storev_fp</a></span>, <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode32">eval_addrmode32</a></span>, <span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Values.html#Val.add">Val.add</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span>) (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0))) <span class="kwd">with</span> <span class="id"><a href="Values.html#Vzero">Vzero</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR8</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span>))) <span class="kwd">with</span> 0%<span class="id">Z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RGRels.html#obj_valid_block_fp">obj_valid_block_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#Locs.belongsto">Locs.belongsto</a></span>, <span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span>, <span class="id"><a href="Footprint.html#Locs.union">Locs.union</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> 0 <span class="id">ofs</span>); <span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> 4); <span class="id">simpls</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">obj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobj_inv</span>' <span class="kwd">as</span> (<span class="id">L</span>' &amp; <span class="id">HL</span>' &amp; <span class="id">Hobj_inv</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">Hobj_inv</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">HL</span>'; <span class="id">inv</span> <span class="id">HL</span>'; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">unlock_st</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> [<span class="id">Hload_spec_m</span> <span class="id">Hst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">H_L_addr_eq</span> : <span class="id"><a href="MemLemmas.html#ogenv_match_L_addr_eq">ogenv_match_L_addr_eq</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H_L_addr_eq</span> <span class="kwd">as</span> [<span class="id">L</span>'' [<span class="id">H_L_addr_tso</span> <span class="id">H_L_addr_spec</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">H_L_addr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H_L_addr_tso</span>; <span class="tactic">subst</span> <span class="id">L</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sge</span> = <span class="id">sG</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_init</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 8 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec_p_exec</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#unlock_spec_fn">unlock_spec_fn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SpecLang.html#EntAtomstep">SpecLang.EntAtomstep</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;At&nbsp;EntAtom&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;After&nbsp;EntAtom&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;Seq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SpecLang.html#Atomstep">SpecLang.Atomstep</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;load&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SpecLang.html#Atomstep">SpecLang.Atomstep</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#load_gm_load_spec_m">load_gm_load_spec_m</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">r</span>' <span class="id"><a href="code.html#r">r</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span> <span class="kwd">else</span> <span class="id">te</span> <span class="id">r</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;assgin&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := (<span class="kwd">fun</span> <span class="id">r</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">r</span>' <span class="id"><a href="code.html#x">x</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="kwd">if</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">r</span>' <span class="id"><a href="code.html#r">r</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span> <span class="kwd">else</span> <span class="id">te</span> <span class="id">r</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;skip&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;seq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_step">InteractionSemantics.star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed_ex</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
<br/>
&nbsp;abort&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hstep_abort</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep_abort</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="SpecLang.html#fstep">SpecLang.fstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="SpecLang.html#normalstep">SpecLang.normalstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="SpecLang.html#eval_bexpr">SpecLang.eval_bexpr</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id"><a href="code.html#r">r</a></span> <span class="id"><a href="code.html#x">x</a></span>) <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
<br/>
&nbsp;not&nbsp;at&nbsp;external&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;not&nbsp;after&nbsp;external&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;not&nbsp;halt&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hspec_embed_nex</span> <span class="id">Hspec_init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hstep</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep</span>; <span class="tactic">subst</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="SpecLang.html#fstep">SpecLang.fstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hspec_embed_nex</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock release : movl $0 RAX </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;G&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Id">Id</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_retl_match">unlock_retl_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim_next_intr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_m_unchange_objinv1</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">solve_mem_strip</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call_elim</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock release : retl </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hspec_embed</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id">exists</span> <span class="id">fsm</span>, <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">sm</span> <span class="id">fl</span> <span class="id">fsm</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hspec_embed</span> <span class="kwd">as</span> [<span class="id">Hspec_embed</span> | <span class="id">Hspec_embed</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hspec_embed</span> <span class="kwd">as</span> [<span class="id">fsm</span> <span class="id">Hspec_embed</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec_p_exec</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exec_instr_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
<br/>
&nbsp;G&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Gobj">Gobj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOMemLemmas.html#tm_unchange">tm_unchange</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="InvRG.html#Id">Id</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#obj_unlock_match">obj_unlock_match</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_halt_match">unlock_halt_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pregmap_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hspec_embed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve_m_unchange_objinv1</span> <span class="id">tm</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">solve_mem_strip</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">inv</span> <span class="id">Hspec_embed</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">external_call_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#star_refl">InteractionSemantics.star_refl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">introv</span> <span class="id">Hstep</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hspec_embed</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsostep</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">ret_zero_ptr_false</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="SpecLang.html#CallStateIn">SpecLang.CallStateIn</a></span> <span class="id"><a href="SpecLang.html#Sskip">SpecLang.Sskip</a></span>).<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_tau_obj_mem_fp</span></span> holds in function unlock. </div>
<span class="kwd">Lemma</span> <span class="id"><a name="unlock_footprint_case">unlock_footprint_case</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">sc</span> <span class="id">tm</span> <span class="id">gm</span> <span class="id">t</span> <span class="id">b</span> <span class="id">fp</span> <span class="id">tc</span> <span class="id">tc</span>' <span class="id">b</span>' <span class="id">gm</span>' <span class="id">sm</span> <span class="id">ofs</span> <span class="id">fl</span> <span class="id">b0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hge_equiv</span> : <span class="id"><a href="TSOGlobSem.html#genv_match">genv_match</a></span> (<span class="id"><a href="InteractionSemantics.html#F">InteractionSemantics.F</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#V">InteractionSemantics.V</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hunlock_match_state</span> : <span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id"><a href="LockRelProof.html#sm">sm</a></span>) (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id"><a href="LockRelProof.html#tm">tm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hbf</span> : <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> = <span class="id"><a href="LockRelProof.html#b">b</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hmem</span> : <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> = <span class="id"><a href="LockRelProof.html#gm">gm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstep</span> : <span class="id"><a href="AsmTSO.html#tsostep">tsostep</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> (<span class="id"><a href="LockRelProof.html#b">b</a></span>, <span class="id"><a href="LockRelProof.html#gm">gm</a></span>) <span class="id"><a href="LockRelProof.html#fp">fp</a></span> <span class="id">tc</span>' (<span class="id">b</span>', <span class="id">gm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlocs_belongsto</span> : <span class="id"><a href="Footprint.html#Locs.belongsto">Locs.belongsto</a></span> (<span class="id"><a href="Footprint.html#FP.locs">FP.locs</a></span> <span class="id"><a href="LockRelProof.html#fp">fp</a></span>) <span class="id"><a href="LockRelProof.html#b0">b0</a></span> <span class="id"><a href="LockRelProof.html#ofs">ofs</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#b0">b0</a></span> <span class="id"><a href="LockRelProof.html#ofs">ofs</a></span> \/ (<span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="MemAux.html#get_block">get_block</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id">n</span> = <span class="id"><a href="LockRelProof.html#b0">b0</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9954')">Proof.</div>
<div class="proofscript" id="proof9954">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Locs.belongsto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hunlock_match_state</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep</span>; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> [<span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="id">external_call_elim</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hlocs_belongsto</span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Htso_core</span> : <span class="id"><a href="LockRelProof.html#tso_lock_release_init_state">tso_lock_release_init_state</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htso_core</span> <span class="kwd">as</span> [<span class="id">fb</span> [<span class="id">Hfind_symb</span> <span class="id">Htso_core</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Htso_core</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">fundef_init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Htso_core</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htso_core</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> [<span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="id">external_call_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H1</span> : <span class="id"><a href="loadframe.html#args_len_rec">args_len_rec</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H2</span> : <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>, <span class="id">H3</span> : <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>, <span class="id">H4</span> : <span class="id"><a href="TSOMem.html#tsoalloc">tsoalloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H1</span> <span class="id">to</span> <span class="id">Hargs_len_rec</span>, <span class="id">H2</span> <span class="id">to</span> <span class="id">Hobj_inv</span>, <span class="id">H3</span> <span class="id">to</span> <span class="id">Hembed</span>, <span class="id">H4</span> <span class="id">to</span> <span class="id">Htsoalloc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Hlocs_belongsto</span> <span class="id">Hargs_len_rec</span> <span class="id">Hobj_inv</span> <span class="id">Hembed</span> <span class="id">Htsoalloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htsoalloc</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">Htsoalloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hargs_len_rec</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_args_fp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">uncheck_alloc_fp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">FP.locs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Locs.union</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dis_if_else</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> [<span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="id">external_call_elim</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ptr_elim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H6</span> <span class="id">to</span> <span class="id">H_L_addr</span>, <span class="id">H8</span> <span class="id">to</span> <span class="id">H_L_addr_get</span>, <span class="id">H9</span> <span class="id">to</span> <span class="id">H_rel</span>, <span class="id">H14</span> <span class="id">to</span> <span class="id">Hobj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">H_L_addr</span> <span class="id">H_L_addr_get</span> <span class="id">H_rel</span> <span class="id">Hlocs_belongsto</span> <span class="id">Hobj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">exec_instr_TSO_fp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">exec_store_fp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">eval_addrmode</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span> : <span class="id"><a href="Integers.html#Int.add">Int.add</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0) = <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht</span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_L_addr</span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqb</span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht1</span> : <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht1</span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht2</span> : <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0) = 0%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht2</span> <span class="kwd">in</span> <span class="id">Hlocs_belongsto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_fp</span>, <span class="id">FP.locs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">Locs.union</span>, <span class="id">range_locset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#eq_block">eq_block</a></span> <span class="id">L</span> <span class="id">b0</span>) <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zle">zle</a></span> 0 <span class="id">ofs</span>) <span class="id">eqn</span>:?;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> 4) <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">obj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobj_inv</span> <span class="kwd">as</span> [<span class="id">L</span>' [<span class="id">Hfind_symb</span>' <span class="id">Hobj_inv</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">H_L_addr_get</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H_L_addr_get</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">Hobj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hstep</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">context</span> [<span class="id"><a href="AsmTSO.html#tsofstep">tsofstep</a></span>] |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">ptr_elim</span>]; <span class="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="id">external_call_elim</span>; <span class="id">ret_zero_ptr_false</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_rely</span></span> holds in function unlock. </div>
<span class="kwd">Lemma</span> <span class="id"><a name="lock_release_rely">lock_release_rely</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">sm</span>' <span class="id">tc</span> <span class="id">tm</span> <span class="id">tm</span>' <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span> <span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hunlock_match</span> : <span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id"><a href="LockRelProof.html#sm">sm</a></span>) (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id"><a href="LockRelProof.html#tm">tm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hrely_step</span> : <span class="id"><a href="InvRG.html#Robj">Robj</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> <span class="id"><a href="LockRelProof.html#sm">sm</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id">sm</span>' <span class="id">tm</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id">sm</span>') (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id">tm</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9955')">Proof.</div>
<div class="proofscript" id="proof9955">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemLemmas.html#R_impl_I_I">R_impl_I_I</a></span> <span class="kwd">in</span> <span class="id">Hrely_step</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hrely_step</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hunlock_match</span>; <span class="tactic">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_init_match">unlock_init_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_label_match">unlock_label_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#get_lock_addr_match">get_lock_addr_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#mov_one_match">mov_one_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_step_match">unlock_step_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_set_ret_val_match">unlock_set_ret_val_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_retl_match">unlock_retl_match</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="InvRG.html#unlock_halt_match">unlock_halt_match</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_halt_noscstep</span></span> holds in function unlock. </div>
<span class="kwd">Lemma</span> <span class="id"><a name="lock_rel_not_abort">lock_rel_not_abort</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">fm</span> <span class="id">gm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hspec_init</span> : <span class="id"><a href="InteractionSemantics.html#init_genv">InteractionSemantics.init_genv</a></span> <span class="id"><a href="SpecLang.html#speclang">SpecLang.speclang</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="code.html#lock_comp_unit">lock_comp_unit</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#sG">sG</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Himp_init</span> : <span class="id"><a href="AsmTSO.html#init_genv">init_genv</a></span> <span class="id"><a href="code.html#lock_comp_tso_unit">lock_comp_tso_unit</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlock_rel_match_state</span> : <span class="id"><a href="InvRG.html#unlock_match_state">unlock_match_state</a></span> <span class="id"><a href="LockRelProof.html#sge">sge</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> (<span class="id"><a href="LockRelProof.html#sc">sc</a></span>, <span class="id"><a href="LockRelProof.html#sm">sm</a></span>) (<span class="id"><a href="LockRelProof.html#tc">tc</a></span>, <span class="id"><a href="LockRelProof.html#tm">tm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hbf_nil</span> : <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> <span class="id"><a href="LockRelProof.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hgm</span> : <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="LockRelProof.html#tm">tm</a></span> = <span class="id"><a href="LockRelProof.html#gm">gm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hstep</span> : <span class="kwd">forall</span> (<span class="id">fp</span> : <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>) (<span class="id">tc</span>' : <span class="id"><a href="AsmTSO.html#core">core</a></span>) (<span class="id">b</span>' : <span class="id"><a href="TSOMem.html#buffer">buffer</a></span>) (<span class="id">gm</span>' : <span class="id"><a href="GMemory.html#gmem">gmem</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="AsmTSO.html#tsostep">tsostep</a></span> <span class="id"><a href="LockRelProof.html#tge">tge</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="LockRelProof.html#gm">gm</a></span>) <span class="id"><a href="LockRelProof.html#fp">fp</a></span> <span class="id">tc</span>' (<span class="id">b</span>', <span class="id">gm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hnot_halt</span> : <span class="id"><a href="AsmTSO.html#halt">halt</a></span> <span class="id"><a href="LockRelProof.html#tc">tc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hembed</span> : <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="LockRelProof.html#gm">gm</a></span> <span class="id"><a href="LockRelProof.html#fl">fl</a></span> <span class="id"><a href="LockRelProof.html#fm">fm</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9956')">Proof.</div>
<div class="proofscript" id="proof9956">
&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hlock_rel_match_state</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : init </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Htc</span> : <span class="id"><a href="LockRelProof.html#tso_lock_release_init_state">tso_lock_release_init_state</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htc</span> <span class="kwd">as</span> [<span class="id">fb</span> [<span class="id">Hfind_symb</span> <span class="id">Hfun_init</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfun_init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">fundef_init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hfun_init</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clear_trivial_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Halloc</span> : <span class="id"><a href="TSOMemLemmas.html#tsoalloc_bf_nil_succ_sz0">tsoalloc_bf_nil_succ_sz0</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Halloc</span> <span class="kwd">as</span> [<span class="id">tm1</span> [<span class="id">stk</span> <span class="id">Halloc</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trivial_not_abort</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : unlock label </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>; <span class="id">trivial_not_abort</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : movl $L R8 </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>; <span class="id">trivial_not_abort</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : movl $1 R9 </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>; <span class="id">trivial_not_abort</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : movl R9 <span class="bracket"><span class="id">R8</span></span> </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H1</span> : <span class="id"><a href="InvRG.html#obj_inv">obj_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>, <span class="id">H2</span> : <span class="id">_</span> = <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id">_</span> <span class="id"><a href="code.html#lock_L_ident">lock_L_ident</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H3</span> : <span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">IR</a></span> <span class="id"><a href="Asm.html#RDX">RDX</a></span>) = <span class="id">_</span>, <span class="id">H4</span> : <span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">IR</a></span> <span class="id"><a href="Asm.html#RCX">RCX</a></span>) = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">renames</span> <span class="id">H1</span> <span class="id">to</span> <span class="id">Hobj_inv</span>, <span class="id">H2</span> <span class="id">to</span> <span class="id">Hfind_symb</span>, <span class="id">H3</span> <span class="id">to</span> <span class="id">HR9</span>, <span class="id">H4</span> <span class="id">to</span> <span class="id">HR8</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">obj_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobj_inv</span> <span class="kwd">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">L</span>' [<span class="id">Hfind_symb</span>' [<span class="id">Hst</span> [<span class="id">Hstore</span> [<span class="id">Htso_store</span> <span class="id">Hunbuffer_safe</span>]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> [<span class="id">Hst</span> | <span class="id">Hst</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">lock_st</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">Hfind_symb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hfind_symb</span>; <span class="tactic">subst</span> <span class="id">L</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Htso_store</span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htso_store</span> <span class="kwd">as</span> [<span class="id">bm</span>' <span class="id">Htso_store</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_tsomem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id">memory</span> <span class="id">L</span> 0 (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>)) <span class="id">eqn</span>:<span class="id">Hstore_gm</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hstore_tso</span> : <span class="id"><a href="TSOMemLemmas.html#store_gm_embed_store_tsofmem">store_gm_embed_store_tsofmem</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tso</span> <span class="kwd">as</span> [<span class="id">tm</span>' <span class="id">Hstore_tso</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_store_TSO">exec_store_TSO</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR9</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span> : <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.add">Int.add</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htso_store</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">unlock_st</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split_and</span> <span class="id">Hst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">_</span> \/ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hst</span> | <span class="id">Hst</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">Hfind_symb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hfind_symb</span>; <span class="tactic">subst</span> <span class="id">L</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hst</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hst</span> <span class="kwd">as</span> [<span class="id">t</span>' [<span class="id">bf1</span> [<span class="id">bf2</span> [<span class="id">Hin_bf</span> [<span class="id">Hnot_in_obfs</span> [<span class="id">Hcont_one</span> <span class="id">Hload</span>]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpls</span>; <span class="tactic">subst</span>; <span class="id">simpls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">t</span> <span class="id">t</span>') <span class="id">eqn</span>:<span class="id">Htid</span>; <span class="tactic">try</span> <span class="tactic">subst</span> <span class="id">t</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hbf_nil</span> <span class="kwd">in</span> <span class="id">Hin_bf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bf1</span>; <span class="id">simpls</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Htso_store</span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htso_store</span> <span class="kwd">as</span> [<span class="id">bm</span>' <span class="id">Htso_store</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_tsomem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm</span>) <span class="id">L</span> 0 (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eqn</span>:<span class="id">Hstore_gm</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hstore_tso</span> : <span class="id"><a href="TSOMemLemmas.html#store_gm_embed_store_tsofmem">store_gm_embed_store_tsofmem</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tso</span> <span class="kwd">as</span> [<span class="id">tm</span>' <span class="id">Hstore_tso</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_store_TSO">exec_store_TSO</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR9</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span> : <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.add">Int.add</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htso_store</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfind_symb</span>' <span class="kwd">in</span> <span class="id">Hfind_symb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hfind_symb</span>; <span class="tactic">subst</span> <span class="id">L</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Htso_store</span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htso_store</span> <span class="kwd">as</span> [<span class="id">bm</span>' <span class="id">Htso_store</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfolds</span> <span class="id">store_tsomem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> <span class="id">memory</span> <span class="id">L</span> 0 (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Integers.html#Int.one">Int.one</a></span>)) <span class="id">eqn</span>:<span class="id">Hstore_gm</span>; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lets</span> <span class="id">Hstore_tso</span> : <span class="id"><a href="TSOMemLemmas.html#store_gm_embed_store_tsofmem">store_gm_embed_store_tsofmem</a></span> <span class="id">___</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstore_tso</span> <span class="kwd">as</span> [<span class="id">tm</span>' <span class="id">Hstore_tso</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_store_TSO">exec_store_TSO</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR9</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?; <span class="id">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HR8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ht</span> : <span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.of_int">Ptrofs.of_int</a></span> (<span class="id"><a href="Integers.html#Int.add">Int.add</a></span> <span class="id"><a href="Integers.html#Int.zero">Int.zero</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> 0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ht</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Htso_store</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore_tso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : mov $0 RAX </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>; <span class="id">trivial_not_abort</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
<div class="doc">lock acquire : retl </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hstep</span>; <span class="id">trivial_not_abort</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hnot_halt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">rs</span> <span class="id"><a href="Asm.html#PC">PC</a></span> = <span class="id"><a href="Values.html#Vzero">Vzero</a></span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hnot_halt</span>; <span class="tactic">clear</span> - <span class="id">Hnot_halt</span>; <span class="id">simpls</span>; <span class="id">tryfalse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
