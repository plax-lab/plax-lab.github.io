<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module TSOCompositionality</title>
<meta name="description" content="Documentation of Coq module TSOCompositionality" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module TSOCompositionality</h1>
<div class="coq">
<span class="id">From</span> <span class="id">mathcomp.ssreflect</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">fintype</span> <span class="id">ssrnat</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Maps.html">Maps</a></span> <span class="id"><a href="Axioms.html">Axioms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span> <span class="id"><a href="Integers.html">Integers</a></span> <span class="id"><a href="Floats.html">Floats</a></span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Events.html">Events</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Locations.html">Locations</a></span> <span class="id"><a href="Stacklayout.html">Stacklayout</a></span> <span class="id"><a href="Conventions.html">Conventions</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CUAST.html">CUAST</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="GMemory.html">GMemory</a></span> <span class="id"><a href="FMemory.html">FMemory</a></span> <span class="id"><a href="TSOMem.html">TSOMem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="GAST.html">GAST</a></span> <span class="id"><a href="GlobDefs.html">GlobDefs</a></span> <span class="id"><a href="ETrace.html">ETrace</a></span> <span class="id"><a href="Blockset.html">Blockset</a></span> <span class="id"><a href="DRF.html">DRF</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Languages.html">Languages</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="TSOGlobSem.html">TSOGlobSem</a></span> <span class="id"><a href="GlobSemantics.html">GlobSemantics</a></span> <span class="id"><a href="TSOGlobUSim.html">TSOGlobUSim</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html">RGRels</a></span> <span class="id"><a href="ClientSim.html">ClientSim</a></span> <span class="id"><a href="AsmClientSim.html">AsmClientSim</a></span> <span class="id"><a href="ObjectSim.html">ObjectSim</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="ASM_local.html">ASM_local</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AsmLang.html">AsmLang</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AsmTSO.html">AsmTSO</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="InteractionSemantics.html">InteractionSemantics</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="TSOCompInvs.html">TSOCompInvs</a></span> <span class="id"><a href="ObjRGIProp.html">ObjRGIProp</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Compositionality">Compositionality</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.scunits">scunits</a></span>: @<span class="id"><a href="GAST.html#cunits">cunits</a></span> <span class="id"><a href="Languages.html#NL">NL</a></span> <span class="id"><a href="Languages.html#L">L</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.tcunits">tcunits</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="AsmTSO.html#comp_unit">AsmTSO.comp_unit</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.H_client_code">H_client_code</a></span>: <span class="id"><a href="TSOCompInvs.html#client_id">client_id</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.scunits">scunits</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.tcunits">tcunits</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.oscu">oscu</a></span>: @<span class="id"><a href="GAST.html#cunit">cunit</a></span> <span class="id"><a href="Languages.html#NL">NL</a></span> <span class="id"><a href="Languages.html#L">L</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.otcu">otcu</a></span>: <span class="id"><a href="AsmTSO.html#comp_unit">AsmTSO.comp_unit</a></span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.Ro">Ro</a></span> <span class="id"><a name="Compositionality.Go">Go</a></span>: <span class="id"><a href="ASM_local.html#genv">ASM_local.genv</a></span> -&gt; <span class="id"><a href="GlobDefs.html#tid">tid</a></span> -&gt; <span class="id"><a href="RGRels.html#stRel">stRel</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.Io">Io</a></span>: <span class="id"><a href="ASM_local.html#genv">ASM_local.genv</a></span> -&gt; <span class="id"><a href="RGRels.html#stInv">stInv</a></span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.H_object_sim">H_object_sim</a></span>: <span class="id"><a href="TSOCompInvs.html#objcu_sim">objcu_sim</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.oscu">oscu</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.otcu">otcu</a></span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.e">e</a></span>: <span class="id"><a href="GAST.html#entries">entries</a></span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.HRP">HRP</a></span>: <span class="id"><a href="ObjectSim.html#RespectPerm">RespectPerm</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.H_sta_oo">H_sta_oo</a></span>: <span class="kwd">forall</span> <span class="id">ge</span> <span class="id">t</span>, <span class="id"><a href="RGRels.html#Sta">Sta</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span>) (<span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>)).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.H_rg_oo">H_rg_oo</a></span>: <span class="kwd">forall</span> <span class="id">ge</span> <span class="id">t</span> <span class="id">t</span>', <span class="id"><a href="TSOCompositionality.html#t">t</a></span> &lt;&gt; <span class="id">t</span>' -&gt; <span class="id"><a href="RGRels.html#Implies">Implies</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>) (<span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id">t</span>')).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.H_sta_o_ub">H_sta_o_ub</a></span>: <span class="kwd">forall</span> <span class="id">ge</span>, <span class="id"><a href="RGRels.html#UBSta">UBSta</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span>)).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="Compositionality.H_rg_ub_o">H_rg_ub_o</a></span>: <span class="kwd">forall</span> <span class="id">ge</span> <span class="id">t</span>, <span class="id"><a href="RGRels.html#UBImplies">UBImplies</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span>) (<span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>)).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_sta_co">H_sta_co</a></span>: <span class="kwd">forall</span> <span class="id">ge</span> <span class="id">t</span>, <span class="id"><a href="RGRels.html#Sta">Sta</a></span> <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10305')">Proof.</div>
<div class="proofscript" id="proof10305">
 <span class="tactic">eapply</span> <span class="id"><a href="ObjRGIProp.html#RP_Ic_Sta_Go">RP_Ic_Sta_Go</a></span>; <span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_sta_cc">H_sta_cc</a></span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="RGRels.html#Sta">Sta</a></span> <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> (<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10306')">Proof.</div>
<div class="proofscript" id="proof10306">
 <span class="tactic">exact</span> <span class="id"><a href="ClientSim.html#Ic_sta">Ic_sta</a></span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_sta_oc">H_sta_oc</a></span>: <span class="kwd">forall</span> <span class="id">ge</span> <span class="id">t</span>, <span class="id"><a href="RGRels.html#Sta">Sta</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span>) (<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10307')">Proof.</div>
<div class="proofscript" id="proof10307">
 <span class="tactic">eapply</span> <span class="id"><a href="ObjRGIProp.html#RP_Io_Sta_Gc">RP_Io_Sta_Gc</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">H_sta_co</span> <span class="id">H_sta_cc</span> <span class="id">H_sta_oc</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_rg_cc">H_rg_cc</a></span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">t</span>', <span class="id"><a href="RGRels.html#Implies">Implies</a></span> (<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>) (<span class="id"><a href="ClientSim.html#Rc">Rc</a></span> <span class="id">t</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10308')">Proof.</div>
<div class="proofscript" id="proof10308">
 <span class="tactic">exact</span> <span class="id"><a href="ClientSim.html#Gc_implies_Rc">Gc_implies_Rc</a></span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_rg_oc">H_rg_oc</a></span>: <span class="kwd">forall</span> <span class="id">ge</span> <span class="id">t</span> <span class="id">t</span>', <span class="id">Implies</span>' <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> (<span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>) (<span class="id"><a href="ClientSim.html#Rc">Rc</a></span> <span class="id">t</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10309')">Proof.</div>
<div class="proofscript" id="proof10309">
 <span class="tactic">eapply</span> <span class="id"><a href="ObjRGIProp.html#RP_Go_Implies_Rc">RP_Go_Implies_Rc</a></span>; <span class="tactic">eauto</span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_rg_co">H_rg_co</a></span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">ge</span> <span class="id">t</span>', <span class="id"><a href="TSOCompositionality.html#t">t</a></span> &lt;&gt; <span class="id">t</span>' -&gt; <span class="id">Implies</span>' (<span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span>) (<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>) (<span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#ge">ge</a></span> <span class="id">t</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10310')">Proof.</div>
<div class="proofscript" id="proof10310">
 <span class="tactic">eapply</span> <span class="id"><a href="ObjRGIProp.html#RP_Gc_Implies_Ro">RP_Gc_Implies_Ro</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">H_rg_cc</span> <span class="id">H_rg_oc</span> <span class="id">H_rg_co</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_sta_c_ub">H_sta_c_ub</a></span>: <span class="id"><a href="RGRels.html#UBSta">UBSta</a></span> <span class="id"><a href="ClientSim.html#Ic">Ic</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10311')">Proof.</div>
<div class="proofscript" id="proof10311">
 <span class="tactic">exact</span> <span class="id"><a href="ClientSim.html#UBSta_Ic">UBSta_Ic</a></span>. Qed.</div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="H_rg_ub_c">H_rg_ub_c</a></span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="RGRels.html#UBImplies">UBImplies</a></span> <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> (<span class="id"><a href="ClientSim.html#Rc">Rc</a></span> <span class="id"><a href="TSOCompositionality.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10312')">Proof.</div>
<div class="proofscript" id="proof10312">
 <span class="tactic">exact</span> <span class="id"><a href="ClientSim.html#UBImplies_Rc">UBImplies_Rc</a></span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">H_sta_c_ub</span> <span class="id">H_rg_ub_c</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="MATCH">MATCH</a></span> (<span class="id">SGE</span>: <span class="id"><a href="GlobDefs.html#GlobEnv.t">GlobEnv.t</a></span>) (<span class="id">TGE</span>: <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.t">TSOGlobEnv.t</a></span>) <span class="id">iobj</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">spc</span>: @<span class="id"><a href="GlobDefs.html#ProgConfig">ProgConfig</a></span> <span class="id"><a href="TSOCompositionality.html#SGE">SGE</a></span>) (<span class="id">tpc</span>: @<span class="id"><a href="TSOGlobSem.html#TSOProgConfig">TSOProgConfig</a></span> <span class="id"><a href="TSOCompositionality.html#TGE">TGE</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOCompInvs.html#MS">MS</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#SGE">SGE</a></span> <span class="id"><a href="TSOCompositionality.html#TGE">TGE</a></span> <span class="id"><a href="TSOCompositionality.html#iobj">iobj</a></span> <span class="id"><a href="TSOCompositionality.html#spc">spc</a></span> <span class="id"><a href="TSOCompositionality.html#tpc">tpc</a></span> /\ <span class="id"><a href="TSOCompInvs.html#BufWD">BufWD</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Ro">Ro</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Go">Go</a></span> <span class="id"><a href="TSOCompositionality.html#Compositionality.Io">Io</a></span> <span class="id"><a href="TSOCompositionality.html#SGE">SGE</a></span> <span class="id"><a href="TSOCompositionality.html#TGE">TGE</a></span> <span class="id"><a href="TSOCompositionality.html#iobj">iobj</a></span> <span class="id"><a href="TSOCompositionality.html#tpc">tpc</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="match_fls_eq">match_fls_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">SGE</span> <span class="id">TGE</span> <span class="id">iobj</span> <span class="id">spc</span> <span class="id">tpc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOCompositionality.html#MATCH">MATCH</a></span> <span class="id"><a href="TSOCompositionality.html#SGE">SGE</a></span> <span class="id"><a href="TSOCompositionality.html#TGE">TGE</a></span> <span class="id"><a href="TSOCompositionality.html#iobj">iobj</a></span> <span class="id"><a href="TSOCompositionality.html#spc">spc</a></span> <span class="id"><a href="TSOCompositionality.html#tpc">tpc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id"><a href="TSOCompositionality.html#SGE">SGE</a></span> = <span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id"><a href="TSOCompositionality.html#TGE">TGE</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10313')">Proof.</div>
<div class="proofscript" id="proof10313">
 <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">GE_eq</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">auto</span>. Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="progSrc">progSrc</a></span> : <span class="id"><a href="GAST.html#prog">prog</a></span> <span class="id"><a href="Languages.html#L">L</a></span> := (<span class="id"><a href="TSOCompositionality.html#Compositionality.oscu">oscu</a></span> :: <span class="id"><a href="TSOCompositionality.html#Compositionality.scunits">scunits</a></span>, <span class="id"><a href="TSOCompositionality.html#Compositionality.e">e</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="progTgt">progTgt</a></span> : <span class="id"><a href="TSOGlobSem.html#tsoprog">tsoprog</a></span> := (<span class="id"><a href="TSOCompositionality.html#Compositionality.otcu">otcu</a></span> :: <span class="id"><a href="TSOCompositionality.html#Compositionality.tcunits">tcunits</a></span>, <span class="id"><a href="TSOCompositionality.html#Compositionality.e">e</a></span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="compositionality">compositionality</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobUSim.html#TSOGlobUSim">TSOGlobUSim</a></span> <span class="id"><a href="TSOCompositionality.html#progSrc">progSrc</a></span> <span class="id"><a href="TSOCompositionality.html#progTgt">progTgt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof10314')">Proof.</div>
<div class="proofscript" id="proof10314">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOGlobUSim.html#TSOGlobUSim">TSOGlobUSim</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">sgm</span> <span class="id">SGE</span> <span class="id">spc</span> <span class="id">t</span> <span class="id">tgm</span> <span class="id">TGE</span> <span class="id">tpc</span> <span class="id">INITREL</span> <span class="id">INITCONFIG</span> <span class="id">Hdrf</span> <span class="id">Hsafe</span> <span class="id">TSOINITCONFIG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#init_genvs_sim">init_genvs_sim</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i_obj</span> <span class="id">H_gemodsim</span>].<br/>
<div class="doc">construct match_state </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="TSOCompositionality.html#MATCH">MATCH</a></span> <span class="id">SGE</span> <span class="id">TGE</span> <span class="id">i_obj</span>). <span class="tactic">split</span>.<br/>
<div class="doc">match_state is a simulation invariant </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">sgm</span> <span class="id">spc</span> <span class="id">tgm</span> <span class="id">tpc</span> <span class="id">t</span> <span class="id">INITCONFIG</span> <span class="id">Hdrf</span> <span class="id">Hsafe</span> <span class="id">TSOINITCONFIG</span> <span class="id">INITREL</span> <span class="id">H_gemodsim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
<div class="doc">tau-step sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">spc</span> <span class="id">tpc</span> [<span class="id">MATCH</span> <span class="id">BufWD</span>] <span class="id">tpc</span>' <span class="id">fpT</span>' <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#MS_preserved_after_tau_step_if_not_conflicting_client_fp">MS_preserved_after_tau_step_if_not_conflicting_client_fp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#BufWD_client_core_not_conflictc">BufWD_client_core_not_conflictc</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">spc</span>' &amp; <span class="id">fpS</span>' &amp; <span class="id">Hsstep</span> &amp; <span class="id">MATCH</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#BufWD_preserved_if_post_states_MS">BufWD_preserved_if_post_states_MS</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">BufWD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">BufWD</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
<div class="doc">sw-step sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">spc</span> <span class="id">tpc</span> [<span class="id">MATCH</span> <span class="id">BufWD</span>] <span class="id">tpc</span>' <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#MS_preserved_after_sw">MS_preserved_after_sw</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">spc</span>' &amp; <span class="id">Hsstep</span> &amp; <span class="id">MATCH</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#BufWD_preserved_if_post_states_MS">BufWD_preserved_if_post_states_MS</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">BufWD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">BufWD</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
<div class="doc">unbuffer sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">spc</span> <span class="id">tpc</span> [<span class="id">MATCH</span> <span class="id">BufWD</span>] <span class="id">t</span>' <span class="id">tpc</span>' <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#MS_preserved_after_unbuffer">MS_preserved_after_unbuffer</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">MATCH</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#BufWD_preserved_if_post_states_MS">BufWD_preserved_if_post_states_MS</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">BufWD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">BufWD</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
<div class="doc">evt-step sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">spc</span> <span class="id">tpc</span> [<span class="id">MATCH</span> <span class="id">BufWD</span>] <span class="id">v</span> <span class="id">tpc</span>' <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#MS_preserved_after_evt_step">MS_preserved_after_evt_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">spc</span>' &amp; <span class="id">Hsstep</span> &amp; <span class="id">MATCH</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#BufWD_preserved_if_post_states_MS">BufWD_preserved_if_post_states_MS</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">BufWD</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">BufWD</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
<div class="doc">final-state sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">spc</span> <span class="id">tpc</span> <span class="id">Hmatch</span> <span class="id">Hfinal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hfinal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hmatch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">spc</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">thdp_sims</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.tp_valid">ThreadPool.tp_valid</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">csi</span> <span class="id">Hgetcs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">thread_simulation</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Hgetcs</span> <span class="kwd">in</span> <span class="id">thread_simulation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">thread_simulation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.valid_tid">ThreadPool.valid_tid</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">valid_tid_eq</span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">i</span> <span class="id">Hvalid</span>). <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">Hthrdhalt</span> <span class="id">Hbufnil</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Hthrdhalt</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<div class="doc">abort case </div>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;thread&nbsp;abort&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">Hnthalt</span> &amp; <span class="id">Hbufnil</span> &amp; <span class="id">Habort</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tpc</span> <span class="kwd">as</span> [<span class="id">thdp</span> <span class="id">cid</span> <span class="id">tm</span>] .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">spc</span> <span class="kwd">as</span> [<span class="id">stp</span> <span class="id">cid</span>' <span class="id">sm</span> <span class="id">atombit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">HMS</span> <span class="id">HBufWD</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#tid_eq">tid_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">cid</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#atom_bit_0">atom_bit_0</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">atombit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">exists</span> <span class="id">tC</span> <span class="id">tcs</span>, (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">TSOThrdPool.content</a></span> <span class="id">thdp</span>) !! <span class="id">cid</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOCompositionality.html#tC">tC</a></span> :: <span class="id"><a href="TSOCompositionality.html#tcs">tcs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">TSOThrdPool.content</a></span> <span class="id">thdp</span>) !! <span class="id">cid</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="kwd">as</span> [(<span class="id">tC</span> &amp; <span class="id">tcs</span> &amp; <span class="id">H_tp_core</span>)|<span class="id">H_tp_core</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> ((<span class="id"><a href="TSOGlobSem.html#TSOThrdPool.content">TSOThrdPool.content</a></span> <span class="id">thdp</span>) !! <span class="id">cid</span>) <span class="id">eqn</span>:<span class="id">X</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hnthalt</span>. <span class="tactic">simpl</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thdp_sims">thdp_sims</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>. <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thread_simulation">thread_simulation</a></span>; <span class="tactic">eauto</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [|<span class="id">sC</span> <span class="id">scs</span>]. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">H_stp_core</span>. <span class="tactic">rename</span> <span class="id">H2</span> <span class="id">into</span> <span class="id">Hthdsim</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <span class="tactic">split</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">intro</span>.<br/>
&nbsp;not&nbsp;halted&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thdp_sims">thdp_sims</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thread_simulation">thread_simulation</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#tid_eq">tid_eq</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">inv</span> <span class="id">B</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">congruence</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;not&nbsp;non-sw&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hthdsim</span>.<br/>
&nbsp;case:&nbsp;client&nbsp;abort&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;sc&nbsp;program&nbsp;no&nbsp;core&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">fn</span>, <span class="id"><a href="GlobDefs.html#FLists.get_tfid">FLists.get_tfid</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id">TGE</span>) <span class="id">cid</span> <span class="id"><a href="TSOCompositionality.html#fn">fn</a></span> = <span class="id">flid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">fn</span> <span class="id">Hfn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#thdp_sims">thdp_sims</a></span> <span class="kwd">in</span> <span class="id">HMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#tp_inv_src">tp_inv_src</a></span> <span class="kwd">in</span> <span class="id">HMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.cs_inv">ThreadPool.cs_inv</a></span> <span class="kwd">in</span> <span class="id">HMS</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.fid_belongsto">ThreadPool.fid_belongsto</a></span> <span class="kwd">in</span> <span class="id">HMS</span>; [|<span class="id">left</span>; <span class="tactic">eauto</span>]. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="ClientSim.html#match_abort">ClientSim.match_abort</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id">TGE</span>) <span class="id">flid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hfn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#buffered_alloc_local_tm_alloc_not_fl">buffered_alloc_local_tm_alloc_not_fl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;-<span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.wd_fl">GlobEnv.wd_fl</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#GE_wd">GE_wd</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#buffered_alloc_local">buffered_alloc_local</a></span> <span class="kwd">in</span> <span class="id">HMS</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#fl_valid_eq_rel_tm_gm_vb">fl_valid_eq_rel_tm_gm_vb</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Hfn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#fl_valid_match">fl_valid_match</a></span> <span class="kwd">in</span> <span class="id">HMS</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">tfp</span> <span class="id">tc</span>' <span class="id">b</span>' <span class="id">m</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hcorestep</span> [<span class="id">m</span>'' <span class="id">Happly</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">cid</span> <span class="id">tfp</span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hconflict</span>|<span class="id">Hnoconflict</span>].<br/>
&nbsp;not&nbsp;conflict&nbsp;by&nbsp;buf&nbsp;nil...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hbufnil</span> <span class="id">Hconflict</span>; <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hconflict</span>. <span class="tactic">rewrite</span> <span class="id">Hbufnil</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">Hbufnil</span> <span class="id">cid</span>) <span class="kwd">in</span> <span class="id">Hcorestep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">TSOSemLemmas.non_conflict_access_unbuffer_safe</span>' <span class="kwd">in</span> <span class="id">Hnoconflict</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Corestep">TSOGlobSem.Corestep</a></span> <span class="id">TGE</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_unbuffer_safe">Ic_unbuffer_safe</a></span>. <span class="id">inv</span> <span class="id">HMS</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id">TGE</span> = <span class="id"><a href="GlobDefs.html#GlobEnv.freelists">GlobEnv.freelists</a></span> <span class="id">SGE</span>) <span class="kwd">as</span> <span class="id">Heqfls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="TSOCompInvs.html#GE_eq">GE_eq</a></span> <span class="kwd">in</span> <span class="id">HMS</span>. <span class="id">inv</span> <span class="id">HMS</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H7</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span> <span class="id">Hsc_no_corestep</span>.<br/>
&nbsp;sc&nbsp;program&nbsp;no&nbsp;call&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">funid</span> <span class="id">sg</span> <span class="id">args</span> <span class="id">new_ix</span> <span class="id">cc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#at_external">at_external</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOCompositionality.html#funid">funid</a></span>, <span class="id"><a href="TSOCompositionality.html#sg">sg</a></span>, <span class="id"><a href="TSOCompositionality.html#args">args</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GAST.html#not_primitive">not_primitive</a></span> <span class="id"><a href="TSOCompositionality.html#funid">funid</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id">SGE</span> <span class="id"><a href="TSOCompositionality.html#funid">funid</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOCompositionality.html#new_ix">new_ix</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#init_core">init_core</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id"><a href="TSOCompositionality.html#new_ix">new_ix</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id"><a href="TSOCompositionality.html#new_ix">new_ix</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOCompositionality.html#funid">funid</a></span> <span class="id"><a href="TSOCompositionality.html#args">args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">cc</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) <span class="kwd">as</span> <span class="id">Hsc_no_callstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">funid</span> <span class="id">sg0</span> <span class="id">args</span> <span class="id">new_ix</span> <span class="id">cc</span>' <span class="id">Hsatext</span> <span class="id">Hextfun</span> <span class="id">Hsgetmod</span> <span class="id">Hsinit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AsmTSO.html#at_external">AsmTSO.at_external</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.modules">TSOGlobEnv.modules</a></span> <span class="id">TGE</span> <span class="id">ix</span>') <span class="id">tc</span>) <span class="kwd">as</span> [[[<span class="id">funid</span>' <span class="id">sg0</span>']  <span class="id">args</span>']|] <span class="id">eqn</span>:<span class="id">Htatext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">SGE</span>, <span class="id">TGE</span>. <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#GE_eq">GE_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H7</span> <span class="kwd">in</span> <span class="id">Hsgetmod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="ClientSim.html#match_at_external">ClientSim.match_at_external</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">Hsatext</span>, <span class="id">Htatext</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AsmTSO.html#init_core">AsmTSO.init_core</a></span> (<span class="id">modules0</span> <span class="id">new_ix</span>) <span class="id">funid</span> <span class="id">args</span>) <span class="kwd">as</span> [<span class="id">tcc</span>'|] <span class="id">eqn</span>:<span class="id">Htinit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Call">TSOGlobSem.Call</a></span> {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.Build_t">TSOGlobEnv.M</a></span> := <span class="id">M</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TSOGlobEnv.modules</span> := <span class="id">modules0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TSOGlobEnv.get_mod</span> := <span class="id">get_mod0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TSOGlobEnv.ge_bound</span> := <span class="id">ge_bound0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">TSOGlobEnv.freelists</span> := <span class="id">freelists0</span> |}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.push">TSOThrdPool.push</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;tso&nbsp;cannot&nbsp;init:&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H15</span> <span class="id">new_ix</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H15</span> <span class="kwd">as</span> [[<span class="id">Hmodsim</span> <span class="id">Hix</span>]|[<span class="id">Hmodsim</span> <span class="id">Hix</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hmodsim</span>. <span class="id">exploit</span> <span class="id"><a href="ClientSim.html#match_init_none">ClientSim.match_init_none</a></span>. <span class="tactic">exact</span> <span class="id">H3</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">modules</span> <span class="id">new_ix</span>). <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">subst</span> <span class="id">Ge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hmodsim</span>. <span class="id">exploit</span> <span class="id"><a href="ObjectSim.html#match_init_none">ObjectSim.match_init_none</a></span>. <span class="tactic">exact</span> <span class="id">H3</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="InteractionSemantics.html#init_core">init_core</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id">modules</span> <span class="id">i_obj</span>)) (<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id">modules</span> <span class="id">i_obj</span>)) <span class="id">funid</span> <span class="id">args</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="kwd">as</span> <span class="id">Hsinit</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Hsinit</span>. <span class="tactic">intro</span>; <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hsinit</span> <span class="id">cc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> <span class="id">Hsinit</span>'. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">contradiction</span>.<br/>
&nbsp;tso&nbsp;no&nbsp;at&nbsp;ext&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="ClientSim.html#match_at_external">ClientSim.match_at_external</a></span> <span class="kwd">in</span> <span class="id">Htatext</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;sc&nbsp;program&nbsp;no&nbsp;return&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">sC</span>' <span class="id">scs</span>' <span class="id">res</span> <span class="id">sc</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">scs</span> = <span class="id">sC</span>' :: <span class="id">scs</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#halt">halt</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOCompositionality.html#res">res</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#after_external">after_external</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> (<span class="id"><a href="GlobDefs.html#Core.i">Core.i</a></span> <span class="id">sC</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#Core.c">Core.c</a></span> <span class="id">sC</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#res_sg">res_sg</a></span> <span class="id">sg</span> <span class="id"><a href="TSOCompositionality.html#res">res</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sc</span>'' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) <span class="kwd">as</span> <span class="id">Hsc_no_return</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">scs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tcs</span> <span class="kwd">as</span> [|<span class="id">tC</span>' <span class="id">tcs</span>'] <span class="id">eqn</span>:<span class="id">X</span>; <span class="tactic">subst</span> <span class="id">tcs</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="ClientSim.html#match_halted">ClientSim.match_halted</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AsmTSO.html#after_external">AsmTSO.after_external</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOCore.c">TSOCore.c</a></span> <span class="id">tC</span>') (<span class="id"><a href="GlobDefs.html#res_sg">res_sg</a></span> <span class="id">sg</span> <span class="id">res</span>)) <span class="kwd">as</span> [<span class="id">tc</span>''|] <span class="id">eqn</span>:<span class="id">Htaftext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Return">TSOGlobSem.Return</a></span> <span class="id">TGE</span>). <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.pop">TSOThrdPool.pop</a></span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">exploit</span> <span class="id"><a href="ClientSim.html#match_after_external_none">ClientSim.match_after_external_none</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;sc&nbsp;program&nbsp;no&nbsp;thread&nbsp;halt&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">res</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">scs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#halt">halt</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>)) <span class="id">sc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="TSOCompositionality.html#res">res</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) <span class="kwd">as</span> <span class="id">Hsc_no_halt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="ClientSim.html#match_halted">ClientSim.match_halted</a></span> <span class="kwd">in</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">scs</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Halt">TSOGlobSem.Halt</a></span> <span class="id">TGE</span>). <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.pop">TSOThrdPool.pop</a></span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;sc&nbsp;program&nbsp;no&nbsp;print&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">v</span> <span class="id">sc</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#at_external">at_external</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="GAST.html#print">print</a></span>, <span class="id"><a href="GAST.html#print_sg">print_sg</a></span>, <span class="id"><a href="TSOCompositionality.html#v">v</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#not_pointer">not_pointer</a></span> <span class="id"><a href="TSOCompositionality.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="InteractionSemantics.html#after_external">after_external</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">ix</span>)) <span class="id">sc</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sc</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) <span class="kwd">as</span> <span class="id">Hsc_no_print</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="ClientSim.html#match_at_external">ClientSim.match_at_external</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AsmTSO.html#after_external">AsmTSO.after_external</a></span> <span class="id">tc</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="kwd">as</span> [<span class="id">tc</span>'|] <span class="id">eqn</span>:<span class="id">Htaftext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#EF_Print">TSOGlobSem.EF_Print</a></span> <span class="id">TGE</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">C</span>; <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="ClientSim.html#match_after_external_none">ClientSim.match_after_external_none</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsc_no_corestep</span> <span class="kwd">as</span> [<span class="id">Hsc_no_corestep</span>|<span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">auto</span>; <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H_tp_core0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hsc_no_corestep</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Heqfls</span> <span class="kwd">in</span> *. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H_tp_core0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hsc_no_callstep</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.pop">ThreadPool.pop</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_pop</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H_tp_pop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span> <span class="kwd">in</span> <span class="id">H_tp_caller</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">scs</span> <span class="kwd">as</span> [|<span class="id">sC</span>' <span class="id">scs</span>']; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H_tp_caller</span>; <span class="id">inv</span> <span class="id">H_tp_caller</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_tp_core0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hsc_no_return</span>; <span class="tactic">eauto</span>.  }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.pop">ThreadPool.pop</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_pop</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H_tp_pop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">scs</span> <span class="kwd">as</span> [|<span class="id">sC</span>' <span class="id">scs</span>']. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_tp_core0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id">Hsc_no_halt</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_thread_halt</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H3</span>.  }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.pop">ThreadPool.pop</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="id">inv</span> <span class="id">H_tp_core0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#match_no_entatom">ClientSim.match_no_entatom</a></span> <span class="kwd">in</span> <span class="id">H_core_atext</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H_core_atext</span>; <span class="id">contradiction</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{  <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.pop">ThreadPool.pop</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H_stp_core</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="id">inv</span> <span class="id">H_tp_core0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hsc_no_print</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;fl&nbsp;ill&nbsp;formed&nbsp;-&nbsp;impossible&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">C</span> <span class="id">HMS</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#fls_embed">fls_embed</a></span> <span class="kwd">in</span> <span class="id">HMS</span>. <span class="id">inv</span> <span class="id">HMS</span>. <span class="id">edestruct</span> <span class="id">Embed</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> <span class="kwd">in</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">C</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;object&nbsp;abort&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <br/>
&nbsp;tso&nbsp;program&nbsp;no&nbsp;core&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">tc</span>' <span class="id">b</span>' <span class="id">gm</span>', ~ <span class="id"><a href="AsmTSO.html#tsostep">tsostep</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.modules">TSOGlobEnv.modules</a></span> <span class="id">TGE</span> <span class="id">i_obj</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id">TGE</span>) <span class="id">flid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tc</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span>) <span class="id"><a href="TSOCompositionality.html#fp">fp</a></span> <span class="id">tc</span>' (<span class="id">b</span>', <span class="id">gm</span>')) <span class="kwd">as</span> <span class="id">Hno_corestep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Corestep">TSOGlobSem.Corestep</a></span> <span class="id">TGE</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hbufnil</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="ObjectSim.html#match_tau">match_tau</a></span> <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">C</span> <span class="kwd">as</span> [<span class="id">Hstep</span>|<span class="id">Hatom</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstep</span> <span class="kwd">as</span> (<span class="id">FP</span> &amp; <span class="id">sc</span>' &amp; <span class="id">sm</span>' &amp; <span class="id">Hstar</span> &amp; [[<span class="id">HGo</span> <span class="id">_</span>]|<span class="id">Habort</span>']).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoupd">tsoupd</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_unbuffer_safe">Ic_unbuffer_safe</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompositionality.html#H_sta_co">H_sta_co</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#mem_inv_client">mem_inv_client</a></span>. <span class="tactic">exact</span> <span class="id">HMS</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span> <span class="kwd">in</span> <span class="id">Habort</span>';[|<span class="tactic">eauto</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SCSemLemmas.html#core_star_globstep_star">SCSemLemmas.core_star_globstep_star</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span> <span class="kwd">in</span> <span class="id">Hstar</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">stp</span>' &amp; <span class="id">Hsstar</span> &amp; [<span class="id">Htp</span>' | <span class="id">Hrefl</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#taustar_etrace_star">SCSemLemmas.taustar_etrace_star</a></span> <span class="kwd">in</span> <span class="id">Hsstar</span>. <span class="tactic">destruct</span> <span class="id">Hsstar</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#source_safe">source_safe</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#abort_condition_abort">abort_condition_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id">scs</span>). <span class="id">instantiate</span> (1:=<span class="id">flid</span>). <span class="id">instantiate</span> (1:=<span class="id">sg</span>). <span class="id">instantiate</span> (1:=<span class="id">sc</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">GDefLemmas.solv_thread</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hrefl</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>); <span class="tactic">subst</span> <span class="id">sm</span>' <span class="id">sc</span>' <span class="id">stp</span>' <span class="id">FP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#source_safe">source_safe</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#star_refl">ETrace.star_refl</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#abort_condition_abort">abort_condition_abort</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hatom</span> <span class="kwd">as</span> (<span class="id">FP1</span> &amp; <span class="id">sc_ent</span> &amp; <span class="id">sm1</span> &amp; <span class="id">sc_ent</span>' &amp; <span class="id">FP2</span> &amp; <span class="id">sc_ext</span> &amp; <span class="id">sm</span>' &amp; <span class="id">sc</span>' &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hstar1</span> &amp; <span class="id">Hent1</span> &amp; <span class="id">Hent2</span> &amp; <span class="id">Hstar2</span> &amp; [<span class="id">Hext</span> | <span class="id">Habort</span>']).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">Hext</span> <span class="kwd">as</span> (<span class="id">_</span> &amp; <span class="id">_</span> &amp; <span class="id">HGo</span> &amp; <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoupd">tsoupd</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_unbuffer_safe">Ic_unbuffer_safe</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompositionality.html#H_sta_co">H_sta_co</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#mem_inv_client">mem_inv_client</a></span>. <span class="tactic">exact</span> <span class="id">HMS</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exfalso</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span> <span class="kwd">in</span> <span class="id">Habort</span>'; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SCSemLemmas.html#core_star_globstep_star">SCSemLemmas.core_star_globstep_star</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span> <span class="kwd">in</span> <span class="id">Hstar1</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">stp</span>' &amp; <span class="id">Hsstar1</span> &amp; <span class="id">Hstp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="GlobSemantics.html#Ent_Atom">Ent_Atom</a></span> <span class="id">SGE</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= {| <span class="id"><a href="GlobDefs.html#Core.Build_t">Core.i</a></span> := <span class="id">ix</span>; <span class="id">Core.c</span> := <span class="id">sc_ent</span>; <span class="id">Core.sg</span> := <span class="id">sg</span>; <span class="id">Core.F</span> := <span class="id">flid</span> |}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">cid</span>). <span class="id">instantiate</span> (1:= <span class="id">stp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstp</span>' <span class="kwd">as</span> [<span class="id">Hstp</span>'|(<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GDefLemmas.solv_thread</span>. <span class="tactic">subst</span> <span class="id">stp</span>' <span class="id">sc</span>. <span class="id">GDefLemmas.solv_thread</span>. <span class="tactic">rewrite</span> <span class="id">H_stp_core</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= {| <span class="id"><a href="GlobDefs.html#Core.Build_t">Core.i</a></span> := <span class="id">ix</span>; <span class="id">Core.c</span> := <span class="id">sc_ent</span>; <span class="id">Core.sg</span> := <span class="id">sg</span>; <span class="id">Core.F</span> := <span class="id">flid</span> |} :: <span class="id">scs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstp</span>' <span class="kwd">as</span> [<span class="id">Hstp</span>'|(<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GDefLemmas.solv_thread</span>. <span class="tactic">subst</span> <span class="id">stp</span>' <span class="id">sc</span>. <span class="id">GDefLemmas.solv_thread</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">sm1</span>). <span class="tactic">intro</span> <span class="id">Hent</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="SCSemLemmas.html#core_star_globstep_star">SCSemLemmas.core_star_globstep_star</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span> <span class="kwd">in</span> <span class="id">Hstar2</span>. <span class="tactic">exact</span> <span class="id">Hstar2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">scs</span>). <span class="id">instantiate</span> (1:= <span class="id">sg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GDefLemmas.solv_thread</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.Build_t">ThreadPool.content</a></span> := <span class="id"><a href="Maps.html#PMap.set">PMap.set</a></span> <span class="id">cid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;({| <span class="id"><a href="GlobDefs.html#Core.Build_t">Core.i</a></span> := <span class="id">ix</span>; <span class="id">Core.c</span> := <span class="id">sc_ent</span>'; <span class="id">Core.sg</span> := <span class="id">sg</span>; <span class="id">Core.F</span> := <span class="id">flid</span> |} :: <span class="id">scs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#ThreadPool.content">ThreadPool.content</a></span> <span class="id">stp</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ThreadPool.next_tid</span> := <span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">stp</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ThreadPool.next_fmap</span> := <span class="id"><a href="GlobDefs.html#ThreadPool.next_fmap">ThreadPool.next_fmap</a></span> <span class="id">stp</span>' |}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">stp</span>'' &amp; <span class="id">Hsstar2</span> &amp; <span class="id">Hstp</span>''). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#taustar_etrace_star">SCSemLemmas.taustar_etrace_star</a></span> <span class="kwd">in</span> <span class="id">Hsstar1</span>. <span class="tactic">destruct</span> <span class="id">Hsstar1</span> <span class="kwd">as</span> [<span class="id">ls1</span> <span class="id">Hsstar1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#taustar_etrace_star">SCSemLemmas.taustar_etrace_star</a></span> <span class="kwd">in</span> <span class="id">Hsstar2</span>. <span class="tactic">destruct</span> <span class="id">Hsstar2</span> <span class="kwd">as</span> [<span class="id">ls2</span> <span class="id">Hsstar2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#source_safe">source_safe</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#etrace_star_star">SCSemLemmas.etrace_star_star</a></span>. <span class="tactic">exact</span> <span class="id">Hsstar1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#etrace_star_star">SCSemLemmas.etrace_star_star</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#star_step">ETrace.star_step</a></span>. <span class="tactic">exact</span> <span class="id">Hent</span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#star_refl">ETrace.star_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hsstar2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#abort_condition_abort">abort_condition_abort</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id">scs</span>). <span class="id">instantiate</span> (1:= <span class="id">flid</span>). <span class="id">instantiate</span> (1:= <span class="id">sg</span>). <span class="id">instantiate</span> (1:= <span class="id">sc_ext</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">Hstp</span>'' <span class="kwd">as</span> [<span class="id">Hstp</span>'' | (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>)]; [| <span class="tactic">subst</span> <span class="id">sc_ext</span> <span class="id">stp</span>''].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GDefLemmas.solv_thread</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thdp_sims">thdp_sims</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOCompInvs.html#tp_inv_src">tp_inv_src</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.cs_inv">ThreadPool.cs_inv</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.fid_valid">ThreadPool.fid_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>;[|<span class="tactic">simpl</span>;<span class="id">left</span>;<span class="tactic">eauto</span>]. <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">fn</span> [<span class="id">_</span> <span class="id">Hfn</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfn</span>. <span class="tactic">subst</span> <span class="id">flid</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#buffered_alloc_local_tm_alloc_not_fl">buffered_alloc_local_tm_alloc_not_fl</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.wd_fl">GlobEnv.wd_fl</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#GE_wd">GE_wd</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#buffered_alloc_local">buffered_alloc_local</a></span> <span class="kwd">in</span> <span class="id">HMS</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thdp_sims">thdp_sims</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOCompInvs.html#tp_inv_src">tp_inv_src</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.cs_inv">ThreadPool.cs_inv</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.fid_valid">ThreadPool.fid_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>;[|<span class="tactic">simpl</span>;<span class="id">left</span>;<span class="tactic">eauto</span>]. <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">fn</span> [<span class="id">_</span> <span class="id">Hfn</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hfn</span>. <span class="tactic">subst</span> <span class="id">flid</span>. <span class="id">erewrite</span> <span class="id"><a href="TSOCompInvs.html#match_fls_eq">TSOCompInvs.match_fls_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#fl_valid_match">fl_valid_match</a></span> <span class="kwd">in</span> <span class="id">HMS</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HMS</span>. <span class="id">revert</span> <span class="id">HMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOCompInvs.html#fl_valid_eq">fl_valid_eq</a></span>, <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#FLists.get_block">FLists.get_block</a></span>, <span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">HMS</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="id">revert</span> <span class="id">H2</span>. <span class="tactic">clear</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>'. <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>'. <span class="tactic">discriminate</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;tso&nbsp;program&nbsp;object&nbsp;not&nbsp;returning&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="AsmTSO.html#halt">AsmTSO.halt</a></span> <span class="id">tc</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) <span class="kwd">as</span> <span class="id">Hnot_returning</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="AsmTSO.html#halt">AsmTSO.halt</a></span> <span class="id">tc</span>) <span class="kwd">as</span> [<span class="id">res</span>|] <span class="id">eqn</span>:<span class="id">Hhalt</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tcs</span> <span class="kwd">as</span> [|<span class="id">tc</span>' <span class="id">tcs</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Halt">TSOGlobSem.Halt</a></span> <span class="id">TGE</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.pop">TSOThrdPool.pop</a></span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AsmTSO.html#after_external">AsmTSO.after_external</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOCore.c">TSOCore.c</a></span> <span class="id">tc</span>') (<span class="id"><a href="GlobDefs.html#res_sg">res_sg</a></span> <span class="id">sg</span> <span class="id">res</span>)) <span class="kwd">as</span> [<span class="id">tc</span>''|] <span class="id">eqn</span>:<span class="id">Haftext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="TSOGlobSem.html#Return">TSOGlobSem.Return</a></span> <span class="id">TGE</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOGlobSem.html#TSOThrdPool.pop">TSOThrdPool.pop</a></span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id">Habort</span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">scs</span> <span class="kwd">as</span> [|<span class="id">sc</span>' <span class="id">scs</span>']; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="ObjectSim.html#match_halt_noscstep">ObjectSim.match_halt_noscstep</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">Hno_sccorestep</span> <span class="id">Hnot_atext</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ObjectSim.html#match_halt">ObjectSim.match_halt</a></span> <span class="kwd">in</span> <span class="id">Hhalt</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#match_after_external_none">ClientSim.match_after_external_none</a></span> <span class="kwd">in</span> <span class="id">Haftext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">HMS</span> <span class="id">Hhalt</span> <span class="id">Haftext</span> <span class="id">H_stp_core</span> <span class="id">Hnot_atext</span> <span class="id">Hno_sccorestep</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOCompInvs.html#source_safe">source_safe</a></span> <span class="kwd">in</span> <span class="id">HMS</span>. <span class="tactic">eapply</span> <span class="id">HMS</span>. <span class="tactic">eapply</span> <span class="id"><a href="ETrace.html#star_refl">ETrace.star_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">GDefLemmas.solv_thread</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">GDefLemmas.solv_thread</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_tp_core</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id">Hno_sccorestep</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_tp_core</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_tp_core</span>. <span class="id">inv</span> <span class="id">H_tp_caller</span>. <span class="id">inv</span> <span class="id">H_tp_pop</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H_tp_core</span>. <span class="id">inv</span> <span class="id">H_thread_halt</span>. <span class="id">inv</span> <span class="id">H_tp_pop</span>. <span class="id">GDefLemmas.solv_thread</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GDefLemmas.solv_thread</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GDefLemmas.solv_thread</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#fls_embed">fls_embed</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">edestruct</span> <span class="id">Embed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="ObjectSim.html#match_abort">ObjectSim.match_abort</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thdp_sims">thdp_sims</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>. <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#thread_simulation">thread_simulation</a></span>; <span class="tactic">eauto</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H_tp_core</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>; <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_top">ThreadPool.get_top</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H_tp_core0</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;unbuffer&nbsp;abort&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id"><a href="TSOCompInvs.html#mem_inv_client">mem_inv_client</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_unbuffer_safe">Ic_unbuffer_safe</a></span> <span class="kwd">in</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">t</span>' &amp; <span class="id">Htbuf</span> &amp; <span class="id">Hunbuf</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#unbuffer_safe_unbuffer">unbuffer_safe_unbuffer</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<div class="doc">init states are matched </div>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_wd">GlobEnv.ge_wd</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">rewrite</span> <span class="id">H15</span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#tso_sc_initRel_Ic">tso_sc_initRel_Ic</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">SGE</span>. <span class="tactic">destruct</span> <span class="id">TGE</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H_gemodsim</span>. <span class="tactic">clear</span> <span class="id">i_obj1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep.html#EqdepTheory.inj_pair2">Eqdep.EqdepTheory.inj_pair2</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H10</span> <span class="id">i_obj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="ObjectSim.html#match_initmem">match_initmem</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">specialize</span> (<span class="id">H9</span> <span class="id">i_obj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;thread&nbsp;sims&nbsp;...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">TSOINITCONFIG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOCompInvs.html#ge_mod_sim_thdp_init_thrdsims">ge_mod_sim_thdp_init_thrdsims</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;flists&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">intros</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="id">tpc</span>) <span class="id">eqn</span>:?. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">memory</span> <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="FMemory.html#Mem.mkmem">Mem.mkmem</a></span> <span class="id">mem_contents</span> <span class="id">mem_access</span> <span class="id">validblocks</span> <span class="id">_</span> 0%<span class="id">nat</span> <span class="id">_</span> <span class="id">_</span> <span class="id">access_max</span> <span class="id">invalid_noaccess</span> <span class="id">contents_default</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;inv&nbsp;thdp&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOSemLemmas.html#init_inv">TSOSemLemmas.init_inv</a></span>;<span class="tactic">eauto</span>. <br/>
&nbsp;buffered&nbsp;alloc&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span>' <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;valid_block&nbsp;eq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="TSOGlobSem.html#init_rel_ge_bound">init_rel_ge_bound</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">HBOUND</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOGlobSem.html#init_rel_freelists">init_rel_freelists</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">HFLS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span> <span class="id">t0</span> <span class="id">fn</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#FLists.get_tfl">FLists.get_tfl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="GlobDefs.html#FLists.get_tfid">FLists.get_tfid</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id">TGE</span>) <span class="id">t0</span> <span class="id">fn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">fn</span>. <span class="tactic">intro</span> <span class="id">flid</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOCompInvs.html#fl_valid_eq">fl_valid_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">rewrite</span> <span class="id">H15</span>. <span class="tactic">simpl</span>. <span class="tactic">intros</span> <span class="id">tgm</span>' <span class="id">A</span>. <span class="id">inv</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span> <span class="id">H8</span> <span class="id">HFLS</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H8</span>. <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">flid</span>). <span class="id">specialize</span> (<span class="id">H0</span> <span class="id">flid</span>). <span class="id">revert</span> <span class="id">H0</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HFLS</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="GlobDefs.html#FLists.get_fl">FLists.get_fl</a></span> (<span class="id"><a href="TSOGlobSem.html#TSOGlobEnv.freelists">TSOGlobEnv.freelists</a></span> <span class="id">TGE</span>) <span class="id">flid</span>) (<span class="id"><a href="GlobDefs.html#gm">gm</a></span> <span class="id">spc</span>). <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fl</span> <span class="id">gm</span>. <span class="tactic">unfold</span> <span class="id"><a href="MemAux.html#no_overlap">MemAux.no_overlap</a></span>, <span class="id"><a href="MemAux.html#valid_block_bset">MemAux.valid_block_bset</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> (<span class="id"><a href="GlobDefs.html#FLists.get_block">FLists.get_block</a></span> <span class="id">fl</span> <span class="id">n</span>) <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> (<span class="id"><a href="GlobDefs.html#FLists.get_block">FLists.get_block</a></span> <span class="id">fl</span> <span class="id">n</span>) <span class="id">n</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">C</span>; [<span class="id">contradict</span> <span class="id">H2</span>|<span class="id">contradict</span> <span class="id">H0</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;sep&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">INITCONFIG</span>. <span class="tactic">eapply</span> <span class="id"><a href="TSOGlobSem.html#init_rel_sgm_sep">init_rel_sgm_sep</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;BufWD&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOCompInvs.html#buf_emp_BufWD">buf_emp_BufWD</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="tactic">rewrite</span> <span class="id">H7</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">eapply</span> <span class="id">flist_norep</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">TSOINITCONFIG</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intro</span>. <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">H6</span>. <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Blockset.html#Bset.belongsto">Bset.belongsto</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsomem_init">tsomem_init</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="tactic">rewrite</span> <span class="id">Heqt0</span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">H8</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">inversion</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="TSOCompositionality.html#Compositionality">Compositionality</a></span>.<br/>
<br/>
<span class="kwd">Check</span> <span class="id"><a href="TSOCompositionality.html#compositionality">compositionality</a></span>.<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
