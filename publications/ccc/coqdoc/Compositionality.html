<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Compositionality</title>
<meta name="description" content="Documentation of Coq module Compositionality" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Compositionality</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">mathcomp.ssreflect.fintype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Maps.html">Maps</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Blockset.html">Blockset</a></span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="InteractionSemantics.html">InteractionSemantics</a></span> <span class="id"><a href="GAST.html">GAST</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ReachClose.html">ReachClose</a></span> <span class="id"><a href="LDSim.html">LDSim</a></span> <span class="id"><a href="AuxLDSim.html">AuxLDSim</a></span> <span class="id"><a href="Invs.html">Invs</a></span> <span class="id"><a href="GlobDefs.html">GlobDefs</a></span> <span class="id"><a href="GSimDefs.html">GSimDefs</a></span> <span class="id"><a href="GlobDSim.html">GlobDSim</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_forall2_nth_rel">list_forall2_nth_rel</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">P</span>: <span class="id"><a href="Compositionality.html#A">A</a></span> -&gt; <span class="id"><a href="Compositionality.html#B">B</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="Compositionality.html#P">P</a></span> <span class="id"><a href="Compositionality.html#l1">l1</a></span> <span class="id"><a href="Compositionality.html#l2">l2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Coqlib.html#option_rel">option_rel</a></span> <span class="id"><a href="Compositionality.html#P">P</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="Compositionality.html#l1">l1</a></span> <span class="id"><a href="Compositionality.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="Compositionality.html#l2">l2</a></span> <span class="id"><a href="Compositionality.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9162')">Proof.</div>
<div class="proofscript" id="proof9162">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="existTeq">existTeq</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html#ProofIrrelevanceTheory.EqdepTheory.inj_pair2">ProofIrrelevance.ProofIrrelevanceTheory.EqdepTheory.inj_pair2</a></span>.<br/>
<br/>
<h1> Compositionality of local simulations </h1>
<br/>
<div class="doc">This file defines and proves compositionality of local simulations.
    It says when modules of source and target programs are locally simulated, 
    then we could deduce a global downward simulation on whole programs.
 </div>
<br/>
<span class="kwd">Definition</span> <span class="id">reach_close</span>' {<span class="id">NL</span>} {<span class="id">L</span>} (<span class="id">c</span> : @<span class="id"><a href="GAST.html#cunit">cunit</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="ReachClose.html#reach_close">reach_close</a></span> (<span class="id"><a href="Compositionality.html#c">c</a></span>.(<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>)).<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rc_cunits">rc_cunits</a></span> {<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">L</span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span>} (<span class="id">cus</span>: <span class="id"><a href="GAST.html#cunits">cunits</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">reach_close</span>' <span class="id"><a href="Compositionality.html#cus">cus</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ldsims">ldsims</a></span> {<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">L</span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span>} <span class="id">scus</span> <span class="id">tcus</span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="kwd">fun</span> <span class="id">scu</span> <span class="id">tcu</span> =&gt; <span class="id"><a href="LDSim.html#ldsim">ldsim</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span>.(<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>) <span class="id"><a href="Compositionality.html#tcu">tcu</a></span>.(<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>)) <span class="id"><a href="Compositionality.html#scus">scus</a></span> <span class="id"><a href="Compositionality.html#tcus">tcus</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ldsims_aux">ldsims_aux</a></span> {<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">L</span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span>} <span class="id">scus</span> <span class="id">tcus</span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="kwd">fun</span> <span class="id">scu</span> <span class="id">tcu</span> =&gt; <span class="id"><a href="AuxLDSim.html#ldsim_aux">ldsim_aux</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span>.(<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>) <span class="id"><a href="Compositionality.html#tcu">tcu</a></span>.(<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>)) <span class="id"><a href="Compositionality.html#scus">scus</a></span> <span class="id"><a href="Compositionality.html#tcus">tcus</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ldsim_rc_ldsim_aux_list">ldsim_rc_ldsim_aux_list</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">L</span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span>) (<span class="id">scu</span> <span class="id">tcu</span>: <span class="id"><a href="GAST.html#cunits">cunits</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GAST.html#wd_langs">wd_langs</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Compositionality.html#ldsims">ldsims</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span> <span class="id"><a href="Compositionality.html#tcu">tcu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Compositionality.html#rc_cunits">rc_cunits</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Compositionality.html#ldsims_aux">ldsims_aux</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span> <span class="id"><a href="Compositionality.html#tcu">tcu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9163')">Proof.</div>
<div class="proofscript" id="proof9163">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">NL</span> <span class="id">L</span>. <br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">scu</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">tcu</span>. <span class="id">constructor</span>. <span class="tactic">inversion</span> <span class="id">H0</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">inversion</span> <span class="id">H0</span>. <span class="tactic">inversion</span> <span class="id">H1</span>. <span class="tactic">subst</span>. <span class="tactic">clear</span> <span class="id">H1</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="AuxLDSim.html#ldsim_rc_ldsim_aux">ldsim_rc_ldsim_aux</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHscu</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> <span class="id">cu</span> <span class="id">IN</span>. <span class="tactic">apply</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fn_preserved">fn_preserved</a></span> {<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} {<span class="id">L</span>:@<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span>} (<span class="id">scus</span> <span class="id">tcus</span>: <span class="id"><a href="GAST.html#cunits">cunits</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="kwd">fun</span> <span class="id">scu</span> <span class="id">tcu</span>: <span class="id"><a href="GAST.html#cunit">cunit</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span> =&gt; <span class="id"><a href="InteractionSemantics.html#internal_fn">internal_fn</a></span> (<span class="id"><a href="Compositionality.html#L">L</a></span> (<span class="id"><a href="GAST.html#lid">lid</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span>)) ((<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span> <span class="id"><a href="Compositionality.html#scu">scu</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="InteractionSemantics.html#internal_fn">internal_fn</a></span> (<span class="id"><a href="Compositionality.html#L">L</a></span> (<span class="id"><a href="GAST.html#lid">lid</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span> <span class="id"><a href="Compositionality.html#tcu">tcu</a></span>)) ((<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span> <span class="id"><a href="Compositionality.html#tcu">tcu</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Compositionality.html#scus">scus</a></span> <span class="id"><a href="Compositionality.html#tcus">tcus</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fn_preserved_get_mod_eq">fn_preserved_get_mod_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">NL</span> (<span class="id">L</span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#NL">NL</a></span>) (<span class="id">scus</span> <span class="id">tcus</span>: <span class="id"><a href="GAST.html#cunits">cunits</a></span> <span class="id"><a href="Compositionality.html#L">L</a></span>) <span class="id">SGE</span> <span class="id">TGE</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Compositionality.html#fn_preserved">fn_preserved</a></span> <span class="id"><a href="Compositionality.html#scus">scus</a></span> <span class="id"><a href="Compositionality.html#tcus">tcus</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.init">GlobEnv.init</a></span> <span class="id"><a href="Compositionality.html#scus">scus</a></span> <span class="id"><a href="Compositionality.html#SGE">SGE</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#GlobEnv.init">GlobEnv.init</a></span> <span class="id"><a href="Compositionality.html#tcus">tcus</a></span> <span class="id"><a href="Compositionality.html#TGE">TGE</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fnid</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#option_rel">option_rel</a></span> (<span class="kwd">fun</span> <span class="id">ord1</span> <span class="id">ord2</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq">Nat.eq</a></span> (<span class="id">nat_of_ord</span> <span class="id"><a href="Compositionality.html#ord1">ord1</a></span>) (<span class="id">nat_of_ord</span> <span class="id"><a href="Compositionality.html#ord2">ord2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id"><a href="Compositionality.html#SGE">SGE</a></span> <span class="id"><a href="Compositionality.html#fnid">fnid</a></span>) (<span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id"><a href="Compositionality.html#TGE">TGE</a></span> <span class="id"><a href="Compositionality.html#fnid">fnid</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9164')">Proof.</div>
<div class="proofscript" id="proof9164">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="kwd">fun</span> (<span class="id">ir</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">cui</span>: <span class="id"><a href="GAST.html#cunit">cunit</a></span> <span class="id">L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">let</span> (<span class="id">i</span>, <span class="id">res</span>) := <span class="id"><a href="Compositionality.html#ir">ir</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Compositionality.html#res">res</a></span> <span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="Compositionality.html#res">res</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">fnid</span> (<span class="id"><a href="InteractionSemantics.html#internal_fn">internal_fn</a></span> (<span class="id">L</span> (<span class="id"><a href="GAST.html#lid">lid</a></span> <span class="id">L</span> <span class="id"><a href="Compositionality.html#cui">cui</a></span>)) (<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id">L</span> <span class="id"><a href="Compositionality.html#cui">cui</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="Compositionality.html#res">res</a></span>)) <span class="kwd">as</span> <span class="id">FUN</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id">FUN</span> <span class="id">scus</span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id">FUN</span> <span class="id">tcus</span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">HeqFUN</span> <span class="id">H</span> (0%<span class="id">nat</span>, @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>). <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">HFUN</span> <span class="id">Hfn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hfn</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">replace</span> (<span class="id">FUN</span> <span class="id">p</span> <span class="id">a1</span>) <span class="kwd">with</span> (<span class="id">FUN</span> <span class="id">p</span> <span class="id">b1</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FUN</span>. <span class="tactic">destruct</span> <span class="id">p</span>. <span class="tactic">destruct</span> <span class="id">o</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id">SGE</span> <span class="id">fnid</span>) <span class="kwd">as</span> [[<span class="id">m</span> <span class="id">LTM</span>]|] <span class="id">eqn</span>:<span class="id">GETS</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id">TGE</span> <span class="id">fnid</span>) <span class="kwd">as</span> [[<span class="id">m</span>' <span class="id">LTM</span>']|] <span class="id">eqn</span>:<span class="id">GETT</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETS</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETT</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">constructor</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">HeqFUN</span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">GETS</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">GETS</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span>, <span class="id"><a href="Coqlib.html#list_forall2_length">list_forall2_length</a></span>, &lt;- <span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="kwd">in</span> <span class="id">LTM</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">m</span> <span class="kwd">with</span> (<span class="id">nat_of_ord</span> (<span class="id">Ordinal</span> <span class="id">LTM</span>)) <span class="kwd">in</span> <span class="id">GETS</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETS</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> <span class="id">GETT</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="kwd">in</span> <span class="id">LTM</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="Coqlib.html#list_forall2_length">list_forall2_length</a></span> <span class="kwd">in</span> <span class="id">LTM</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="kwd">in</span> <span class="id">LTM</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">m</span>' <span class="kwd">with</span> (<span class="id">nat_of_ord</span> (<span class="id">Ordinal</span> <span class="id">LTM</span>')) <span class="kwd">in</span> <span class="id">GETT</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETT</span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<br/>
<div class="doc">TODO: move to ? </div>
<span class="kwd">Lemma</span> <span class="id"><a name="init_tp_next">init_tp_next</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">GE</span> <span class="id">e</span> <span class="id">thdp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="GlobDefs.html#ThreadPool.init">ThreadPool.init</a></span> <span class="id"><a href="Compositionality.html#GE">GE</a></span> <span class="id"><a href="Compositionality.html#e">e</a></span> <span class="id"><a href="Compositionality.html#thdp">thdp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.to_nat">Pos.to_nat</a></span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id"><a href="Compositionality.html#thdp">thdp</a></span>) - 1)%<span class="id">nat</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Compositionality.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9165')">Proof.</div>
<div class="proofscript" id="proof9165">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">intros</span> <span class="id">thdp</span> <span class="id">INIT</span>; <span class="id">inv</span> <span class="id">INIT</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHe</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>. <span class="tactic">generalize</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">thdp0</span>). <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#minus_Sn_m">minus_Sn_m</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.Pnat.html#Pos2Nat.inj_succ">Pos2Nat.inj_succ</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.Pnat.html#Pos2Nat.is_pos">Pos2Nat.is_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="init_get_valid_spec">init_get_valid_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">GE</span> <span class="id">e</span> <span class="id">tp</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="GlobDefs.html#ThreadPool.init">ThreadPool.init</a></span> <span class="id"><a href="Compositionality.html#GE">GE</a></span> <span class="id"><a href="Compositionality.html#e">e</a></span> <span class="id"><a href="Compositionality.html#tp">tp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.valid_tid">ThreadPool.valid_tid</a></span> <span class="id"><a href="Compositionality.html#tp">tp</a></span> <span class="id"><a href="Compositionality.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">funid</span> <span class="id">mid</span> <span class="id">cc</span> <span class="id">fid</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id"><a href="Compositionality.html#e">e</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.to_nat">Pos.to_nat</a></span> <span class="id"><a href="Compositionality.html#t">t</a></span> - 1)%<span class="id">nat</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Compositionality.html#funid">funid</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod">GlobEnv.get_mod</a></span> <span class="id"><a href="Compositionality.html#GE">GE</a></span> <span class="id"><a href="Compositionality.html#funid">funid</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Compositionality.html#mid">mid</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="InteractionSemantics.html#init_core">init_core</a></span> (<span class="id"><a href="InteractionSemantics.html#ModSem.lang">ModSem.lang</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="Compositionality.html#GE">GE</a></span> <span class="id"><a href="Compositionality.html#mid">mid</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="InteractionSemantics.html#ModSem.Ge">ModSem.Ge</a></span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id"><a href="Compositionality.html#GE">GE</a></span> <span class="id"><a href="Compositionality.html#mid">mid</a></span>)) <span class="id"><a href="Compositionality.html#funid">funid</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Compositionality.html#cc">cc</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="id"><a href="Compositionality.html#tp">tp</a></span> <span class="id"><a href="Compositionality.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="GlobDefs.html#Core.Build_t">Core.Build_t</a></span> <span class="id"><a href="Compositionality.html#mid">mid</a></span> <span class="id"><a href="Compositionality.html#cc">cc</a></span> <span class="id"><a href="AST.html#signature_main">AST.signature_main</a></span> <span class="id"><a href="Compositionality.html#fid">fid</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9166')">Proof.</div>
<div class="proofscript" id="proof9166">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">subst</span>. <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.nlt_1_r">Pos.nlt_1_r</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">subst</span>. <br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.spawn">ThreadPool.spawn</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.valid_tid">ThreadPool.valid_tid</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Plt_succ_inv">Plt_succ_inv</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">VALID</span>|<span class="id">NEW</span>].<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe</span> <span class="id">thdp</span> <span class="id">t</span> <span class="id">H4</span> <span class="id">VALID</span>). <span class="tactic">destruct</span> <span class="id">IHe</span> <span class="kwd">as</span> (<span class="id">funid</span> &amp; <span class="id">mid</span> &amp; <span class="id">cc</span>' &amp; <span class="id">fid</span> &amp; <span class="id">NTH</span> &amp; <span class="id">GETMOD</span> <span class="comment">(*&amp;&nbsp;GETFID*)</span> &amp; <span class="id">INIT</span> &amp; <span class="id">GETCS</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">funid</span>, <span class="id">mid</span>, <span class="id">cc</span>', <span class="id">fid</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_app1">nth_error_app1</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_Some">nth_error_Some</a></span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.spawn">ThreadPool.spawn</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#Plt_ne">Plt_ne</a></span>; <span class="tactic">eauto</span>.<br/>
<div class="doc">NEW </div>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_tp_next">init_tp_next</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">eexists</span> <span class="id">a</span>, <span class="id">m_id</span>, <span class="id">cc</span>, <span class="id">_</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_app2">nth_error_app2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_length">rev_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_diag">Nat.sub_diag</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_length">rev_length</a></span>, &lt;- <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="comment">(*split;&nbsp;auto.*)</span> <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.spawn">ThreadPool.spawn</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#FLists.get_tfid">FLists.get_tfid</a></span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Compositionality">Compositionality</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">NL</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.L">L</a></span>: @<span class="id"><a href="GAST.html#langs">langs</a></span> <span class="id"><a href="Compositionality.html#Compositionality.NL">NL</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.scunits">scunits</a></span> <span class="id"><a name="Compositionality.tcunits">tcunits</a></span>: @<span class="id"><a href="GAST.html#cunits">cunits</a></span> <span class="id"><a href="Compositionality.html#Compositionality.NL">NL</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="Compositionality.e">e</a></span>: <span class="id"><a href="GAST.html#entries">entries</a></span>).<br/>
<br/>
<div class="doc">The compositionality lemma (Lem. 4) </div>
&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id"><a name="compositionality">compositionality</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
<div class="doc">languages are well-defined </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hwd_src</span>: <span class="id"><a href="GAST.html#wd_langs">wd_langs</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hwd_tgt</span>: <span class="id"><a href="GAST.html#wd_langs">wd_langs</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>)<br/>
<div class="doc">all compilation units are reach-closed </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hrc</span>: <span class="id"><a href="Compositionality.html#rc_cunits">rc_cunits</a></span> (<span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span>))<br/>
<div class="doc">all cunits are ldsimed </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hldsim</span>: <span class="id"><a href="Compositionality.html#ldsims">ldsims</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>)<br/>
<div class="doc">functions exposed to other modules are preserved </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hfn</span>: <span class="id"><a href="Compositionality.html#fn_preserved">fn_preserved</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDSim.html#GlobDSim">GlobDSim</a></span> (<span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span>, <span class="id"><a href="Compositionality.html#Compositionality.e">e</a></span>) (<span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>, <span class="id"><a href="Compositionality.html#Compositionality.e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9167')">Proof.</div>
<div class="proofscript" id="proof9167">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">mu</span> <span class="id">sgm</span> <span class="id">SGE</span> <span class="id">spc</span> <span class="id">tgm</span> <span class="id">TGE</span> <span class="id">tpc</span> <span class="id">t</span> <span class="id">MEMREL</span> <span class="id">SINITCONFIG</span> <span class="id">TINITCONFIG</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hldsim_aux</span>: <span class="id"><a href="Compositionality.html#ldsims_aux">ldsims_aux</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="Compositionality.html#ldsim_rc_ldsim_aux_list">ldsim_rc_ldsim_aux_list</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hrc</span> <span class="id">Hldsim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="Invs.html#glob_index">glob_index</a></span>, <span class="id"><a href="Invs.html#glob_order">glob_order</a></span>, (<span class="id"><a href="Invs.html#match_state">Invs.match_state</a></span> <span class="id">SGE</span> <span class="id">TGE</span> <span class="id">sgm</span> <span class="id">tgm</span> <span class="id">mu</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">spc</span> <span class="kwd">as</span> [<span class="id">stp</span> <span class="id">t1</span> <span class="id">sgm</span>' <span class="id">b1</span>], <span class="id">tpc</span> <span class="kwd">as</span> [<span class="id">ttp</span> <span class="id">t2</span> <span class="id">tgm</span>' <span class="id">b2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">SINITCONFIG</span> <span class="kwd">as</span> [<span class="id">INITSGE</span> <span class="id">INITSM</span> <span class="id">INITSTP</span> <span class="id">SFLWD</span> <span class="id">SFLFREE</span> <span class="id">SMRC</span> <span class="id">STID</span> <span class="id">STPTID</span> <span class="id">SAB</span> <span class="id">SM</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">TINITCONFIG</span> <span class="kwd">as</span> [<span class="id">INITTGE</span> <span class="id">INITTM</span> <span class="id">INITTTP</span> <span class="id">TFLWD</span> <span class="id">TFLFREE</span> <span class="id">TMRC</span> <span class="id">TTID</span> <span class="id">TTPTID</span> <span class="id">TAB</span> <span class="id">TM</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">GEMODSIM</span>: <span class="id"><a href="Invs.html#GE_mod_sim">GE_mod_sim</a></span> <span class="id">SGE</span> <span class="id">TGE</span> <span class="id">mu</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">fnid</span> <span class="id">Is</span> <span class="id">sfid</span> <span class="id">tfid</span> <span class="id">SGETMOD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#fn_preserved_get_mod_eq">fn_preserved_get_mod_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SGETMOD</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H1</span> <span class="id">into</span> <span class="id">TGETMOD</span>, <span class="id">y</span> <span class="id">into</span> <span class="id">It</span>, <span class="id">H2</span> <span class="id">into</span> <span class="id">MIDEQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">It</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.ge_init">GlobEnv.ge_init</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span> <span class="id">SGE</span> <span class="id">INITSGE</span> <span class="id">Is</span>) <span class="kwd">as</span> [<span class="id">scu</span> [<span class="id">NTH</span> <span class="id">MODSEM</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.ge_init">GlobEnv.ge_init</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span> <span class="id">TGE</span> <span class="id">INITTGE</span> <span class="id">It</span>) <span class="kwd">as</span> [<span class="id">tcu</span> [<span class="id">NTH</span>' <span class="id">MODSEM</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">MODSIM</span>: <span class="id"><a href="AuxLDSim.html#ldsim_aux">ldsim_aux</a></span> (<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> <span class="id">scu</span>) (<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> <span class="id">tcu</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">Is</span> <span class="kwd">as</span> [<span class="id">Is</span> <span class="id">HIs</span>], <span class="id">It</span> <span class="kwd">as</span> [<span class="id">It</span> <span class="id">HIt</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">Hldsim_aux</span> <span class="id">NTH</span> <span class="id">NTH</span>' <span class="id">MIDEQ</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq">Nat.eq</a></span>; <span class="tactic">simpl</span>; <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="id">exploit</span> <span class="id"><a href="Compositionality.html#list_forall2_nth_rel">list_forall2_nth_rel</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NTH</span>, <span class="id">NTH</span>'. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">SGE</span> <span class="id">Is</span>) <span class="kwd">as</span> [<span class="id">sl</span> <span class="id">sge</span> <span class="id">sG</span>] <span class="id">eqn</span>:<span class="id">SMODSEM</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.modules">GlobEnv.modules</a></span> <span class="id">TGE</span> <span class="id">It</span>) <span class="kwd">as</span> [<span class="id">tl</span> <span class="id">tge</span> <span class="id">tG</span>] <span class="id">eqn</span>:<span class="id">TMODSEM</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MODSEM</span>. <span class="tactic">apply</span> <span class="id"><a href="Compositionality.html#existTeq">existTeq</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="Compositionality.html#existTeq">existTeq</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MODSEM</span>'. <span class="tactic">apply</span> <span class="id"><a href="Compositionality.html#existTeq">existTeq</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="Compositionality.html#existTeq">existTeq</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">INITSG</span>, <span class="id">H1</span> <span class="id">into</span> <span class="id">INITTG</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">MODSIM</span>; <span class="tactic">eauto</span>.      <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_bound_consist">GlobEnv.ge_bound_consist</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_wd">GlobEnv.ge_wd</a></span>. <span class="tactic">exact</span> <span class="id">INITSGE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2:= <span class="id">Is</span>). <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_bound_consist">GlobEnv.ge_bound_consist</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_wd">GlobEnv.ge_wd</a></span>. <span class="tactic">exact</span> <span class="id">INITTGE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2:= <span class="id">It</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>.      <br/>
<div class="doc">Done: constraints on GE bounds ? </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMREL</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">I</span> &amp; <span class="id">I_order</span> &amp; <span class="id">R</span> &amp; <span class="id">MATCH</span>). <span class="id">exists</span> <span class="id">I</span>, <span class="id">I_order</span>, <span class="id">R</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fnid</span>' <span class="id">argS</span> <span class="id">argT</span> <span class="id">score</span> <span class="id">GARGS</span> <span class="id">ARGREL</span> <span class="id">INITS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">MATCH</span> <span class="kwd">as</span> <span class="id">SIM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AuxLDSim.html#match_init">match_init</a></span> <span class="kwd">in</span> <span class="id">MATCH</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">MATCH</span> <span class="kwd">as</span> (<span class="id">tcore</span> &amp; <span class="id">INITT</span> &amp; <span class="id">MATCH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">simpl</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">MATCH</span>; <span class="tactic">eauto</span>. <span class="tactic">clear</span> <span class="id">MATCH</span>. <span class="tactic">intros</span> [<span class="id">i</span> <span class="id">MATCH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">eauto</span>.<br/>
<div class="doc">Done: strengthen InitRel: including SGE TGE and ge_init_inj... </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">try</span> (<span class="id">inv</span> <span class="id">MEMREL</span>; <span class="tactic">auto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMREL</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_src</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_bound_consist">GlobEnv.ge_bound_consist</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_wd">GlobEnv.ge_wd</a></span>. <span class="tactic">exact</span> <span class="id">INITSGE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2:= <span class="id">Is</span>). <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMREL</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_tgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_bound_consist">GlobEnv.ge_bound_consist</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#GlobEnv.ge_wd">GlobEnv.ge_wd</a></span>. <span class="tactic">exact</span> <span class="id">INITTGE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2:= <span class="id">It</span>). <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">MEMREL</span>. <span class="id">specialize</span> (<span class="id">ir_senv_init_inj</span> <span class="id">Is</span> <span class="id">It</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#fn_preserved_get_mod_eq">fn_preserved_get_mod_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SGETMOD</span>, <span class="id">TGETMOD</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">specialize</span> (<span class="id">ir_senv_init_inj</span> <span class="id">H2</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SMODSEM</span>, <span class="id">TMODSEM</span> <span class="kwd">in</span> <span class="id">ir_senv_init_inj</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ir_senv_init_inj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Senv.find_symbol">Senv.find_symbol</a></span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">ir_senv_init_inj</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">score</span> <span class="id">tcore</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="id">stp</span> <span class="id">t</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Compositionality.html#score">score</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="id">ttp</span> <span class="id">t</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Compositionality.html#tcore">tcore</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">index</span> <span class="id">index_order</span> <span class="id">i</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Invs.html#CallStack_sim_cur">CallStack_sim_cur</a></span> <span class="id">SGE</span> <span class="id">TGE</span> <span class="id"><a href="Compositionality.html#index">index</a></span> <span class="id"><a href="Compositionality.html#index_order">index_order</a></span> <span class="id">i</span>' <span class="id">mu</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> (<span class="id"><a href="Compositionality.html#score">score</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">sgm</span> (<span class="id"><a href="Compositionality.html#tcore">tcore</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">tgm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">score</span> &amp; <span class="id">tcore</span> &amp; <span class="id">HSCS</span> &amp; <span class="id">HTCS</span> &amp; <span class="id">index</span> &amp; <span class="id">index_order</span> &amp; <span class="id">i</span>' &amp; <span class="id">CSSIMCUR</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_get_valid_spec">init_get_valid_spec</a></span>; <span class="tactic">try</span> <span class="id">eexact</span> <span class="id">INITSTP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">funid</span> &amp; <span class="id">mid</span> &amp; <span class="id">cc</span> &amp; <span class="id">fid</span> &amp; <span class="id">NTH</span> &amp; <span class="id">GETMOD</span> &amp; <span class="id">INIT</span> &amp; <span class="id">GETCS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_get_valid_spec">init_get_valid_spec</a></span>; <span class="tactic">try</span> <span class="id">eexact</span> <span class="id">INITTTP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">funid</span>' &amp; <span class="id">mid</span>' &amp; <span class="id">cc</span>' &amp; <span class="id">fid</span>' &amp; <span class="id">NTH</span>' &amp; <span class="id">GETMOD</span>' &amp; <span class="id">INIT</span>' &amp; <span class="id">GETCS</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NTH</span> <span class="kwd">in</span> <span class="id">NTH</span>'. <span class="id">inv</span> <span class="id">NTH</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.M">GlobEnv.M</a></span> <span class="id">SGE</span> = <span class="id"><a href="GlobDefs.html#GlobEnv.M">GlobEnv.M</a></span> <span class="id">TGE</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span>), (<span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>); <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#list_forall2_length">list_forall2_length</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">nat_of_ord</span> <span class="id">mid</span> = <span class="id">nat_of_ord</span> <span class="id">mid</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;by&nbsp;preservation&nbsp;of&nbsp;internal_fn&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETMOD</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETMOD</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="kwd">fun</span> (<span class="id">ir</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">cui</span>: <span class="id"><a href="GAST.html#cunit">cunit</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">let</span> (<span class="id">i</span>, <span class="id">res</span>) := <span class="id"><a href="Compositionality.html#ir">ir</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Compositionality.html#res">res</a></span> <span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="Compositionality.html#res">res</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">funid</span>' (<span class="id"><a href="InteractionSemantics.html#internal_fn">internal_fn</a></span> (<span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> (<span class="id"><a href="GAST.html#lid">lid</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> <span class="id"><a href="Compositionality.html#cui">cui</a></span>)) (<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> <span class="id"><a href="Compositionality.html#cui">cui</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="Compositionality.html#res">res</a></span>)) <span class="kwd">as</span> <span class="id">FUN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id">FUN</span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id">FUN</span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">HeqFUN</span> <span class="id">Hfn</span> (0%<span class="id">nat</span>, @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>). <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">HFUN</span> <span class="id">Hfn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hfn</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">replace</span> (<span class="id">FUN</span> <span class="id">p</span> <span class="id">a1</span>) <span class="kwd">with</span> (<span class="id">FUN</span> <span class="id">p</span> <span class="id">b1</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FUN</span>. <span class="tactic">destruct</span> <span class="id">p</span>. <span class="tactic">destruct</span> <span class="id">o</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">GETMOD</span>. <span class="tactic">rewrite</span> <span class="id">GETMOD</span> <span class="kwd">in</span> <span class="id">GETMOD</span>'. <span class="id">inv</span> <span class="id">GETMOD</span>'; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">eauto</span>).<br/>
<div class="doc">sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">GEMODSIM</span> <span class="id">funid</span>' <span class="id">mid</span> <span class="id">fid</span> <span class="id">fid</span>'). <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">mid</span>'' [<span class="id">GETMOD</span>'' <span class="id">MODSIM</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">GETMOD</span>' <span class="kwd">in</span> <span class="id">GETMOD</span>''. <span class="id">inv</span> <span class="id">GETMOD</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">MODSIM</span> <span class="kwd">as</span> (<span class="id">I</span> &amp; <span class="id">I_order</span> &amp; <span class="id">R</span> &amp; <span class="id">MODSIM</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">MODSIM</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">tcore</span> [<span class="id">INIT</span>'' <span class="id">SIM</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">INIT</span>' <span class="kwd">in</span> <span class="id">INIT</span>''. <span class="id">inv</span> <span class="id">INIT</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIM</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">INITSM</span>. <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">INITTM</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;local_init_rel&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMREL</span>; <span class="id">inv</span> <span class="id">INITSM</span>; <span class="id">inv</span> <span class="id">INITTM</span>; <span class="id">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_weak">Bset.inj_weak</a></span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemAux.html#bset_eq_no_overlap">MemAux.bset_eq_no_overlap</a></span>; <span class="tactic">auto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_src_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemAux.html#bset_eq_no_overlap">MemAux.bset_eq_no_overlap</a></span>; <span class="tactic">auto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_tgt_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#FLists.flist_norep">FLists.flist_norep</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#FLists.flist_norep">FLists.flist_norep</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_src_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_tgt_valid</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;HLRely&nbsp;refl&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMREL</span>. <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">ir_inject</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">unfold</span> <span class="id"><a href="MemAux.html#unchg_freelist">MemAux.unchg_freelist</a></span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMemory.GMem.forward_refl</a></span>, <span class="id"><a href="GMemory.html#GMem.unchanged_on_refl">GMemory.GMem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_src_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_tgt_valid</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SIM</span>. <span class="tactic">intros</span> (<span class="id">i</span> &amp; <span class="id">SIM</span> &amp; <span class="id">MATCH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">I</span>, <span class="id">I_order</span>, <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Invs.html#top_sim">top_sim</a></span>. <span class="id">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">CSSIMCUR</span>; <span class="tactic">subst</span>. <span class="tactic">clear</span> <span class="id">H8</span>. <span class="tactic">destruct</span> <span class="id">H7</span> <span class="kwd">as</span> [[<span class="id">Rcur</span> [<span class="id">RcurSim</span> <span class="id">RcurMatch</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="AuxLDSim.html#index_wf">AuxLDSim.index_wf</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">RcurSim</span>) <span class="kwd">as</span> <span class="id">WF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="Invs.html#i_wrap">i_wrap</a></span> <span class="id">index</span> <span class="id">index_order</span> <span class="id">WF</span> <span class="id">i</span>'). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(**&nbsp;init&nbsp;mem,&nbsp;init&nbsp;fl&nbsp;properties&nbsp;*)</span><br/>
<div class="doc">TODO: strengthen InitRel, validblock &lt;-&gt; Shared mu </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="GMemory.html#GMem.valid_block">GMemory.GMem.valid_block</a></span> <span class="id">sgm</span> <span class="id"><a href="Compositionality.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="Injections.html#SharedSrc">Injections.SharedSrc</a></span> <span class="id">mu</span> <span class="id"><a href="Compositionality.html#b">b</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ir_shared_src_valid">ir_shared_src_valid</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="GMemory.html#GMem.valid_block">GMemory.GMem.valid_block</a></span> <span class="id">tgm</span> <span class="id"><a href="Compositionality.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="Injections.html#SharedTgt">Injections.SharedTgt</a></span> <span class="id">mu</span> <span class="id"><a href="Compositionality.html#b">b</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ir_shared_tgt_valid">ir_shared_tgt_valid</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Invs.html#Config_sim_GConfigDSim">Config_sim_GConfigDSim</a></span>; <span class="tactic">auto</span>.<br/>
<div class="doc">TODO: strengthen InitRel, inject_weak mu ? </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_weak">Bset.inj_weak</a></span>, <span class="id"><a href="GlobDefs.html#ir_mu_wd">ir_mu_wd</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">MEMREL</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemAux.html#bset_eq_no_overlap">MemAux.bset_eq_no_overlap</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="MemAux.html#bset_eq_no_overlap">MemAux.bset_eq_no_overlap</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">tauto</span>.<br/>
<div class="doc">wd_lang </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">inversion</span> <span class="id">INITSGE</span>. <span class="tactic">destruct</span> (<span class="id">ge_init</span> <span class="id">i</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">inversion</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">Hwd_src</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_In">nth_error_In</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">inversion</span> <span class="id">INITTGE</span>. <span class="tactic">destruct</span> (<span class="id">ge_init</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">inversion</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">Hwd_tgt</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_In">nth_error_In</a></span>; <span class="tactic">eauto</span>. }<br/>
<div class="doc">env wd </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INITSGE</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INITTGE</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Invs.html#match_state">match_state</a></span>. <span class="tactic">split</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
<div class="doc">TODO: strengthen InitRel </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">b</span>'. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_injective">Bset.inj_injective</a></span>, <span class="id"><a href="Blockset.html#Bset.inj_weak">Bset.inj_weak</a></span>, <span class="id"><a href="GlobDefs.html#ir_mu_wd">ir_mu_wd</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>, <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>.<br/>
<div class="doc">match state </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMemory.GMem.forward_refl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMemory.GMem.forward_refl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">revert</span> <span class="id">INITSTP</span> <span class="id">INITTTP</span>. <span class="tactic">simpl</span>. <span class="tactic">clear</span>. <span class="id">revert</span> <span class="id">stp</span> <span class="id">ttp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id"><a href="Compositionality.html#Compositionality.e">e</a></span>; <span class="tactic">intros</span> <span class="id">stp</span> <span class="id">ttp</span> <span class="id">SINIT</span> <span class="id">TINIT</span>; <span class="tactic">inversion</span> <span class="id">SINIT</span>; <span class="tactic">inversion</span> <span class="id">TINIT</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">SINIT</span> <span class="id">TINIT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.emp">ThreadPool.emp</a></span>; <span class="tactic">simpl</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gi">PMap.gi</a></span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">t</span>'. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.spawn">ThreadPool.spawn</a></span>, <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_tp_next">init_tp_next</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_tp_next">init_tp_next</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHe0</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span> <span class="id">H8</span>). <span class="tactic">apply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.init_inv">ThreadPool.init_inv</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.init_inv">ThreadPool.init_inv</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">clear</span> <span class="id">H</span>. <span class="tactic">rename</span> <span class="id">H0</span> <span class="id">into</span> <span class="id">NEXTEQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">thdp</span>) (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">thdp0</span>)). <span class="tactic">rewrite</span> <span class="id">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#plt">plt</a></span> <span class="id">t</span>' (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">thdp</span>)) <span class="kwd">as</span> [<span class="id">PLT</span>|<span class="id">PGE</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>; <span class="tactic">try</span> (<span class="tactic">intro</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Plt_ne">Plt_ne</a></span> <span class="kwd">in</span> <span class="id">PLT</span>; <span class="tactic">eauto</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.le_nlt">Pos.le_nlt</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_eq_cases">Pos.lt_eq_cases</a></span> <span class="kwd">in</span> <span class="id">PGE</span>. <span class="tactic">destruct</span> <span class="id">PGE</span> <span class="kwd">as</span> [<span class="id">PGT</span>|<span class="id">EQ</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>; <span class="tactic">try</span> (<span class="tactic">intro</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Plt_ne">Plt_ne</a></span> <span class="kwd">in</span> <span class="id">PGT</span>; <span class="tactic">eauto</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">e1</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id"><a href="GSimDefs.html#match_cs_cons">match_cs_cons</a></span>. <span class="id">constructor</span>; <span class="id">cbv</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">thdp</span>) (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">thdp0</span>) <span class="id">NEXTEQ</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.Pnat.html#Pos2Nat.is_pos">Pos2Nat.is_pos</a></span> <span class="id">t</span>). <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.Pnat.html#Pos2Nat.is_pos">Pos2Nat.is_pos</a></span> <span class="id">t0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.Pnat.html#Pos2Nat.inj_iff">Pos2Nat.inj_iff</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="GSimDefs.html#LFPG_emp">GSimDefs.LFPG_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">Footprint.FP.subset_emp</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.init_inv">ThreadPool.init_inv</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#ThreadPool.init_inv">ThreadPool.init_inv</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">HSCS</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">exists</span> (<span class="id">tcore</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>). <span class="tactic">split</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">until</span> 1. <span class="tactic">intros</span> <span class="id">GETCS</span> <span class="id">GETCS</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">STPTID</span> <span class="id">score</span> <span class="id">tcore</span> <span class="id">HSCS</span> <span class="id">HTCS</span> <span class="id">index</span> <span class="id">index_order</span> <span class="id">i</span>' <span class="id">Rcur</span> <span class="id">CSSIMCUR</span> <span class="id">RcurSim</span> <span class="id">RcurMatch</span> <span class="id">sg_eq_current</span> <span class="id">WF</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">STPTID</span>': <span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id">t0</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">stp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.init_inv">ThreadPool.init_inv</a></span> <span class="id"><a href="Compositionality.html#Compositionality.e">e</a></span> <span class="id">stp</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#plt">plt</a></span> <span class="id">t0</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">stp</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#ThreadPool.tp_finite">ThreadPool.tp_finite</a></span> <span class="kwd">in</span> <span class="id">GETCS</span>. <span class="tactic">discriminate</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">TTPTID</span>': <span class="id"><a href="Coqlib.html#Plt">Plt</a></span> <span class="id">t0</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">ttp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.init_inv">ThreadPool.init_inv</a></span> <span class="id"><a href="Compositionality.html#Compositionality.e">e</a></span> <span class="id">ttp</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#plt">plt</a></span> <span class="id">t0</span> (<span class="id"><a href="GlobDefs.html#ThreadPool.next_tid">ThreadPool.next_tid</a></span> <span class="id">ttp</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">unfold</span> <span class="id"><a href="GlobDefs.html#ThreadPool.get_cs">ThreadPool.get_cs</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#ThreadPool.tp_finite">ThreadPool.tp_finite</a></span> <span class="kwd">in</span> <span class="id">GETCS</span>'. <span class="tactic">discriminate</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_get_valid_spec">init_get_valid_spec</a></span>; <span class="tactic">try</span> <span class="id">eexact</span> <span class="id">STPTID</span>'; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">funid</span> &amp; <span class="id">mid</span> &amp; <span class="id">cc</span> &amp; <span class="id">fid</span> &amp; <span class="id">NTH</span> &amp; <span class="id">GETMOD</span> &amp; <span class="id">INIT</span> &amp; <span class="id">SGETCS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Compositionality.html#init_get_valid_spec">init_get_valid_spec</a></span>; <span class="tactic">try</span> <span class="id">eexact</span> <span class="id">TTPTID</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">funid</span>' &amp; <span class="id">mid</span>' &amp; <span class="id">cc</span>' &amp; <span class="id">fid</span>' &amp; <span class="id">NTH</span>' &amp; <span class="id">GETMOD</span>' &amp; <span class="id">INIT</span>' &amp; <span class="id">TGETCS</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NTH</span> <span class="kwd">in</span> <span class="id">NTH</span>'. <span class="id">inv</span> <span class="id">NTH</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SGETCS</span> <span class="kwd">in</span> <span class="id">GETCS</span>. <span class="id">inv</span> <span class="id">GETCS</span>. <span class="tactic">rewrite</span> <span class="id">TGETCS</span> <span class="kwd">in</span> <span class="id">GETCS</span>'. <span class="id">inv</span> <span class="id">GETCS</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.M">GlobEnv.M</a></span> <span class="id">SGE</span> = <span class="id"><a href="GlobDefs.html#GlobEnv.M">GlobEnv.M</a></span> <span class="id">TGE</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> (<span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span>), (<span class="id"><a href="GlobDefs.html#GlobEnv.mod_num">GlobEnv.mod_num</a></span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span>); <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#list_forall2_length">list_forall2_length</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">nat_of_ord</span> <span class="id">mid</span> = <span class="id">nat_of_ord</span> <span class="id">mid</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;by&nbsp;preservation&nbsp;of&nbsp;internal_fn&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETMOD</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="GlobDefs.html#GlobEnv.get_mod_init">GlobEnv.get_mod_init</a></span> <span class="kwd">in</span> <span class="id">GETMOD</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="kwd">fun</span> (<span class="id">ir</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">cui</span>: <span class="id"><a href="GAST.html#cunit">cunit</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">let</span> (<span class="id">i</span>, <span class="id">res</span>) := <span class="id"><a href="Compositionality.html#ir">ir</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Compositionality.html#res">res</a></span> <span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="Compositionality.html#res">res</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">funid</span>' (<span class="id"><a href="InteractionSemantics.html#internal_fn">internal_fn</a></span> (<span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> (<span class="id"><a href="GAST.html#lid">lid</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> <span class="id"><a href="Compositionality.html#cui">cui</a></span>)) (<span class="id"><a href="GAST.html#cu">cu</a></span> <span class="id"><a href="Compositionality.html#Compositionality.L">L</a></span> <span class="id"><a href="Compositionality.html#cui">cui</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Compositionality.html#i">i</a></span>, <span class="id"><a href="Compositionality.html#res">res</a></span>)) <span class="kwd">as</span> <span class="id">FUN</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id">FUN</span> <span class="id"><a href="Compositionality.html#Compositionality.scunits">scunits</a></span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id">FUN</span> <span class="id"><a href="Compositionality.html#Compositionality.tcunits">tcunits</a></span> (0%<span class="id">nat</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">generalize</span> <span class="id">HeqFUN</span> <span class="id">Hfn</span> (0%<span class="id">nat</span>, @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>). <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">HFUN</span> <span class="id">Hfn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hfn</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">replace</span> (<span class="id">FUN</span> <span class="id">p</span> <span class="id">a1</span>) <span class="kwd">with</span> (<span class="id">FUN</span> <span class="id">p</span> <span class="id">b1</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FUN</span>. <span class="tactic">destruct</span> <span class="id">p</span>. <span class="tactic">destruct</span> <span class="id">o</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">GETMOD</span>. <span class="tactic">rewrite</span> <span class="id">GETMOD</span> <span class="kwd">in</span> <span class="id">GETMOD</span>'. <span class="id">inv</span> <span class="id">GETMOD</span>'; <span class="tactic">auto</span>. }<br/>
<div class="doc">sim </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">GEMODSIM</span> <span class="id">funid</span>' <span class="id">mid</span> <span class="id">fid</span> <span class="id">fid</span>'). <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">mid</span>'' [<span class="id">GETMOD</span>'' <span class="id">MODSIM</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">GETMOD</span>' <span class="kwd">in</span> <span class="id">GETMOD</span>''. <span class="id">inv</span> <span class="id">GETMOD</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">MODSIM</span> <span class="kwd">as</span> (<span class="id">I</span> &amp; <span class="id">I_order</span> &amp; <span class="id">R</span> &amp; <span class="id">MODSIM</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">MODSIM</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">tcore</span> [<span class="id">INIT</span>'' <span class="id">SIM</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">INIT</span>' <span class="kwd">in</span> <span class="id">INIT</span>''. <span class="id">inv</span> <span class="id">INIT</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="id">exists</span> <span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SIM</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">INITSM</span>. <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">INITTM</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;local_init_rel&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MEMREL</span>; <span class="id">inv</span> <span class="id">INITSM</span>; <span class="id">inv</span> <span class="id">INITTM</span>; <span class="id">constructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="Blockset.html#Bset.inj_weak">Bset.inj_weak</a></span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemAux.html#bset_eq_no_overlap">MemAux.bset_eq_no_overlap</a></span>; <span class="tactic">auto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_src_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemAux.html#bset_eq_no_overlap">MemAux.bset_eq_no_overlap</a></span>; <span class="tactic">auto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_tgt_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#FLists.flist_norep">FLists.flist_norep</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GlobDefs.html#FLists.flist_norep">FLists.flist_norep</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_src_valid</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="MemClosures.html#bset_eq_reach_closed">MemClosures.bset_eq_reach_closed</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">ir_shared_tgt_valid</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SIM</span>. <span class="tactic">intros</span> ( <span class="id">i</span> &amp; <span class="id">SIM</span> &amp; <span class="id">MATCH</span>). <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="MemAux.html#unchg_freelist">MemAux.unchg_freelist</a></span>. <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMemory.GMem.forward_refl</a></span>, <span class="id"><a href="GMemory.html#GMem.unchanged_on_refl">GMemory.GMem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="MemAux.html#unchg_freelist">MemAux.unchg_freelist</a></span>. <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMemory.GMem.forward_refl</a></span>, <span class="id"><a href="GMemory.html#GMem.unchanged_on_refl">GMemory.GMem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}      <br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="Compositionality.html#Compositionality">Compositionality</a></span>.<br/>
&nbsp;&nbsp;<br/>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
