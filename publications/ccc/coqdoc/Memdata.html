<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Memdata</title>
<meta name="description" content="Documentation of Coq module Memdata" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Memdata</h1>
<div class="coq">
<br/>
<div class="doc">In-memory representation of values. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="Archi.html">Archi</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Floats.html">Floats</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Values.html">Values</a></span>.<br/>
<br/>
<h1> Properties of memory chunks </h1>
<br/>
<div class="doc">Memory reads and writes are performed by quantities called memory chunks,
  encoding the type, size and signedness of the chunk being addressed.
  The following functions extract the size information from a chunk. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="size_chunk">size_chunk</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; 2<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; 2<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; 8<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_chunk_pos">size_chunk_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>, <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> &gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1396')">Proof.</div>
<div class="proofscript" id="proof1396">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="size_chunk_nat">size_chunk_nat</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#nat_of_Z">nat_of_Z</a></span>(<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_chunk_conv">size_chunk_conv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>, <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1397')">Proof.</div>
<div class="proofscript" id="proof1397">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_chunk_nat_pos">size_chunk_nat_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>, <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1398')">Proof.</div>
<div class="proofscript" id="proof1398">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>). <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">exists</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_chunk_Mptr">size_chunk_Mptr</a></span>: <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> = <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> 8 <span class="kwd">else</span> 4.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1399')">Proof.</div>
<div class="proofscript" id="proof1399">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Memory reads and writes must respect alignment constraints:
  the byte offset of the location being addressed should be an exact
  multiple of the natural alignment for the chunk being addressed.
  This natural alignment is defined by the following
  <span class="bracket"><span class="id">align_chunk</span></span> function.  Some target architectures
  (e.g. PowerPC and x86) have no alignment constraints, which we could
  reflect by taking <span class="bracket"><span class="id">align_chunk</span> <span class="id">chunk</span> = 1</span>.  However, other architectures
  have stronger alignment requirements.  The following definition is
  appropriate for PowerPC, ARM and x86. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="align_chunk">align_chunk</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; 2<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; 2<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; 4<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="align_chunk_pos">align_chunk_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>, <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> &gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1400')">Proof.</div>
<div class="proofscript" id="proof1400">
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="align_chunk_Mptr">align_chunk_Mptr</a></span>: <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> = <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> 8 <span class="kwd">else</span> 4.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1401')">Proof.</div>
<div class="proofscript" id="proof1401">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="align_size_chunk_divides">align_size_chunk_divides</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span>, (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> | <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1402')">Proof.</div>
<div class="proofscript" id="proof1402">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_refl">Zdivide_refl</a></span>; <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="align_le_divides">align_le_divides</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk1</span> <span class="id">chunk2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> &lt;= <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> -&gt; (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> | <span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1403')">Proof.</div>
<div class="proofscript" id="proof1403">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">chunk1</span>; <span class="tactic">destruct</span> <span class="id">chunk2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;<span class="id">solve</span> [ <span class="id">omegaContradiction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_refl">Zdivide_refl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exists</span> 2; <span class="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exists</span> 4; <span class="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">exists</span> 8; <span class="tactic">reflexivity</span> ].<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="quantity">quantity</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="Q32">Q32</a></span> | <span class="id"><a name="Q64">Q64</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="quantity_eq">quantity_eq</a></span> (<span class="id">q1</span> <span class="id">q2</span>: <span class="id"><a href="Memdata.html#quantity">quantity</a></span>) : {<span class="id"><a href="Memdata.html#q1">q1</a></span> = <span class="id"><a href="Memdata.html#q2">q2</a></span>} + {<span class="id"><a href="Memdata.html#q1">q1</a></span> &lt;&gt; <span class="id"><a href="Memdata.html#q2">q2</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1404')">Proof.</div>
<div class="proofscript" id="proof1404">
 <span class="id">decide</span> <span class="id">equality</span>. Defined.</div>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="Memdata.html#quantity_eq">quantity_eq</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="size_quantity_nat">size_quantity_nat</a></span> (<span class="id">q</span>: <span class="id"><a href="Memdata.html#quantity">quantity</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="kwd">with</span> <span class="id"><a href="Memdata.html#Q32">Q32</a></span> =&gt; 4%<span class="id">nat</span> | <span class="id"><a href="Memdata.html#Q64">Q64</a></span> =&gt; 8%<span class="id">nat</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_quantity_nat_pos">size_quantity_nat_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">q</span>, <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1405')">Proof.</div>
<div class="proofscript" id="proof1405">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">q</span>; [<span class="id">exists</span> 3%<span class="id">nat</span> | <span class="id">exists</span> 7%<span class="id">nat</span>]; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Memory values </h1>
<br/>
<div class="doc">A ``memory value'' is a byte-sized quantity that describes the current
  content of a memory cell.  It can be either:
<ul>
<li>
 a concrete 8-bit integer;
</li>
<li>
 a byte-sized fragment of an opaque value;
</li>
<li>
 the special constant <span class="bracket"><span class="id">Undef</span></span> that represents uninitialized memory.
</li>
</ul>
</div>
<br/>
<div class="doc">Values stored in memory cells. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="memval">memval</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Undef">Undef</a></span>: <span class="id"><a href="Memdata.html#memval">memval</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Byte">Byte</a></span>: <span class="id"><a href="Integers.html#byte">byte</a></span> -&gt; <span class="id"><a href="Memdata.html#memval">memval</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Fragment">Fragment</a></span>: <span class="id"><a href="Values.html#val">val</a></span> -&gt; <span class="id"><a href="Memdata.html#quantity">quantity</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="Memdata.html#memval">memval</a></span>.<br/>
<br/>
<h1> Encoding and decoding integers </h1>
<br/>
<div class="doc">We define functions to convert between integers and lists of bytes
  of a given length </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="bytes_of_int">bytes_of_int</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) {<span class="kwd">struct</span> <span class="id">n</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="Integers.html#Byte.repr">Byte.repr</a></span> <span class="id"><a href="Memdata.html#x">x</a></span> :: <span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id">m</span> (<span class="id"><a href="Memdata.html#x">x</a></span> / 256)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="int_of_bytes">int_of_bytes</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0<br/>
&nbsp;&nbsp;| <span class="id">b</span> :: <span class="id">l</span>' =&gt; <span class="id"><a href="Integers.html#Byte.unsigned">Byte.unsigned</a></span> <span class="id">b</span> + <span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> <span class="id">l</span>' * 256<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rev_if_be">rev_if_be</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">List.rev</a></span> <span class="id"><a href="Memdata.html#l">l</a></span> <span class="kwd">else</span> <span class="id"><a href="Memdata.html#l">l</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="encode_int">encode_int</a></span> (<span class="id">sz</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span> (<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#sz">sz</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="decode_int">decode_int</a></span> (<span class="id">b</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> (<span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span> <span class="id"><a href="Memdata.html#b">b</a></span>).<br/>
<br/>
<div class="doc">Length properties </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="length_bytes_of_int">length_bytes_of_int</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>) = <span class="id"><a href="Memdata.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1406')">Proof.</div>
<div class="proofscript" id="proof1406">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="id">decEq</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rev_if_be_length">rev_if_be_length</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1407')">Proof.</div>
<div class="proofscript" id="proof1407">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_length">List.rev_length</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_int_length">encode_int_length</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sz</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span>(<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> <span class="id"><a href="Memdata.html#sz">sz</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>) = <span class="id"><a href="Memdata.html#sz">sz</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1408')">Proof.</div>
<div class="proofscript" id="proof1408">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#rev_if_be_length">rev_if_be_length</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#length_bytes_of_int">length_bytes_of_int</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Decoding after encoding </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_of_bytes_of_int">int_of_bytes_of_int</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> (<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>) = <span class="id"><a href="Memdata.html#x">x</a></span> <span class="id">mod</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> * 8)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1409')">Proof.</div>
<div class="proofscript" id="proof1409">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod_1_r">Zmod_1_r</a></span>. <span class="tactic">auto</span>.<br/>
<span class="id">Opaque</span> <span class="id"><a href="Integers.html#Byte.wordsize">Byte.wordsize</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zsucc">Zsucc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id">n</span>) * 8) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id">n</span> * 8 + 8) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#Zmod_recombine">Zmod_recombine</a></span>. <span class="tactic">rewrite</span> <span class="id">IHn</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="Integers.html#Byte.unsigned">Byte.unsigned</a></span> (<span class="id"><a href="Integers.html#Byte.repr">Byte.repr</a></span> <span class="id">x</span>)) <span class="kwd">with</span> (<span class="id"><a href="Integers.html#Byte.Z_mod_modulus">Byte.Z_mod_modulus</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Byte.Z_mod_modulus_eq">Byte.Z_mod_modulus_eq</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rev_if_be_involutive">rev_if_be_involutive</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span> (<span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>) = <span class="id"><a href="Memdata.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1410')">Proof.</div>
<div class="proofscript" id="proof1410">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_involutive">List.rev_involutive</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_int">decode_encode_int</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">x</span>, <span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>) = <span class="id"><a href="Memdata.html#x">x</a></span> <span class="id">mod</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> * 8)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1411')">Proof.</div>
<div class="proofscript" id="proof1411">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_int">decode_int</a></span>, <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#rev_if_be_involutive">rev_if_be_involutive</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#int_of_bytes_of_int">int_of_bytes_of_int</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_int_1">decode_encode_int_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 1 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>))) = <span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 <span class="id"><a href="Memdata.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1412')">Proof.</div>
<div class="proofscript" id="proof1412">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int">decode_encode_int</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Integers.html#Int.repr_unsigned">Int.repr_unsigned</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.zero_ext_mod">Int.zero_ext_mod</a></span>. <span class="tactic">compute</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_int_2">decode_encode_int_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 2 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>))) = <span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 <span class="id"><a href="Memdata.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1413')">Proof.</div>
<div class="proofscript" id="proof1413">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int">decode_encode_int</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Integers.html#Int.repr_unsigned">Int.repr_unsigned</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.zero_ext_mod">Int.zero_ext_mod</a></span>. <span class="tactic">compute</span>; <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_int_4">decode_encode_int_4</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 4 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>))) = <span class="id"><a href="Memdata.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1414')">Proof.</div>
<div class="proofscript" id="proof1414">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int">decode_encode_int</a></span>. <span class="tactic">transitivity</span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zmod_small">Zmod_small</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_range">Int.unsigned_range</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.repr_unsigned">Int.repr_unsigned</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_int_8">decode_encode_int_8</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 8 (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="Memdata.html#x">x</a></span>))) = <span class="id"><a href="Memdata.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1415')">Proof.</div>
<div class="proofscript" id="proof1415">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int">decode_encode_int</a></span>. <span class="tactic">transitivity</span> (<span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zmod_small">Zmod_small</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int64.unsigned_range">Int64.unsigned_range</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int64.repr_unsigned">Int64.repr_unsigned</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">A length-<span class="bracket"><span class="id">n</span></span> encoding depends only on the low <span class="bracket">8*<span class="id">n</span></span> bits of the integer. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bytes_of_int_mod">bytes_of_int_mod</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Int.eqmod">Int.eqmod</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> * 8)) <span class="id"><a href="Memdata.html#x">x</a></span> <span class="id"><a href="Memdata.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#x">x</a></span> = <span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1416')">Proof.</div>
<div class="proofscript" id="proof1416">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zsucc">Zsucc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id">n</span>) * 8) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id">n</span> * 8 + 8) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQM</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Integers.html#Byte.eqm_samerepr">Byte.eqm_samerepr</a></span>. <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Integers.html#Int.eqmod_divides">Int.eqmod_divides</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_factor_l">Zdivide_factor_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">EQM</span> <span class="kwd">as</span> [<span class="id">k</span> <span class="id">EQ</span>]. <span class="id">exists</span> <span class="id">k</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_plus_full_l">Z_div_plus_full_l</a></span>. <span class="id">decEq</span>. <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 8) <span class="kwd">with</span> 256. <span class="tactic">ring</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_int_8_mod">encode_int_8_mod</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Int.eqmod">Int.eqmod</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 8) <span class="id"><a href="Memdata.html#x">x</a></span> <span class="id"><a href="Memdata.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 1%<span class="id">nat</span> <span class="id"><a href="Memdata.html#x">x</a></span> = <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 1%<span class="id">nat</span> <span class="id"><a href="Memdata.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1417')">Proof.</div>
<div class="proofscript" id="proof1417">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span>. <span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#bytes_of_int_mod">bytes_of_int_mod</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_int_16_mod">encode_int_16_mod</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Integers.html#Int.eqmod">Int.eqmod</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 16) <span class="id"><a href="Memdata.html#x">x</a></span> <span class="id"><a href="Memdata.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 2%<span class="id">nat</span> <span class="id"><a href="Memdata.html#x">x</a></span> = <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 2%<span class="id">nat</span> <span class="id"><a href="Memdata.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1418')">Proof.</div>
<div class="proofscript" id="proof1418">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span>. <span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#bytes_of_int_mod">bytes_of_int_mod</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Encoding and decoding values </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="inj_bytes">inj_bytes</a></span> (<span class="id">bl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="proj_bytes">proj_bytes</a></span> (<span class="id">vl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Integers.html#byte">byte</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id">b</span> :: <span class="id">vl</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">vl</span>' <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">bl</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">b</span> :: <span class="id">bl</span>) <span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="length_inj_bytes">length_inj_bytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bl</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1419')">Proof.</div>
<div class="proofscript" id="proof1419">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">List.map_length</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="proj_inj_bytes">proj_inj_bytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bl</span>, <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1420')">Proof.</div>
<div class="proofscript" id="proof1420">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bl</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHbl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inj_proj_bytes">inj_proj_bytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cl</span> <span class="id">bl</span>, <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#cl">cl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span> -&gt; <span class="id"><a href="Memdata.html#cl">cl</a></span> = <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1421')">Proof.</div>
<div class="proofscript" id="proof1421">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">cl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">cl</span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="inj_value_rec">inj_value_rec</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>) (<span class="id">q</span>: <span class="id"><a href="Memdata.html#quantity">quantity</a></span>) {<span class="kwd">struct</span> <span class="id">n</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">m</span> :: <span class="id"><a href="Memdata.html#inj_value_rec">inj_value_rec</a></span> <span class="id">m</span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="inj_value">inj_value</a></span> (<span class="id">q</span>: <span class="id"><a href="Memdata.html#quantity">quantity</a></span>) (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#inj_value_rec">inj_value_rec</a></span> (<span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>) <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="check_value">check_value</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>) (<span class="id">q</span>: <span class="id"><a href="Memdata.html#quantity">quantity</a></span>) (<span class="id">vl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">n</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#n">n</a></span>, <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span>, <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v</span>' <span class="id">q</span>' <span class="id">m</span>' :: <span class="id">vl</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.eq">Val.eq</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id">v</span>' &amp;&amp; <span class="id"><a href="Memdata.html#quantity_eq">quantity_eq</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">q</span>' &amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat">beq_nat</a></span> <span class="id">m</span> <span class="id">m</span>' &amp;&amp; <span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id">m</span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">vl</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="proj_value">proj_value</a></span> (<span class="id">q</span>: <span class="id"><a href="Memdata.html#quantity">quantity</a></span>) (<span class="id">vl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) : <span class="id"><a href="Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v</span> <span class="id">q</span>' <span class="id">n</span> :: <span class="id">vl</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Memdata.html#check_value">check_value</a></span> (<span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>) <span class="id">v</span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="kwd">then</span> <span class="id">v</span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="encode_val">encode_val</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#v">v</a></span>, <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, (<span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> | <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>) =&gt; <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 1%<span class="id">nat</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, (<span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> | <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>) =&gt; <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 2%<span class="id">nat</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 4%<span class="id">nat</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> 4%<span class="id">nat</span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span> <span class="kwd">else</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#Q32">Q32</a></span> <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 8%<span class="id">nat</span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#Q64">Q64</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> 8%<span class="id">nat</span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> =&gt; <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 4%<span class="id">nat</span> (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Floats.html#Float32.to_bits">Float32.to_bits</a></span> <span class="id">n</span>)))<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> =&gt; <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 8%<span class="id">nat</span> (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> (<span class="id"><a href="Floats.html#Float.to_bits">Float.to_bits</a></span> <span class="id">n</span>)))<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#Q32">Q32</a></span> <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#Q64">Q64</a></span> <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>) <span class="id"><a href="Memdata.html#Undef">Undef</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="decode_val">decode_val</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">vl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span>) : <span class="id"><a href="Values.html#val">val</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">bl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 8 (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 16 (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span>(<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="id"><a href="Values.html#Vlong">Vlong</a></span>(<span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span>(<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> =&gt; <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span>(<span class="id"><a href="Floats.html#Float32.of_bits">Float32.of_bits</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> =&gt; <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span>(<span class="id"><a href="Floats.html#Float.of_bits">Float.of_bits</a></span> (<span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span> (<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> <span class="id">bl</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#Q32">Q32</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#Q32">Q32</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#Q64">Q64</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span>) <span class="kwd">else</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#Q64">Q64</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">solve_encode_val_length</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id">_</span>) = <span class="id">_</span> ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#length_inj_bytes">length_inj_bytes</a></span>; <span class="id">solve_encode_val_length</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> <span class="id">_</span> <span class="id">_</span>) = <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_int_length">encode_int_length</a></span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="kwd">if</span> ?<span class="id">x</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>) = <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?; <span class="id">solve_encode_val_length</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">reflexivity</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_length">encode_val_length</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">v</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span>(<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>) = <span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1422')">Proof.</div>
<div class="proofscript" id="proof1422">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="id">solve_encode_val_length</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="check_inj_value">check_inj_value</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">q</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> (<span class="id"><a href="Memdata.html#inj_value_rec">inj_value_rec</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1423')">Proof.</div>
<div class="proofscript" id="proof1423">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat_refl">beq_nat_refl</a></span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_inj_value">proj_inj_value</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">q</span> <span class="id">v</span>, <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>) = <span class="id"><a href="Memdata.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1424')">Proof.</div>
<div class="proofscript" id="proof1424">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span>, <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_quantity_nat_pos">size_quantity_nat_pos</a></span> <span class="id">q</span>) <span class="kwd">as</span> [<span class="id">n</span> <span class="id">EQ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ</span> <span class="tactic">at</span> 1. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#check_inj_value">check_inj_value</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="in_inj_value">in_inj_value</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mv</span> <span class="id">v</span> <span class="id">q</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>) -&gt; <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1425')">Proof.</div>
<div class="proofscript" id="proof1425">
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">q</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id">q</span>). <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">exists</span> <span class="id">n</span>; <span class="tactic">auto</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_inj_value_mismatch">proj_inj_value_mismatch</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">q1</span> <span class="id">q2</span> <span class="id">v</span>, <span class="id"><a href="Memdata.html#q1">q1</a></span> &lt;&gt; <span class="id"><a href="Memdata.html#q2">q2</a></span> -&gt; <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q1">q1</a></span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q2">q2</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1426')">Proof.</div>
<div class="proofscript" id="proof1426">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id">q2</span> <span class="id">v</span>) <span class="id">eqn</span>:<span class="id">V</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#in_inj_value">in_inj_value</a></span> (<span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v0</span> <span class="id">q</span> <span class="id">n</span>) <span class="id">v</span> <span class="id">q2</span>) <span class="kwd">as</span> [<span class="id">n</span>' <span class="id">EQ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">V</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_quantity_nat_pos">size_quantity_nat_pos</a></span> <span class="id">q1</span>) <span class="kwd">as</span> [<span class="id">p</span> <span class="id">EQ1</span>]; <span class="tactic">rewrite</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_false">dec_eq_false</a></span> <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="decode_encode_val">decode_encode_val</a></span> (<span class="id">v1</span>: <span class="id"><a href="Values.html#val">val</a></span>) (<span class="id">chunk1</span> <span class="id">chunk2</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">v2</span>: <span class="id"><a href="Values.html#val">val</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#v1">v1</a></span>, <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span>, <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vundef">Vundef</a></span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span>, <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 8 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>, <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 8 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span>, <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>, <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span>, <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 16 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>, <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 16 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span>, <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>, <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint32">Mint32</a></span>, <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Many32">Many32</a></span>, <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint32">Mint32</a></span>, <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span>(<span class="id"><a href="Floats.html#Float32.of_bits">Float32.of_bits</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span>, <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, (<span class="id"><a href="AST.html#Mint64">Mint64</a></span> | <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> | <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> | <span class="id"><a href="AST.html#Many64">Many64</a></span>), <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="docright">(* nothing meaningful to say about v2  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, (<span class="id"><a href="AST.html#Mint32">Mint32</a></span> | <span class="id"><a href="AST.html#Many32">Many32</a></span>), (<span class="id"><a href="AST.html#Mint32">Mint32</a></span> | <span class="id"><a href="AST.html#Many32">Many32</a></span>) =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span>, (<span class="id"><a href="AST.html#Mint64">Mint64</a></span> | <span class="id"><a href="AST.html#Many64">Many64</a></span>) =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span>, <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span>, <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span>(<span class="id"><a href="Floats.html#Float.of_bits">Float.of_bits</a></span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span>, <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>, (<span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span>|<span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>|<span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span>|<span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>|<span class="id"><a href="AST.html#Mint32">Mint32</a></span>|<span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span>|<span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span>|<span class="id"><a href="AST.html#Many32">Many32</a></span>), <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="docright">(* nothing meaningful to say about v2  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span>, <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span>, <span class="id"><a href="AST.html#Mint64">Mint64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vlong">Vlong</a></span>(<span class="id"><a href="Floats.html#Float.to_bits">Float.to_bits</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span>, <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span>, (<span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span>|<span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>|<span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span>|<span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>|<span class="id"><a href="AST.html#Mint32">Mint32</a></span>|<span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span>|<span class="id"><a href="AST.html#Mint64">Mint64</a></span>|<span class="id"><a href="AST.html#Many32">Many32</a></span>), <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">f</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>   <br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span>, <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Mfloat32">Mfloat32</a></span>, <span class="id"><a href="AST.html#Mint32">Mint32</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span>(<span class="id"><a href="Floats.html#Float32.to_bits">Float32.to_bits</a></span> <span class="id">f</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Many32">Many32</a></span>, <span class="id"><a href="AST.html#Many32">Many32</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span>, <span class="id"><a href="AST.html#Many64">Many64</a></span>, <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span>, (<span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span>|<span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span>|<span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span>|<span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span>|<span class="id"><a href="AST.html#Mint32">Mint32</a></span>|<span class="id"><a href="AST.html#Mint64">Mint64</a></span>|<span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span>|<span class="id"><a href="AST.html#Many64">Many64</a></span>), <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">f</span>, <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="decode_val_undef">decode_val_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bl</span> <span class="id">chunk</span>, <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#Undef">Undef</a></span> :: <span class="id"><a href="Memdata.html#bl">bl</a></span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1427')">Proof.</div>
<div class="proofscript" id="proof1427">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">chunk</span>, <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="proj_bytes_inj_value">proj_bytes_inj_value</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">q</span> <span class="id">v</span>, <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1428')">Proof.</div>
<div class="proofscript" id="proof1428">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">q</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">solve_decode_encode_val_general</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span> || <span class="tactic">reflexivity</span> ||<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="kwd">if</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:?<br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id">_</span>) ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#proj_inj_bytes">proj_inj_bytes</a></span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#proj_bytes_inj_value">proj_bytes_inj_value</a></span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id">_</span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id">_</span> <span class="id">_</span>) ] =&gt; <span class="tactic">rewrite</span> ?<span class="id"><a href="Memdata.html#proj_inj_value">proj_inj_value</a></span>, ?<span class="id"><a href="Memdata.html#proj_inj_value_mismatch">proj_inj_value_mismatch</a></span> <span class="tactic">by</span> <span class="tactic">congruence</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span>(<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 1 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">_</span>))) ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int_1">decode_encode_int_1</a></span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span>(<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 2 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">_</span>))) ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int_2">decode_encode_int_2</a></span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span>(<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 4 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">_</span>))) ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int_4">decode_encode_int_4</a></span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span> [ <span class="id"><a href="Integers.html#Int64.repr">Int64.repr</a></span>(<span class="id"><a href="Memdata.html#decode_int">decode_int</a></span> (<span class="id"><a href="Memdata.html#encode_int">encode_int</a></span> 8 (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">_</span>))) ] =&gt; <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#decode_encode_int_8">decode_encode_int_8</a></span><br/>
&nbsp;&nbsp;| |- <span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> <span class="id">_</span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> <span class="id">_</span> <span class="id">_</span>)) = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">_</span> =&gt; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.sign_ext_idem">Int.sign_ext_idem</a></span>; <span class="tactic">omega</span><br/>
&nbsp;&nbsp;| |- <span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> <span class="id">_</span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> <span class="id">_</span> <span class="id">_</span>)) = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">_</span> =&gt; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.zero_ext_idem">Int.zero_ext_idem</a></span>; <span class="tactic">omega</span><br/>
&nbsp;&nbsp;| |- <span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> <span class="id">_</span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> <span class="id">_</span> <span class="id">_</span>)) = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">_</span> =&gt; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.sign_ext_zero_ext">Int.sign_ext_zero_ext</a></span>; <span class="tactic">omega</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_val_general">decode_encode_val_general</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">chunk1</span> <span class="id">chunk2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#decode_encode_val">decode_encode_val</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1429')">Proof.</div>
<div class="proofscript" id="proof1429">
<span class="id">Opaque</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">destruct</span> <span class="id">chunk1</span> <span class="id">eqn</span>:<span class="id">C1</span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#decode_val_undef">decode_val_undef</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk2</span> <span class="id">eqn</span>:<span class="id">C2</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_encode_val">decode_encode_val</a></span>, <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>, <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span>;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">solve_decode_encode_val_general</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="Floats.html#Float.of_to_bits">Float.of_to_bits</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="Floats.html#Float32.of_to_bits">Float32.of_to_bits</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_encode_val_similar">decode_encode_val_similar</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v1</span> <span class="id">chunk1</span> <span class="id">chunk2</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="AST.html#type_of_chunk">type_of_chunk</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> = <span class="id"><a href="AST.html#type_of_chunk">type_of_chunk</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> = <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#decode_encode_val">decode_encode_val</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#chunk1">chunk1</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id"><a href="Memdata.html#chunk2">chunk2</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1430')">Proof.</div>
<div class="proofscript" id="proof1430">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">v2</span>; <span class="tactic">intros</span> <span class="id">TY</span> <span class="id">SZ</span> <span class="id">DE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk1</span>; <span class="tactic">destruct</span> <span class="id">chunk2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">TY</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SZ</span>; <span class="tactic">try</span> <span class="id">omegaContradiction</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_val_type">decode_val_type</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">cl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#cl">cl</a></span>) (<span class="id"><a href="AST.html#type_of_chunk">type_of_chunk</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1431')">Proof.</div>
<div class="proofscript" id="proof1431">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">cl</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;(<span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span> || <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.load_result_type">Val.load_result_type</a></span> || <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; (<span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span> || <span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.load_result_type">Val.load_result_type</a></span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int8_signed_unsigned">encode_val_int8_signed_unsigned</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1432')">Proof.</div>
<div class="proofscript" id="proof1432">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int16_signed_unsigned">encode_val_int16_signed_unsigned</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1433')">Proof.</div>
<div class="proofscript" id="proof1433">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int8_zero_ext">encode_val_int8_zero_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 8 <span class="id"><a href="Memdata.html#n">n</a></span>)) = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1434')">Proof.</div>
<div class="proofscript" id="proof1434">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_int_8_mod">encode_int_8_mod</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.eqmod_zero_ext">Int.eqmod_zero_ext</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">compute</span>; <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int8_sign_ext">encode_val_int8_sign_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 8 <span class="id"><a href="Memdata.html#n">n</a></span>)) = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1435')">Proof.</div>
<div class="proofscript" id="proof1435">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_int_8_mod">encode_int_8_mod</a></span>. <span class="tactic">apply</span> <span class="id">Int.eqmod_sign_ext</span>'. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int16_zero_ext">encode_val_int16_zero_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.zero_ext">Int.zero_ext</a></span> 16 <span class="id"><a href="Memdata.html#n">n</a></span>)) = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1436')">Proof.</div>
<div class="proofscript" id="proof1436">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_int_16_mod">encode_int_16_mod</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.eqmod_zero_ext">Int.eqmod_zero_ext</a></span>. <span class="tactic">compute</span>; <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int16_sign_ext">encode_val_int16_sign_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int.sign_ext">Int.sign_ext</a></span> 16 <span class="id"><a href="Memdata.html#n">n</a></span>)) = <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1437')">Proof.</div>
<div class="proofscript" id="proof1437">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="id">decEq</span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#encode_int_16_mod">encode_int_16_mod</a></span>. <span class="tactic">apply</span> <span class="id">Int.eqmod_sign_ext</span>'. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_val_cast">decode_val_cast</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v</span> := <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#l">l</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8signed">Mint8signed</a></span> =&gt; <span class="id"><a href="Memdata.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span> 8 <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint8unsigned">Mint8unsigned</a></span> =&gt; <span class="id"><a href="Memdata.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.zero_ext">Val.zero_ext</a></span> 8 <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16signed">Mint16signed</a></span> =&gt; <span class="id"><a href="Memdata.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span> 16 <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint16unsigned">Mint16unsigned</a></span> =&gt; <span class="id"><a href="Memdata.html#v">v</a></span> = <span class="id"><a href="Values.html#Val.zero_ext">Val.zero_ext</a></span> 16 <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1438')">Proof.</div>
<div class="proofscript" id="proof1438">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">auto</span>; <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.sign_ext_idem">Int.sign_ext_idem</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.zero_ext">Val.zero_ext</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.zero_ext_idem">Int.zero_ext_idem</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.sign_ext">Val.sign_ext</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.sign_ext_idem">Int.sign_ext_idem</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.zero_ext">Val.zero_ext</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int.zero_ext_idem">Int.zero_ext_idem</a></span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Pointers cannot be forged. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="quantity_chunk">quantity_chunk</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="AST.html#Mint64">Mint64</a></span> | <span class="id"><a href="AST.html#Mfloat64">Mfloat64</a></span> | <span class="id"><a href="AST.html#Many64">Many64</a></span> =&gt; <span class="id"><a href="Memdata.html#Q64">Q64</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Memdata.html#Q32">Q32</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="shape_encoding">shape_encoding</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>) (<span class="id">v</span>: <span class="id"><a href="Values.html#val">val</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="shape_encoding_f">shape_encoding_f</a></span>: <span class="kwd">forall</span> <span class="id">q</span> <span class="id">i</span> <span class="id">mvl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#q">q</a></span> = <span class="id"><a href="Memdata.html#quantity_chunk">quantity_chunk</a></span> <span class="id">chunk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#i">i</a></span> = <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvl">mvl</a></span> -&gt; <span class="id">exists</span> <span class="id">j</span>, <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v</span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> &lt;&gt; <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id">chunk</span> <span class="id">v</span> (<span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v</span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#i">i</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="shape_encoding_b">shape_encoding_b</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">mvl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvl">mvl</a></span> -&gt; <span class="id">exists</span> <span class="id">b</span>', <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id">b</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id">chunk</span> <span class="id">v</span> (<span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id"><a href="Memdata.html#b">b</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="shape_encoding_u">shape_encoding_u</a></span>: <span class="kwd">forall</span> <span class="id">mvl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvl">mvl</a></span> -&gt; <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Undef">Undef</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id">chunk</span> <span class="id">v</span> (<span class="id"><a href="Memdata.html#Undef">Undef</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_shape">encode_val_shape</a></span>: <span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">v</span>, <span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1439')">Proof.</div>
<div class="proofscript" id="proof1439">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_chunk_nat_pos">size_chunk_nat_pos</a></span> <span class="id">chunk</span>) <span class="kwd">as</span> [<span class="id">sz</span> <span class="id">EQ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="kwd">forall</span> <span class="id">mv</span> <span class="id">q</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#n">n</a></span> &lt; <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> (<span class="id"><a href="Memdata.html#inj_value_rec">inj_value_rec</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id">v</span> <span class="id"><a href="Memdata.html#q">q</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>, <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v</span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> &lt;&gt; <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">IHn</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">B</span>: <span class="kwd">forall</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#q">q</a></span> = <span class="id"><a href="Memdata.html#quantity_chunk">quantity_chunk</a></span> <span class="id">chunk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id">chunk</span> <span class="id">v</span> (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;{<br/>
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_quantity_nat_pos">size_quantity_nat_pos</a></span> <span class="id">q</span>) <span class="kwd">as</span> [<span class="id">sz</span>' <span class="id">EQ</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ</span>'. <span class="tactic">simpl</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">C</span>: <span class="kwd">forall</span> <span class="id">bl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>) = <span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id">chunk</span> <span class="id">v</span> (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">bl</span> <span class="kwd">as</span> [|<span class="id">b1</span> <span class="id">bl</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">congruence</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">b</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>); <span class="id">exists</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">D</span>: <span class="id"><a href="Memdata.html#shape_encoding">shape_encoding</a></span> <span class="id">chunk</span> <span class="id">v</span> (<span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span>) <span class="id"><a href="Memdata.html#Undef">Undef</a></span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="Coqlib.html#in_list_repeat">in_list_repeat</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="id">chunk</span> <span class="id">v</span>). <span class="tactic">intros</span> <span class="id">LEN</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="kwd">in</span> <span class="id">LEN</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>;<br/>
&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id">B</span> || <span class="tactic">apply</span> <span class="id">C</span> || <span class="tactic">apply</span> <span class="id">D</span> || (<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; (<span class="tactic">apply</span> <span class="id">B</span> || <span class="tactic">apply</span> <span class="id">D</span>)));<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="shape_decoding">shape_decoding</a></span> (<span class="id">chunk</span>: <span class="id"><a href="AST.html#memory_chunk">memory_chunk</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Memdata.html#memval">memval</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="shape_decoding_f">shape_decoding_f</a></span>: <span class="kwd">forall</span> <span class="id">v</span> <span class="id">q</span> <span class="id">i</span> <span class="id">mvl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#q">q</a></span> = <span class="id"><a href="Memdata.html#quantity_chunk">quantity_chunk</a></span> <span class="id">chunk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#i">i</a></span> = <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvl">mvl</a></span> -&gt; <span class="id">exists</span> <span class="id">j</span>, <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> &lt;&gt; <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id">chunk</span> (<span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#i">i</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>) (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span> <span class="id"><a href="Memdata.html#v">v</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="shape_decoding_b">shape_decoding_b</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">mvl</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="kwd">with</span> <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vfloat">Vfloat</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="Values.html#Vsingle">Vsingle</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> |  <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvl">mvl</a></span> -&gt; <span class="id">exists</span> <span class="id">b</span>', <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id">b</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id">chunk</span> (<span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id"><a href="Memdata.html#b">b</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>) <span class="id"><a href="Memdata.html#v">v</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="shape_decoding_u">shape_decoding_u</a></span>: <span class="kwd">forall</span> <span class="id">mvl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id">chunk</span> <span class="id"><a href="Memdata.html#mvl">mvl</a></span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_val_shape">decode_val_shape</a></span>: <span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">mv1</span> <span class="id">mvl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#mv1">mv1</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>) (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> (<span class="id"><a href="Memdata.html#mv1">mv1</a></span> :: <span class="id"><a href="Memdata.html#mvl">mvl</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1440')">Proof.</div>
<div class="proofscript" id="proof1440">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="kwd">forall</span> <span class="id">mv</span> <span class="id">mvs</span> <span class="id">bs</span>, <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#mvs">mvs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memdata.html#bs">bs</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvs">mvs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id"><a href="Memdata.html#b">b</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">mvs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="id">exists</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">mvs</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">B</span>: <span class="kwd">forall</span> <span class="id">v</span> <span class="id">q</span> <span class="id">mv</span> <span class="id">n</span> <span class="id">mvs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#mvs">mvs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mvs">mvs</a></span> -&gt; (<span class="id"><a href="Memdata.html#n">n</a></span> &lt; <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>, <span class="id"><a href="Memdata.html#mv">mv</a></span> = <span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="Memdata.html#j">j</a></span> &lt;&gt; <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">destruct</span> <span class="id">mvs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">InvBooleans</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat_true">beq_nat_true</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">subst</span> <span class="id">mv</span>. <span class="id">exists</span> <span class="id">n0</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHn</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">U</span>: <span class="kwd">forall</span> <span class="id">mvs</span>, <span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id">chunk</span> <span class="id"><a href="Memdata.html#mvs">mvs</a></span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">replace</span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>) <span class="kwd">with</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">C</span>: <span class="kwd">forall</span> <span class="id">q</span>, <span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> = <span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id">chunk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint32">Mint32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many32">Many32</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Mint64">Mint64</a></span> \/ <span class="id">chunk</span> = <span class="id"><a href="AST.html#Many64">Many64</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#shape_decoding">shape_decoding</a></span> <span class="id">chunk</span> (<span class="id">mv1</span> :: <span class="id">mvl</span>) (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> (<span class="id">mv1</span> :: <span class="id">mvl</span>)))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span>. <span class="tactic">destruct</span> <span class="id">mv1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#size_quantity_nat_pos">size_quantity_nat_pos</a></span> <span class="id">q</span>) <span class="kwd">as</span> [<span class="id">sz</span> <span class="id">EQ</span>]. <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#quantity_eq">quantity_eq</a></span> <span class="id">q</span> <span class="id">q0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat">beq_nat</a></span> <span class="id">sz</span> <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">EQN</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id">sz</span> <span class="id">v</span> <span class="id">q</span> <span class="id">mvl</span>) <span class="id">eqn</span>:<span class="id">CHECK</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat_true">beq_nat_true</a></span> <span class="kwd">in</span> <span class="id">EQN</span>. <span class="tactic">subst</span> <span class="id">n</span> <span class="id">q0</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">E</span>|[<span class="id">E</span>|[<span class="id">E</span>|<span class="id">E</span>]]]; <span class="tactic">subst</span> <span class="id">chunk</span>; <span class="tactic">destruct</span> <span class="id">q</span>; <span class="tactic">auto</span> || <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> (<span class="id">mv1</span> :: <span class="id">mvl</span>)) <span class="kwd">as</span> [<span class="id">bl</span>|] <span class="id">eqn</span>:<span class="id">PB</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">A</span> <span class="id">mv1</span>); <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">intros</span> [<span class="id">b1</span> <span class="id">EQ1</span>]; <span class="tactic">subst</span> <span class="id">mv1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; (<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#shape_decoding_u">shape_decoding_u</a></span> || <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#shape_decoding_b">shape_decoding_b</a></span>); <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>, <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; (<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#shape_decoding_u">shape_decoding_u</a></span> || <span class="tactic">apply</span> <span class="id">C</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Compatibility with memory injections </h1>
<br/>
<div class="doc">Relating two memory values according to a memory injection. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="memval_inject">memval_inject</a></span> (<span class="id">f</span>: <span class="id"><a href="Values.html#meminj">meminj</a></span>): <span class="id"><a href="Memdata.html#memval">memval</a></span> -&gt; <span class="id"><a href="Memdata.html#memval">memval</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="memval_inject_byte">memval_inject_byte</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id">f</span> (<span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>) (<span class="id"><a href="Memdata.html#Byte">Byte</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="memval_inject_frag">memval_inject_frag</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">q</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">f</span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id">f</span> (<span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>) (<span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#n">n</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="memval_inject_undef">memval_inject_undef</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id">f</span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="memval_inject_incr">memval_inject_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">v1</span> <span class="id">v2</span>, <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> -&gt; <span class="id"><a href="Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id">f</span>' -&gt; <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id">f</span>' <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1441')">Proof.</div>
<div class="proofscript" id="proof1441">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="Values.html#val_inject_incr">val_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">decode_val</span></span>, applied to lists of memory values that are pairwise
  related by <span class="bracket"><span class="id">memval_inject</span></span>, returns values that are related by <span class="bracket"><span class="id">Val.inject</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_bytes_inject">proj_bytes_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">vl</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="id">vl</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">vl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1442')">Proof.</div>
<div class="proofscript" id="proof1442">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">al</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> (<span class="id">IHlist_forall2</span> <span class="id">l</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="check_value_inject">check_value_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">vl</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="id">vl</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">q</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id">v</span>' -&gt; <span class="id"><a href="Memdata.html#v">v</a></span> &lt;&gt; <span class="id"><a href="Values.html#Vundef">Vundef</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id">v</span>' <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">vl</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1443')">Proof.</div>
<div class="proofscript" id="proof1443">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">assert</span> (<span class="id">n</span> = <span class="id">n0</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat_true">beq_nat_true</a></span>; <span class="tactic">auto</span>). <span class="tactic">subst</span> <span class="id">v1</span> <span class="id">q0</span> <span class="id">n0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">v2</span> <span class="kwd">with</span> <span class="id">v</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Coqlib.html#proj_sumbool">proj_sumbool</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat_refl">beq_nat_refl</a></span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="id">inv</span> <span class="id">H4</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_value_inject">proj_value_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">q</span> <span class="id">vl1</span> <span class="id">vl2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) <span class="id"><a href="Memdata.html#vl1">vl1</a></span> <span class="id"><a href="Memdata.html#vl2">vl2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#vl1">vl1</a></span>) (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#vl2">vl2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1444')">Proof.</div>
<div class="proofscript" id="proof1444">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#check_value">check_value</a></span> (<span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id">q</span>) <span class="id">v1</span> <span class="id">q</span> (<span class="id"><a href="Memdata.html#Fragment">Fragment</a></span> <span class="id">v1</span> <span class="id">q0</span> <span class="id">n</span> :: <span class="id">al</span>)) <span class="id">eqn</span>:<span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Values.html#Val.eq">Val.eq</a></span> <span class="id">v1</span> <span class="id"><a href="Values.html#Vundef">Vundef</a></span>). <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Memdata.html#check_value_inject">check_value_inject</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_bytes_not_inject">proj_bytes_not_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">vl</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) <span class="id"><a href="Memdata.html#vl">vl</a></span> <span class="id">vl</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">vl</span>' &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1445')">Proof.</div>
<div class="proofscript" id="proof1445">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">apply</span> <span class="id">IHlist_forall2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">al</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">bl</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="check_value_undef">check_value_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">q</span> <span class="id">v</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> -&gt; <span class="id"><a href="Memdata.html#check_value">check_value</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1446')">Proof.</div>
<div class="proofscript" id="proof1446">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHn</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_r">andb_false_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_value_undef">proj_value_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">q</span> <span class="id">vl</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> -&gt; <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1447')">Proof.</div>
<div class="proofscript" id="proof1447">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#proj_value">proj_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">vl</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#check_value_undef">check_value_undef</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="decode_val_inject">decode_val_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">vl1</span> <span class="id">vl2</span> <span class="id">chunk</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) <span class="id"><a href="Memdata.html#vl1">vl1</a></span> <span class="id"><a href="Memdata.html#vl2">vl2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#vl1">vl1</a></span>) (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#vl2">vl2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1448')">Proof.</div>
<div class="proofscript" id="proof1448">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">vl1</span>) <span class="kwd">as</span> [<span class="id">bl1</span>|] <span class="id">eqn</span>:<span class="id">PB1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memdata.html#proj_bytes_inject">proj_bytes_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">PB2</span>. <span class="tactic">rewrite</span> <span class="id">PB2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="kwd">forall</span> <span class="id">q</span> <span class="id">fn</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id">f</span> (<span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">vl1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">vl2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">bl</span> =&gt; <span class="id"><a href="Memdata.html#fn">fn</a></span> <span class="id">bl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Values.html#Val.load_result">Val.load_result</a></span> <span class="id">chunk</span> (<span class="id"><a href="Memdata.html#proj_value">proj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id">vl2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">vl2</span>) <span class="kwd">as</span> [<span class="id">bl2</span>|] <span class="id">eqn</span>:<span class="id">PB2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#proj_value_undef">proj_value_undef</a></span>. <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Memdata.html#proj_bytes_not_inject">proj_bytes_not_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.load_result_inject">Val.load_result_inject</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#proj_value_inject">proj_value_inject</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Symmetrically, <span class="bracket"><span class="id">encode_val</span></span>, applied to values related by <span class="bracket"><span class="id">Val.inject</span></span>,
  returns lists of memory values that are pairwise
  related by <span class="bracket"><span class="id">memval_inject</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inj_bytes_inject">inj_bytes_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">bl</span>, <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>) (<span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span> <span class="id"><a href="Memdata.html#bl">bl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1449')">Proof.</div>
<div class="proofscript" id="proof1449">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="repeat_Undef_inject_any">repeat_Undef_inject_any</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) (<span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#vl">vl</a></span>) <span class="id"><a href="Memdata.html#Undef">Undef</a></span>) <span class="id"><a href="Memdata.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1450')">Proof.</div>
<div class="proofscript" id="proof1450">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">vl</span>; <span class="tactic">simpl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="repeat_Undef_inject_encode_val">repeat_Undef_inject_encode_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">chunk</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) (<span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> (<span class="id"><a href="Memdata.html#size_chunk_nat">size_chunk_nat</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span>) <span class="id"><a href="Memdata.html#Undef">Undef</a></span>) (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1451')">Proof.</div>
<div class="proofscript" id="proof1451">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span> <span class="id">chunk</span> <span class="id">v</span>). <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#repeat_Undef_inject_any">repeat_Undef_inject_any</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="repeat_Undef_inject_self">repeat_Undef_inject_self</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) (<span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span>) (<span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span> <span class="id"><a href="Memdata.html#n">n</a></span> <span class="id"><a href="Memdata.html#Undef">Undef</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1452')">Proof.</div>
<div class="proofscript" id="proof1452">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inj_value_inject">inj_value_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">q</span>, <span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> -&gt; <span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span>) (<span class="id"><a href="Memdata.html#inj_value">inj_value</a></span> <span class="id"><a href="Memdata.html#q">q</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1453')">Proof.</div>
<div class="proofscript" id="proof1453">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#inj_value">inj_value</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#size_quantity_nat">size_quantity_nat</a></span> <span class="id">q</span>). <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="encode_val_inject">encode_val_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">chunk</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span>) (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span>) (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="Memdata.html#chunk">chunk</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1454')">Proof.</div>
<div class="proofscript" id="proof1454">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="Coqlib.html#list_repeat">list_repeat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>;<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Memdata.html#inj_bytes_inject">inj_bytes_inject</a></span>, <span class="id"><a href="Memdata.html#inj_value_inject">inj_value_inject</a></span>, <span class="id"><a href="Memdata.html#repeat_Undef_inject_self">repeat_Undef_inject_self</a></span>, <span class="id"><a href="Memdata.html#repeat_Undef_inject_encode_val">repeat_Undef_inject_encode_val</a></span>.<br/>
- <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Memdata.html#inj_value_inject">inj_value_inject</a></span>, <span class="id"><a href="Memdata.html#repeat_Undef_inject_self">repeat_Undef_inject_self</a></span>.<br/>
- <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Memdata.html#inj_value_inject">inj_value_inject</a></span>, <span class="id"><a href="Memdata.html#repeat_Undef_inject_self">repeat_Undef_inject_self</a></span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="tactic">destruct</span> <span class="id">v2</span>; <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#inj_value_inject">inj_value_inject</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="tactic">destruct</span> <span class="id">v2</span>; <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#inj_value_inject">inj_value_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="memval_lessdef">memval_lessdef</a></span>: <span class="id"><a href="Memdata.html#memval">memval</a></span> -&gt; <span class="id"><a href="Memdata.html#memval">memval</a></span> -&gt; <span class="kwd">Prop</span> := <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Values.html#inject_id">inject_id</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="memval_lessdef_refl">memval_lessdef_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mv</span>, <span class="id"><a href="Memdata.html#memval_lessdef">memval_lessdef</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span> <span class="id"><a href="Memdata.html#mv">mv</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1455')">Proof.</div>
<div class="proofscript" id="proof1455">
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">destruct</span> <span class="id">mv</span>; <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="Values.html#val_inject_id">val_inject_id</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">memval_inject</span></span> and compositions </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="memval_inject_compose">memval_inject_compose</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v2">v2</a></span> -&gt; <span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> <span class="id">f</span>' <span class="id"><a href="Memdata.html#v2">v2</a></span> <span class="id"><a href="Memdata.html#v3">v3</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#memval_inject">memval_inject</a></span> (<span class="id"><a href="Values.html#compose_meminj">compose_meminj</a></span> <span class="id"><a href="Memdata.html#f">f</a></span> <span class="id">f</span>') <span class="id"><a href="Memdata.html#v1">v1</a></span> <span class="id"><a href="Memdata.html#v3">v3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1456')">Proof.</div>
<div class="proofscript" id="proof1456">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Values.html#val_inject_compose">val_inject_compose</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<h1> Breaking 64-bit memory accesses into two 32-bit accesses </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_of_bytes_append">int_of_bytes_append</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l2</span> <span class="id">l1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> (<span class="id"><a href="Memdata.html#l1">l1</a></span> ++ <span class="id"><a href="Memdata.html#l2">l2</a></span>) = <span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> <span class="id"><a href="Memdata.html#l1">l1</a></span> + <span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> <span class="id"><a href="Memdata.html#l2">l2</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l1">l1</a></span>) * 8).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1457')">Proof.</div>
<div class="proofscript" id="proof1457">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span> <span class="id">int_of_bytes</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">length</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>)) * 8) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>) * 8 + 8) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>. <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 8) <span class="kwd">with</span> 256. <span class="tactic">rewrite</span> <span class="id">IHl1</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_of_bytes_range">int_of_bytes_range</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, 0 &lt;= <span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> <span class="id"><a href="Memdata.html#l">l</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>) * 8).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1458')">Proof.</div>
<div class="proofscript" id="proof1458">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">length</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>)) * 8) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) * 8 + 8) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>. <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 8) <span class="kwd">with</span> 256.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">int_of_bytes</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Integers.html#Byte.unsigned_range">Byte.unsigned_range</a></span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id"><a href="Integers.html#Byte.modulus">Byte.modulus</a></span> <span class="kwd">with</span> 256. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="length_proj_bytes">length_proj_bytes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">b</span>, <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Memdata.html#b">b</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1459')">Proof.</div>
<div class="proofscript" id="proof1459">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l</span>) <span class="id">eqn</span>:<span class="id">E</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">f_equal</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proj_bytes_append">proj_bytes_append</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l2</span> <span class="id">l1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> (<span class="id"><a href="Memdata.html#l1">l1</a></span> ++ <span class="id"><a href="Memdata.html#l2">l2</a></span>) =<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#l1">l1</a></span>, <span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id"><a href="Memdata.html#l2">l2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b2</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">b1</span> ++ <span class="id">b2</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1460')">Proof.</div>
<div class="proofscript" id="proof1460">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHl1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l1</span>); <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l2</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="decode_val_int64">decode_val_int64</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l1">l1</a></span> = 4%<span class="id">nat</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l2">l2</a></span> = 4%<span class="id">nat</span> -&gt; <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.lessdef">Val.lessdef</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span> (<span class="id"><a href="Memdata.html#l1">l1</a></span> ++ <span class="id"><a href="Memdata.html#l2">l2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span> (<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Memdata.html#l1">l1</a></span> <span class="kwd">else</span> <span class="id"><a href="Memdata.html#l2">l2</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Memdata.html#decode_val">decode_val</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Memdata.html#l2">l2</a></span> <span class="kwd">else</span> <span class="id"><a href="Memdata.html#l1">l1</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1461')">Proof.</div>
<div class="proofscript" id="proof1461">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_val">decode_val</a></span>. <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#proj_bytes_append">proj_bytes_append</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l1</span>) <span class="kwd">as</span> [<span class="id">b1</span>|] <span class="id">eqn</span>:<span class="id">B1</span>; <span class="tactic">destruct</span> (<span class="id"><a href="Memdata.html#proj_bytes">proj_bytes</a></span> <span class="id">l2</span>) <span class="kwd">as</span> [<span class="id">b2</span>|] <span class="id">eqn</span>:<span class="id">B2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memdata.html#length_proj_bytes">length_proj_bytes</a></span>. <span class="id">eexact</span> <span class="id">B1</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">intro</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Memdata.html#length_proj_bytes">length_proj_bytes</a></span>. <span class="id">eexact</span> <span class="id">B2</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">intro</span> <span class="id">L2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">UR</span>: <span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="Memdata.html#l">l</a></span> = 4%<span class="id">nat</span> -&gt; <span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>)) = <span class="id"><a href="Memdata.html#int_of_bytes">int_of_bytes</a></span> <span class="id"><a href="Memdata.html#l">l</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Memdata.html#int_of_bytes_range">int_of_bytes_range</a></span> <span class="id">l</span>). <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> 4 * 8)) <span class="kwd">with</span> (<span class="id"><a href="Integers.html#Int.max_unsigned">Int.max_unsigned</a></span> + 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Values.html#Val.lessdef_same">Val.lessdef_same</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#decode_int">decode_int</a></span>, <span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span>; <span class="tactic">rewrite</span> <span class="id">B1</span>; <span class="tactic">rewrite</span> <span class="id">B2</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_length">rev_length</a></span> <span class="id">b1</span>) <span class="kwd">in</span> <span class="id">L1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_length">rev_length</a></span> <span class="id">b2</span>) <span class="kwd">in</span> <span class="id">L2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_app_distr">rev_app_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">b1</span>' := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">b1</span>) <span class="kwd">in</span> *; <span class="tactic">set</span> (<span class="id">b2</span>' := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">b2</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int64.ofwords_add">Int64.ofwords_add</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id">UR</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#int_of_bytes_append">int_of_bytes_append</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L2</span>. <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> 4 * 8) <span class="kwd">with</span> 32. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.longofwords">Val.longofwords</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int64.ofwords_add">Int64.ofwords_add</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id">UR</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#int_of_bytes_append">int_of_bytes_append</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">L1</span>. <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> 4 * 8) <span class="kwd">with</span> 32. <span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bytes_of_int_append">bytes_of_int_append</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n2</span> <span class="id">x2</span> <span class="id">n1</span> <span class="id">x1</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="Memdata.html#x1">x1</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="Memdata.html#n1">n1</a></span> * 8) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> (<span class="id"><a href="Memdata.html#n1">n1</a></span> + <span class="id"><a href="Memdata.html#n2">n2</a></span>) (<span class="id"><a href="Memdata.html#x1">x1</a></span> + <span class="id"><a href="Memdata.html#x2">x2</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> <span class="id"><a href="Memdata.html#n1">n1</a></span> * 8)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#n1">n1</a></span> <span class="id"><a href="Memdata.html#x1">x1</a></span> ++ <span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> <span class="id"><a href="Memdata.html#n2">n2</a></span> <span class="id"><a href="Memdata.html#x2">x2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1462')">Proof.</div>
<div class="proofscript" id="proof1462">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n1</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">f_equal</span>. <span class="tactic">omega</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">E</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n1</span>) * 8) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n1</span> * 8) * 256).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>. <span class="id">change</span> 256 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 8). <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> *. <span class="tactic">simpl</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Integers.html#Byte.eqm_samerepr">Byte.eqm_samerepr</a></span>. <span class="id">exists</span> (<span class="id">x2</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n1</span> * 8)).<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id"><a href="Integers.html#Byte.modulus">Byte.modulus</a></span> <span class="kwd">with</span> 256. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_assoc">Zmult_assoc</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_plus">Z_div_plus</a></span>. <span class="tactic">apply</span> <span class="id">IHn1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#Zdiv_interval_1">Zdiv_interval_1</a></span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>; <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bytes_of_int64">bytes_of_int64</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> 8 (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="Memdata.html#i">i</a></span>) =<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> 4 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id"><a href="Memdata.html#i">i</a></span>)) ++ <span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> 4 (<span class="id"><a href="Integers.html#Int.unsigned">Int.unsigned</a></span> (<span class="id"><a href="Integers.html#Int64.hiword">Int64.hiword</a></span> <span class="id"><a href="Memdata.html#i">i</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1463')">Proof.</div>
<div class="proofscript" id="proof1463">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">transitivity</span> (<span class="id"><a href="Memdata.html#bytes_of_int">bytes_of_int</a></span> (4 + 4) (<span class="id"><a href="Integers.html#Int64.unsigned">Int64.unsigned</a></span> (<span class="id"><a href="Integers.html#Int64.ofwords">Int64.ofwords</a></span> (<span class="id"><a href="Integers.html#Int64.hiword">Int64.hiword</a></span> <span class="id">i</span>) (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id">i</span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Int64.ofwords_recompose">Int64.ofwords_recompose</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Int64.ofwords_add</span>'.<br/>
&nbsp;&nbsp;<span class="id">change</span> 32 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z_of_nat">Z_of_nat</a></span> 4 * 8).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Memdata.html#bytes_of_int_append">bytes_of_int_append</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Integers.html#Int.unsigned_range">Int.unsigned_range</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="encode_val_int64">encode_val_int64</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint64">Mint64</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>)<br/>
&nbsp;&nbsp;++ <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id"><a href="AST.html#Mint32">Mint32</a></span> (<span class="kwd">if</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="kwd">then</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span> <span class="id"><a href="Memdata.html#v">v</a></span> <span class="kwd">else</span> <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span> <span class="id"><a href="Memdata.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1464')">Proof.</div>
<div class="proofscript" id="proof1464">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#big_endian">Archi.big_endian</a></span> <span class="id">eqn</span>:<span class="id">BI</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.loword">Val.loword</a></span>, <span class="id"><a href="Values.html#Val.hiword">Val.hiword</a></span>, <span class="id"><a href="Memdata.html#encode_val">encode_val</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span>, <span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span>. <span class="tactic">rewrite</span> <span class="id">BI</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_app_distr">rev_app_distr</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#bytes_of_int64">bytes_of_int64</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#inj_bytes">inj_bytes</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#encode_int">encode_int</a></span>, <span class="id"><a href="Memdata.html#rev_if_be">rev_if_be</a></span>. <span class="tactic">rewrite</span> <span class="id">BI</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Memdata.html#bytes_of_int64">bytes_of_int64</a></span>.<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
