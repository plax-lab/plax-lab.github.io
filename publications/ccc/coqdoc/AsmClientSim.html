<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module AsmClientSim</title>
<meta name="description" content="Documentation of Coq module AsmClientSim" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module AsmClientSim</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Coqlib.html">Coqlib</a></span> <span class="id"><a href="Maps.html">Maps</a></span> <span class="id"><a href="Axioms.html">Axioms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="AST.html">AST</a></span> <span class="id"><a href="Integers.html">Integers</a></span> <span class="id"><a href="Floats.html">Floats</a></span> <span class="id"><a href="Values.html">Values</a></span> <span class="id"><a href="Events.html">Events</a></span> <span class="id"><a href="Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="Smallstep.html">Smallstep</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CUAST.html">CUAST</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Footprint.html">Footprint</a></span> <span class="id"><a href="GMemory.html">GMemory</a></span> <span class="id"><a href="FMemory.html">FMemory</a></span> <span class="id"><a href="TSOMem.html">TSOMem</a></span> <span class="id"><a href="FMemOpFP.html">FMemOpFP</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="GlobDefs.html">GlobDefs</a></span> <span class="id"><a href="GAST.html">GAST</a></span> <span class="id"><a href="ETrace.html">ETrace</a></span> <span class="id"><a href="LDSimDefs.html">LDSimDefs</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="ASM_local.html">ASM_local</a></span> <span class="id"><a href="AsmLang.html">AsmLang</a></span> <span class="id"><a href="AsmTSO.html">AsmTSO</a></span> <span class="id"><a href="TSOGlobSem.html">TSOGlobSem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="InteractionSemantics.html">InteractionSemantics</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="RGRels.html">RGRels</a></span> <span class="id"><a href="ClientSim.html">ClientSim</a></span> <span class="id"><a href="SCSemLemmas.html">SCSemLemmas</a></span> <span class="id"><a href="TSOSemLemmas.html">TSOSemLemmas</a></span> <span class="id"><a href="TSOMemLemmas.html">TSOMemLemmas</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Notation</span> <span class="id"><a name="footprint">footprint</a></span> := <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="strip_fl_eq_fmem_eq">strip_fl_eq_fmem_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fm</span> <span class="id">fm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span> = <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">fm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#fm">fm</a></span> = <span class="id">fm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9460')">Proof.</div>
<div class="proofscript" id="proof9460">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">fm</span>, <span class="id">fm</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">nextblockid</span> = <span class="id">nextblockid0</span>).<br/>
&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">valid_wd</span> <span class="id">valid_wd0</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">nextblockid</span> <span class="id">nextblockid0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_gt_cases">Nat.lt_gt_cases</a></span> <span class="kwd">in</span> <span class="id">n</span>. <span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">valid_wd</span> <span class="id">nextblockid</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">valid_wd0</span> <span class="id">nextblockid</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">valid_wd</span> <span class="id">nextblockid0</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">valid_wd0</span> <span class="id">nextblockid0</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">nextblockid</span>. <span class="tactic">f_equal</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="Axioms.html#proof_irr">proof_irr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="helpers_i64ext_sem_det">helpers_i64ext_sem_det</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ef</span> <span class="id">vargs</span> <span class="id">vres</span> <span class="id">vres</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="helpers.html#i64ext_sem">helpers.i64ext_sem</a></span> <span class="id"><a href="AsmClientSim.html#ef">ef</a></span> <span class="id"><a href="AsmClientSim.html#vargs">vargs</a></span> <span class="id"><a href="AsmClientSim.html#vres">vres</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="helpers.html#i64ext_sem">helpers.i64ext_sem</a></span> <span class="id"><a href="AsmClientSim.html#ef">ef</a></span> <span class="id"><a href="AsmClientSim.html#vargs">vargs</a></span> <span class="id">vres</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#vres">vres</a></span> = <span class="id">vres</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9461')">Proof.</div>
<div class="proofscript" id="proof9461">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="helpers.html#i64ext_extcall">helpers.i64ext_extcall</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="helpers.html#i64ext_extcall">helpers.i64ext_extcall</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>, <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> (<span class="id"><a href="Globalenvs.html#Genv.empty_genv">Genv.empty_genv</a></span> <span class="id"><a href="ASM_local.html#fundef">fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Memory.html#Mem.empty">Memory.Mem.empty</a></span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> (<span class="id"><a href="Globalenvs.html#Genv.empty_genv">Genv.empty_genv</a></span> <span class="id"><a href="ASM_local.html#fundef">fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Memory.html#Mem.empty">Memory.Mem.empty</a></span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Events.html#external_call_determ">external_call_determ</a></span>. <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">exact</span> <span class="id">H2</span>. <span class="tactic">clear</span>. <span class="tactic">intuition</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tupdate_update_same">tupdate_update_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">bufs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> = <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9462')">Proof.</div>
<div class="proofscript" id="proof9462">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intro</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tupdate_update_get_same">tupdate_update_get_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">bufs</span> <span class="id">buf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#buf">buf</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> = <span class="id"><a href="AsmClientSim.html#buf">buf</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9463')">Proof.</div>
<div class="proofscript" id="proof9463">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tupdate_update2">tupdate_update2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">buf</span> <span class="id">buf</span>' <span class="id">bufs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#buf">buf</a></span> (<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id">buf</span>' <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>) = <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#buf">buf</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9464')">Proof.</div>
<div class="proofscript" id="proof9464">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="emp_not_conflictc">emp_not_conflictc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">bufs</span>, ~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9465')">Proof.</div>
<div class="proofscript" id="proof9465">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">Locs.unfolds</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">ofs</span> &amp; <span class="id">H</span>); <span class="id">red_boolean_true</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="conflictc_ext">conflictc_ext</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp</span> <span class="id">bufs</span> <span class="id">bufs</span>' <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id">t</span>' &lt;&gt; <span class="id"><a href="AsmClientSim.html#t">t</a></span> -&gt; <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id">bufs</span>' <span class="id">t</span>') -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> <span class="id">bufs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9466')">Proof.</div>
<div class="proofscript" id="proof9466">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="conflictc_union">conflictc_union</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp1</span> <span class="id">fp2</span> <span class="id">bufs</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="AsmClientSim.html#fp1">fp1</a></span> <span class="id"><a href="AsmClientSim.html#fp2">fp2</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp1">fp1</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> \/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp2">fp2</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9467')">Proof.</div>
<div class="proofscript" id="proof9467">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span>, <span class="id"><a href="FPLemmas.html#fpconflict_union">FPLemmas.fpconflict_union</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|<span class="id">H2</span>]; [<span class="id">left</span>|<span class="id">right</span>]; <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_sym">FP.conflict_sym</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">econstructor</span>; <span class="tactic">eauto</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">conflictc_union</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fp1</span> <span class="id">fp2</span> <span class="id">bufs</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp1">fp1</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> \/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp2">fp2</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="Footprint.html#FP.union">FP.union</a></span> <span class="id"><a href="AsmClientSim.html#fp1">fp1</a></span> <span class="id"><a href="AsmClientSim.html#fp2">fp2</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9468')">Proof.</div>
<div class="proofscript" id="proof9468">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union">USimDRF.conflict_union</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.union_comm_eq">FP.union_comm_eq</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="USimDRF.html#conflict_union">USimDRF.conflict_union</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_args_fp_in_stk">store_args_fp_in_stk</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">tys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">locs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="Footprint.html#FP.Build_t">FP.Build_t</a></span> <span class="id"><a href="Footprint.html#Locs.emp">Locs.emp</a></span> <span class="id"><a href="Footprint.html#Locs.emp">Locs.emp</a></span> <span class="id"><a href="AsmClientSim.html#locs">locs</a></span> <span class="id"><a href="Footprint.html#Locs.emp">Locs.emp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="Footprint.html#Locs.belongsto">Locs.belongsto</a></span> <span class="id"><a href="AsmClientSim.html#locs">locs</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="AsmClientSim.html#b">b</a></span> = <span class="id"><a href="AsmClientSim.html#stk">stk</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9469')">Proof.</div>
<div class="proofscript" id="proof9469">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span>. <span class="tactic">generalize</span> 0. <span class="tactic">induction</span> <span class="id">tys</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exists</span> <span class="id"><a href="Footprint.html#Locs.emp">Locs.emp</a></span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">simpl</span>. <span class="id">specialize</span> (<span class="id">IHtys</span> (<span class="id">z</span> + <span class="id"><a href="AST.html#typesize">typesize</a></span> <span class="id">a</span>)). <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">locs0</span> &amp; <span class="id">Hfp0</span> &amp; <span class="id">Hstk0</span>). <span class="tactic">rewrite</span> <span class="id">Hfp0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack_fp">loadframe.store_stack_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.union">FP.union</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#Locs.emp_union_locs">Locs.emp_union_locs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="id">eexists</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#belongsto_union">belongsto_union</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="InteractionSemantics.html#belongsto_union">belongsto_union</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="conflict_store_args_conflict_alloc">conflict_store_args_conflict_alloc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">stk</span> <span class="id">tys</span> <span class="id">bufs</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9470')">Proof.</div>
<div class="proofscript" id="proof9470">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">t</span> <span class="id">stk</span> <span class="id">tys</span> <span class="id">bufs</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>, <span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span>. <span class="tactic">intros</span> <span class="id">_</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="AsmClientSim.html#store_args_fp_in_stk">store_args_fp_in_stk</a></span> <span class="id">stk</span> <span class="id">tys</span>) <span class="kwd">as</span> [<span class="id">locs</span> [<span class="id">Hfp</span> <span class="id">Hstk</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfp</span>. <span class="tactic">clear</span> <span class="id">Hfp</span> <span class="id">tys</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="id">Locs.unfolds</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">ofs</span> &amp; <span class="id">H</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_cmps">FP.ge_cmps</a></span>, <span class="id"><a href="Footprint.html#FP.ge_reads">FP.ge_reads</a></span>, <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>, <span class="id"><a href="Footprint.html#FP.ge_frees">FP.ge_frees</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">Locs.unfolds</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_r">andb_false_r</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">orb_false_r</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">red_boolean_true</span>. <span class="tactic">apply</span> <span class="id">Hstk</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.conflict_ff">FP.conflict_ff</a></span>; <span class="tactic">simpl</span>. <span class="id">Locs.unfolds</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">stk</span>, <span class="id">ofs</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>. <span class="tactic">apply</span> <span class="id">Hstk</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.conflict_rf">FP.conflict_rf</a></span>; <span class="tactic">simpl</span>. <span class="id">Locs.unfolds</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">stk</span>, <span class="id">ofs</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>. <span class="tactic">apply</span> <span class="id">Hstk</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.conflict_wf">FP.conflict_wf</a></span>; <span class="tactic">simpl</span>. <span class="id">Locs.unfolds</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">stk</span>, <span class="id">ofs</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="conflict_store_conflict_alloc">conflict_store_conflict_alloc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">bufs</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9471')">Proof.</div>
<div class="proofscript" id="proof9471">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>, <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>, <span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">FP.conflict</span>'<span class="id">_conflict_equiv</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_cmps">FP.ge_cmps</a></span>, <span class="id"><a href="Footprint.html#FP.ge_reads">FP.ge_reads</a></span>, <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>, <span class="id"><a href="Footprint.html#FP.ge_frees">FP.ge_frees</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">Locs.unfolds</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">ofs</span>' &amp; <span class="id">H</span>). <span class="tactic">eapply</span> <span class="id">FP.conflict</span>'<span class="id">_conflict_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>; <span class="id">econstructor</span>; <span class="id">exists</span> <span class="id">b</span>, <span class="id">ofs</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_cmps">FP.ge_cmps</a></span>, <span class="id"><a href="Footprint.html#FP.ge_reads">FP.ge_reads</a></span>, <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>, <span class="id"><a href="Footprint.html#FP.ge_frees">FP.ge_frees</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span>; <span class="id">Locs.unfolds</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">H3</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">ofs</span>' &amp; <span class="id">H</span>). <span class="tactic">eapply</span> <span class="id">FP.conflict</span>'<span class="id">_conflict_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">red_boolean_true</span>; <span class="id">econstructor</span>; <span class="id">exists</span> <span class="id">b</span>, <span class="id">ofs</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Footprint.html#FP.ge_cmps">FP.ge_cmps</a></span>, <span class="id"><a href="Footprint.html#FP.ge_reads">FP.ge_reads</a></span>, <span class="id"><a href="Footprint.html#FP.ge_writes">FP.ge_writes</a></span>, <span class="id"><a href="Footprint.html#FP.ge_frees">FP.ge_frees</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span>; <span class="id">Locs.unfolds</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">H3</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">H3</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemOpFP.html#range_locset_loc">range_locset_loc</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">H3</span>. <span class="tactic">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span> 10 <span class="kwd">with</span> <span class="id">bool</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Pallocframe_succeed_link_ra_inrange">Pallocframe_succeed_link_ra_inrange</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">f</span> <span class="id">sz</span> <span class="id">ofs_ra</span> <span class="id">ofs_link</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">rs</span>' <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#exec_instr">exec_instr</a></span> <span class="id"><a href="AsmClientSim.html#ge">ge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> (<span class="id"><a href="ASM_local.html#Pallocframe">Pallocframe</a></span> <span class="id"><a href="AsmClientSim.html#sz">sz</a></span> <span class="id"><a href="AsmClientSim.html#ofs_ra">ofs_ra</a></span> <span class="id"><a href="AsmClientSim.html#ofs_link">ofs_link</a></span>) <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> = <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">rs</span>' <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="AsmClientSim.html#ofs_ra">ofs_ra</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> &lt;= <span class="id"><a href="AsmClientSim.html#sz">sz</a></span> /\ (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> | <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="AsmClientSim.html#ofs_ra">ofs_ra</a></span>)) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="AsmClientSim.html#ofs_link">ofs_link</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> &lt;= <span class="id"><a href="AsmClientSim.html#sz">sz</a></span> /\ (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> | <span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="AsmClientSim.html#ofs_link">ofs_link</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9472')">Proof.</div>
<div class="proofscript" id="proof9472">
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m</span> 0 <span class="id">sz</span>) <span class="kwd">as</span> [<span class="id">m1</span> <span class="id">stk</span>] <span class="id">eqn</span>:<span class="id">Halloc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore1</span>; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id">m0</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="id">eqn</span>:<span class="id">Hstore2</span>; [|<span class="tactic">discriminate</span>]. <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.store_access">Mem.store_access</a></span>. <span class="tactic">exact</span> <span class="id">Hstore1</span>. <span class="tactic">intro</span> <span class="id">Haccess2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">Hstore1</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> <span class="id">Hstore2</span>. <span class="tactic">destruct</span> <span class="id">Hstore2</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs_ra</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> - 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Halloc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stk</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs_ra</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> - 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Memperm.Writable</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>. <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span>, <span class="id"><a href="AST.html#Mptr">Mptr</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>. <span class="tactic">intro</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Haccess2</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">Hstore2</span> <span class="id">Haccess2</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id">Hstore1</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs_link</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> - 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="FMemory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Halloc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stk</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs_link</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> - 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> <span class="id"><a href="Memperm.html#Writable">Memperm.Writable</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>. <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span>, <span class="id"><a href="AST.html#Mptr">Mptr</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>. <span class="tactic">intro</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">clear</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id"><a href="Values.html#eq_block">eq_block</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">omega</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_on_loc_trans">eq_on_loc_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">m1</span> <span class="id">m2</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#m1">m1</a></span> <span class="id"><a href="AsmClientSim.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#m2">m2</a></span> <span class="id"><a href="AsmClientSim.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#m1">m1</a></span> <span class="id"><a href="AsmClientSim.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9473')">Proof.</div>
<div class="proofscript" id="proof9473">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eq_loc_validity</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">eq_loc_perm</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Gc_trans">Gc_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sm1</span> <span class="id">tm1</span> <span class="id">sm2</span> <span class="id">tm2</span> <span class="id">sm3</span> <span class="id">tm3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sm1">sm1</a></span> <span class="id"><a href="AsmClientSim.html#tm1">tm1</a></span> <span class="id"><a href="AsmClientSim.html#sm2">sm2</a></span> <span class="id"><a href="AsmClientSim.html#tm2">tm2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sm2">sm2</a></span> <span class="id"><a href="AsmClientSim.html#tm2">tm2</a></span> <span class="id"><a href="AsmClientSim.html#sm3">sm3</a></span> <span class="id"><a href="AsmClientSim.html#tm3">tm3</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sm1">sm1</a></span> <span class="id"><a href="AsmClientSim.html#tm1">tm1</a></span> <span class="id"><a href="AsmClientSim.html#sm3">sm3</a></span> <span class="id"><a href="AsmClientSim.html#tm3">tm3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9474')">Proof.</div>
<div class="proofscript" id="proof9474">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">H4</span>, <span class="id">H3</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">H3</span>, <span class="id">H4</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intuition</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_on_loc_trans">eq_on_loc_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">H6</span>. <span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intuition</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">H9</span> <span class="kwd">as</span> (<span class="id">bis1</span> &amp; <span class="id">Hinsert1</span> &amp; <span class="id">Hclient1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H10</span> <span class="kwd">as</span> (<span class="id">bis2</span> &amp; <span class="id">Hinsert2</span> &amp; <span class="id">Hclient2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">bis1</span> ++ <span class="id">bis2</span>). <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">Hinsert2</span>, <span class="id">Hinsert1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>; <span class="tactic">auto</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H9</span>. <span class="tactic">apply</span> <span class="id"><a href="Coqlib.html#in_app">in_app</a></span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="tactic">destruct</span> <span class="id">H11</span>; [<span class="tactic">eapply</span> <span class="id">Hclient1</span>|<span class="tactic">eapply</span> <span class="id">Hclient2</span>]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GMemory.html#GMem.forward_trans">GMem.forward_trans</a></span>; <span class="tactic">intuition</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Gc_refl">Gc_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sm</span> <span class="id">tm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Ic">Ic</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9475')">Proof.</div>
<div class="proofscript" id="proof9475">
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">auto</span>). <span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>. <span class="tactic">intro</span>; <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_validity_eq_nextblock">eq_validity_eq_nextblock</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fl</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">fm</span> <span class="id">fm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">n</span>, <span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#n">n</a></span> = <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> <span class="id">m</span>')) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">m</span>' <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id">fm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9476')">Proof.</div>
<div class="proofscript" id="proof9476">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="FMemory.html#Mem.valid_wd">Mem.valid_wd</a></span> <span class="id">fm</span>). <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="FMemory.html#Mem.valid_wd">Mem.valid_wd</a></span> <span class="id">fm</span>').<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="id">revert</span> <span class="id">H</span> <span class="id">H1</span> <span class="id">H2</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span> <span class="id">fm</span>) (<span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span> <span class="id">fm</span>') (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">fm</span>) (<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">fm</span>) (<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">fm</span>').<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">N1</span> <span class="id">N2</span> <span class="id">fl</span> <span class="id">vl1</span> <span class="id">vl2</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">N1</span> <span class="id">N2</span>); <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_gt_cases">Nat.lt_gt_cases</a></span> <span class="kwd">in</span> <span class="id">n</span>. <span class="tactic">destruct</span> <span class="id">n</span>; <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">N1</span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id">N1</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">N1</span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id">N1</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id">N1</span>) <span class="id">N1</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>, <span class="id">H1</span>, <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">N2</span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id">N2</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">N2</span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id">N2</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id">N2</span>) <span class="id">N2</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>, <span class="id">H1</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rel_vb_nextblock_eq">rel_vb_nextblock_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span>) (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>)) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> = <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> = <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9477')">Proof.</div>
<div class="proofscript" id="proof9477">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">fl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">m</span>) <span class="id"><a href="AsmClientSim.html#n">n</a></span>) (<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">tm</span>) <span class="id"><a href="AsmClientSim.html#n">n</a></span>) (<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">tm</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">n</span>). <span class="id">erewrite</span> &lt;- <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="AsmClientSim.html#n">n</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span> <span class="id">m</span> &lt;-&gt; <span class="id"><a href="AsmClientSim.html#n">n</a></span> &lt; <span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span> <span class="id">tm</span>)%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.valid_wd">Mem.valid_wd</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="FMemory.html#Mem.valid_wd">Mem.valid_wd</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span>. <span class="tactic">f_equal</span>; <span class="tactic">auto</span>. <span class="id">revert</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span> <span class="id">m</span>) (<span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span> <span class="id">tm</span>). <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">Heq</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">n1</span> <span class="id">n2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_gt_cases">Nat.lt_gt_cases</a></span> <span class="id">n1</span> <span class="id">n2</span>) <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span> <span class="kwd">as</span> [<span class="id">n</span>|<span class="id">n</span>]; [<span class="id">specialize</span> (<span class="id">Heq</span> <span class="id">n1</span>)|<span class="id">specialize</span> (<span class="id">Heq</span> <span class="id">n2</span>)]; <span class="tactic">omega</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<div class="doc">Refinement on Mem Ops </div>
<span class="kwd">Record</span> <span class="id"><a name="meminv">meminv</a></span> (<span class="id">t</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) (<span class="id">fl</span>: <span class="id"><a href="MemAux.html#freelist">MemAux.freelist</a></span>) (<span class="id">sgm</span>: <span class="id"><a href="GMemory.html#gmem">gmem</a></span>) (<span class="id">bufs</span>: <span class="id"><a href="TSOMem.html#buffers">buffers</a></span>) (<span class="id">tgm</span>: <span class="id"><a href="GMemory.html#gmem">gmem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="meminv_Ic">meminv_Ic</a></span>: <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="meminv_sep">meminv_sep</a></span>: <span class="id"><a href="RGRels.html#sep_obj_client_block">sep_obj_client_block</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="meminv_rel_vb">meminv_rel_vb</a></span>: <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="meminv_alloc_local">meminv_alloc_local</a></span>: <span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>;<br/>
&nbsp;&nbsp;}.<br/>
<br/>
<div class="doc">Res type is for recording returning values:
      - <span class="bracket"><span class="id">alloc</span></span> : new block 
      - <span class="bracket"><span class="id">load</span></span> : loaded value 
      - <span class="bracket"><span class="id">store</span></span> : unit
      - <span class="bracket"><span class="id">free</span></span> : unit
      - <span class="bracket"><span class="id">valid_block</span></span> : true/false
 </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fmemop">fmemop</a></span> {<span class="id">Res</span>: <span class="kwd">Type</span>}: <span class="kwd">Type</span> := <span class="id"><a href="FMemory.html#mem">mem</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt; <span class="id"><a href="AsmClientSim.html#Res">Res</a></span> -&gt; <span class="id"><a href="FMemory.html#mem">mem</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tsofmemop">tsofmemop</a></span> {<span class="id">Res</span>: <span class="kwd">Type</span>}: <span class="kwd">Type</span> := <span class="id"><a href="TSOMem.html#tsofmem">tsofmem</a></span> -&gt; <span class="id"><a href="Footprint.html#FP.t">FP.t</a></span> -&gt; <span class="id"><a href="AsmClientSim.html#Res">Res</a></span> -&gt; <span class="id"><a href="TSOMem.html#tsofmem">tsofmem</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="memops_refine">memops_refine</a></span> {<span class="id">Res</span>: <span class="kwd">Type</span>} (<span class="id">opSrc</span>: @<span class="id"><a href="AsmClientSim.html#fmemop">fmemop</a></span> <span class="id"><a href="AsmClientSim.html#Res">Res</a></span>) (<span class="id">opTgt</span>: @<span class="id"><a href="AsmClientSim.html#tsofmemop">tsofmemop</a></span> <span class="id"><a href="AsmClientSim.html#Res">Res</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sgm</span> <span class="id">bufs</span> <span class="id">tgm</span> <span class="id">sfm</span> <span class="id">tfm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tbfm</span> := <span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tfp</span> <span class="id">tres</span> <span class="id">tbfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#opTgt">opTgt</a></span> <span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> <span class="id"><a href="AsmClientSim.html#tres">tres</a></span> <span class="id">tbfm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">sfp</span> <span class="id">sres</span> <span class="id">sfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sgm</span>' := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tgm</span>' := <span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tbfm</span>') <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">buf</span>' := <span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tbfm</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bufs</span>' := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id">buf</span>' <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#sres">sres</a></span> = <span class="id"><a href="AsmClientSim.html#tres">tres</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id">sgm</span>' <span class="id">bufs</span>' <span class="id">tgm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span>) <span class="id">sgm</span>' (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id">bufs</span>' <span class="id">tgm</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sfp</span> <span class="id">sres</span> <span class="id">sfm</span>', ~ <span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>').<br/>
<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">Hsimpl</span>:=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H1</span>:?<span class="id">a</span>,<span class="id">H2</span>:?<span class="id">a</span>-&gt;?<span class="id">b</span>|-<span class="id">_</span>=&gt;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">H1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span>/\<span class="id">_</span>|-<span class="id">_</span>=&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">exists</span> <span class="id">_</span>,<span class="id">_</span>|-<span class="id">_</span>=&gt;<span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">Esimpl</span>:=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span>|-<span class="id">_</span>/\<span class="id">_</span>=&gt;<span class="tactic">split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>:<span class="id">_</span>|-<span class="id">exists</span> <span class="id">_</span>,<span class="id">_</span>=&gt;<span class="id">eexists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">ex_match</span>:=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?<span class="id">Hx</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">ex_match2</span>:=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">context</span>[<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]  |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?<span class="id">Hx</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> |- <span class="id">context</span>[<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?<span class="id">Hx</span>;<span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>;<span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">ex_match3</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span>: ?<span class="id">x</span> = ?<span class="id">y</span> |- <span class="id">context</span> [?<span class="id">x</span>] =&gt; <span class="tactic">rewrite</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_fl_embed_nextblockeq">meminv_fl_embed_nextblockeq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">t</span> <span class="id">fl</span> <span class="id">bfs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> <span class="id"><a href="AsmClientSim.html#bfs">bfs</a></span> <span class="id">m</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m2</span> <span class="id">fm1</span> <span class="id">fm2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#fm1">fm1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> (<span class="id"><a href="AsmClientSim.html#bfs">bfs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#m2">m2</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#fm2">fm2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#fm1">fm1</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span>) = <span class="id"><a href="AsmClientSim.html#fm2">fm2</a></span>.(<span class="id"><a href="FMemory.html#Mem.nextblockid">Mem.nextblockid</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9478')">Proof.</div>
<div class="proofscript" id="proof9478">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H2</span>;  <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="kwd">in</span> <span class="id">meminv_rel_vb0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">b</span>, <span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id">fm1</span>) <span class="id"><a href="AsmClientSim.html#n">n</a></span> = <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm2</span>))&lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm1</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span> <span class="id">H0</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">fm1</span>,<span class="id">fm2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.lt_total">Nat.lt_total</a></span> <span class="id">nextblockid</span> <span class="id">nextblockid0</span>);<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">b</span>,<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">freelist</span> <span class="id">nextblockid</span> = <span class="id"><a href="AsmClientSim.html#b">b</a></span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">valid_wd</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">valid_wd0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span>&lt;- <span class="id">H3</span>,<span class="id">H2</span>,<span class="id">H4</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">b</span>,<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">freelist</span> <span class="id">nextblockid0</span> = <span class="id"><a href="AsmClientSim.html#b">b</a></span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">valid_wd</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">valid_wd0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>,&lt;- <span class="id">H2</span>, <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inbuffer_split">inbuffer_split</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">bf1</span> <span class="id">bf2</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id"><a href="AsmClientSim.html#bf1">bf1</a></span>++<span class="id"><a href="AsmClientSim.html#bf2">bf2</a></span>) <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> <span class="id"><a href="AsmClientSim.html#bf1">bf1</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> \/ <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> <span class="id"><a href="AsmClientSim.html#bf2">bf2</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9479')">Proof.</div>
<div class="proofscript" id="proof9479">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> [|];[<span class="id">left</span>|<span class="id">right</span>];<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="strip_fold">strip_fold</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.mk_gmem">GMem.mem_contents</a></span> := <span class="id"><a href="FMemory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GMem.mem_access</span> := <span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GMem.validblocks</span> := <span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GMem.access_max</span> := <span class="id"><a href="FMemory.html#Mem.access_max">Mem.access_max</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GMem.invalid_noaccess</span> := <span class="id"><a href="FMemory.html#Mem.invalid_noaccess">Mem.invalid_noaccess</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GMem.contents_default</span> := <span class="id"><a href="FMemory.html#Mem.contents_default">Mem.contents_default</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span> |} = <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#fm">fm</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9480')">Proof.</div>
<div class="proofscript" id="proof9480">
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="unbuffer_forward">unbuffer_forward</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#buf_alloc_invalid">buf_alloc_invalid</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#buf_alloc_norep">buf_alloc_norep</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">tm</span>' ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tm</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.forward">GMem.forward</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>)(<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9481')">Proof.</div>
<div class="proofscript" id="proof9481">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx0</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#alloc">alloc</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span>,<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hx0</span>;<span class="id">ex_match2</span>;<span class="id">inv</span> <span class="id">Hx0</span>;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span>;<span class="tactic">simpl</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx0</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#alloc">alloc</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span>,<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hx0</span>;<span class="id">ex_match2</span>;<span class="id">inv</span> <span class="id">Hx0</span>;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2 :<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">ex_match2</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">Hx</span>. <span class="id">left</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="apply_buffer_forward">apply_buffer_forward</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#buf_alloc_invalid">buf_alloc_invalid</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#buf_alloc_norep">buf_alloc_norep</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">bf</span> <span class="id">ls</span> <span class="id">tm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> = <span class="id"><a href="AsmClientSim.html#bf">bf</a></span>++<span class="id"><a href="AsmClientSim.html#ls">ls</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> <span class="id"><a href="AsmClientSim.html#bf">bf</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.forward">GMem.forward</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id">tm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9482')">Proof.</div>
<div class="proofscript" id="proof9482">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">bf</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">tm</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bf</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMem.forward_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">tm1</span> ,<span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span> <span class="id">tm</span> <span class="id">t</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#tm1">tm1</a></span> /\ <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm1">tm1</a></span> = <span class="id">g</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hx</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#unbuffer_forward">unbuffer_forward</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="GMemory.html#GMem.forward_trans">GMem.forward_trans</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="ClientSim.html#Ic_buf_alloc_invalid_norep_stable">Ic_buf_alloc_invalid_norep_stable</a></span>;<span class="tactic">eauto</span>. <span class="tactic">intros</span>[].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">x</span> <span class="id">t</span> = <span class="id">bf</span>++<span class="id">ls</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#unbuffer">unbuffer</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H3</span>.  <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHbf</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tsoalloc_thread_local_norep">tsoalloc_thread_local_norep</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tm</span>  <span class="id">lo</span> <span class="id">hi</span> <span class="id">tm</span>' <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tsoalloc">tsoalloc</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> (<span class="id">tm</span>',<span class="id"><a href="AsmClientSim.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>' <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> <span class="id">b</span>' <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span>) (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span>' &lt;&gt; <span class="id"><a href="AsmClientSim.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9483')">Proof.</div>
<div class="proofscript" id="proof9483">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_nth_error">In_nth_error</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error_split">nth_error_split</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">Hsimpl</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#apply_buffer_split_2">apply_buffer_split_2</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">Hsimpl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">b</span>' (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> <span class="id">x2</span>)).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">left</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_in_validblocks_stable">apply_buffer_in_validblocks_stable</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>. <span class="tactic">intro</span>;<span class="tactic">subst</span>. <span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#next_block_not_in_validblock">next_block_not_in_validblock</a></span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="alloc_refine">alloc_refine</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opSrc</span> := <span class="kwd">fun</span> <span class="id">sfm</span> <span class="id">fp</span> <span class="id">stk</span> <span class="id">sfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> = (<span class="id">sfm</span>', <span class="id"><a href="AsmClientSim.html#stk">stk</a></span>) /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opTgt</span> := <span class="kwd">fun</span> <span class="id">tbfm</span> <span class="id">fp</span> <span class="id">stk</span> <span class="id">tbfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tsoalloc">tsoalloc</a></span> <span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> (<span class="id">tbfm</span>', <span class="id"><a href="AsmClientSim.html#stk">stk</a></span>) /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span> <span class="id"><a href="Values.html#block">block</a></span> <span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#opTgt">opTgt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9484')">Proof.</div>
<div class="proofscript" id="proof9484">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">sfm</span>' <span class="id">sres</span>,  (<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">sfm</span> <span class="id">lo</span> <span class="id">hi</span> = (<span class="id">sfm</span>', <span class="id"><a href="AsmClientSim.html#sres">sres</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">Hsimpl</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">H3</span> <span class="id">into</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">BLOCKEQ</span>: (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span> = <span class="id">tres</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_fl_embed_nextblockeq">meminv_fl_embed_nextblockeq</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">BLOCKEQ2</span>: <span class="id">tres</span> = <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>;<span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">x0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">FPMATCHC</span>:<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> (<span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span> <span class="id">sfm</span> <span class="id">lo</span> <span class="id">hi</span>)  (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id">tres</span> <span class="id">lo</span> <span class="id">hi</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span>,<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>;<span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.  }<br/>
&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">x</span> <span class="id">into</span> <span class="id">sfm</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span>  (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id">tres</span> <span class="id">lo</span> <span class="id">hi</span>) <span class="id">bufs</span> \/ ~<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span>  (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id">tres</span> <span class="id">lo</span> <span class="id">hi</span>) <span class="id">bufs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>;[<span class="id">right</span>|<span class="id">left</span>].<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R</span>:<span class="kwd">forall</span> <span class="id">t</span>' <span class="id">ofs</span>, <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id">t</span>')(<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>) <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> -&gt; <span class="id">t</span>' = <span class="id">t</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H3</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">t</span>' <span class="id">t</span>);<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H3</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span>,<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>,<span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_ff">FP.conflict_ff</a></span>;<span class="tactic">simpl</span>. <span class="id">Locs.unfolds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>),0. <span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_ff">FP.conflict_ff</a></span>;<span class="tactic">simpl</span>;<span class="id">Locs.unfolds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>),<span class="id">ofs</span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOSemLemmas.html#add_minus_eq">add_minus_eq</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_wf">FP.conflict_wf</a></span>;<span class="tactic">simpl</span>;<span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>),<span class="id">ofs</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">UBS1</span>:<span class="id"><a href="TSOMem.html#unbuffer_safe">unbuffer_safe</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tbfm</span>') <span class="id">bufs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tbfm</span>') |}).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#meminv_Ic">meminv_Ic</a></span> <span class="kwd">in</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="ClientSim.html#Ic_ub_safe">Ic_ub_safe</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOSemLemmas.html#unbuffer_safe_append_preserve">unbuffer_safe_append_preserve</a></span> <span class="kwd">with</span>(<span class="id">bi</span>:= (<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>') <span class="id">lo</span> <span class="id">hi</span>))(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoupd">tsoupd</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">gm</span>'',<span class="id"><a href="TSOMem.html#alloc">alloc</a></span> <span class="id">gm</span>' (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>') <span class="id">lo</span> <span class="id">hi</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gm</span>'').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#alloc">alloc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>. <span class="id">erewrite</span> <span class="id"><a href="TSOAuxDefs.html#apply_buffer_app_eq">TSOAuxDefs.apply_buffer_app_eq</a></span>;<span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOSemLemmas.html#inv_bi">inv_bi</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#fpsmile_nfconflict">fpsmile_nfconflict</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span>;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span>,<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">IC1</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Ic">Ic</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tbfm</span>') <span class="id">bufs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tbfm</span>') |}).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id"><a href="AsmClientSim.html#strip_fold">strip_fold</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#meminv_Ic">meminv_Ic</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">_</span> ? <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H4</span>,<span class="id">H5</span>;<span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#inbuffer_split">inbuffer_split</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_no_conflict_bi</span>. 3:<span class="tactic">exact</span> <span class="id">H4</span>. 3:<span class="tactic">exact</span> <span class="id">H5</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">b</span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>). <span class="tactic">intro</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>;<span class="id">econstructor</span>;<span class="tactic">simpl</span>;<span class="tactic">auto</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">apply</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#inbuffer_split">inbuffer_split</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_no_conflict_bi</span>. 3:<span class="tactic">exact</span> <span class="id">H4</span>. 3:<span class="tactic">exact</span> <span class="id">H5</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">b</span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>). <span class="tactic">intro</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>;<span class="id">econstructor</span>;<span class="tactic">simpl</span>;<span class="tactic">auto</span>; <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="tactic">apply</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">b</span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>). <span class="tactic">intro</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">apply</span> <span class="id">R</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_no_conflict_bi</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">H5</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">simpl</span>;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#meminv_Ic">meminv_Ic</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">_</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="AsmClientSim.html#strip_fold">strip_fold</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">ex_match2</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">t</span> &lt;&gt; <span class="id">t0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">t</span> <span class="id">H0</span>) <span class="kwd">as</span> ?. <span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_b_get">TSOMemLemmas.tupdate_b_get</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">b</span> &lt;&gt; <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="id">right</span>. <span class="tactic">simpl</span>. <span class="id">left</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H13</span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>) <span class="id">b</span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H5</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>;<span class="id">econstructor</span>;<span class="tactic">simpl</span>;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span> . <span class="tactic">exact</span> <span class="id">H4</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">contradict</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="id">ex_match2</span>;<span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H10</span>;<span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="id">left</span>;<span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_on_loc_trans">eq_on_loc_trans</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">R0</span> <span class="id">H7</span>;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span>;<span class="tactic">inversion</span> 1;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>;<span class="tactic">auto</span>. <span class="tactic">intros</span>[];<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unfocus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">ex_match</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">intro</span>. <span class="id">left</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>,<span class="id">H13</span>,<span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>,<span class="id">H13</span>,<span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>) <span class="id">b</span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [];<span class="id">contradict</span> <span class="id">H5</span>;<span class="tactic">split</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_mem_eq</span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="AsmClientSim.html#strip_fold">strip_fold</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H2</span> <span class="id">R0</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">H13</span> <span class="id">n</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">intro</span>;<span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">destruct</span> <span class="id">H</span>;[<span class="id">left</span>; <span class="tactic">congruence</span>|<span class="id">right</span>; <span class="tactic">apply</span> <span class="id">eq_loc_validity</span>;<span class="tactic">auto</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H6</span> <span class="kwd">in</span> <span class="id">H7</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#buf_alloc_invalid">buf_alloc_invalid</a></span>,<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>. <span class="tactic">eapply</span> <span class="id">Ic_buf_alloc_invalid</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">fm</span>')(<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">fm</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#next_block_not_in_validblock">next_block_not_in_validblock</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#apply_buffer_forward">apply_buffer_forward</a></span> <span class="kwd">in</span> <span class="id">Ic_buf_alloc_invalid</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2. <span class="tactic">simpl</span>. <span class="id">erewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">List.app_nil_r</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id">Ic_buf_alloc_invalid</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_buf_alloc_invalid</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#strip_fold">strip_fold</a></span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ?] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#alloc_norep_preserve">alloc_norep_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">t</span> <span class="id">t0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="AsmClientSim.html#tsoalloc_thread_local_norep">tsoalloc_thread_local_norep</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H3</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>,<span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_ff">FP.conflict_ff</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H9</span>. <span class="id">exists</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>),0. <span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#sep_obj_client_block">sep_obj_client_block</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b</span> (<span class="id">tres</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#alloc_obj_mem_unchg">alloc_obj_mem_unchg</a></span> <span class="kwd">in</span> <span class="id">H4</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#alloc_clt_mem_unchg">alloc_clt_mem_unchg</a></span> <span class="kwd">in</span> <span class="id">H5</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">meminv_sep0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span>;<span class="tactic">simpl</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H5</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="id">ex_match</span>. <span class="id">inv</span> <span class="id">H4</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H13</span>. <span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span>,<span class="id"><a href="FMemory.html#strip">strip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="kwd">in</span> <span class="id">meminv_rel_vb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_rel_vb0</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">intros</span>[];[ <span class="id">left</span>; <span class="tactic">congruence</span>| <span class="id">right</span>; <span class="tactic">eapply</span> <span class="id">H</span>;<span class="tactic">eauto</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">meminv_alloc_local0</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">split</span>;<span class="tactic">intro</span>;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#alloc_obj_mem_unchg">alloc_obj_mem_unchg</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="tactic">apply</span> <span class="id">R0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">b</span>&lt;&gt; (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#alloc_obj_mem_unchg">alloc_obj_mem_unchg</a></span> <span class="kwd">in</span> <span class="id">R0</span> <span class="kwd">as</span> <span class="id">R2</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">R2</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">intro</span>;<span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="id">right</span>;<span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">H5</span>;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gso">PMap.gso</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> <span class="id">tres</span> <span class="id">lo</span> <span class="id">hi</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Focus</span> 2. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#alloc_obj_mem_unchg">alloc_obj_mem_unchg</a></span> <span class="kwd">in</span> <span class="id">R0</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H7</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="kwd">in</span> <span class="id">R0</span>;<span class="id">inv</span> <span class="id">R0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span> <span class="kwd">in</span> *. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemLemmas.html#alloc_forward">FMemLemmas.alloc_forward</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_refine">store_refine</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opSrc</span> := <span class="kwd">fun</span> <span class="id">sfm</span> <span class="id">fp</span> <span class="id">res</span> <span class="id">sfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sfm</span>' /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opTgt</span> := <span class="kwd">fun</span> <span class="id">tbfm</span> <span class="id">fp</span> <span class="id">res</span> <span class="id">tbfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tbfm</span>' /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#opTgt">opTgt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9485')">Proof.</div>
<div class="proofscript" id="proof9485">
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( (<span class="kwd">forall</span> <span class="id">sfp</span> <span class="id">sres</span> <span class="id">sfm</span>', ~ <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>') \/  ~(<span class="kwd">forall</span> <span class="id">sfp</span> <span class="id">sres</span> <span class="id">sfm</span>', ~ <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>')).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">Classical_Pred_Type.not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">Classical_Prop.NNPP</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">TRANS</span>: <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id">x</span> <span class="id">tres</span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H3</span>. <span class="tactic">rename</span> <span class="id">TRANS</span> <span class="id">into</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>,<span class="id">tres</span>,<span class="id">x1</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id">x</span> <span class="id">tfp</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">opTgt</span>,<span class="id">opSrc</span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> <span class="id">tfp</span> <span class="id">bufs</span> \/ ~<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> <span class="id">tfp</span> <span class="id">bufs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;[<span class="id">right</span>|<span class="id">left</span>];<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">opTgt</span>,<span class="id">opSrc</span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>;<span class="tactic">subst</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R</span>:<span class="kwd">forall</span> <span class="id">ofs0</span>,  <span class="id">ofs</span> &lt;= <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt; <span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> -&gt;  <span class="kwd">forall</span> <span class="id">t</span>' : <span class="id"><a href="GlobDefs.html#tid">tid</a></span>, <span class="id">t</span>' &lt;&gt; <span class="id">t</span> -&gt; ~ <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id">t</span>') <span class="id">b</span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H7</span> <span class="id">H2</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span>,<span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>;<span class="tactic">simpl</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span>,<span class="id"><a href="FMemOpFP.html#free_fp">free_fp</a></span>,<span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_wf">FP.conflict_wf</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_wf">FP.conflict_wf</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOSemLemmas.html#add_minus_eq">add_minus_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>,<span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_ww">FP.conflict_ww</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>,<span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">enough</span>(<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id">t</span> <span class="id">sgm</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id">bufs</span>; <span class="id">memory</span> := <span class="id">tgm</span> |} (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tbfm</span>') <span class="id">bufs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tbfm</span>') |}).<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="kwd">in</span> <span class="id">H6</span>;<span class="id">Hsimpl</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#sep_obj_client_block">sep_obj_client_block</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">meminv_sep0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(2:=<span class="id">b0</span>). <span class="id">instantiate</span>(1:=<span class="id">ofs1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>;<span class="tactic">destruct</span> <span class="id">H7</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=<span class="id">ofs2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>;<span class="tactic">destruct</span> <span class="id">H8</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_rel_vb0</span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=<span class="id">n</span>). <span class="tactic">intro</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hx1</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">Hx1</span>. <span class="tactic">simpl</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H7</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">meminv_alloc_local0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="kwd">forall</span> (<span class="id">b0</span> : <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>), <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt;-&gt; <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>) <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">intros</span>[];<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="id">constructor</span>;<span class="tactic">simpl</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="kwd">forall</span> (<span class="id">b0</span> : <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> -&gt; <span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> <span class="id">sgm</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>;<span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="FMemory.html#Mem.setN_other">Mem.setN_other</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">v0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>,&lt;-<span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">ofs0</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R2</span>:  <span class="kwd">forall</span> (<span class="id">b0</span> : <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id"><a href="TSOMem.html#BufferedStore">BufferedStore</a></span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> -&gt; ~ <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">H9</span>. 2:<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H12</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">ex_match</span>. <span class="tactic">inversion</span> <span class="id">v0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> <span class="id">H11</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">specialize</span> (<span class="id">H8</span> <span class="id">_</span> <span class="id">H17</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOSemLemmas.html#unbuffer_safe_append_preserve">unbuffer_safe_append_preserve</a></span> <span class="kwd">with</span>(<span class="id">bi</span>:=<span class="id"><a href="TSOMem.html#BufferedStore">BufferedStore</a></span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>)(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>;<span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoupd">tsoupd</a></span> <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_apply_buffer">unbuffer_safe_apply_buffer</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOAuxDefs.html#buffer_safe">TSOAuxDefs.buffer_safe</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOAuxDefs.html#apply_buffer_app_eq">TSOAuxDefs.apply_buffer_app_eq</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="kwd">forall</span> <span class="id">ofs0</span>,  <span class="id">ofs</span> &lt;= <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt; <span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>-&gt; <span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id">b</span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> <span class="id">sgm</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id">b</span> <span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">R2</span>. <span class="id">econstructor</span>. <span class="id">left</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span>. <span class="id">ex_match2</span>;<span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">Hx</span>;<span class="tactic">clear</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>,<span class="id"><a href="TSOMem.html#store">store</a></span>;<span class="tactic">intros</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hx</span> <span class="id">Hx1</span> <span class="id">Hx0</span> <span class="id">H3</span>.  <span class="id">contradict</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">v0</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#range_perm">range_perm</a></span> ;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">_</span> ? <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eq_loc_perm</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Mem.perm_order</span>' <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="GMemory.html#GMem.access_max">GMem.access_max</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(2:=<span class="id">x</span>). <span class="id">instantiate</span>(2:=<span class="id">b</span>). <span class="id">instantiate</span>(1:=<span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Memperm.perm_order</span>'';<span class="tactic">intro</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOSemLemmas.html#inv_bi">inv_bi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">compute</span>[<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#fpsmile_nfconflict">fpsmile_nfconflict</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id">b0</span> <span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">meminv_Ic0</span> <span class="kwd">as</span> [<span class="id">_</span> ? <span class="id">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H10</span>,<span class="id">H11</span>;<span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_no_conflict_bi</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>;<span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">R</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_no_conflict_bi</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>;<span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">R</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_no_conflict_bi</span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">meminv_Ic0</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">_</span> ?  ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id">b0</span> <span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H9</span>;<span class="tactic">eapply</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?. <span class="id">contradict</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H12</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H3</span> <span class="id">H8</span>;<span class="tactic">clear</span>;<span class="tactic">simpl</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">ex_match</span>. <span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>,<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> *. <span class="id">ex_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hx</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) <span class="id">b</span> <span class="id">ofs0</span>) <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="id">inv</span> <span class="id">Heqb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemLemmas.html#setN_geteq2">FMemLemmas.setN_geteq2</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>,&lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="kwd">forall</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>, <span class="id">ofs</span> &lt;= <span class="id"><a href="AsmClientSim.html#r">r</a></span> &lt; <span class="id">ofs</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="Memdata.html#encode_val">encode_val</a></span> <span class="id">chunk</span> <span class="id">v</span>)) -&gt; <span class="id"><a href="AsmClientSim.html#r">r</a></span> &lt;&gt; <span class="id">ofs0</span>).  <span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>,&lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>;<span class="tactic">subst</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> !<span class="id"><a href="FMemory.html#Mem.setN_other">Mem.setN_other</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H12</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_on_loc_trans">eq_on_loc_trans</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">t</span>&lt;&gt;<span class="id">t0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">t</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~  <span class="id"><a href="TSOMem.html#in_buffer_item">in_buffer_item</a></span> ( <span class="id"><a href="TSOMem.html#BufferedStore">BufferedStore</a></span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>) <span class="id">b0</span> <span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H10</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>;<span class="id">ex_match2</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="id">right</span>;<span class="tactic">auto</span>. <span class="id">left</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H12</span> <span class="id">H3</span>;<span class="tactic">clear</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>;<span class="tactic">intros</span>. <span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">simpl</span>;<span class="id">FMemLemmas.gmem_unfolds</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="id">b</span> <span class="id">ofs</span> (<span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span>) <span class="id">b0</span> <span class="id">ofs0</span>) <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="id">inv</span> <span class="id">Heqb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> !<span class="id"><a href="FMemory.html#Mem.setN_other">Mem.setN_other</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Memdata.html#encode_val_length">encode_val_length</a></span>,&lt;-<span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>;<span class="tactic">subst</span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[ <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ? <span class="id">_</span> ] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#buf_alloc_invalid">buf_alloc_invalid</a></span>,<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>;<span class="tactic">simpl</span>;<span class="tactic">intros</span>;<span class="id">ex_match2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>;<span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[ <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ? ] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#alloc_norep_preserve">alloc_norep_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemLemmas.html#store_forward">FMemLemmas.store_forward</a></span>;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="free_refine">free_refine</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opSrc</span> := <span class="kwd">fun</span> <span class="id">sfm</span> <span class="id">fp</span> <span class="id">res</span> <span class="id">sfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sfm</span>' /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#free_fp">free_fp</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opTgt</span> := <span class="kwd">fun</span> <span class="id">tbfm</span> <span class="id">fp</span> <span class="id">res</span> <span class="id">tbfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tbfm</span>' /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#free_fp">free_fp</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#opTgt">opTgt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9486')">Proof.</div>
<div class="proofscript" id="proof9486">
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( (<span class="kwd">forall</span> <span class="id">sfp</span> <span class="id">sres</span> <span class="id">sfm</span>', ~ <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>') \/  ~(<span class="kwd">forall</span> <span class="id">sfp</span> <span class="id">sres</span> <span class="id">sfm</span>', ~ <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>')).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">Classical_Pred_Type.not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">Classical_Prop.NNPP</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">TRANS</span>: <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id">x</span> <span class="id">tres</span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H3</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H3</span>. <span class="tactic">rename</span> <span class="id">TRANS</span> <span class="id">into</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>,<span class="id">tres</span>,<span class="id">x1</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id">x</span> <span class="id">tfp</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">opTgt</span>,<span class="id">opSrc</span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> <span class="id">tfp</span> <span class="id">bufs</span> \/ ~<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> <span class="id">tfp</span> <span class="id">bufs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;[<span class="id">right</span>|<span class="id">left</span>];<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">opTgt</span>,<span class="id">opSrc</span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>;<span class="tactic">subst</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R</span>:<span class="kwd">forall</span> <span class="id">ofs0</span>,  <span class="id">lo</span> &lt;= <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt; <span class="id">hi</span> -&gt;  <span class="kwd">forall</span> <span class="id">t</span>' : <span class="id"><a href="GlobDefs.html#tid">tid</a></span>, <span class="id">t</span>' &lt;&gt; <span class="id">t</span> -&gt; ~ <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id">t</span>') <span class="id">b</span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H7</span> <span class="id">H2</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span>,<span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>;<span class="tactic">simpl</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span>,<span class="id"><a href="FMemOpFP.html#free_fp">free_fp</a></span>,<span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_ff">FP.conflict_ff</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_ff">FP.conflict_ff</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOSemLemmas.html#add_minus_eq">add_minus_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>,<span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_wf">FP.conflict_wf</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>,<span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">enough</span>(<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id">t</span> <span class="id">sgm</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id">bufs</span>; <span class="id">memory</span> := <span class="id">tgm</span> |} (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tbfm</span>') <span class="id">bufs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tbfm</span>') |}).<br/>
&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">Hsimpl</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#sep_obj_client_block">sep_obj_client_block</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">H14</span> <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="RGRels.html#client_mem">client_mem</a></span> <span class="id">sgm</span> <span class="id">b0</span> <span class="id">ofs2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.unchecked_free">Mem.unchecked_free</a></span>,<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="tactic">destruct</span> <span class="id">H15</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">b0</span> <span class="id">b</span>) <span class="id">eqn</span>:?;<span class="id">ex_match2</span>;<span class="tactic">subst</span>;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">meminv_sep0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [? <span class="id">_</span> ?  <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">meminv_Ic0</span> <span class="kwd">as</span> [? <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_apply_buffer">TSOMemLemmas.unbuffer_safe_apply_buffer</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H2</span>,<span class="id">H15</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H10</span>;<span class="id">inv</span> <span class="id">H10</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H14</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H14</span>;<span class="id">ex_match</span>. <span class="id">inv</span> <span class="id">H14</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#rel_tm_gm_vb">rel_tm_gm_vb</a></span> <span class="kwd">in</span> <span class="id">meminv_rel_vb0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_rel_vb0</span>;<span class="tactic">eauto</span>. <span class="id">instantiate</span>(1:=<span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hx0</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#free">free</a></span>,<span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>,<span class="id"><a href="TSOMem.html#unchecked_free">unchecked_free</a></span>;<span class="tactic">intros</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hx0</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#tm_alloc_not_fl">tm_alloc_not_fl</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H15</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="kwd">forall</span> (<span class="id">b0</span> : <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>), <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt;-&gt; <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>) <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="SCSemLemmas.html#free_obj_mem_unchg">free_obj_mem_unchg</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="kwd">forall</span> (<span class="id">b0</span> : <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> -&gt; <span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> <span class="id">sgm</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>;<span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">r</span>. <span class="id">instantiate</span>(1:=<span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="id">inv</span> <span class="id">Hx1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span>. <span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R2</span>:  <span class="kwd">forall</span> (<span class="id">b0</span> : <span class="id"><a href="Values.html#block">block</a></span>) (<span class="id">ofs0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id"><a href="TSOMem.html#BufferedFree">BufferedFree</a></span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>  :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> -&gt; ~ <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id"><a href="AsmClientSim.html#b0">b0</a></span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H8</span>. <span class="id">inv</span> <span class="id">H9</span>. 2:<span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H12</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">ex_match</span>.  <span class="id">inv</span> <span class="id">H3</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> <span class="id">H11</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">specialize</span> (<span class="id">r</span> <span class="id">_</span> <span class="id">H16</span>) <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H11</span> <span class="kwd">in</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>;<span class="tactic">simpl</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOSemLemmas.html#unbuffer_safe_append_preserve">unbuffer_safe_append_preserve</a></span> <span class="kwd">with</span>(<span class="id">bi</span>:=<span class="id"><a href="TSOMem.html#BufferedFree">BufferedFree</a></span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>)(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>;<span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoupd">tsoupd</a></span> <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_apply_buffer">TSOMemLemmas.unbuffer_safe_apply_buffer</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOAuxDefs.html#buffer_safe">TSOAuxDefs.buffer_safe</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOAuxDefs.html#apply_buffer_app_eq">TSOAuxDefs.apply_buffer_app_eq</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="kwd">forall</span> <span class="id">ofs0</span>,  <span class="id">lo</span> &lt;= <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt; <span class="id">hi</span>-&gt; <span class="id"><a href="RGRels.html#eq_on_loc">eq_on_loc</a></span> <span class="id">b</span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> <span class="id">sgm</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id">b</span> <span class="id">ofs0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">R2</span>. <span class="id">econstructor</span>. <span class="id">left</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span>. <span class="id">ex_match2</span>;<span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">Hx</span>;<span class="tactic">clear</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span>;<span class="tactic">intros</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hx</span> <span class="id">Hx1</span> <span class="id">Hx0</span> <span class="id">H3</span>.  <span class="id">contradict</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#range_perm">range_perm</a></span> ;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">r</span> <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">_</span> ? <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">r</span>. <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> *;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eq_loc_perm</span> <span class="kwd">in</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Mem.perm_order</span>' <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="GMemory.html#GMem.access_max">GMem.access_max</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(2:=<span class="id">x</span>). <span class="id">instantiate</span>(2:=<span class="id">b</span>). <span class="id">instantiate</span>(1:=<span class="id">ofs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Memperm.perm_order</span>'';<span class="tactic">intro</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">r</span>;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOSemLemmas.html#inv_bi">inv_bi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">compute</span>[<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#fpsmile_nfconflict">fpsmile_nfconflict</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.smile_conflict_compat">FP.smile_conflict_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id">b0</span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">meminv_Ic0</span> <span class="kwd">as</span> [<span class="id">_</span> ? <span class="id">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H10</span>,<span class="id">H11</span>;<span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_no_conflict_bi</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>;<span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">R</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_no_conflict_bi</span>;<span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>;<span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">R</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Ic_no_conflict_bi</span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">meminv_Ic0</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">_</span> ?  ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~<span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sgm</span> <span class="id">b0</span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H9</span>;<span class="tactic">eapply</span> <span class="id">H6</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#apply_buffer_split">TSOMemLemmas.apply_buffer_split</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H0</span> <span class="kwd">as</span> ?. <span class="id">contradict</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H12</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H3</span> <span class="id">H8</span>;<span class="tactic">clear</span>;<span class="tactic">simpl</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H8</span>;<span class="id">ex_match</span>. <span class="id">inv</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span> <span class="kwd">in</span> *. <span class="id">ex_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hx</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> !<span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>;<span class="id">ex_match2</span>;<span class="tactic">subst</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H10</span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> ?. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H12</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>;<span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_on_loc_trans">eq_on_loc_trans</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">t</span>&lt;&gt;<span class="id">t0</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">t</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~  <span class="id"><a href="TSOMem.html#in_buffer_item">in_buffer_item</a></span> ( <span class="id"><a href="TSOMem.html#BufferedFree">BufferedFree</a></span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span>) <span class="id">b0</span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>;<span class="id">contradict</span> <span class="id">H10</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>;<span class="id">ex_match2</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="id">right</span>;<span class="tactic">auto</span>. <span class="id">left</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H12</span> <span class="id">H3</span>;<span class="tactic">clear</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>;<span class="tactic">intros</span>. <span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">simpl</span>;<span class="id">FMemLemmas.gmem_unfolds</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="id">b</span> <span class="id">lo</span> (<span class="id">hi</span>-<span class="id">lo</span>) <span class="id">b0</span> <span class="id">ofs</span>) <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOSemLemmas.html#add_minus_eq">add_minus_eq</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="id">inv</span> <span class="id">Heqb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOSemLemmas.html#add_minus_eq">add_minus_eq</a></span> <span class="kwd">in</span> <span class="id">Heqb1</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[ <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ? <span class="id">_</span> ] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#buf_alloc_invalid">buf_alloc_invalid</a></span>,<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>;<span class="tactic">simpl</span>;<span class="tactic">intros</span>;<span class="id">ex_match2</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOSemLemmas.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|];<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>;<span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[ <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ? ] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#alloc_norep_preserve">alloc_norep_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">inv</span> <span class="id">H2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemLemmas.html#free_forward">FMemLemmas.free_forward</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="load_refine">load_refine</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opSrc</span> := <span class="kwd">fun</span> <span class="id">sfm</span> <span class="id">fp</span> <span class="id">v</span> <span class="id">sfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id">sfm</span>' /\ <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#load_fp">load_fp</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opTgt</span> := <span class="kwd">fun</span> <span class="id">tbfm</span> <span class="id">fp</span> <span class="id">v</span> <span class="id">tbfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> = <span class="id">tbfm</span>' /\ <span class="id"><a href="TSOMem.html#tsoload">tsoload</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> /\ <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="FMemOpFP.html#load_fp">load_fp</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span> <span class="id"><a href="Values.html#val">val</a></span> <span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#opTgt">opTgt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9487')">Proof.</div>
<div class="proofscript" id="proof9487">
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( (<span class="kwd">forall</span> (<span class="id">sfp</span> : <span class="id"><a href="AsmClientSim.html#footprint">footprint</a></span>) (<span class="id">sres</span> : <span class="id"><a href="Values.html#val">val</a></span>) (<span class="id">sfm</span>' : <span class="id"><a href="FMemory.html#mem">mem</a></span>), ~ <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>') \/  ~(<span class="kwd">forall</span> (<span class="id">sfp</span> : <span class="id"><a href="AsmClientSim.html#footprint">footprint</a></span>) (<span class="id">sres</span> : <span class="id"><a href="Values.html#val">val</a></span>) (<span class="id">sfm</span>' : <span class="id"><a href="FMemory.html#mem">mem</a></span>), ~ <span class="id">opSrc</span> <span class="id">sfm</span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#sres">sres</a></span> <span class="id">sfm</span>')).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">Classical_Pred_Type.not_all_ex_not</a></span> <span class="kwd">in</span> <span class="id">H3</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">Classical_Prop.NNPP</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>,<span class="id">x0</span>,<span class="id">x1</span>. <span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id">x</span> <span class="id">tfp</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">opTgt</span>,<span class="id">opSrc</span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>( <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> <span class="id">tfp</span> <span class="id">bufs</span> \/ ~<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> <span class="id">tfp</span> <span class="id">bufs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>;[<span class="id">right</span>|<span class="id">left</span>];<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">opTgt</span>,<span class="id">opSrc</span> <span class="kwd">in</span> *. <span class="id">Hsimpl</span>;<span class="tactic">subst</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">R</span>:<span class="kwd">forall</span> <span class="id">ofs0</span>,  <span class="id">ofs</span> &lt;= <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span> &lt; <span class="id">ofs</span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id">chunk</span> -&gt;  <span class="kwd">forall</span> <span class="id">t</span>' : <span class="id"><a href="GlobDefs.html#tid">tid</a></span>, <span class="id">t</span>' &lt;&gt; <span class="id">t</span> -&gt; ~ <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id">t</span>') <span class="id">b</span> <span class="id"><a href="AsmClientSim.html#ofs0">ofs0</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoload">tsoload</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>,<span class="id"><a href="TSOMem.html#load">load</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H8</span>;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="id">contradict</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H6</span> <span class="id">H</span>;<span class="tactic">clear</span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#conflict_bi">conflict_bi</a></span>,<span class="id"><a href="FMemOpFP.html#load_fp">load_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Memdata.html#size_chunk_pos">size_chunk_pos</a></span> <span class="id">chunk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>;<span class="tactic">simpl</span>;<span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#uncheck_alloc_fp">uncheck_alloc_fp</a></span>,<span class="id"><a href="FMemOpFP.html#free_fp">free_fp</a></span>,<span class="id"><a href="FMemOpFP.html#store_fp">store_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_rf">FP.conflict_rf</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_rf">FP.conflict_rf</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="TSOSemLemmas.html#add_minus_eq">add_minus_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>,<span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.conflict_rw">FP.conflict_rw</a></span>. <span class="id">Locs.unfolds</span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>,<span class="id">ofs0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#range_locset">range_locset</a></span>;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>,<span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">x0</span> = <span class="id">tres</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoload">tsoload</a></span> <span class="kwd">in</span> <span class="id">H8</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>,<span class="id"><a href="TSOMem.html#load">load</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H8</span>;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemLemmas.html#get_eq_getN_eq">FMemLemmas.get_eq_getN_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;-<span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span>(1:=<span class="id">ofs0</span>). <span class="id">instantiate</span>(1:=<span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>[]. <span class="tactic">inversion</span> <span class="id">v</span>. <span class="id">specialize</span> (<span class="id">H6</span> <span class="id">ofs0</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="kwd">in</span> <span class="id">H3</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H0</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 (<span class="tactic">split</span>;<span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="ClientSim.html#Gc">Gc</a></span>  <span class="id">t</span> <span class="id">sgm</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id">bufs</span>; <span class="id">memory</span> := <span class="id">tgm</span> |} (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">x1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id">t</span> (<span class="id">bufs</span> <span class="id">t</span>) <span class="id">bufs</span>; <span class="id">memory</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">tfm</span> |}).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Esimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_same_eq">TSOMemLemmas.tupdate_same_eq</a></span>;<span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H</span>;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">econstructor</span>;<span class="id">FMemLemmas.gmem_unfolds</span>;<span class="tactic">try</span> <span class="tactic">tauto</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">instantiate</span>(1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id"><a href="GMemory.html#GMem.forward_refl">GMem.forward_refl</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">split</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>;<span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="TSOMemLemmas.html#tupdate_same_eq">TSOMemLemmas.tupdate_same_eq</a></span>;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>.<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_client_loc_forward">meminv_client_loc_forward</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">bufs</span> <span class="id">t</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">tgm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fl</span> := <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="RGRels.html#client_mem">client_mem</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tgm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id">tgm</span>' <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.perm">GMem.perm</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Memperm.Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.perm">GMem.perm</a></span> <span class="id">tgm</span>' <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Memperm.Nonempty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9488')">Proof.</div>
<div class="proofscript" id="proof9488">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>((<span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id">b</span> <span class="id">ofs</span>) \/ ~ (<span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id">b</span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Coqlib.html#peq">peq</a></span> <span class="id">x</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span> ;<span class="tactic">simpl</span> <span class="kwd">in</span>*.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>[].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.perm">GMem.perm</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> &lt;- <span class="id">eq_loc_perm</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span> <span class="kwd">as</span> [[? ? ? ? ? ] ? <span class="id">_</span> <span class="id">_</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_apply_buffer">TSOMemLemmas.unbuffer_safe_apply_buffer</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id">x</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>[].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GMemory.html#GMem.perm">GMem.perm</a></span> <span class="id">x0</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> <span class="id"><a href="Memperm.html#Nonempty">Memperm.Nonempty</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.perm">GMem.perm</a></span> <span class="kwd">in</span> *;<span class="id">erewrite</span> &lt;- <span class="id">eq_loc_perm</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#apply_buffer_forward">apply_buffer_forward</a></span>;<span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span>[].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="apply_buffer_item_validity_preserve">apply_buffer_item_validity_preserve</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">bi</span> <span class="id">b</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#apply_buffer_item">apply_buffer_item</a></span> <span class="id"><a href="AsmClientSim.html#bi">bi</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id">m</span>' <span class="id"><a href="AsmClientSim.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9489')">Proof.</div>
<div class="proofscript" id="proof9489">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bi</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#alloc">alloc</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span>,<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">H</span>;<span class="id">ex_match2</span>;<span class="id">inv</span> <span class="id">H</span>;<span class="tactic">simpl</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id">tm</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~ <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id">t</span>) <span class="id">b</span> <span class="id">ofs</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H8</span> <span class="id">H2</span> <span class="id">H3</span>.  <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> (<span class="id">bufs</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">tm</span>. <span class="tactic">clear</span> <span class="id">tfm</span> <span class="id">t</span> <span class="id">bufs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">revert</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">tm</span> <span class="id">tgm</span>' <span class="id">H8</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">b0</span>;<span class="tactic">intros</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">ex_match</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHb0</span>;<span class="tactic">eauto</span>. <span class="id">instantiate</span>(1:=<span class="id">ofs</span>). <span class="tactic">intros</span>[];<span class="id">contradict</span> <span class="id">H8</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">right</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H3</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">a</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#alloc">alloc</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span>,<span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hx</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">Hx</span>;<span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> <span class="id">H</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">contradict</span> <span class="id">H8</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">left</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">alloc_forward</span> <span class="kwd">in</span> <span class="id">H8</span> <span class="kwd">as</span> ?;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(~ <span class="id"><a href="TSOMem.html#in_buffer">in_buffer</a></span> (<span class="id">bufs</span> <span class="id">t</span>) <span class="id">b</span> <span class="id">ofs</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H10</span> <span class="id">H8</span> <span class="id">H2</span> <span class="id">H9</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> (<span class="id">bufs</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">tm</span>. <span class="tactic">clear</span> <span class="id">tfm</span> <span class="id">t</span> <span class="id">bufs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">revert</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">tm</span> <span class="id">tgm</span>' <span class="id">H8</span> <span class="id">H2</span> <span class="id">H9</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">b0</span>;<span class="tactic">intros</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#optbind">optbind</a></span> <span class="kwd">in</span> <span class="id">H2</span>;<span class="id">ex_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id">g</span> <span class="id">b</span>). <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#apply_buffer_item_validity_preserve">apply_buffer_item_validity_preserve</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHb0</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span>,<span class="id"><a href="TSOMem.html#free">free</a></span>,<span class="id"><a href="TSOMem.html#alloc">alloc</a></span> <span class="kwd">in</span> <span class="id">Hx</span>;<span class="id">ex_match</span>;<span class="id">inv</span> <span class="id">Hx</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> *;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="id">ex_match2</span>;<span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H10</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">left</span>;<span class="tactic">eauto</span>. <span class="tactic">subst</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gsspec">PMap.gsspec</a></span>. <span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H10</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">left</span>;<span class="tactic">eauto</span>. <span class="tactic">subst</span>;<span class="id">econstructor</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>,<span class="id"><a href="Coqlib.html#zlt">zlt</a></span>;<span class="tactic">auto</span>;<span class="id">inv</span> <span class="id">Hx1</span>;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>[];<span class="id">contradict</span> <span class="id">H10</span>. <span class="id">econstructor</span>;<span class="tactic">eauto</span>. <span class="id">right</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">meminv_Ic0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Ic_mem_eq</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>[].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="GMemory.html#GMem.perm">GMem.perm</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> &lt;-<span class="id">eq_loc_perm</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="tso_valid_pointer_matchc">tso_valid_pointer_matchc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tfm</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">t</span>  <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span>)(<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tgm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>)(<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tgm</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id">tgm</span>' <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span> {|<span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span>:=<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>;<span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>|} <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9490')">Proof.</div>
<div class="proofscript" id="proof9490">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">Mem.weak_valid_pointer</a></span>,<span class="id"><a href="TSOAuxDefs.html#tso_weak_valid_pointer">TSOAuxDefs.tso_weak_valid_pointer</a></span>,<span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span>,<span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_apply_buffer">unbuffer_safe_apply_buffer</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>. <span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.perm_dec">Mem.perm_dec</a></span>,<span class="id"><a href="TSOMem.html#perm_dec">perm_dec</a></span>;<span class="id">inv</span> <span class="id">H1</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">n</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_client_loc_forward">meminv_client_loc_forward</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span>((<span class="id"><a href="GMemory.html#GMem.mem_access">GMem.mem_access</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sm</span>)) !! <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sm</span>);<span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">access_max</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">p</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">p</span>;<span class="id">inv</span> <span class="id">p</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H4</span>;<span class="id">inv</span> <span class="id">H4</span>;<span class="tactic">auto</span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="tso_weak_valid_pointer_matchc">tso_weak_valid_pointer_matchc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tfm</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">t</span>  <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span>)(<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">Mem.weak_valid_pointer</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tgm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>)(<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tgm</span>'-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="GMemory.html#GMem.valid_block">GMem.valid_block</a></span> <span class="id">tgm</span>' <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOAuxDefs.html#tso_weak_valid_pointer">TSOAuxDefs.tso_weak_valid_pointer</a></span> {|<span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span>:=<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>;<span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>|} <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9491')">Proof.</div>
<div class="proofscript" id="proof9491">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">Mem.weak_valid_pointer</a></span>,<span class="id"><a href="TSOAuxDefs.html#tso_weak_valid_pointer">TSOAuxDefs.tso_weak_valid_pointer</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_iff">orb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [].<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="AsmClientSim.html#tso_valid_pointer_matchc">tso_valid_pointer_matchc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="AsmClientSim.html#tso_valid_pointer_matchc">tso_valid_pointer_matchc</a></span> <span class="kwd">with</span>(<span class="id">ofs</span> :=<span class="id">ofs</span> -1 );<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">bool</span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tfm</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">t</span>  <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span>)(<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span>) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOAuxDefs.html#tso_weak_valid_pointer">TSOAuxDefs.tso_weak_valid_pointer</a></span> {|<span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span>:=<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>;<span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>|} <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.weak_valid_pointer">Mem.weak_valid_pointer</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="AsmTSO.html#tso_weak_valid_pointer_fp">tso_weak_valid_pointer_fp</a></span> {|<span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span>:=<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>;<span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>|} <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>)(<span class="id"><a href="FMemOpFP.html#weak_valid_pointer_fp">weak_valid_pointer_fp</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9492')">Proof.</div>
<div class="proofscript" id="proof9492">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> [[? <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="TSOMemLemmas.html#unbuffer_safe_apply_buffer">unbuffer_safe_apply_buffer</a></span> <span class="kwd">with</span>(<span class="id">t</span>:=<span class="id">t</span>) <span class="kwd">in</span> <span class="id">Ic_ub_safe</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">Hsimpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#tso_weak_valid_pointer_fp">tso_weak_valid_pointer_fp</a></span>,<span class="id"><a href="FMemOpFP.html#weak_valid_pointer_fp">weak_valid_pointer_fp</a></span>,<span class="id"><a href="FMemOpFP.html#valid_pointer_fp">valid_pointer_fp</a></span>,<span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span>;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>;<span class="id">constructor</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#Locs.subset_refl">Locs.subset_refl</a></span>;<span class="tactic">simpl</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="FMemLemmas.html#range_locset_expend1_subset">FMemLemmas.range_locset_expend1_subset</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#perm_dec">perm_dec</a></span>,<span class="id"><a href="FMemory.html#Mem.perm_dec">Mem.perm_dec</a></span> ;<span class="id">inv</span> <span class="id">Hx</span>;<span class="id">inv</span> <span class="id">Hx0</span>.<br/>
&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_client_loc_forward">meminv_client_loc_forward</a></span>;<span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H</span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span>((<span class="id"><a href="GMemory.html#GMem.mem_access">GMem.mem_access</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sm</span>)) !! <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sm</span>);<span class="tactic">split</span>;<span class="tactic">auto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">access_max</span> <span class="id">b</span> <span class="id">ofs</span>) <span class="kwd">as</span> ?.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">p</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#strip">strip</a></span>;<span class="tactic">simpl</span>;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">p</span>;<span class="id">inv</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOAuxDefs.html#tso_weak_valid_pointer">TSOAuxDefs.tso_weak_valid_pointer</a></span>,<span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">ex_match2</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_iff">orb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H1</span> <span class="kwd">as</span> [|];<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#perm_dec">perm_dec</a></span>;<span class="tactic">try</span> <span class="tactic">discriminate</span>;<span class="tactic">eapply</span> <span class="id"><a href="InteractionSemantics.html#Memperm_validblock">Memperm_validblock</a></span>;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_compare_ints_fp_subset">meminv_compare_ints_fp_subset</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">bufs</span> <span class="id">t</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fl</span> := <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#check_compare_ints_TSO">check_compare_ints_TSO</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Footprint.html#FP.subset">FP.subset</a></span> (<span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="AsmLang.html#compare_ints_fp">compare_ints_fp</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9493')">Proof.</div>
<div class="proofscript" id="proof9493">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span>,<span class="id"><a href="AsmTSO.html#check_compare_ints_TSO">check_compare_ints_TSO</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">ex_match2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_ints_fp">compare_ints_fp</a></span>,<span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#tso_cmpu_bool_fp_total">tso_cmpu_bool_fp_total</a></span>,<span class="id"><a href="Cop_fp.html#cmpu_bool_fp_total">Cop_fp.cmpu_bool_fp_total</a></span>,<span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="kwd">in</span> *;<span class="id">ex_match2</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>;<span class="tactic">compute</span>["&amp;&amp;"] <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>; <span class="tactic">eapply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#tso_cmpu_bool_fp_total">tso_cmpu_bool_fp_total</a></span>,<span class="id"><a href="Cop_fp.html#cmpu_bool_fp_total">Cop_fp.cmpu_bool_fp_total</a></span>,<span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="kwd">in</span> *;<span class="id">ex_match2</span>;<span class="tactic">subst</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_parallel_union">FP.subset_parallel_union</a></span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>;<span class="tactic">compute</span>["&amp;&amp;"] <span class="kwd">in</span> *;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>;<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#tso_weak_valid_pointer_fp_matchc">tso_weak_valid_pointer_fp_matchc</a></span>;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_compare_ints_not_conflict_eq">meminv_compare_ints_not_conflict_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">bufs</span> <span class="id">t</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fl</span> := <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#check_compare_ints_TSO">check_compare_ints_TSO</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>)) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#compare_ints">compare_ints</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="AsmTSO.html#compare_ints_TSO">compare_ints_TSO</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9494')">Proof.</div>
<div class="proofscript" id="proof9494">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_ints">compare_ints</a></span>,<span class="id"><a href="AsmTSO.html#compare_ints_TSO">compare_ints_TSO</a></span>,<span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span>,<span class="id"><a href="AsmTSO.html#check_compare_ints_TSO">check_compare_ints_TSO</a></span>;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;2: <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>,<span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>,<span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_match2</span>;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_extcall_arg">meminv_extcall_arg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">rs</span> <span class="id">a</span> <span class="id">fp</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ASM_local.html#extcall_arg_fp">extcall_arg_fp</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#extcall_arg">extcall_arg</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> {| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>; <span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> |} <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#extcall_arg">AsmLang.extcall_arg</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) /\ <span class="id">v</span>' = <span class="id"><a href="AsmClientSim.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">v</span>', ~ <span class="id"><a href="AsmLang.html#extcall_arg">AsmLang.extcall_arg</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9495')">Proof.</div>
<div class="proofscript" id="proof9495">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">repeat</span> <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id">eqn</span>:<span class="id">Haddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#load_refine">load_refine</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">fp</span>' &amp; <span class="id">v</span>' &amp; <span class="id">_</span> &amp; (<span class="id">_</span> &amp; <span class="id">Hload</span> &amp; <span class="id">Hfp</span>) &amp; [(<span class="id">Hdrf</span> &amp; <span class="id">Hmatch</span> &amp; <span class="id">Hv</span> &amp; <span class="id">_</span>) |<span class="id">Hrace</span>]) |<span class="id">Habort</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>|<span class="id">left</span>|<span class="id">right</span>]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">simpl</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">eauto</span>. }<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_extcall_arg_pair">meminv_extcall_arg_pair</a></span>:<br/>
<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">rs</span> <span class="id">a</span> <span class="id">fp</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ASM_local.html#extcall_arg_pair_fp">extcall_arg_pair_fp</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> {| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>; <span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> |} <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#extcall_arg_pair">AsmLang.extcall_arg_pair</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) /\ <span class="id">v</span>' = <span class="id"><a href="AsmClientSim.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">v</span>', ~ <span class="id"><a href="AsmLang.html#extcall_arg_pair">AsmLang.extcall_arg_pair</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9496')">Proof.</div>
<div class="proofscript" id="proof9496">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_extcall_arg">meminv_extcall_arg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [(<span class="id">v</span>' &amp; <span class="id">Harg</span> &amp; <span class="id">Hfp</span>) | <span class="id">Habort</span>]; [<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_extcall_arg">meminv_extcall_arg</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_extcall_arg">meminv_extcall_arg</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [(<span class="id">vhi</span>' &amp; <span class="id">Hhi</span> &amp; <span class="id">Hfp1</span>) | <span class="id">Habort</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span> <span class="kwd">as</span> [(<span class="id">vlo</span>' &amp; <span class="id">Hlo</span> &amp; <span class="id">Hfp2</span>) | <span class="id">Habort</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfp1</span> <span class="kwd">as</span> [[<span class="id">Hfp1</span> <span class="id">Hhi</span>']|<span class="id">Hrace</span>];[|<span class="id">right</span>; <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfp2</span> <span class="kwd">as</span> [[<span class="id">Hfp2</span> <span class="id">Hlo</span>']|<span class="id">Hrace</span>];[|<span class="id">right</span>; <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intro</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_extcall_arguments">meminv_extcall_arguments</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">rs</span> <span class="id">sig</span> <span class="id">args</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#extcall_arguments">extcall_arguments</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#sig">sig</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ASM_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sig">sig</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">args</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#extcall_arguments">AsmLang.extcall_arguments</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#sig">sig</a></span> <span class="id">args</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) /\ <span class="id">args</span>' = <span class="id"><a href="AsmClientSim.html#args">args</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">args</span>', ~ <span class="id"><a href="AsmLang.html#extcall_arguments">AsmLang.extcall_arguments</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#sig">sig</a></span> <span class="id">args</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9497')">Proof.</div>
<div class="proofscript" id="proof9497">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#extcall_arguments">extcall_arguments</a></span>, <span class="id"><a href="ASM_local.html#extcall_arguments_fp">extcall_arguments_fp</a></span>, <span class="id"><a href="AsmLang.html#extcall_arguments">AsmLang.extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">sig</span>. <span class="tactic">generalize</span> (<span class="id"><a href="Conventions1.html#loc_arguments">Conventions1.loc_arguments</a></span> <span class="id">sig</span>). <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">revert</span> <span class="id">fp</span> <span class="id">H3</span>. <span class="tactic">induction</span> <span class="id">H2</span>; <span class="tactic">intros</span> <span class="id">fp</span> <span class="id">Hfp</span>; <span class="id">inv</span> <span class="id">Hfp</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_extcall_arg_pair">meminv_extcall_arg_pair</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [(<span class="id">v</span>' &amp; <span class="id">Harg</span> &amp; <span class="id">A</span>) | <span class="id">Habort</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlist_forall2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [(<span class="id">args</span>' &amp; <span class="id">Hargs</span> &amp; <span class="id">B</span>) | <span class="id">Habort</span>]; [<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [[<span class="id">Hdrf</span> <span class="id">Hv</span>']|<span class="id">Hrace</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">B</span> <span class="kwd">as</span> [[<span class="id">Hdrf</span>' <span class="id">Hargs</span>']|<span class="id">Hrace</span>']; [<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>. <span class="tactic">intro</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">destruct</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_args_refine">store_args_refine</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">args</span> <span class="id">tys</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opSrc</span> := <span class="kwd">fun</span> <span class="id">sfm</span> <span class="id">fp</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">sfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sfm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">opTgt</span> := <span class="kwd">fun</span> <span class="id">tbfm</span> <span class="id">fp</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">tbfm</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span> <span class="id"><a href="AsmClientSim.html#tbfm">tbfm</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tbfm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#fp">fp</a></span> = <span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span> <span class="id"><a href="AsmClientSim.html#opSrc">opSrc</a></span> <span class="id"><a href="AsmClientSim.html#opTgt">opTgt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9498')">Proof.</div>
<div class="proofscript" id="proof9498">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span>, <span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span>,<span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> 0. <span class="tactic">intros</span> <span class="id">until</span> <span class="id">tys</span>. <span class="id">revert</span> <span class="id">z</span> <span class="id">args</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tys</span>; <span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmClientSim.html#memops_refine">memops_refine</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">args</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="loadframe.html#store_args_rec_fp">loadframe.store_args_rec_fp</a></span> <span class="id">stk</span> <span class="id">z</span> (<span class="id">a</span> :: <span class="id">tys</span>)) <span class="kwd">as</span> <span class="id">FP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">args</span>; [<span class="id">inv</span> <span class="id">H2</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span> |- *; <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack_fmem">loadframe.store_stack_fmem</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> ?<span class="id">v</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> <span class="id">v</span>); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp1</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm1</span> &amp; (<span class="id">Hstore1</span> &amp; <span class="id">Hfp1</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf1</span> &amp; <span class="id">Hfpmatch1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch1</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtys</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv1</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm2</span> &amp; (<span class="id">Hstore2</span> &amp; <span class="id">Hfp2</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf2</span> &amp; <span class="id">Hfpmatch2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch2</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">Hstore2</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> ?<span class="id">v</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> <span class="id">v</span>); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp1</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm1</span> &amp; (<span class="id">Hstore1</span> &amp; <span class="id">Hfp1</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf1</span> &amp; <span class="id">Hfpmatch1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch1</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtys</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv1</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm2</span> &amp; (<span class="id">Hstore2</span> &amp; <span class="id">Hfp2</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf2</span> &amp; <span class="id">Hfpmatch2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch2</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">Hstore2</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int64.hiword">Int64.hiword</a></span> <span class="id">i</span>))] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int64.hiword">Int64.hiword</a></span> <span class="id">i</span>))); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp1</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm1</span> &amp; (<span class="id">Hstore1</span> &amp; <span class="id">Hfp1</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf1</span> &amp; <span class="id">Hfpmatch1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict1</span> <span class="id">Hfpmatch1</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>]; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">Hstore1</span>; [| | <span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id">i</span>))] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id">i</span>))); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm2</span> &amp; (<span class="id">Hstore2</span> &amp; <span class="id">Hfp2</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf2</span> &amp; <span class="id">Hfpmatch2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict2</span> <span class="id">Hfpmatch2</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>]; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">Hstore2</span>; [| | <span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtys</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv2</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp3</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm3</span> &amp; (<span class="id">Hstore3</span> &amp; <span class="id">Hfp3</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf3</span> &amp; <span class="id">Hfpmatch3</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv3</span> &amp; <span class="id">HGc3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict3</span> <span class="id">Hfpmatch3</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">Hstore3</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack_fp">loadframe.store_stack_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">destruct</span> <span class="id">C</span> <span class="kwd">as</span> [<span class="id">C</span>|<span class="id">C</span>]. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">destruct</span> <span class="id">C</span> <span class="kwd">as</span> [<span class="id">C</span>|<span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf3</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">Habort</span>; <span class="tactic">clear</span>; <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id">i</span>))); [|<span class="id">right</span>;<span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">Habort</span>; <span class="tactic">clear</span>; <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> ?<span class="id">v</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> <span class="id">v</span>); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp1</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm1</span> &amp; (<span class="id">Hstore1</span> &amp; <span class="id">Hfp1</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf1</span> &amp; <span class="id">Hfpmatch1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch1</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtys</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv1</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm2</span> &amp; (<span class="id">Hstore2</span> &amp; <span class="id">Hfp2</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf2</span> &amp; <span class="id">Hfpmatch2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch2</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">Hstore2</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> ?<span class="id">v</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> <span class="id">v</span>); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp1</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm1</span> &amp; (<span class="id">Hstore1</span> &amp; <span class="id">Hfp1</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf1</span> &amp; <span class="id">Hfpmatch1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch1</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtys</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv1</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm2</span> &amp; (<span class="id">Hstore2</span> &amp; <span class="id">Hfp2</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf2</span> &amp; <span class="id">Hfpmatch2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch2</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">Hstore2</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">stk</span> ?<span class="id">ofs</span> ?<span class="id">v</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span> <span class="id">chunk</span> <span class="id">stk</span> <span class="id">ofs</span> <span class="id">v</span>); <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp1</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm1</span> &amp; (<span class="id">Hstore1</span> &amp; <span class="id">Hfp1</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf1</span> &amp; <span class="id">Hfpmatch1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch1</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHtys</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv1</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_get_same">tupdate_update_get_same</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm2</span> &amp; (<span class="id">Hstore2</span> &amp; <span class="id">Hfp2</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(<span class="id">Hdrf2</span> &amp; <span class="id">Hfpmatch2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|[<span class="id">Hconflict</span> <span class="id">Hfpmatch2</span>]])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id">Habort</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">Hstore2</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>; <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">right</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_rec_fmem">loadframe.store_args_rec_fmem</a></span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intros</span> [<span class="id">C</span> <span class="id">_</span>]; <span class="id">inv</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="tactic">split</span>;[|<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">FP</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span>. <span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;}<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="meminv_initialize">meminv_initialize</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">args</span> <span class="id">tys</span> <span class="id">z</span> <span class="id">bm1</span> <span class="id">stk</span> <span class="id">tsofm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#args_len_rec">loadframe.args_len_rec</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tsoalloc">tsoalloc</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) 0 (4 * <span class="id"><a href="AsmClientSim.html#z">z</a></span>) (<span class="id"><a href="AsmClientSim.html#bm1">bm1</a></span>, <span class="id"><a href="AsmClientSim.html#stk">stk</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span> <span class="id"><a href="AsmClientSim.html#bm1">bm1</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tsofm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bufs</span>' := (<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tsofm</span>') <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tm</span>' := (<span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tsofm</span>')) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">sfm1</span> <span class="id">sfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> 0 (4 * <span class="id"><a href="AsmClientSim.html#z">z</a></span>) = (<span class="id"><a href="AsmClientSim.html#sfm1">sfm1</a></span>, <span class="id"><a href="AsmClientSim.html#stk">stk</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span> <span class="id"><a href="AsmClientSim.html#sfm1">sfm1</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sfm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>') (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id">bufs</span>' <span class="id">tm</span>') /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>') <span class="id">bufs</span>' <span class="id">tm</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> 0 (4 * <span class="id"><a href="AsmClientSim.html#z">z</a></span>)) <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> 0 (4 * <span class="id"><a href="AsmClientSim.html#z">z</a></span>))) <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9499')">Proof.</div>
<div class="proofscript" id="proof9499">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">remember</span> (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id">bufs</span> <span class="id">tm</span>) <span class="kwd">as</span> <span class="id">TM</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">sfm</span> 0 (4 * <span class="id">z</span>)) <span class="kwd">as</span> [<span class="id">sfm1</span> <span class="id">stk</span>'] <span class="id">eqn</span>:<span class="id">Halloc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">stk</span>' = <span class="id">stk</span>) <span class="kwd">as</span> <span class="id">Hstk</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">Mem.alloc_result</a></span> <span class="kwd">in</span> <span class="id">Halloc</span>. <span class="tactic">subst</span> <span class="id">stk</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H11</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>) (<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">fm</span>') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>) (<span class="id"><a href="FMemory.html#Mem.validblocks">Mem.validblocks</a></span> <span class="id">sfm</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_rel_vb">meminv_rel_vb</a></span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_validity_eq_nextblock">eq_validity_eq_nextblock</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1:= (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm</span>')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">simpl</span>. <span class="id">specialize</span> (<span class="id">H4</span> <span class="id">n</span>). <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>, &lt;- <span class="id">H3</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">stk</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id">stk</span> 0 (4 * <span class="id">z</span>)) (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">TM</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [|<span class="id">Hnotconflict</span>].<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span> <span class="id">sfm1</span> <span class="id">stk</span> <span class="id">args</span> <span class="id">tys</span>) <span class="id">eqn</span>:<span class="id">A</span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">TM</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> (<span class="id"><a href="loadframe.html#store_args_fp">loadframe.store_args_fp</a></span> <span class="id">stk</span> <span class="id">tys</span>) (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">TM</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">apply</span> <span class="id">Hnotconflict</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflict_store_args_conflict_alloc">conflict_store_args_conflict_alloc</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#alloc_refine">alloc_refine</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">fp1</span> &amp; <span class="id">stk</span>' &amp; <span class="id">sfm1</span>' &amp; (<span class="id">Halloc</span>' &amp; <span class="id">Hfp</span>) &amp; [<span class="id">Hmatch</span>|[<span class="id">Hconflict</span> <span class="id">_</span>]]) | <span class="id">Habort</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">Hnotconflict</span>; <span class="tactic">subst</span> <span class="id">TM</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>| <span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fp1</span>. <span class="tactic">destruct</span> <span class="id">Hmatch</span> <span class="kwd">as</span> (<span class="id">_</span> &amp; <span class="id">_</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>). <span class="tactic">rewrite</span> <span class="id">Halloc</span> <span class="kwd">in</span> <span class="id">Halloc</span>'; <span class="id">inv</span> <span class="id">Halloc</span>'.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#store_args_refine">store_args_refine</a></span>. <span class="tactic">exact</span> <span class="id">Hmeminv1</span>.<br/>
&nbsp;embed&nbsp;after&nbsp;alloc...&nbsp;*)</span>&nbsp;&nbsp;{ <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">Mem.alloc_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">bm1</span>)). <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>. <span class="tactic">clear</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">bm1</span> <span class="kwd">with</span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">bm1</span>) (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">bm1</span>)) <span class="kwd">in</span> <span class="id">H4</span> <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">bm1</span>; <span class="tactic">auto</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp2</span> &amp; <span class="id">_</span> &amp; <span class="id">sfm</span>' &amp; (<span class="id">Hstoreargs</span> &amp; <span class="id">Hsfp2</span>) &amp; [(<span class="id">_</span> &amp; <span class="id">_</span> &amp; <span class="id">_</span> &amp; <span class="id">Hmeminv</span>' &amp; <span class="id">HGc</span>' )| [<span class="id">Hconflict</span> <span class="id">_</span>]])|<span class="id">Habort</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>|<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">sfm1</span>', <span class="id">sfm</span>'. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">bufs</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">H5</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>. <span class="id">contradiction</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span>; <span class="tactic">auto</span>. <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="store_args_succeed_tso">store_args_succeed_tso</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">args</span> <span class="id">tys</span> <span class="id">z</span> <span class="id">m</span> <span class="id">stk</span> <span class="id">m</span>' <span class="id">tfm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#args_len_rec">loadframe.args_len_rec</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span> <span class="id"><a href="AsmClientSim.html#m">m</a></span> <span class="id"><a href="AsmClientSim.html#stk">stk</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span> (<span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span> {| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>; <span class="id">fmemory</span> := <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) 0 (4 * <span class="id"><a href="AsmClientSim.html#z">z</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#tys">tys</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tfm</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">exists</span> <span class="id">m</span>'', <span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tfm</span>') (<span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tfm</span>')) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>''.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9500')">Proof.</div>
<div class="proofscript" id="proof9500">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#store_args_fmem">store_args_fmem</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">tfm</span>). <span class="tactic">intro</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span> {| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>; <span class="id">fmemory</span> := <span class="id">tfm</span> |} (<span class="id"><a href="TSOMem.html#BufferedAlloc">BufferedAlloc</a></span> <span class="id">b</span> 0 (4 * <span class="id">z</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> <span class="id">tbfm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">z0</span>, <span class="id"><a href="AsmClientSim.html#z0">z0</a></span> = 0) <span class="kwd">as</span> [<span class="id">z0</span> <span class="id">Hz0</span>] <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">buf</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> <span class="id">tbfm</span> (<span class="id"><a href="Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) 0 <span class="id">args</span> <span class="id">tys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tbfm</span> ++ <span class="id">buf</span>') (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tbfm</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">bi</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="AsmClientSim.html#bi">bi</a></span> <span class="id">buf</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">chunk</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#bi">bi</a></span> = <span class="id"><a href="TSOMem.html#BufferedStore">BufferedStore</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id">b</span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">z0</span> &lt;= <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> + <span class="id"><a href="Memdata.html#size_chunk">size_chunk</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> &lt;= 4 * <span class="id">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id"><a href="Memdata.html#align_chunk">align_chunk</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> | <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>))).<br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">Heqtbfm</span>. <span class="tactic">clear</span> <span class="id">tfm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (4 * <span class="id">z</span>) <span class="kwd">with</span> (0 + (4 * <span class="id">z</span>)) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_args_fmem">loadframe.store_args_fmem</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (4 | 0). <span class="id">remember</span> 0 <span class="kwd">as</span> <span class="id">z</span>'. <span class="tactic">cut</span> (<span class="id">z</span>' &gt;= 0). <span class="tactic">rewrite</span> <span class="id">Heqz</span>' <span class="kwd">in</span> <span class="id">Hz0</span>. <span class="tactic">clear</span> <span class="id">Heqz</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">z</span>'. <span class="id">revert</span> <span class="id">args</span> <span class="id">z</span> <span class="id">tbfm</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">z0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tys</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#args_len_rec">loadframe.args_len_rec</a></span>. <span class="tactic">intros</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">args</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> <span class="id">tbfm</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">args</span> <span class="kwd">as</span> [|<span class="id">v</span> <span class="id">args</span>]; [<span class="id">inv</span> <span class="id">H</span>|]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="val_casted.html#val_has_type_func">val_casted.val_has_type_func</a></span>; [|<span class="id">inv</span> <span class="id">H</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="loadframe.html#args_len_rec">loadframe.args_len_rec</a></span> <span class="id">eqn</span>:<span class="id">A</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">args</span> <span class="id">z0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (4 * (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id">a</span> + <span class="id">z0</span>)) <span class="kwd">as</span> <span class="id">OFS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="loadframe.html#store_stack_fmem">loadframe.store_stack_fmem</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;int&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>. <span class="tactic">destruct</span> <span class="id">Hstore</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> ?<span class="id">tm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">tm</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>). <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>. <span class="tactic">intro</span> <span class="id">Halign0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">z</span>'0 + 4 &gt;= 0) <span class="kwd">as</span> <span class="id">Hge0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">_</span> <span class="id">Hge0</span> <span class="id">Halign0</span> <span class="id">H2</span>). <span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">buf_tail</span> &amp; <span class="id">Hstoreargs</span> &amp; <span class="id">Hbuf_tail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstoreargs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hstoreargs</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">z</span>'0)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tint">Tint</a></span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">Hbuf_tail</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tint">Tint</a></span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor2">Zred_factor2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;float64&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>. <span class="tactic">destruct</span> <span class="id">Hstore</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> ?<span class="id">tm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">tm</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>). <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_factor_l">Z.divide_factor_l</a></span>. <span class="tactic">intro</span> <span class="id">Halign0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=2) <span class="kwd">in</span> <span class="id">Halign0</span>. <span class="tactic">replace</span> (4 * 2) <span class="kwd">with</span> 8 <span class="kwd">in</span> <span class="id">Halign0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">z</span>'0 + 8 &gt;= 0) <span class="kwd">as</span> <span class="id">Hge0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">_</span> <span class="id">Hge0</span> <span class="id">Halign0</span> <span class="id">H2</span>). <span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">buf_tail</span> &amp; <span class="id">Hstoreargs</span> &amp; <span class="id">Hbuf_tail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstoreargs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hstoreargs</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">z</span>'0)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tfloat">Tfloat</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">Hbuf_tail</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tfloat">Tfloat</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor4">Zred_factor4</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;long&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Values.html#Vint">Vint</a></span> (<span class="id"><a href="Integers.html#Int64.loword">Int64.loword</a></span> <span class="id">i</span>))) <span class="id">eqn</span>:<span class="id">Hstore2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore1</span>. <span class="tactic">destruct</span> <span class="id">Hstore1</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore2</span>. <span class="tactic">destruct</span> <span class="id">Hstore2</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> ?<span class="id">tm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">tm</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>). <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_factor_l">Z.divide_factor_l</a></span>. <span class="tactic">intro</span> <span class="id">Halign0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=2) <span class="kwd">in</span> <span class="id">Halign0</span>. <span class="tactic">replace</span> (4 * 2) <span class="kwd">with</span> 8 <span class="kwd">in</span> <span class="id">Halign0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">z</span>'0 + 8 &gt;= 0) <span class="kwd">as</span> <span class="id">Hge0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">_</span> <span class="id">Hge0</span> <span class="id">Halign0</span> <span class="id">H2</span>). <span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">buf_tail</span> &amp; <span class="id">Hstoreargs</span> &amp; <span class="id">Hbuf_tail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstoreargs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hstoreargs</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span>|[<span class="id">H</span>|<span class="id">H</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id">z</span>'0 + 4))); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor4">Zred_factor4</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">replace</span> (4 * 2) <span class="kwd">with</span> (4 + 4) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">rewrite</span> &lt;-(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span> 4 4 (4*<span class="id">z0</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">omega</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">z</span>'0 )); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor4">Zred_factor4</a></span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">Hbuf_tail</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tlong">Tlong</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor4">Zred_factor4</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;float32&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>. <span class="tactic">destruct</span> <span class="id">Hstore</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> ?<span class="id">tm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">tm</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>). <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>. <span class="tactic">intro</span> <span class="id">Halign0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">z</span>'0 + 4 &gt;= 0) <span class="kwd">as</span> <span class="id">Hge0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">_</span> <span class="id">Hge0</span> <span class="id">Halign0</span> <span class="id">H2</span>). <span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">buf_tail</span> &amp; <span class="id">Hstoreargs</span> &amp; <span class="id">Hbuf_tail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstoreargs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hstoreargs</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">z</span>'0)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tsingle">Tsingle</a></span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">Hbuf_tail</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tsingle">Tsingle</a></span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor2">Zred_factor2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;any32&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>. <span class="tactic">destruct</span> <span class="id">Hstore</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> ?<span class="id">tm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">tm</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>). <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>. <span class="tactic">intro</span> <span class="id">Halign0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">z</span>'0 + 4 &gt;= 0) <span class="kwd">as</span> <span class="id">Hge0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">_</span> <span class="id">Hge0</span> <span class="id">Halign0</span> <span class="id">H2</span>). <span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">buf_tail</span> &amp; <span class="id">Hstoreargs</span> &amp; <span class="id">Hbuf_tail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstoreargs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hstoreargs</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">z</span>'0)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tany32">Tany32</a></span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">Hbuf_tail</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tany32">Tany32</a></span>) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor2">Zred_factor2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;any64&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">Hstore</span>. <span class="tactic">destruct</span> <span class="id">Hstore</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Halign</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> | |- <span class="id">context</span>[<span class="id"><a href="AsmTSO.html#store_args_rec_fmem">store_args_rec_fmem</a></span> ?<span class="id">tm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>] =&gt; <span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">tm</span>) <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>). <span class="tactic">exact</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_factor_l">Z.divide_factor_l</a></span>. <span class="tactic">intro</span> <span class="id">Halign0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=2) <span class="kwd">in</span> <span class="id">Halign0</span>. <span class="tactic">replace</span> (4 * 2) <span class="kwd">with</span> 8 <span class="kwd">in</span> <span class="id">Halign0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">z</span>'0 + 8 &gt;= 0) <span class="kwd">as</span> <span class="id">Hge0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtys</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">_</span> <span class="id">Hge0</span> <span class="id">Halign0</span> <span class="id">H2</span>). <span class="tactic">destruct</span> <span class="id">IHtys</span> <span class="kwd">as</span> (<span class="id">buf_tail</span> &amp; <span class="id">Hstoreargs</span> &amp; <span class="id">Hbuf_tail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hstoreargs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Hstoreargs</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">bi</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span> <span class="kwd">in</span> *. <span class="tactic">split</span>. <span class="tactic">destruct</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> (<span class="id"><a href="Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">z</span>'0)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.unsigned_repr_eq">Ptrofs.unsigned_repr_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_le_mono">Z.add_le_mono</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mod_le">Z.mod_le</a></span>. <span class="tactic">omega</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id"><a href="Integers.html#Ptrofs.modulus_pos">Ptrofs.modulus_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">apply</span> <span class="id"><a href="loadframe.html#args_len_rec_non_neg">loadframe.args_len_rec_non_neg</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tany64">Tany64</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">Hbuf_tail</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">OFS</span>. <span class="tactic">replace</span> (<span class="id"><a href="Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="AST.html#Tany64">Tany64</a></span>) <span class="kwd">with</span> 2 <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.OmegaLemmas.html#Zred_factor4">Zred_factor4</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">buf</span> &amp; <span class="id">Hstore</span> &amp; <span class="id">Hbuf</span>). <span class="tactic">rewrite</span> <span class="id">Hstore</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">Hstore</span>. <span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">tbfm</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> <span class="id">_</span> ?<span class="id">m</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> <span class="id">m</span> <span class="kwd">as</span> <span class="id">M</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="TSOMem.html#range_perm">range_perm</a></span> <span class="id">M</span> <span class="id">b</span> 0 (4 * <span class="id">z</span>) <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span> <span class="id"><a href="Memperm.html#Writable">Memperm.Writable</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">M</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">ofs</span> <span class="id">Hofs</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">simpl</span>. <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">z0</span>. <span class="id">revert</span> <span class="id">H1</span> <span class="id">Hbuf</span>. <span class="tactic">clear</span>. <span class="id">revert</span> <span class="id">M</span>. <span class="tactic">generalize</span> (4 * <span class="id">z</span>). <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">Bound</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">buf</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">simpl</span>. <span class="id">exploit</span> <span class="id">Hbuf</span>. <span class="id">left</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">chunk</span> &amp; <span class="id">ofs</span> &amp; <span class="id">v</span> &amp; <span class="id">Hbi</span> &amp; <span class="id">Hlo</span> &amp; <span class="id">Hhi</span> &amp; <span class="id">Halign</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a</span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#valid_access_dec">valid_access_dec</a></span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">IHbuf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ofs</span>' <span class="id">Hofs</span>'. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">Hbuf</span>. <span class="id">right</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">clear</span> <span class="id">n</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ofs</span>' <span class="id">Hofs</span>'. <span class="tactic">eapply</span> <span class="id">H1</span>. <span class="tactic">omega</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_load_refine</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">bufs</span> <span class="id">t</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#load">load</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9501')">Proof.</div>
<div class="proofscript" id="proof9501">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="id">pose</span> <span class="id">proof</span> <span class="id">H2</span> <span class="kwd">as</span> <span class="id">Hload</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.load_valid_access">Mem.load_valid_access</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#load">load</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#valid_access_dec">valid_access_dec</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;{ <span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span> <span class="kwd">in</span> <span class="id">Hload</span>. <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.valid_access_dec">Mem.valid_access_dec</a></span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hload</span>. <span class="tactic">f_equal</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.getN_exten">Mem.getN_exten</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">clear</span> <span class="id">v1</span>. <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">Hperm</span> <span class="id">_</span>]. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Memdata.html#size_chunk_conv">size_chunk_conv</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Hperm</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">revert</span> <span class="id">H3</span> <span class="id">H0</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="FMemory.html#Mem.mem_contents">Mem.mem_contents</a></span> <span class="id">sfm</span>) <span class="kwd">with</span> (<span class="id"><a href="GMemory.html#GMem.mem_contents">GMem.mem_contents</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>)) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">eapply</span> <span class="id"><a href="RGRels.html#eq_loc_content">eq_loc_content</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_mem_eq">Ic_mem_eq</a></span>. <span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">clear</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#meminv_Ic">meminv_Ic</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ofs</span>' <span class="id">Hofs</span>'. <span class="id">specialize</span> (<span class="id">H2</span> <span class="id">ofs</span>' <span class="id">Hofs</span>'). <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span> = (<span class="id"><a href="GMemory.html#GMem.mem_access">GMem.mem_access</a></span> <span class="id">tm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">B</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_mem_eq">Ic_mem_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RGRels.html#eq_loc_perm">eq_loc_perm</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id">Mem.perm_order</span>' <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="tactic">exact</span> 1%<span class="id">positive</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_store_refine</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">bufs</span> <span class="id">t</span> <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">sfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sfm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">buf</span>, <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="id"><a href="AsmClientSim.html#chunk">chunk</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> <span class="id"><a href="AsmClientSim.html#buf">buf</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tm</span>', <span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> <span class="id"><a href="AsmClientSim.html#buf">buf</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9502')">Proof.</div>
<div class="proofscript" id="proof9502">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.store_valid_access_3">Mem.store_valid_access_3</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#valid_access_dec">valid_access_dec</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">clear</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#meminv_Ic">meminv_Ic</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H3</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span> <span class="id">ofs</span>' <span class="id">Hofs</span>'.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">ofs</span>' <span class="id">Hofs</span>'). <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span> = (<span class="id"><a href="GMemory.html#GMem.mem_access">GMem.mem_access</a></span> <span class="id">tm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">B</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_mem_eq">Ic_mem_eq</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RGRels.html#eq_loc_perm">eq_loc_perm</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id">Mem.perm_order</span>' <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span>' <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="tactic">exact</span> 1%<span class="id">positive</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Val_and_result">Val_and_result</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.and">Val.and</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vundef">Vundef</a></span> \/ <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Values.html#Val.and">Val.and</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9503')">Proof.</div>
<div class="proofscript" id="proof9503">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">destruct</span> <span class="id">v1</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">v2</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_free_refine</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">sfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">sfm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tm</span>', <span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> (<span class="id"><a href="TSOMem.html#BufferedFree">BufferedFree</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#lo">lo</a></span> <span class="id"><a href="AsmClientSim.html#hi">hi</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9504')">Proof.</div>
<div class="proofscript" id="proof9504">
&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.free_range_perm">Mem.free_range_perm</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#free">free</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#range_perm_dec">range_perm_dec</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">clear</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#meminv_Ic">meminv_Ic</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">intros</span> <span class="id">ofs</span> <span class="id">Hofs</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">ofs</span> <span class="id">Hofs</span>). <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span> = (<span class="id"><a href="GMemory.html#GMem.mem_access">GMem.mem_access</a></span> <span class="id">tm</span>) !! <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">B</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_mem_eq">Ic_mem_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="RGRels.html#eq_loc_perm">eq_loc_perm</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id">Mem.perm_order</span>' <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Cur">Memperm.Cur</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="FMemory.html#Mem.mem_access">Mem.mem_access</a></span> <span class="id">sfm</span>) !! <span class="id">b</span> <span class="id">ofs</span> <span class="id"><a href="Memperm.html#Max">Memperm.Max</a></span>); <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">C1</span> <span class="id">C2</span>]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="tactic">exact</span> 1%<span class="id">positive</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_extcall_arg</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">rs</span> <span class="id">a</span> <span class="id">arg</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#extcall_arg">AsmLang.extcall_arg</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#extcall_arg">extcall_arg</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9505')">Proof.</div>
<div class="proofscript" id="proof9505">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id">eqn</span>:<span class="id">Haddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">eapply</span> <span class="id">meminv_load_refine</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_extcall_arg_pair</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">rs</span> <span class="id">l</span> <span class="id">arg</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#extcall_arg_pair">AsmLang.extcall_arg_pair</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#l">l</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#l">l</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9506')">Proof.</div>
<div class="proofscript" id="proof9506">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H3</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">meminv_extcall_arg</span>'.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_extcall_arguments</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sm</span> <span class="id">tm</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">rs</span> <span class="id">sig</span> <span class="id">args</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> (<span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span>) <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#extcall_arguments">AsmLang.extcall_arguments</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#sig">sig</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#extcall_arguments">extcall_arguments</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#sig">sig</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9507')">Proof.</div>
<div class="proofscript" id="proof9507">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">sig</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#extcall_arguments">AsmLang.extcall_arguments</a></span>, <span class="id"><a href="AsmTSO.html#extcall_arguments">extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Conventions1.html#loc_arguments">Conventions1.loc_arguments</a></span> <span class="id">sig</span>). <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H3</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id">meminv_extcall_arg_pair</span>'.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_valid_pointer_refine</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#b">b</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9508')">Proof.</div>
<div class="proofscript" id="proof9508">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span>, <span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.perm_dec">Mem.perm_dec</a></span>; <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#perm_dec">perm_dec</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.perm">Mem.perm</a></span> <span class="kwd">in</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">p</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (~ <span class="id"><a href="RGRels.html#obj_mem">obj_mem</a></span> <span class="id">sm</span> <span class="id">b</span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">destruct</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">p</span>. <span class="id">inv</span> <span class="id">p</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="ClientSim.html#Ic_mem_eq">Ic_mem_eq</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="RGRels.html#eq_loc_perm">eq_loc_perm</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">Unshelve</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">meminv_cmpu_bool_Some_refine</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">c</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> (<span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span>) <span class="id"><a href="AsmClientSim.html#c">c</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>', <span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> (<span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>)) <span class="id"><a href="AsmClientSim.html#c">c</a></span> <span class="id"><a href="AsmClientSim.html#v1">v1</a></span> <span class="id"><a href="AsmClientSim.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9509')">Proof.</div>
<div class="proofscript" id="proof9509">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id">_</span> || <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_iff">orb_true_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">match</span> ?<span class="id">x</span> &amp;&amp; ?<span class="id">y</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?<span class="id">Hx</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">match</span> ?<span class="id">x</span> || ?<span class="id">y</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?<span class="id">Hx</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="id">eqn</span>:?<span class="id">Hx</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="FMemory.html#Mem.valid_pointer">Mem.valid_pointer</a></span> <span class="id">_</span> ?<span class="id">b</span> ?<span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> |- <span class="id">context</span>[<span class="id"><a href="TSOMem.html#tso_valid_pointer">tso_valid_pointer</a></span> <span class="id">_</span> ?<span class="id">b</span> ?<span class="id">ofs</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id">meminv_valid_pointer_refine</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">b</span> <span class="id">ofs</span>); <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="id">eassumption</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_r">orb_true_r</a></span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="MatchStateSim">MatchStateSim</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="MatchStateSim.cu">cu</a></span> : <span class="id"><a href="ASM_local.html#Asm_comp_unit">Asm_comp_unit</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStateSim.HNODUPGD">HNODUPGD</a></span>: <span class="id"><a href="CUAST.html#nodup_gd_ident">nodup_gd_ident</a></span> (<span class="id"><a href="CUAST.html#cu_defs">cu_defs</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.cu">cu</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStateSim.HNODUPEF">HNODUPEF</a></span>: (<span class="id"><a href="CUAST.html#nodup_ef">nodup_ef</a></span> (<span class="id"><a href="CUAST.html#cu_defs">cu_defs</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.cu">cu</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="MatchStateSim.sge">sge</a></span> : <span class="id"><a href="Globalenvs.html#Genv.t">Genv.t</a></span> <span class="id"><a href="ASM_local.html#fundef">fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Variable</span> (<span class="id"><a name="MatchStateSim.tge">tge</a></span> : <span class="id"><a href="Globalenvs.html#Genv.t">Genv.t</a></span> <span class="id"><a href="ASM_local.html#fundef">fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStateSim.HSINITGE">HSINITGE</a></span> : <span class="id"><a href="InteractionSemantics.html#init_genv">init_genv</a></span> <span class="id"><a href="AsmLang.html#AsmLang">AsmLang</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.cu">cu</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStateSim.HTINITGE">HTINITGE</a></span> : <span class="id"><a href="AsmTSO.html#init_genv">AsmTSO.init_genv</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.cu">cu</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Hypothesis</span> (<span class="id"><a name="MatchStateSim.HGEMATCH">HGEMATCH</a></span> : <span class="id"><a href="TSOGlobSem.html#genv_match">genv_match</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="symbols_preserved">symbols_preserved</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="AST.html#ident">ident</a></span>), <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#s">s</a></span> = <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9510')">Proof.</div>
<div class="proofscript" id="proof9510">
 <span class="tactic">intro</span> <span class="id">s</span>. <span class="id">exploit</span> <span class="id"><a href="TSOGlobSem.html#genv_symb_eq">genv_symb_eq</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="find_def_find_symbol">find_def_find_symbol</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">gd</span>, <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#gd">gd</a></span> -&gt; <span class="id">exists</span> <span class="id">s</span>, <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#s">s</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9511')">Proof.</div>
<div class="proofscript" id="proof9511">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.HSINITGE">HSINITGE</a></span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H7</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b0</span> &amp; <span class="id">Hb0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H8</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">Hgd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hgd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="CUAST.html#nodup_gd_ident_exists">nodup_gd_ident_exists</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hgd</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">id</span> &amp; <span class="id">Hid</span>). <span class="id">specialize</span> (<span class="id">H5</span> <span class="id">id</span>). <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#cu_to_prog">cu_to_prog</a></span> <span class="kwd">in</span> <span class="id">Hid</span>. <span class="tactic">rewrite</span> <span class="id">Hid</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">rewrite</span> <span class="id">Hb0</span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="id">inv</span> <span class="id">H12</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_def_find_symbol</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">gd</span>, <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#gd">gd</a></span> -&gt; <span class="id">exists</span> <span class="id">s</span>, <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#s">s</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9512')">Proof.</div>
<div class="proofscript" id="proof9512">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.HTINITGE">HTINITGE</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H5</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b0</span> &amp; <span class="id">Hb0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H6</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">Hgd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hgd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="CUAST.html#nodup_gd_ident_exists">nodup_gd_ident_exists</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hgd</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">id</span> &amp; <span class="id">Hid</span>). <span class="id">specialize</span> (<span class="id">H3</span> <span class="id">id</span>). <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#cu_to_prog">cu_to_prog</a></span> <span class="kwd">in</span> <span class="id">Hid</span>. <span class="tactic">rewrite</span> <span class="id">Hid</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> <span class="id">Hb0</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="find_def_eq">find_def_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> = <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9513')">Proof.</div>
<div class="proofscript" id="proof9513">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_def">Genv.find_def</a></span>. <span class="tactic">intro</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="Globalenvs.html#Genv.genv_defs">Genv.genv_defs</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#find_def_find_symbol">find_def_find_symbol</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">s</span> <span class="id">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOGlobSem.html#genv_symb_eq">genv_symb_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="kwd">in</span> <span class="id">Hs</span>. <span class="tactic">rewrite</span> <span class="id">Hs</span>. <span class="tactic">intro</span> <span class="id">Hs</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">Hs</span>'. <span class="tactic">destruct</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.HSINITGE">HSINITGE</a></span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">HSINITGE</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">HSINITGE</span>'. <span class="id">inv</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.HTINITGE">HTINITGE</a></span>. <span class="id">fold</span> (<span class="id"><a href="CUAST.html#cu_to_prog">cu_to_prog</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.cu">cu</a></span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">s</span>). <span class="id">specialize</span> (<span class="id">H10</span> <span class="id">s</span>). <span class="tactic">rewrite</span> <span class="id">Hs</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id">Hs</span>' <span class="kwd">in</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H5</span>. <span class="tactic">eauto</span>. <span class="id">exploit</span> <span class="id">H13</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H15</span>. <span class="id">inv</span> <span class="id">H15</span>. <span class="tactic">intros</span> <span class="id">C</span> <span class="id">D</span>. <span class="tactic">rewrite</span> <span class="id">C</span> <span class="kwd">in</span> <span class="id">D</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="Globalenvs.html#Genv.genv_defs">Genv.genv_defs</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span>) ! <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">find_def_find_symbol</span>'. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">s</span> <span class="id">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOGlobSem.html#genv_symb_eq">genv_symb_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="kwd">in</span> <span class="id">Hs</span>. <span class="tactic">rewrite</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">C</span>. <span class="id">exploit</span> <span class="id"><a href="TSOGlobSem.html#genv_defs_match">genv_defs_match</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">B</span>. <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="senv_preserved">senv_preserved</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span>.	<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9514')">Proof.</div>
<div class="proofscript" id="proof9514">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Senv.public_symbol">Senv.public_symbol</a></span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.public_symbol">Genv.public_symbol</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span>; <span class="tactic">auto</span>; <span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="TSOGlobSem.html#genv_public_eq">genv_public_eq</a></span> <span class="kwd">in</span> <span class="id">i</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="TSOGlobSem.html#genv_public_eq">genv_public_eq</a></span> <span class="kwd">in</span> <span class="id">i</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Senv.block_is_volatile">Senv.block_is_volatile</a></span>; <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.block_is_volatile">Genv.block_is_volatile</a></span>, <span class="id"><a href="Globalenvs.html#Genv.find_var_info">Genv.find_var_info</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#find_def_eq">find_def_eq</a></span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="function_ptr_eq">function_ptr_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span> = <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9515')">Proof.</div>
<div class="proofscript" id="proof9515">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#find_def_eq">find_def_eq</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="symbol_address_eq">symbol_address_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#id">id</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#id">id</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9516')">Proof.</div>
<div class="proofscript" id="proof9516">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>. <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_addrmode32_eq">eval_addrmode32_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ASM_local.html#eval_addrmode32">eval_addrmode32</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> = <span class="id"><a href="ASM_local.html#eval_addrmode32">eval_addrmode32</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9517')">Proof.</div>
<div class="proofscript" id="proof9517">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode32">eval_addrmode32</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>, <span class="id">base</span>; <span class="tactic">repeat</span> <span class="tactic">f_equal</span>; <span class="tactic">destruct</span> <span class="id">const</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#symbol_address_eq">symbol_address_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_addrmode64_eq">eval_addrmode64_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ASM_local.html#eval_addrmode64">eval_addrmode64</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> = <span class="id"><a href="ASM_local.html#eval_addrmode64">eval_addrmode64</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9518')">Proof.</div>
<div class="proofscript" id="proof9518">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode64">eval_addrmode64</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>, <span class="id">base</span>; <span class="tactic">repeat</span> <span class="tactic">f_equal</span>; <span class="tactic">destruct</span> <span class="id">const</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#symbol_address_eq">symbol_address_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_addrmode_eq">eval_addrmode_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> = <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#a">a</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9519')">Proof.</div>
<div class="proofscript" id="proof9519">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode32_eq">eval_addrmode32_eq</a></span>, <span class="id"><a href="AsmClientSim.html#eval_addrmode64_eq">eval_addrmode64_eq</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="senv_symbol_address_eq">senv_symbol_address_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">ofs</span>, <span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#id">id</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span> = <span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#id">id</a></span> <span class="id"><a href="AsmClientSim.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9520')">Proof.</div>
<div class="proofscript" id="proof9520">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span>, <span class="id"><a href="Globalenvs.html#Senv.find_symbol">Senv.find_symbol</a></span>; <span class="tactic">simpl</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eval_builtin_arg_fp_eq">eval_builtin_arg_fp_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">rs</span>: <span class="id"><a href="Asm.html#preg">Asm.preg</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span>) <span class="id">sp</span> <span class="id">arg</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_arg_fp">MemOpFP.eval_builtin_arg_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_arg_fp">MemOpFP.eval_builtin_arg_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9521')">Proof.</div>
<div class="proofscript" id="proof9521">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">A</span>; <span class="tactic">induction</span> <span class="id">A</span>; <span class="tactic">try</span> <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fp</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fp</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="genv_match_eval_builtin_args_fp">genv_match_eval_builtin_args_fp</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">rs</span>: <span class="id"><a href="Asm.html#preg">Asm.preg</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span>) <span class="id">sp</span> <span class="id">args</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_args_fp">MemOpFP.eval_builtin_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_args_fp">MemOpFP.eval_builtin_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9522')">Proof.</div>
<div class="proofscript" id="proof9522">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">args</span>. <span class="tactic">induction</span> <span class="id">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">A</span>; <span class="id">inv</span> <span class="id">A</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span> <span class="id">A</span>; <span class="id">inv</span> <span class="id">A</span>; <span class="id">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">IHargs</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eval_builtin_arg_fp_eq">eval_builtin_arg_fp_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="meminv_eval_builtin_arg">meminv_eval_builtin_arg</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> (<span class="id">rs</span>: <span class="id"><a href="Asm.html#preg">Asm.preg</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span>) <span class="id">sp</span> <span class="id">arg</span> <span class="id">v</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_arg_fp">MemOpFP.eval_builtin_arg_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="AsmLang.html#eval_builtin_arg">AsmLang.eval_builtin_arg</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id">v</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> /\ <span class="id">v</span>' = <span class="id"><a href="AsmClientSim.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">v</span>', ~ <span class="id"><a href="AsmLang.html#eval_builtin_arg">AsmLang.eval_builtin_arg</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9523')">Proof.</div>
<div class="proofscript" id="proof9523">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> 4. <span class="id">revert</span> <span class="id">fp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H2</span>; <span class="tactic">intros</span> <span class="id">fp</span> <span class="id">Hfp</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">left</span>; <span class="id">eexists</span>; <span class="tactic">split</span>; [<span class="id">econstructor</span>; <span class="tactic">eauto</span>|<span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="id">inv</span> <span class="id">Hfp</span>; <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>]; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id">sp</span> <span class="id">ofs</span>) <span class="id">eqn</span>:<span class="id">Haddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#load_refine">load_refine</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp</span> &amp; <span class="id">v</span>' &amp; <span class="id">_</span> &amp; (<span class="id">_</span> &amp; <span class="id">Hload</span> &amp; <span class="id">Hsfp</span>) &amp; [(<span class="id">Hdrf</span> &amp; <span class="id">Hmatch</span> &amp; <span class="id">Hv</span>' &amp; <span class="id">_</span> &amp; <span class="id">_</span>) | (<span class="id">Hrace</span> &amp; <span class="id">Hmatch</span>)])|<span class="id">Habort</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>|<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">v</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">eauto</span>. <span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">Hfp</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>'. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="id">inv</span> <span class="id">Hfp</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id">id</span> <span class="id">ofs</span>) <span class="id">eqn</span>:<span class="id">Haddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span> <span class="kwd">in</span> <span class="id">Haddr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#load_refine">load_refine</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [(<span class="id">sfp</span> &amp; <span class="id">v</span>' &amp; <span class="id">_</span> &amp; (<span class="id">_</span> &amp; <span class="id">Hload</span> &amp; <span class="id">Hsfp</span>) &amp; [(<span class="id">Hdrf</span> &amp; <span class="id">Hmatch</span> &amp; <span class="id">Hv</span>' &amp; <span class="id">_</span> &amp; <span class="id">_</span>) | (<span class="id">Hrace</span> &amp; <span class="id">Hmatch</span>)])|<span class="id">Habort</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>|<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">v</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">eauto</span>. <span class="id">left</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">Hfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span>, <span class="id">Haddr</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>'. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">eauto</span>. <span class="id">right</span>. <span class="id">inv</span> <span class="id">Hfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span>, <span class="id">Haddr</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="id">inv</span> <span class="id">Hfp</span>. <span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hfp</span>. <span class="tactic">eapply</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">eapply</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">Heval1</span>|<span class="id">Habort</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H5</span> <span class="kwd">as</span> [<span class="id">Heval2</span>|<span class="id">Habort</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Heval1</span> <span class="kwd">as</span> (<span class="id">v1</span>' &amp; <span class="id">Heval1</span> &amp; <span class="id">Hfp1</span>). <span class="tactic">destruct</span> <span class="id">Heval2</span> <span class="kwd">as</span> (<span class="id">v2</span>' &amp; <span class="id">Heval2</span> &amp; <span class="id">Hfp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfp1</span> <span class="kwd">as</span> [[<span class="id">Hdrf1</span> <span class="id">Hv1</span>']|<span class="id">Hrace1</span>]; [|<span class="id">right</span>]. <span class="tactic">destruct</span> <span class="id">Hfp2</span> <span class="kwd">as</span> [[<span class="id">Hdrf2</span> <span class="id">Hv2</span>']|<span class="id">Hrace2</span>]; [<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.  <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="meminv_eval_builtin_args">meminv_eval_builtin_args</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> (<span class="id">rs</span>: <span class="id"><a href="Asm.html#preg">Asm.preg</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span>) <span class="id">sp</span> <span class="id">args</span> <span class="id">vargs</span> <span class="id">fp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#vargs">vargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="MemOpFP.html#eval_builtin_args_fp">MemOpFP.eval_builtin_args_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">vargs</span>', <span class="id"><a href="AsmLang.html#eval_builtin_args">AsmLang.eval_builtin_args</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id">vargs</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> /\ <span class="id"><a href="AsmClientSim.html#vargs">vargs</a></span> = <span class="id">vargs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fp">fp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">vargs</span>', ~ <span class="id"><a href="AsmLang.html#eval_builtin_args">AsmLang.eval_builtin_args</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id">vargs</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9524')">Proof.</div>
<div class="proofscript" id="proof9524">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">revert</span> <span class="id">fp</span> <span class="id">H3</span>. <span class="tactic">induction</span> <span class="id">H2</span>; <span class="tactic">intros</span> <span class="id">fp</span> <span class="id">Hfp</span>; <span class="id">inv</span> <span class="id">Hfp</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_eval_builtin_arg">meminv_eval_builtin_arg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Heval</span>|<span class="id">Habort</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlist_forall2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Heval</span>'|<span class="id">Habort</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Heval</span> <span class="kwd">as</span> (<span class="id">v</span>' &amp; <span class="id">Heval</span> &amp; <span class="id">Hfp</span>). <span class="tactic">destruct</span> <span class="id">Heval</span>' <span class="kwd">as</span> (<span class="id">args</span>' &amp; <span class="id">Heval</span>' &amp; <span class="id">Hfp</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfp</span> <span class="kwd">as</span> [[<span class="id">Hdrf</span> <span class="id">Hv</span>']|<span class="id">Hrace</span>]; [|<span class="id">right</span>]. <span class="tactic">destruct</span> <span class="id">Hfp</span>' <span class="kwd">as</span> [[<span class="id">Hdrf</span>' <span class="id">Hargs</span>']|<span class="id">Hrace</span>']; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">subst</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">destruct</span> <span class="id">C</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">meminv_eval_builtin_arg</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> (<span class="id">rs</span>: <span class="id"><a href="Asm.html#preg">Asm.preg</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span>) <span class="id">sp</span> <span class="id">arg</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#eval_builtin_arg">AsmLang.eval_builtin_arg</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#arg">arg</a></span> <span class="id"><a href="AsmClientSim.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9525')">Proof.</div>
<div class="proofscript" id="proof9525">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">induction</span> <span class="id">H3</span>; <span class="tactic">try</span> (<span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id">eqn</span>:<span class="id">Haddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_load_refine</span>'; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id">eqn</span>:<span class="id">Haddr</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_load_refine</span>'; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">Hload</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">Haddr</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#senv_symbol_address_eq">senv_symbol_address_eq</a></span>. <span class="id">econstructor</span>. }<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">meminv_eval_builtin_args</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> (<span class="id">rs</span>: <span class="id"><a href="Asm.html#preg">Asm.preg</a></span> -&gt; <span class="id"><a href="Values.html#val">val</a></span>) <span class="id">sp</span> <span class="id">args</span> <span class="id">vargs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#eval_builtin_args">AsmLang.eval_builtin_args</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#vargs">vargs</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sp">sp</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="id"><a href="AsmClientSim.html#args">args</a></span> <span class="id"><a href="AsmClientSim.html#vargs">vargs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9526')">Proof.</div>
<div class="proofscript" id="proof9526">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">induction</span> <span class="id">H3</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_eval_builtin_arg</span>'; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">Heval</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="invert_symbol_from_string_eq">invert_symbol_from_string_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">name</span>, <span class="id"><a href="CUAST.html#invert_symbol_from_string">invert_symbol_from_string</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#name">name</a></span> = <span class="id"><a href="CUAST.html#invert_symbol_from_string">invert_symbol_from_string</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#name">name</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9527')">Proof.</div>
<div class="proofscript" id="proof9527">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">name</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#invert_symbol_from_string">invert_symbol_from_string</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CUAST.html#invert_block_from_string">invert_block_from_string</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Globalenvs.html#Genv.invert_symbol">Genv.invert_symbol</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.fold_spec">PTree.fold_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Maps.html#PTree.elements_extensional">PTree.elements_extensional</a></span>. <span class="tactic">exact</span> <span class="id"><a href="AsmClientSim.html#find_def_eq">find_def_eq</a></span>. <span class="tactic">intro</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#fundef">fundef</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PTree.fold_spec">PTree.fold_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="Maps.html#PTree.elements_extensional">PTree.elements_extensional</a></span>. <span class="tactic">exact</span> <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">intro</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#fundef">fundef</a></span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="Values.html#block">block</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">simpl_hypos</span>:=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id">H1</span>: ?<span class="id">x</span> = <span class="id">_</span>, <span class="id">H2</span>: ?<span class="id">x</span> = <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_hypos</span><br/>
&nbsp;&nbsp;| [<span class="id">H1</span>: <span class="id">context</span>[<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id">_</span>], <span class="id">H2</span>: <span class="id">context</span>[<span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id">_</span>] |- <span class="id">_</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">simpl_hypos</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="match_state">match_state</a></span> (<span class="id">t</span>: <span class="id"><a href="GlobDefs.html#tid">tid</a></span>) (<span class="id">scm</span>: <span class="id"><a href="InteractionSemantics.html#core">core</a></span> <span class="id"><a href="AsmLang.html#AsmLang">AsmLang</a></span> * <span class="id"><a href="GMemory.html#gmem">gmem</a></span>) (<span class="id">tcm</span>: <span class="id"><a href="InteractionSemantics.html#core">core</a></span> <span class="id"><a href="AsmLang.html#AsmLang">AsmLang</a></span> * <span class="id"><a href="TSOMem.html#tsomem">tsomem</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="match_sep_obj_clt">match_sep_obj_clt</a></span>: <span class="id"><a href="RGRels.html#sep_obj_client_block">sep_obj_client_block</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="AsmClientSim.html#scm">scm</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="match_core">match_core</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="AsmClientSim.html#scm">scm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="AsmClientSim.html#tcm">tcm</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="match_mem">match_mem</a></span>: <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="AsmClientSim.html#scm">scm</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="AsmClientSim.html#tcm">tcm</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">FP.subset_refl</span> <span class="id">FP.subset_emp</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="meminv_exec_instr_eq">meminv_exec_instr_eq</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">sfm</span> <span class="id">bufs</span> (<span class="id">tfm</span>: <span class="id"><a href="FMemory.html#Mem.mem">Mem.mem</a></span>) <span class="id">f</span> <span class="id">i</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">tsofm</span>' <span class="id">tfp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fl</span> := <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sgm</span> := <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tgm</span> := <span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="FMemory.html#Mem.freelist">Mem.freelist</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#exec_instr_TSO">exec_instr_TSO</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="kwd">Next</span> <span class="id">rs</span>' <span class="id">tsofm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#exec_instr_TSO_fp">exec_instr_TSO_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">srs</span>' <span class="id">sfp</span> <span class="id">sfm</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#exec_instr">exec_instr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">srs</span>' <span class="id">sfm</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#exec_instr_fp">exec_instr_fp</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">srs</span>' = <span class="id">rs</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>') (<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tsofm</span>') <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>) (<span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tsofm</span>')) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#sgm">sgm</a></span> <span class="id"><a href="AsmClientSim.html#tgm">tgm</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>') (<span class="id"><a href="TSOMem.html#mktsomem">mktsomem</a></span> (<span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> (<span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">tsofm</span>') <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span>) (<span class="id"><a href="FMemory.html#strip">strip</a></span> (<span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">tsofm</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#fpmatchc">fpmatchc</a></span> <span class="id"><a href="AsmClientSim.html#sfp">sfp</a></span> <span class="id"><a href="AsmClientSim.html#tfp">tfp</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#exec_instr">exec_instr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="AsmLang.html#Stuck">AsmLang.Stuck</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9528')">Proof.</div>
<div class="proofscript" id="proof9528">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">sfm</span> <span class="id">bufs</span> <span class="id">tfm</span> <span class="id">f</span> <span class="id">i</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">tsofm</span>' <span class="id">tfp</span> <span class="id">fl</span> <span class="id">sgm</span> <span class="id">tgm</span> <span class="id">Hfreelist</span> <span class="id">Hmeminv</span> <span class="id">HexecTSO</span> <span class="id">Htfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HexecTSO</span>, <span class="id">Htfp</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <br/>
&nbsp;trivial&nbsp;cases:&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#goto_label">goto_label</a></span>, <span class="id"><a href="AsmTSO.html#tso_goto_label">tso_goto_label</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HexecTSO</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="kwd">match</span> ?<span class="id">a</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="kwd">Next</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="id">eqn</span>:?<span class="id">Ha</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="kwd">Next</span> <span class="id">_</span> <span class="id">_</span> = <span class="kwd">Next</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">HexecTSO</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> ?<span class="id">srs</span>' ?<span class="id">sfm</span>' = <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">_</span> <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">eexists</span> <span class="id">srs</span>', <span class="id"><a href="Footprint.html#FP.emp">FP.emp</a></span>, <span class="id">sfm</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>; <span class="id">left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- ~ <span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> /\ <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#symbol_address_eq">symbol_address_eq</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode32_eq">eval_addrmode32_eq</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode64_eq">eval_addrmode64_eq</a></span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_emp">FP.subset_emp</a></span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmeminv</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;exec_load&nbsp;*)</span>&nbsp;unfold&nbsp;exec_load&nbsp;to&nbsp;mem&nbsp;load&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="AsmTSO.html#exec_load_TSO">exec_load_TSO</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_load_TSO">exec_load_TSO</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#exec_load_fp">exec_load_fp</a></span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#exec_load">exec_load</a></span>, <span class="id"><a href="AsmLang.html#exec_load_fp">exec_load_fp</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#tsoloadv">tsoloadv</a></span> <span class="id">eqn</span>:<span class="id">Hload</span>; <span class="id">inv</span> <span class="id">HexecTSO</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoloadv">tsoloadv</a></span>, <span class="id"><a href="FMemory.html#Mem.loadv">Mem.loadv</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#eval_addrmode_eq">eval_addrmode_eq</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;construct&nbsp;SC&nbsp;load&nbsp;and&nbsp;eliminate&nbsp;abort&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="TSOMem.html#tsoload">tsoload</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#load_refine">load_refine</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">subst</span> <span class="id">fl</span> <span class="id">sgm</span>; <span class="tactic">rewrite</span> <span class="id">Hfreelist</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>| <span class="id">econstructor</span>; <span class="tactic">eauto</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hstep</span>|<span class="id">Habort</span>]; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span>; [<span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>|]; <span class="tactic">eauto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;done&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">destruct</span> <span class="id">Hstep</span> <span class="kwd">as</span> (<span class="id">sfp</span> &amp; <span class="id">sres</span> &amp; <span class="id">sfm</span>' &amp; (<span class="id">Hsfm</span>' &amp; <span class="id">Hload</span>' &amp; <span class="id">Hsfp</span>) &amp; [<span class="id">Hstep</span>|<span class="id">Hrace</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hload</span>'; <span class="tactic">simpl</span>; <span class="tactic">do</span> 3 <span class="id">eexists</span>; <span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">eauto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">destruct</span> <span class="id">Hstep</span> <span class="kwd">as</span> (<span class="id">Hconflict</span> &amp; <span class="id">Hfpmatch</span> &amp; <span class="id">Hres</span> &amp; <span class="id">Hmeminv</span>' &amp; <span class="id">HGc</span>); <span class="tactic">subst</span>; <span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">auto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">fail</span>).<br/>
<br/>
&nbsp;exec_store&nbsp;*)</span>&nbsp;unfold&nbsp;exec_store&nbsp;to&nbsp;mem&nbsp;store&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="AsmTSO.html#exec_store_TSO">exec_store_TSO</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_store_TSO">exec_store_TSO</a></span>, <span class="id"><a href="AsmLang.html#exec_store_fp">exec_store_fp</a></span>, <span class="id"><a href="AsmLang.html#exec_store">exec_store</a></span>, <span class="id"><a href="AsmLang.html#exec_store_fp">exec_store_fp</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#tsostorev">tsostorev</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="id">inv</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostorev">tsostorev</a></span>, <span class="id"><a href="FMemory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#eval_addrmode_eq">eval_addrmode_eq</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;construct&nbsp;SC&nbsp;store&nbsp;and&nbsp;eliminate&nbsp;abort&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hmeminv</span>; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">subst</span> <span class="id">fl</span> <span class="id">sgm</span>; <span class="tactic">rewrite</span> <span class="id">Hfreelist</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>| <span class="id">econstructor</span>; <span class="tactic">eauto</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hstep</span>|<span class="id">Habort</span>]; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span>; [<span class="id">exfalso</span>; <span class="tactic">eapply</span> <span class="id">Habort</span>|]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="kwd">in</span> <span class="id">Hstep</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstep</span> <span class="kwd">as</span> (<span class="id">sfp</span> &amp; <span class="id">sres</span> &amp; <span class="id">sfm</span>' &amp; (<span class="id">Hstore</span>' &amp; <span class="id">Hsfp</span>) &amp; [<span class="id">Hstep</span>|<span class="id">Hrace</span>]); <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span>'; <span class="tactic">simpl</span>; <span class="tactic">do</span> 3 <span class="id">eexists</span>; <span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">eauto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">destruct</span> <span class="id">Hstep</span> <span class="kwd">as</span> (<span class="id">Hconflict</span> &amp; <span class="id">A</span> &amp; <span class="id">Hres</span> &amp; <span class="id">Hmeminv</span>' &amp; <span class="id">HGc</span>); <span class="tactic">repeat</span> (<span class="tactic">split</span>; <span class="tactic">auto</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;compare_ints&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span>) <span class="id">eqn</span>: <span class="id">Hcheck</span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>)); [<span class="id">right</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>|<span class="id">left</span>; <span class="tactic">simpl</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_compare_ints_fp_subset">meminv_compare_ints_fp_subset</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_compare_ints_not_conflict_eq">meminv_compare_ints_not_conflict_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hres</span>. <span class="tactic">rewrite</span> <span class="id">Hres</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_compare_ints_fp_subset">meminv_compare_ints_fp_subset</a></span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;compare_longs&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |-<span class="id">context</span>[<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span>] =&gt; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>)); [<span class="id">right</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>|<span class="id">left</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cop_fp.html#cmplu_bool_fp_total">Cop_fp.cmplu_bool_fp_total</a></span>, <span class="id"><a href="AsmTSO.html#tso_cmplu_bool_fp_total">tso_cmplu_bool_fp_total</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_longs_TSO">compare_longs_TSO</a></span>, <span class="id"><a href="AsmLang.html#compare_longs">compare_longs</a></span>, <span class="id"><a href="Values.html#Val.cmplu">Val.cmplu</a></span>, <span class="id"><a href="Values.html#Val.cmplu_bool">Val.cmplu_bool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cop_fp.html#cmplu_bool_fp_total">Cop_fp.cmplu_bool_fp_total</a></span>, <span class="id"><a href="AsmTSO.html#tso_cmplu_bool_fp_total">tso_cmplu_bool_fp_total</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span>) <span class="id">eqn</span>: <span class="id">Hcheck</span>; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>)); [<span class="id">right</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>|<span class="id">left</span>; <span class="tactic">simpl</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_compare_ints_fp_subset">meminv_compare_ints_fp_subset</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_compare_ints_not_conflict_eq">meminv_compare_ints_not_conflict_eq</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hres</span>. <span class="tactic">rewrite</span> <span class="id">Hres</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#meminv_compare_ints_fp_subset">meminv_compare_ints_fp_subset</a></span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |-<span class="id">context</span>[<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span>] =&gt; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>)); [<span class="id">right</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>|<span class="id">left</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cop_fp.html#cmplu_bool_fp_total">Cop_fp.cmplu_bool_fp_total</a></span>, <span class="id"><a href="AsmTSO.html#tso_cmplu_bool_fp_total">tso_cmplu_bool_fp_total</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_longs_TSO">compare_longs_TSO</a></span>, <span class="id"><a href="AsmLang.html#compare_longs">compare_longs</a></span>, <span class="id"><a href="Values.html#Val.cmplu">Val.cmplu</a></span>, <span class="id"><a href="Values.html#Val.cmplu_bool">Val.cmplu_bool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Cop_fp.html#cmplu_bool_fp_total">Cop_fp.cmplu_bool_fp_total</a></span>, <span class="id"><a href="AsmTSO.html#tso_cmplu_bool_fp_total">tso_cmplu_bool_fp_total</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Archi.html#ptr64">Archi.ptr64</a></span> <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">C</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;compare&nbsp;zero&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.and">Val.and</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r2</span>)) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Values.html#Val.and">Val.and</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r2</span>)) = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>) <span class="kwd">as</span> [<span class="id">HVundef</span>|[<span class="id">n</span> <span class="id">HInt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)), (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r2</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">right</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HVundef</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_ints_fp">compare_ints_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_ints">compare_ints</a></span>, <span class="id"><a href="AsmTSO.html#compare_ints_TSO">compare_ints_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HInt</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_ints_fp">compare_ints_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_ints">compare_ints</a></span>, <span class="id"><a href="AsmTSO.html#compare_ints_TSO">compare_ints_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.andl">Val.andl</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r2</span>)) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="Values.html#Val.andl">Val.andl</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r2</span>)) = <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>) <span class="kwd">as</span> [<span class="id">HVundef</span>|[<span class="id">n</span> <span class="id">HInt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)), (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r2</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">right</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HVundef</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs">compare_longs</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO">compare_longs_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HInt</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs">compare_longs</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO">compare_longs_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.and">Val.and</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>', <span class="id"><a href="Values.html#Val.and">Val.and</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>) = <span class="id"><a href="Values.html#Vint">Vint</a></span> <span class="id">n</span>') <span class="kwd">as</span> [<span class="id">HVundef</span>|[<span class="id">n</span>' <span class="id">HInt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">right</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HVundef</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_ints_fp">compare_ints_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_ints">compare_ints</a></span>, <span class="id"><a href="AsmTSO.html#compare_ints_TSO">compare_ints_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HInt</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_ints_TSO_fp">compare_ints_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_ints_fp">compare_ints_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_ints">compare_ints</a></span>, <span class="id"><a href="AsmTSO.html#compare_ints_TSO">compare_ints_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id"><a href="Values.html#Val.andl">Val.andl</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>) = <span class="id"><a href="Values.html#Vundef">Vundef</a></span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">n</span>', <span class="id"><a href="Values.html#Val.andl">Val.andl</a></span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)) (<span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>) = <span class="id"><a href="Values.html#Vlong">Vlong</a></span> <span class="id">n</span>') <span class="kwd">as</span> [<span class="id">HVundef</span>|[<span class="id">n</span>' <span class="id">HInt</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id">r1</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">right</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HVundef</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs">compare_longs</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO">compare_longs_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">HInt</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#compare_longs_TSO_fp">compare_longs_TSO_fp</a></span>, <span class="id"><a href="AsmLang.html#compare_longs_fp">compare_longs_fp</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Footprint.html#FP.fp_union_emp">FP.fp_union_emp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">left</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#emp_not_conflictc">emp_not_conflictc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#compare_longs">compare_longs</a></span>, <span class="id"><a href="AsmTSO.html#compare_longs_TSO">compare_longs_TSO</a></span>, <span class="id"><a href="Values.html#Val.cmpu">Val.cmpu</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">tgm</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">Hmeminv</span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;free&nbsp;*)</span>&nbsp;construct&nbsp;load&nbsp;ra&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#load_refine">load_refine</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">fl</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">fl</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Hfreelist</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ha</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hload1</span> | <span class="id">Habort</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hload1</span> <span class="kwd">as</span> (<span class="id">sfp1</span> &amp; <span class="id">v</span>' &amp; <span class="id">sfm</span>' &amp; (<span class="id">Hsfm</span>' &amp; <span class="id">Hload1</span> &amp; <span class="id">Hsfp1</span>) &amp; <span class="id">Hloadmatch1</span>); <span class="tactic">subst</span> <span class="id">sfp1</span> <span class="id">sfm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hload1</span>.<br/>
&nbsp;construct&nbsp;load&nbsp;link&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#load_refine">load_refine</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">fl</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">fl</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Hfreelist</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ha0</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hload2</span> | <span class="id">Habort</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hload2</span> <span class="kwd">as</span> (<span class="id">sfp2</span> &amp; <span class="id">v0</span>' &amp; <span class="id">sfm</span>' &amp; (<span class="id">Hsfm</span>' &amp; <span class="id">Hload2</span> &amp; <span class="id">Hsfp2</span>) &amp; <span class="id">Hloadmatch2</span>); <span class="tactic">subst</span> <span class="id">sfp2</span> <span class="id">sfm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hload2</span>.<br/>
&nbsp;construct&nbsp;free&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#free_refine">free_refine</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">sgm</span> <span class="id">fl</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">fl</span>. <span class="id">econstructor</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Hfreelist</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsofree">tsofree</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hfree</span> | <span class="id">Habort</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfree</span> <span class="kwd">as</span> (<span class="id">sfp3</span> &amp; <span class="id">sres</span> &amp; <span class="id">sfm</span>' &amp; (<span class="id">Hfree</span> &amp; <span class="id">Hsfp3</span>) &amp; <span class="id">Hfreematch</span>); <span class="tactic">subst</span> <span class="id">sfp3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfree</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">Hload1</span> <span class="id">Hload2</span> <span class="id">Hfree</span> <span class="id">Ha</span> <span class="id">Ha0</span>. <span class="id">instantiate</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="kwd">in</span> <span class="id">Hfreematch</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;race&nbsp;load1&nbsp;?&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hloadmatch1</span> <span class="kwd">as</span> [<span class="id">Hloadmatch1</span> | <span class="id">Hrace1</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hloadmatch1</span> <span class="kwd">as</span> (<span class="id">Hdrf1</span> &amp; <span class="id">_</span> &amp; <span class="id">Hv</span>' &amp; <span class="id">_</span> &amp; <span class="id">_</span>).<br/>
&nbsp;race&nbsp;load2&nbsp;?&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hloadmatch2</span> <span class="kwd">as</span> [<span class="id">Hloadmatch2</span> | <span class="id">Hrace2</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hloadmatch2</span> <span class="kwd">as</span> (<span class="id">Hdrf2</span> &amp; <span class="id">_</span> &amp; <span class="id">Hv0</span>' &amp; <span class="id">_</span> &amp; <span class="id">_</span>).<br/>
&nbsp;race&nbsp;free&nbsp;?&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfreematch</span> <span class="kwd">as</span> [(<span class="id">Hdrf3</span> &amp; <span class="id">_</span> &amp; <span class="id">Hres</span> &amp; <span class="id">Hmeminv</span>' &amp; <span class="id">HGc</span>') | <span class="id">Hrace3</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>]. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>]. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>]. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="tactic">tauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.free">Mem.free</a></span>; <span class="tactic">auto</span>; <span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id">sfm</span> <span class="id">b</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">i</span> <span class="id">ofs_link</span>))); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id">sfm</span> <span class="id">b</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">i</span> <span class="id">ofs_ra</span>))); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">meminv_exec_instr_eq</span>':<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">i</span> <span class="id">rs</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">rs</span>' <span class="id">sfm</span>' <span class="id">tfm</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmClientSim.html#meminv">meminv</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span> <span class="id"><a href="AsmClientSim.html#fl">fl</a></span> <span class="id"><a href="AsmClientSim.html#sm">sm</a></span> <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>', <span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id">t</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmLang.html#exec_instr">exec_instr</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span> = <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">rs</span>' <span class="id">sfm</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#not_alloc_instr">not_alloc_instr</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>'' <span class="id">b</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="AsmTSO.html#exec_instr_TSO">exec_instr_TSO</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#f">f</a></span> <span class="id"><a href="AsmClientSim.html#i">i</a></span> <span class="id"><a href="AsmClientSim.html#rs">rs</a></span> (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> (<span class="id"><a href="AsmClientSim.html#bufs">bufs</a></span> <span class="id"><a href="AsmClientSim.html#t">t</a></span>) <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) = <span class="kwd">Next</span> <span class="id">rs</span>'' (<span class="id"><a href="TSOMem.html#mktsofmem">mktsofmem</a></span> <span class="id">b</span>' <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tm</span>', <span class="id"><a href="TSOMem.html#apply_buffer">apply_buffer</a></span> <span class="id">b</span>' <span class="id"><a href="AsmClientSim.html#tm">tm</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">tm</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9529')">Proof.</div>
<div class="proofscript" id="proof9529">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">i</span> <span class="id">rs</span> <span class="id">sm</span> <span class="id">bufs</span> <span class="id">tm</span> <span class="id">t</span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">rs</span>' <span class="id">sfm</span>' <span class="id">tfm</span> <span class="id">Hembed</span> <span class="id">Hembed</span>' <span class="id">Hmeminv</span> <span class="id">Hbuffer</span> <span class="id">Hexec</span> <span class="id">Hnotalloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="id">inv</span> <span class="id">Hnotalloc</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hexec</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;trivial&nbsp;cases:&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#goto_label">goto_label</a></span>, <span class="id"><a href="AsmTSO.html#tso_goto_label">tso_goto_label</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hexec</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span> : <span class="kwd">match</span> ?<span class="id">a</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="id">eqn</span>:?<span class="id">Ha</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ha</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="AsmLang.html#Next">AsmLang.Next</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">inv</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hbuffer</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update_same">tupdate_update_same</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#symbol_address_eq">symbol_address_eq</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode32_eq">eval_addrmode32_eq</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode64_eq">eval_addrmode64_eq</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span>[<span class="kwd">Next</span> ?<span class="id">srs</span>' ?<span class="id">sfm</span>' = <span class="kwd">Next</span> <span class="id">_</span> <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;exec_load&nbsp;*)</span>&nbsp;unfold&nbsp;exec_load&nbsp;to&nbsp;mem&nbsp;load&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="AsmLang.html#exec_load">exec_load</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#exec_load">exec_load</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmLang.html#exec_load_fp">exec_load_fp</a></span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_load_TSO">exec_load_TSO</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.loadv">Mem.loadv</a></span> <span class="id">eqn</span>:<span class="id">Hload</span>; <span class="id">inv</span> <span class="id">Hexec</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="FMemory.html#Mem.loadv">Mem.loadv</a></span>, <span class="id"><a href="TSOMem.html#tsoloadv">tsoloadv</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode_eq">eval_addrmode_eq</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;construct&nbsp;TSO&nbsp;load&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="FMemory.html#Mem.load">Mem.load</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">b</span> ?<span class="id">ofs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> |- <span class="id">context</span>[<span class="id"><a href="TSOMem.html#tsoload">tsoload</a></span> ?<span class="id">chunk</span> <span class="id">_</span> ?<span class="id">b</span> ?<span class="id">ofs</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsoload">tsoload</a></span>; <span class="tactic">rewrite</span> <span class="id">Hbuffer</span>; <span class="tactic">simpl</span>; <span class="id">exploit</span> <span class="id">meminv_load_refine</span>'; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hembed</span>; <span class="id">inv</span> <span class="id">Hembed</span>'; <span class="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">A</span>; <span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;exec_store&nbsp;*)</span>&nbsp;unfold&nbsp;exec_store&nbsp;to&nbsp;mem&nbsp;store&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="AsmLang.html#exec_store">exec_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#exec_store_TSO">exec_store_TSO</a></span>, <span class="id"><a href="AsmLang.html#exec_store_fp">exec_store_fp</a></span>, <span class="id"><a href="AsmLang.html#exec_store">exec_store</a></span>, <span class="id"><a href="AsmLang.html#exec_store_fp">exec_store_fp</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="FMemory.html#Mem.storev">Mem.storev</a></span> <span class="id">eqn</span>:<span class="id">Hstore</span>; <span class="id">inv</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostorev">tsostorev</a></span>, <span class="id"><a href="FMemory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#eval_addrmode_eq">eval_addrmode_eq</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="ASM_local.html#eval_addrmode">eval_addrmode</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;construct&nbsp;SC&nbsp;store&nbsp;and&nbsp;eliminate&nbsp;abort&nbsp;case&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">H</span>: <span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">meminv_store_refine</span>' <span class="id">sm</span> <span class="id"><a href="TSOGlobSem.html#tm">tm</a></span> <span class="id">fl</span> <span class="id">sfm</span> <span class="id">tfm</span> <span class="id">bufs</span> <span class="id">t</span>); <span class="tactic">eauto</span>; <span class="tactic">intros</span> (<span class="id">buf</span>' &amp; <span class="id">Hstore</span>' &amp; <span class="id">Happly</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstore</span>'; <span class="id">eexists</span> <span class="id">_</span>, <span class="id">buf</span>'; <span class="tactic">simpl</span>; <span class="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;cmpu&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#check_compare_ints_TSO">check_compare_ints_TSO</a></span>, <span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="id">eqn</span>:<span class="id">A</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">meminv_cmpu_bool_Some_refine</span>' <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [? <span class="id">A</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hbuffer</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#check_compare_ints_TSO">check_compare_ints_TSO</a></span>, <span class="id"><a href="AsmLang.html#check_compare_ints">check_compare_ints</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Values.html#Val.cmpu_bool">Val.cmpu_bool</a></span> <span class="id">eqn</span>:<span class="id">A</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">meminv_cmpu_bool_Some_refine</span>' <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [? <span class="id">A</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hbuffer</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">do</span> 2 <span class="id">eexists</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;free&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Ha0</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_load_refine</span>'; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hembed</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Ha</span>; (<span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">Hembed</span>'; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hload1</span>. <span class="tactic">rewrite</span> <span class="id">Hload1</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_load_refine</span>'; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Hembed</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Ha0</span>; (<span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">Hembed</span>'; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hload2</span>. <span class="tactic">rewrite</span> <span class="id">Hload2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">meminv_free_refine</span>'; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="match_state_clientsim_properties">match_state_clientsim_properties</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id"><a href="ClientSim.html#clientsim_properties">clientsim_properties</a></span> <span class="id"><a href="ClientSim.html#Rc">Rc</a></span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> <span class="id"><a href="AsmLang.html#AsmLang">AsmLang</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.sge">sge</a></span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.tge">tge</a></span> <span class="id"><a href="AsmClientSim.html#match_state">match_state</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9530')">Proof.</div>
<div class="proofscript" id="proof9530">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;init&nbsp;match&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exists</span> <span class="id">tc</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#init_core">AsmTSO.init_core</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="InteractionSemantics.html#init_core">init_core</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.HSINITGE">HSINITGE</a></span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">HSINITGE</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#init_core">ASM_local.init_core</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span>; [|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>; [<span class="tactic">auto</span>|<span class="tactic">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;init&nbsp;None&nbsp;match&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#init_core">AsmTSO.init_core</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="InteractionSemantics.html#init_core">init_core</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim.HSINITGE">HSINITGE</a></span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">HSINITGE</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#init_core">ASM_local.init_core</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id"><a href="Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;tau&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">b</span> <span class="id">m</span> <span class="id">tfp</span> <span class="id">tc</span>' <span class="id">b</span>' <span class="id">m</span>' <span class="id">MS</span> <span class="id">Hbuffer</span> <span class="id">Hmem</span> <span class="id">Hfl</span> <span class="id">Hvalideq</span> <span class="id">Hstep</span> <span class="id">tm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">sc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hstep</span>. <span class="tactic">rename</span> <span class="id">H4</span> <span class="id">into</span> <span class="id">Hembed</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id">exists</span> <span class="id">sfm</span>, <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">sm</span> <span class="id">fl</span> <span class="id"><a href="AsmClientSim.html#sfm">sfm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">sfm</span> <span class="id">Hembed</span>]|<span class="id">C</span>]; [|<span class="id">right</span>; <span class="tactic">intros</span>; <span class="tactic">intro</span> <span class="id">C</span>'; <span class="id">inv</span> <span class="id">C</span>'; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hstrip</span>: <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span> = <span class="id">sm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hembed</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hstrip</span>': <span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">fm</span> = <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hembed</span>'; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;exec&nbsp;instr&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> (<span class="id"><a href="AsmClientSim.html#meminv_exec_instr_eq">meminv_exec_instr_eq</a></span> <span class="id">t</span> <span class="id">sfm</span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>) <span class="id">fm</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">Hembed</span>; <span class="id">inv</span> <span class="id">Hembed</span>'; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_mem">match_mem</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span> <span class="id">HIc</span>. <span class="id">inv</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstrip</span>'. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">MS</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstrip</span>'. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hstrip</span>'. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [ (<span class="id">srs</span>' &amp; <span class="id">sfp</span> &amp; <span class="id">sfm</span>' &amp; <span class="id">Hexec</span> &amp; <span class="id">Hexecfp</span> &amp; <span class="id">Hmatch</span>) | <span class="id">Hstuck</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;match&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">exists</span> <span class="id">sfp</span>, (<span class="id"><a href="ASM_local.html#Core_State">Core_State</a></span> <span class="id">srs</span>' <span class="id">lf</span>), (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmatch</span> <span class="kwd">as</span> [<span class="id">Hresults</span>|<span class="id">Hconflict</span>]; [<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;not&nbsp;conflict&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hresults</span> <span class="kwd">as</span> (<span class="id">Hsmile</span> &amp; <span class="id">Hrs</span> &amp; <span class="id">Hfp</span> &amp; <span class="id">Hmeminv</span>' &amp; <span class="id">HGc</span>'). <span class="tactic">subst</span> <span class="id">srs</span>'.<br/>
&nbsp;conflictc&nbsp;*)</span> <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;fp&nbsp;*)</span> <span class="tactic">split</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;Gc?&nbsp;*)</span> <span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="tactic">rewrite</span> <span class="id">Hstrip</span>' <span class="kwd">in</span> <span class="id">HGc</span>'. <span class="tactic">destruct</span> <span class="id">tm</span>. <span class="tactic">auto</span>.<br/>
&nbsp;match_state&nbsp;*)</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">Hmeminv</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;tm_alloc&nbsp;*)</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmeminv</span>'. <span class="id">inv</span> <span class="id">Hembed</span>; <span class="id">inv</span> <span class="id">Hembed</span>'. <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="tactic">auto</span>.<br/>
&nbsp;relvb&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmeminv</span>'. <span class="id">inv</span> <span class="id">Hembed</span>; <span class="id">inv</span> <span class="id">Hembed</span>'. <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;stuck&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">intros</span> <span class="id">FP</span> <span class="id">sc</span>'' <span class="id">sm</span>'' <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#strip_fl_eq_fmem_eq">strip_fl_eq_fmem_eq</a></span>. <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Hembed</span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>; <span class="id">simpl_hypos</span>. <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;alloc&nbsp;frame&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">simpl</span>.<br/>
&nbsp;construct&nbsp;allocation&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#alloc_refine">alloc_refine</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_mem">match_mem</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span>). <span class="id">instantiate</span> (1:= <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">tm</span> <span class="kwd">with</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>; <span class="id">memory</span> := <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span> |} <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#match_sep_obj_clt">match_sep_obj_clt</a></span> <span class="kwd">in</span> <span class="id">MS</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">tm</span> <span class="kwd">with</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>; <span class="id">memory</span> := <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span> |} <span class="kwd">in</span> <span class="id">Hvalideq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">tm</span> <span class="kwd">with</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>; <span class="id">memory</span> := <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span> |} <span class="kwd">in</span> <span class="id">Hvalideq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">HAllocSucceed</span>|<span class="id">C</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id">exfalso</span>; <span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">sfm</span> 0 <span class="id">sz</span>); <span class="tactic">eapply</span> <span class="id">C</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HAllocSucceed</span> <span class="kwd">as</span> (<span class="id">sfp1</span> &amp; <span class="id">stk</span>' &amp; <span class="id">sfm1</span> &amp; [<span class="id">Halloc</span> <span class="id">Hsfp1</span>] &amp; [<span class="id">Hmatch</span>|<span class="id">Hconflict0</span>]);[|].<br/>
&nbsp;if&nbsp;conflictc,&nbsp;either&nbsp;conflictc&nbsp;as&nbsp;a&nbsp;whole&nbsp;or&nbsp;abort&nbsp;*)</span>&nbsp;need&nbsp;lemma&nbsp;:&nbsp;conflictc&nbsp;fp&nbsp;-&gt;&nbsp;conflictc&nbsp;(FP.union&nbsp;fp&nbsp;_)&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmatch</span> <span class="kwd">as</span> (<span class="id">Hdrf1</span> &amp; <span class="id">Hsfp1</span>' &amp; <span class="id">Hstk</span>' &amp; <span class="id">Hmeminv1</span> &amp; <span class="id">HGc1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">stk</span>'.<br/>
&nbsp;construct&nbsp;store&nbsp;RSP&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hmeminv1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sfm1</span>). <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">Mem.alloc_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">bm</span>'). <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>'. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; [|<span class="id">contradiction</span>]. <span class="tactic">split</span>; [|<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">bm</span>' <span class="kwd">with</span> {| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">bm</span>'; <span class="id">fmemory</span> := <span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">bm</span>' |} <span class="kwd">in</span> <span class="id">H4</span>; [|<span class="tactic">destruct</span> <span class="id">bm</span>'; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">HStore1Succeed</span>|<span class="id">C</span>]; [|<span class="id">right</span>].<br/>
&nbsp;must&nbsp;succeed,&nbsp;by&nbsp;H4...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HStore1Succeed</span> <span class="kwd">as</span> (<span class="id">sfp2</span> &amp; <span class="id">sres</span> &amp; <span class="id">sfm2</span> &amp; [<span class="id">Hstore</span> <span class="id">Hsfp2</span>] &amp; [<span class="id">Hmatch</span>|<span class="id">Hconflict1</span>]); [|<span class="id">exfalso</span>].<br/>
&nbsp;cannot&nbsp;conflict&nbsp;because&nbsp;alloc&nbsp;not&nbsp;conflict...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmatch</span> <span class="kwd">as</span> (<span class="id">Hdrf2</span> &amp; <span class="id">Hsfp2</span>' &amp; <span class="id">Hres2</span> &amp; <span class="id">Hmeminv2</span> &amp; <span class="id">HGc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="kwd">in</span> <span class="id">Hres2</span>. <span class="tactic">subst</span> <span class="id">sres</span>.<br/>
&nbsp;construct&nbsp;store&nbsp;RA&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#store_refine">store_refine</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hmeminv2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sfm2</span>). <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.store_freelist">Mem.store_freelist</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="FMemory.html#Mem.alloc_freelist">Mem.alloc_freelist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">bm2</span>). <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostorev">tsostorev</a></span> <span class="kwd">in</span> *. <span class="tactic">do</span> 2 (<span class="tactic">destruct</span> <span class="id"><a href="Values.html#Val.offset_ptr">Val.offset_ptr</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>'. <span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; [|<span class="id">contradiction</span>]. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">bm2</span> <span class="kwd">with</span> {| <span class="id"><a href="TSOMem.html#mktsofmem">tbuffer</a></span> := <span class="id"><a href="TSOMem.html#tbuffer">tbuffer</a></span> <span class="id">bm2</span>; <span class="id">fmemory</span> := <span class="id"><a href="TSOMem.html#fmemory">fmemory</a></span> <span class="id">bm2</span> |} <span class="kwd">in</span> <span class="id">H5</span>; [|<span class="tactic">destruct</span> <span class="id">bm2</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">HStore2Succeed</span>|<span class="id">C</span>]; [|<span class="id">right</span>].<br/>
&nbsp;must&nbsp;succeed,&nbsp;by&nbsp;H5...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HStore2Succeed</span> <span class="kwd">as</span> (<span class="id">sfp3</span> &amp; <span class="id">sres</span>' &amp; <span class="id">sfm3</span> &amp; [<span class="id">Hstore</span>' <span class="id">Hsfp3</span>] &amp; [<span class="id">Hmatch</span>|<span class="id">Hconflict2</span>]); [|<span class="id">exfalso</span>].<br/>
&nbsp;cannot&nbsp;conflict&nbsp;because&nbsp;alloc&nbsp;not&nbsp;conflict...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmatch</span> <span class="kwd">as</span> (<span class="id">Hdrf3</span> &amp; <span class="id">Hsfp3</span>' &amp; <span class="id">Hres3</span> &amp; <span class="id">Hmeminv3</span> &amp; <span class="id">HGc3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="kwd">in</span> <span class="id">Hres3</span>. <span class="tactic">subst</span> <span class="id">sres</span>'.<br/>
&nbsp;construct&nbsp;step&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>.<br/>
(FP.union&nbsp;(tsoalloc_fp&nbsp;stk&nbsp;0&nbsp;sz)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(FP.union&nbsp;(store_fp&nbsp;Mptr&nbsp;stk&nbsp;_)&nbsp;(store_fp&nbsp;Mptr&nbsp;stk&nbsp;_))),&nbsp;_,&nbsp;_.*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Halloc</span>. <span class="tactic">rewrite</span> <span class="id">Hstore</span>. <span class="tactic">rewrite</span> <span class="id">Hstore</span>'. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;not&nbsp;conflict&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">Hc1</span>|<span class="id">Hc23</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hdrf1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">Hc23</span>. <span class="tactic">destruct</span> <span class="id">Hc23</span> <span class="kwd">as</span> [<span class="id">Hc2</span>|<span class="id">Hc3</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hdrf2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hdrf3</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">congruence</span>.<br/>
&nbsp;FP&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Halloc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>, <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span>. <span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">Mem.alloc_result</a></span> <span class="kwd">in</span> <span class="id">Halloc</span>. <span class="tactic">subst</span> <span class="id">stk</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;Gc&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">tm</span> <span class="kwd">with</span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> <span class="id">tm</span>; <span class="id">memory</span> := <span class="id"><a href="TSOMem.html#memory">memory</a></span> <span class="id">tm</span> |} <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_trans">Gc_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">tm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> <span class="id">HGc3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;match&nbsp;state&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">tm</span>'; <span class="id">inv</span> <span class="id">Hmeminv3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">tm</span>'; <span class="id">inv</span> <span class="id">Hmeminv3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">meminv_Ic0</span>; <span class="tactic">clear</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;alloc&nbsp;local&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="id">inv</span> <span class="id">Hmeminv3</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> <span class="id">meminv_alloc_local0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;rel&nbsp;vb&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">tm</span>'. <span class="id">inv</span> <span class="id">Hmeminv3</span>. <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#tupdate_update2">tupdate_update2</a></span> <span class="kwd">in</span> <span class="id">meminv_rel_vb0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;contradictions&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;by&nbsp;conflict&nbsp;ra&nbsp;fp,&nbsp;then&nbsp;conflict&nbsp;alloc&nbsp;fp,&nbsp;then&nbsp;contradicts&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hconflict2</span> <span class="kwd">as</span> [<span class="id">Hc</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflict_store_conflict_alloc">conflict_store_conflict_alloc</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. <span class="tactic">eapply</span> <span class="id">Hdrf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>. <span class="tactic">eauto</span>. <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>'. <span class="id">inv</span> <span class="id">C</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sfm</span> = <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. } <span class="tactic">subst</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Halloc</span>, <span class="id">Hstore</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">rs</span> <span class="id"><a href="Asm.html#RA">Asm.RA</a></span>)) <span class="id">eqn</span>:<span class="id">C</span>'; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">C</span>. <span class="id">constructor</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hconflict1</span> <span class="kwd">as</span> [<span class="id">Hc</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflict_store_conflict_alloc">conflict_store_conflict_alloc</a></span> <span class="kwd">in</span> <span class="id">Hc</span>. <span class="tactic">eapply</span> <span class="id">Hdrf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflictc_ext">conflictc_ext</a></span>. <span class="tactic">eauto</span>. <span class="tactic">clear</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>'. <span class="id">inv</span> <span class="id">C</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">sfm</span> = <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. } <span class="tactic">subst</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Halloc</span> <span class="kwd">in</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id"><a href="Asm.html#RSP">Asm.RSP</a></span>))) <span class="id">eqn</span>:<span class="id">C</span>'; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">C</span>. <span class="id">constructor</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>. } <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hconflict0</span> <span class="kwd">as</span> [<span class="id">Hc</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">stk</span> = <span class="id">stk</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">Mem.alloc_result</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">stk</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hembed</span>. <span class="tactic">inversion</span> <span class="id">Hembed</span>'. <span class="tactic">subst</span> <span class="id">fl</span>.  <span class="tactic">rewrite</span> &lt;- <span class="id">H7</span> <span class="kwd">in</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_validity_eq_nextblock">eq_validity_eq_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">Hvalideq</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H8</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H7</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">stk</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id">sfm1</span> <span class="id">stk</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span> <span class="id">ofs_link</span>)) (<span class="id">rs</span> (<span class="id"><a href="Asm.html#IR">Asm.IR</a></span> <span class="id"><a href="Asm.html#RSP">Asm.RSP</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eqn</span>:<span class="id">Hstore1</span>; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="FMemory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="AST.html#Mptr">Mptr</a></span> <span class="id">m</span> <span class="id">stk</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="Integers.html#Ptrofs.zero">Ptrofs.zero</a></span> <span class="id">ofs_ra</span>)) (<span class="id">rs</span> <span class="id"><a href="Asm.html#RA">Asm.RA</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eqn</span>:<span class="id">Hstore2</span>; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Halloc</span>, <span class="id">Hstore1</span>, <span class="id">Hstore2</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">Halloc</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span>, <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">Mem.alloc_result</a></span> <span class="kwd">in</span> <span class="id">Halloc</span>. <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H6</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H9</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="id">exploit</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">exact</span> <span class="id">H3</span>. <span class="tactic">exact</span> <span class="id">Hembed</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Halloc</span>, <span class="id">Hstore1</span>, <span class="id">Hstore2</span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="tactic">discriminate</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H6</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H9</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">inv</span> <span class="id">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="id">exploit</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">exact</span> <span class="id">H3</span>. <span class="tactic">exact</span> <span class="id">Hembed</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Halloc</span>, <span class="id">Hstore1</span> <span class="kwd">in</span> <span class="id">H12</span>. <span class="tactic">discriminate</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;builtin&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;Ic&nbsp;-&gt;&nbsp;eval&nbsp;builtin&nbsp;args&nbsp;eq...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_eval_builtin_args">meminv_eval_builtin_args</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [[<span class="id">vargs</span>' [<span class="id">Heval</span> <span class="id">A</span>]]|<span class="id">Habort</span>];[|<span class="id">right</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#genv_match_eval_builtin_args_fp">genv_match_eval_builtin_args_fp</a></span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id">exists</span> <span class="id">vres</span>', <span class="id"><a href="helpers.html#i64ext_sem">helpers.i64ext_sem</a></span> <span class="id">ef</span> <span class="id">vargs</span>' <span class="id">vres</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">vres</span>' <span class="id">Hhelper</span>]|<span class="id">Habort</span>]; [|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmLang.html#exec_step_builtin">exec_step_builtin</a></span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">tm</span>' = <span class="id">tm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="tactic">destruct</span> <span class="id">tm</span>. <span class="id">inv</span> <span class="id">Hembed</span>'. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H7</span>. <span class="tactic">clear</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>. <span class="tactic">intro</span>; <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">H6</span>. <span class="tactic">clear</span> <span class="id">tm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [[<span class="id">Hdrf</span> <span class="id">Hvargs</span>]|<span class="id">Hrace</span>];[<span class="id">left</span>; <span class="tactic">subst</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">vres</span>' = <span class="id">vres</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#helpers_i64ext_sem_det">helpers_i64ext_sem_det</a></span>. <span class="tactic">exact</span> <span class="id">H5</span>. <span class="tactic">exact</span> <span class="id">Hhelper</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>. <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">inv</span> <span class="id">H12</span>. <span class="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">exact</span> <span class="id">H6</span>. <span class="tactic">exact</span> <span class="id">Hembed</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">inv</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmLang.html#eval_builtin_args_determ">AsmLang.eval_builtin_args_determ</a></span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">Heval</span>. <span class="tactic">subst</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H10</span>. <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H11</span>. <span class="id">inv</span> <span class="id">H11</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H8</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">inv</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H13</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H10</span>; <span class="id">inv</span> <span class="id">H10</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">inv</span> <span class="id">H11</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">inv</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">exact</span> <span class="id">Hembed</span>. <span class="tactic">exact</span> <span class="id">H7</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">m</span>'. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;extcall&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;Ic&nbsp;-&gt;&nbsp;ext&nbsp;args&nbsp;eq...&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_extcall_arguments">meminv_extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> [(<span class="id">args</span>' &amp; <span class="id">Hargs</span>' &amp; <span class="id">A</span>)|<span class="id">Habort</span>]; [<span class="id">left</span>|<span class="id">right</span>]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">tfp</span>, <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">split</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmLang.html#exec_step_to_external">exec_step_to_external</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>; <span class="tactic">auto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">tm</span>' = <span class="id">tm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="tactic">destruct</span> <span class="id">tm</span>. <span class="id">inv</span> <span class="id">Hembed</span>'. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">clear</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>. <span class="tactic">intro</span>; <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">H3</span>. <span class="tactic">clear</span> <span class="id">tm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [[<span class="id">B</span> <span class="id">Hargseq</span>]|<span class="id">B</span>]; [<span class="id">left</span>; <span class="tactic">subst</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>. <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">exact</span> <span class="id">Hembed</span>. <span class="tactic">exact</span> <span class="id">H4</span>. <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H5</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H7</span>. <span class="id">inv</span> <span class="id">H7</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;helpers&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>; <span class="id">Locs.unfolds</span>; <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> ( ? &amp; ? &amp; <span class="id">H2</span>) ;<span class="id">red_boolean_true</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="id">tm</span>' = <span class="id">tm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">tm</span>'. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">tm</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tupdate">tupdate</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Axioms.html#functional_extensionality">functional_extensionality</a></span>. <span class="tactic">clear</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">Hembed</span>'; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">X</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">X</span>. <span class="tactic">clear</span> <span class="id">tm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#Gc_refl">Gc_refl</a></span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#match_mem">match_mem</a></span> <span class="kwd">in</span> <span class="id">MS</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">MS</span>. <span class="tactic">auto</span>.  }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;initialize&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">stk</span> = <span class="id"><a href="FMemory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sfm</span>) <span class="kwd">as</span> <span class="id">Hstk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">Hembed</span> <span class="id">Hembed</span>' <span class="id">Hvalideq</span> <span class="id">H0</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>) (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> <span class="id">gm</span>') &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="MemAux.html#get_block">MemAux.get_block</a></span> <span class="id">fl</span> <span class="id"><a href="AsmClientSim.html#n">n</a></span>) (<span class="id"><a href="GMemory.html#GMem.validblocks">GMem.validblocks</a></span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">sfm</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">Hvalideq</span>. <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">Hembed</span>'. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>; <span class="id">inv</span> <span class="id">Hembed</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#eq_validity_eq_nextblock">eq_validity_eq_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span> <span class="kwd">as</span> [<span class="id">bufs</span> <span class="id">tm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#meminv_initialize">meminv_initialize</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">Habort</span>]; [<span class="id">left</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">sfm1</span> &amp; <span class="id">sfm</span>' &amp; <span class="id">Halloc</span> &amp; <span class="id">Hstoreargs</span> &amp; [(<span class="id">HGc</span> &amp; <span class="id">Hmeminv</span>')|<span class="id">Hconflict</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hmeminv</span>' <span class="kwd">as</span> [<span class="id">Hic</span>' <span class="id">Hsep</span>' <span class="id">Hrelvb</span>' <span class="id">Halloclocal</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id">stk</span> 0 (4 * <span class="id">z</span>) = <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span> <span class="id">sfm</span> 0 (4 * <span class="id">z</span>)) <span class="kwd">as</span> <span class="id">Hfpeq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">f_equal</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span>, <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id"><a href="ClientSim.html#conflictc">conflictc</a></span> <span class="id">t</span> (<span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span> <span class="id">stk</span> 0 (4 * <span class="id">z</span>)) <span class="id">bufs</span>)) <span class="kwd">as</span> [<span class="id">Hconflict</span>|<span class="id">Hconflict</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;conflict&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">conflictc_union</span>'. <span class="id">left</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hfpeq</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;alloc&nbsp;not&nbsp;conflict...&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="AsmClientSim.html#conflictc_union">conflictc_union</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [<span class="id">A</span>|<span class="id">A</span>]. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#conflict_store_args_conflict_alloc">conflict_store_args_conflict_alloc</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">Hfpeq</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="id">eexists</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">conflictc_union</span>'. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">stk</span>. <span class="tactic">unfold</span> <span class="id"><a href="FMemOpFP.html#alloc_fp">alloc_fp</a></span>, <span class="id"><a href="AsmTSO.html#tsoalloc_fp">tsoalloc_fp</a></span>. <span class="tactic">apply</span> <span class="id"><a href="Footprint.html#FP.subset_refl">FP.subset_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">C</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="id">exploit</span> <span class="id"><a href="TSOAuxDefs.html#embed_eq">TSOAuxDefs.embed_eq</a></span>. <span class="tactic">exact</span> <span class="id">Hembed</span>. <span class="tactic">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">m</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="tactic">rewrite</span> <span class="id">H9</span> <span class="kwd">in</span> <span class="id">Habort</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Habort</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">Mem.alloc_result</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">subst</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;at_external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="AsmTSO.html#at_external">AsmTSO.at_external</a></span>, <span class="id"><a href="ASM_local.html#at_external">ASM_local.at_external</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tc</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="AsmClientSim.html#invert_symbol_from_string_eq">invert_symbol_from_string_eq</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;after_external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tc</span>'. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;after_external&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;halt&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;abort&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">sc</span> <span class="id">sm</span> <span class="id">tc</span> <span class="id">tm</span> <span class="id">fl</span> <span class="id">m</span> <span class="id">MS</span> <span class="id">Halloclocal</span> <span class="id">Hrelvb</span> <span class="id">Hbuf</span> <span class="id">Hmem</span> <span class="id">Habort</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">tm</span> <span class="kwd">as</span> [<span class="id">bufs</span> <span class="id">tm</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id">exists</span> <span class="id">tfm</span>, <span class="id"><a href="FMemory.html#embed">embed</a></span> <span class="id">tm</span> <span class="id">fl</span> <span class="id"><a href="AsmClientSim.html#tfm">tfm</a></span>)) <span class="kwd">as</span> [[<span class="id">tfm</span> <span class="id">Hembed</span>]|<span class="id">C</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>|<span class="id">right</span>; <span class="tactic">intros</span> <span class="id">tfm</span> <span class="id">C</span>'; <span class="tactic">apply</span> <span class="id">C</span>; <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">FP</span> <span class="id">sc</span>' <span class="id">sm</span>' <span class="id">Hsstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span> <span class="id">tc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hsstep</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;exec&nbsp;instr&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span> (<span class="id">exists</span> <span class="id">sz</span> <span class="id">ofs_ra</span> <span class="id">ofs_link</span>, <span class="id">i</span> = <span class="id"><a href="ASM_local.html#Pallocframe">Pallocframe</a></span> <span class="id"><a href="AsmClientSim.html#sz">sz</a></span> <span class="id"><a href="AsmClientSim.html#ofs_ra">ofs_ra</a></span> <span class="id"><a href="AsmClientSim.html#ofs_link">ofs_link</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [(<span class="id">sz</span> &amp; <span class="id">ofs_ra</span> &amp; <span class="id">ofs_link</span> &amp; <span class="id">Hallocinstr</span>)| <span class="id">Hnotalloc</span>].<br/>
&nbsp;alloc&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">subst</span> <span class="id">i</span>. <span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmTSO.html#tso_exec_step_internal_allocframe">tso_exec_step_internal_allocframe</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="tactic">inversion</span> <span class="id">Hembed</span>. <span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#tsostore">tsostore</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#Pallocframe_succeed_link_ra_inrange">Pallocframe_succeed_link_ra_inrange</a></span>. <span class="tactic">eauto</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">Hinrange_ra</span> <span class="id">Hinrange_link</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#buffer_insert">buffer_insert</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id">eqn</span>:<span class="id">Hstore1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hstore1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#valid_access_dec">valid_access_dec</a></span>; [|<span class="tactic">discriminate</span>]. <span class="id">inv</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#store">store</a></span> <span class="id">eqn</span>:<span class="id">Hstore2</span>; <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;contradictions..&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">clear</span> <span class="id">v</span>. <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hstore2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#valid_access_dec">valid_access_dec</a></span>; [<span class="tactic">discriminate</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#valid_access">valid_access</a></span>, <span class="id"><a href="TSOMem.html#range_perm">range_perm</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> <span class="id">ofs_ra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>, <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">try</span> <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#store">store</a></span> <span class="kwd">in</span> <span class="id">Hstore1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="TSOMem.html#valid_access_dec">valid_access_dec</a></span>; [<span class="tactic">discriminate</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="TSOMem.html#valid_access">valid_access</a></span>, <span class="id"><a href="TSOMem.html#range_perm">range_perm</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="Integers.html#Ptrofs.unsigned_range">Ptrofs.unsigned_range</a></span> <span class="id">ofs_link</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="Maps.html#PMap.gss">PMap.gss</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#zle">zle</a></span>, <span class="id"><a href="Coqlib.html#zlt">zlt</a></span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">try</span> <span class="id">constructor</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;not&nbsp;alloc&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;Lemma&nbsp;meminv_exec_instr_eq':&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="AsmTSO.html#not_alloc_instr">not_alloc_instr</a></span> <span class="id">i</span>) <span class="kwd">as</span> <span class="id">Hnotalloc</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">Hnotalloc</span>. <span class="tactic">clear</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">meminv_exec_instr_eq</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="id">instantiate</span> (2:= <span class="id">m</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hembed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>'' &amp; <span class="id">b</span>' &amp; <span class="id">Hexec</span> &amp; <span class="id">Happly</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmTSO.html#tso_exec_step_internal">tso_exec_step_internal</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">Hbuf</span> <span class="id">t</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">inv</span> <span class="id">Hembed</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;builtin&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmTSO.html#tso_exec_step_builtin">tso_exec_step_builtin</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">Hbuf</span> <span class="id">t</span>). <span class="tactic">eapply</span> <span class="id">meminv_eval_builtin_args</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#genv_match_eval_builtin_args_fp">genv_match_eval_builtin_args_fp</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;to&nbsp;external&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmTSO.html#tso_exec_step_to_external">tso_exec_step_to_external</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;extcall&nbsp;args&nbsp;eq&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">Hbuf</span> <span class="id">t</span>). <span class="tactic">replace</span> <span class="id">bufs</span> <span class="kwd">with</span> (<span class="id"><a href="TSOMem.html#tso_buffers">tso_buffers</a></span> {| <span class="id"><a href="TSOMem.html#mktsomem">tso_buffers</a></span> := <span class="id">bufs</span>; <span class="id">memory</span> := <span class="id">tm</span> |}) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">meminv_extcall_arguments</span>'; <span class="tactic">try</span> <span class="tactic">exact</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">destruct</span> <span class="id">MS</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;i64ext&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmTSO.html#tso_exec_step_i64ext">tso_exec_step_i64ext</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="AsmClientSim.html#function_ptr_eq">function_ptr_eq</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;initialize&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#rel_vb_nextblock_eq">rel_vb_nextblock_eq</a></span>. <span class="tactic">replace</span> <span class="id">tm</span> <span class="kwd">with</span> (<span class="id"><a href="FMemory.html#strip">strip</a></span> <span class="id">tfm</span>) <span class="kwd">in</span> <span class="id">Hrelvb</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Hembed</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">Hembed</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">intro</span> <span class="id">Hnext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="FMemory.html#Mem.alloc_result">Mem.alloc_result</a></span>. <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">Hstk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#store_args_succeed_tso">store_args_succeed_tso</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tfm</span>' &amp; <span class="id">Hstoreargs</span> &amp; [<span class="id">m</span>'' <span class="id">Happly</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Habort</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmTSO.html#exec_initialize_call">exec_initialize_call</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>. <span class="tactic">inversion</span> <span class="id">Hembed</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>, <span class="id">H2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;after_external&nbsp;None&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="AsmClientSim.html#match_core">match_core</a></span>. <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">intro</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;Rely&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="comment">(*&nbsp;no&nbsp;atom&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="InteractionSemantics.html#at_external">at_external</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="ASM_local.html#at_external">ASM_local.at_external</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">sc</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CUAST.html#invert_symbol_from_string">invert_symbol_from_string</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">destruct</span> <span class="id"><a href="Coqlib.html#peq">peq</a></span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="AsmClientSim.html#MatchStateSim">MatchStateSim</a></span>.<br/>
<br/>
<div class="doc">identity x86 assembly modules satisfies the client simulation </div>
<span class="kwd">Theorem</span> <span class="id"><a name="clientsim_hold">clientsim_hold</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cu</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HNODUPGD</span>: <span class="id"><a href="CUAST.html#nodup_gd_ident">nodup_gd_ident</a></span> (<span class="id"><a href="CUAST.html#cu_defs">cu_defs</a></span> <span class="id"><a href="AsmClientSim.html#cu">cu</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HNODUPEF</span>: (<span class="id"><a href="CUAST.html#nodup_ef">nodup_ef</a></span> (<span class="id"><a href="CUAST.html#cu_defs">cu_defs</a></span> <span class="id"><a href="AsmClientSim.html#cu">cu</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="ClientSim.html#clientsim">clientsim</a></span> <span class="id"><a href="ClientSim.html#Rc">Rc</a></span> <span class="id"><a href="ClientSim.html#Gc">Gc</a></span> <span class="id"><a href="ClientSim.html#Ic">Ic</a></span> <span class="id"><a href="AsmLang.html#AsmLang">AsmLang</a></span> <span class="id"><a href="AsmClientSim.html#cu">cu</a></span> <span class="id"><a href="AsmClientSim.html#cu">cu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9531')">Proof.</div>
<div class="proofscript" id="proof9531">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intros</span> <span class="id">sge</span> <span class="id">sG</span> <span class="id">tge</span> <span class="id">HSINITGE</span> <span class="id">HTINITGE</span> <span class="id">HGENVMATCH</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="AsmClientSim.html#match_state">match_state</a></span>. <span class="tactic">inversion</span> <span class="id">HSINITGE</span>. <span class="tactic">subst</span> <span class="id">sG</span>. <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="AsmClientSim.html#match_state_clientsim_properties">match_state_clientsim_properties</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
