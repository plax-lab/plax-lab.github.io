<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module LibTactics</title>
<meta name="description" content="Documentation of Coq module LibTactics" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module LibTactics</h1>
<div class="coq">
<span class="kwd">Set</span> <span class="id">Asymmetric</span> <span class="id">Patterns</span>.<br/>
<h1> LibTactics: A Collection of Handy General-Purpose Tactics </h1>
<div class="doc">Useful General-Purpose Tactics for Coq </div>
<div class="doc">Distributed under the terms of the LGPL-v3 license </div>
<br/>
<div class="doc">This file contains a set of tactics that extends the set of builtin
    tactics provided with the standard distribution of Coq. It intends
    to overcome a number of limitations of the standard set of tactics,
    and thereby to help user to write shorter and more robust scripts. 
  
    Hopefully, Coq tactics will be improved as time goes by, and this
    file should ultimately be useless. In the meanwhile, serious Coq
    users will probably find it very useful.
    The present file contains the implementation and the detailed
    documentation of those tactics. The SF reader need not read this
    file; instead, he/she is encouraged to read the chapter named
    UseTactics.v, which is gentle introduction to the most useful
    tactics from the LibTactic library. </div>
<br/>
<div class="doc">The main features offered are:
  - More convenient syntax for naming hypotheses, with tactics for
    introduction and inversion that take as input only the name of
    hypotheses of type <span class="bracket"><span class="kwd">Prop</span></span>, rather than the name of all variables. 
  - Tactics providing true support for manipulating N-ary conjunctions, 
    disjunctions and existentials, hidding the fact that the underlying 
    implementation is based on binary predicates.
  - Convenient support for automation: tactic followed with the symbol
    "~" or "*" will call automation on the generated subgoals.  
    Symbol "~" stands for <span class="bracket"><span class="tactic">auto</span></span> and "*" for <span class="bracket"><span class="tactic">intuition</span> <span class="tactic">eauto</span></span>.
    These bindings can be customized.
  - Forward-chaining tactics are provided to instantiate lemmas
    either with variable or hypotheses or a mix of both.
  - A more powerful implementation of <span class="bracket"><span class="tactic">apply</span></span> is provided (it is based
    on <span class="bracket"><span class="tactic">refine</span></span> and thus behaves better with respect to conversion).
  - An improved inversion tactic which substitutes equalities on variables
    generated by the standard inversion mecanism. Moreover, it supports
    the elimination of dependently-typed equalities (requires axiom <span class="bracket"><span class="id">K</span></span>,
    which is a weak form of Proof Irrelevance).
  - Tactics for saving time when writing proofs, with tactics to
    asserts hypotheses or sub-goals, and improved tactics for
    clearing, renaming, and sorting hypotheses.
</div>
<br/>
<div class="doc">External credits:
  - thanks to Xavier Leroy for providing the idea of tactic <span class="bracket"><span class="id">forward</span></span>,
  - thanks to Georges Gonthier for the implementation trick in <span class="bracket"><span class="id">rapply</span></span>,
</div>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<h1> Additional notations for Coq </h1>
<br/>
<h2> N-ary Existentials </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">exists</span> <span class="id">T1</span> ... <span class="id">TN</span>, <span class="id">P</span></span> is a shorthand for 
    <span class="bracket"><span class="id">exists</span> <span class="id">T1</span>, ..., <span class="id">exists</span> <span class="id">TN</span>, <span class="id">P</span></span>. Note that
    <span class="bracket"><span class="id">Coq.Program.Syntax</span></span> already defines exists
    for arity up to 4. </div>
<br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>. <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>. <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">exists</span> <span class="id">x5</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <span class="id">x5</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">exists</span> <span class="id">x5</span>, <span class="id">exists</span> <span class="id">x6</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <span class="id">x5</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">x6</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> <span class="id">x7</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">exists</span> <span class="id">x5</span>, <span class="id">exists</span> <span class="id">x6</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x7</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <span class="id">x5</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">x6</span> <span class="id">ident</span>, <span class="id">x7</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> <span class="id">x7</span> <span class="id">x8</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">exists</span> <span class="id">x5</span>, <span class="id">exists</span> <span class="id">x6</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x7</span>, <span class="id">exists</span> <span class="id">x8</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <span class="id">x5</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">x6</span> <span class="id">ident</span>, <span class="id">x7</span> <span class="id">ident</span>, <span class="id">x8</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> <span class="id">x7</span> <span class="id">x8</span> <span class="id">x9</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">exists</span> <span class="id">x5</span>, <span class="id">exists</span> <span class="id">x6</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x7</span>, <span class="id">exists</span> <span class="id">x8</span>, <span class="id">exists</span> <span class="id">x9</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <span class="id">x5</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">x6</span> <span class="id">ident</span>, <span class="id">x7</span> <span class="id">ident</span>, <span class="id">x8</span> <span class="id">ident</span>, <span class="id">x9</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<span class="kwd">Notation</span> "'<span class="id">exists</span>' <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> <span class="id">x7</span> <span class="id">x8</span> <span class="id">x9</span> <span class="id">x10</span> ',' <span class="id">P</span>" :=<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">x1</span>, <span class="id">exists</span> <span class="id">x2</span>, <span class="id">exists</span> <span class="id">x3</span>, <span class="id">exists</span> <span class="id">x4</span>, <span class="id">exists</span> <span class="id">x5</span>, <span class="id">exists</span> <span class="id">x6</span>, <br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x7</span>, <span class="id">exists</span> <span class="id">x8</span>, <span class="id">exists</span> <span class="id">x9</span>, <span class="id">exists</span> <span class="id">x10</span>, <span class="id">P</span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">x1</span> <span class="id">ident</span>, <span class="id">x2</span> <span class="id">ident</span>, <span class="id">x3</span> <span class="id">ident</span>, <span class="id">x4</span> <span class="id">ident</span>, <span class="id">x5</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">x6</span> <span class="id">ident</span>, <span class="id">x7</span> <span class="id">ident</span>, <span class="id">x8</span> <span class="id">ident</span>, <span class="id">x9</span> <span class="id">ident</span>, <span class="id">x10</span> <span class="id">ident</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">right</span> <span class="id">associativity</span>) : <span class="id">type_scope</span>.  <br/>
<br/>
<br/>
<br/>
<h1> Tools for programming with Ltac </h1>
<br/>
<h2> Identity continuation </h2>
<br/>
<span class="kwd">Ltac</span> <span class="id">idcont</span> <span class="id">tt</span> := <br/>
&nbsp;&nbsp;<span class="id">idtac</span>.<br/>
<br/>
<h2> Untyped arguments for tactics </h2>
<br/>
<div class="doc">Any Coq value can be boxed into the type <span class="bracket"><span class="id">Boxer</span></span>. This is
    useful to use Coq computations for implementing tactics. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Boxer">Boxer</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="boxer">boxer</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="kwd">Type</span>), <span class="id"><a href="LibTactics.html#A">A</a></span> -&gt; <span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>.<br/>
<br/>
<br/>
<h2> Optional arguments for tactics  </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_no_arg</span></span> is a constant that can be used to simulate 
    optional arguments in tactic definitions. 
    Use <span class="bracket"><span class="id">mytactic</span> <span class="id">ltac_no_arg</span></span> on the tactic invokation,
    and use <span class="bracket"><span class="kwd">match</span> <span class="id">arg</span> <span class="kwd">with</span> <span class="id">ltac_no_arg</span> =&gt; ..</span> or
    <span class="bracket"><span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">arg</span> <span class="kwd">with</span> <span class="id">ltac_No_arg</span>  =&gt; ..</span> to
    test whether an argument was provided. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="ltac_No_arg">ltac_No_arg</a></span> : <span class="kwd">Set</span> := <br/>
&nbsp;&nbsp;| <span class="id"><a name="ltac_no_arg">ltac_no_arg</a></span> : <span class="id"><a href="LibTactics.html#ltac_No_arg">ltac_No_arg</a></span>.<br/>
<br/>
<br/>
<h2> Wildcard arguments for tactics  </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_wild</span></span> is a constant that can be used to simulate 
    wildcard arguments in tactic definitions. Notation is <span class="bracket"><span class="id">__</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="ltac_Wild">ltac_Wild</a></span> : <span class="kwd">Set</span> := <br/>
&nbsp;&nbsp;| <span class="id"><a name="ltac_wild">ltac_wild</a></span> : <span class="id"><a href="LibTactics.html#ltac_Wild">ltac_Wild</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">__</span>'" := <span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span> : <span class="id">ltac_scope</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_wilds</span></span> is another constant that is typically used to
    simulate a sequence of <span class="bracket"><span class="id">N</span></span> wildcards, with <span class="bracket"><span class="id">N</span></span> chosen 
    appropriately depending on the context. Notation is <span class="bracket"><span class="id">___</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="ltac_Wilds">ltac_Wilds</a></span> : <span class="kwd">Set</span> := <br/>
&nbsp;&nbsp;| <span class="id"><a name="ltac_wilds">ltac_wilds</a></span> : <span class="id"><a href="LibTactics.html#ltac_Wilds">ltac_Wilds</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">___</span>'" := <span class="id"><a href="LibTactics.html#ltac_wilds">ltac_wilds</a></span> : <span class="id">ltac_scope</span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ltac_scope</span>.<br/>
<br/>
<br/>
<h2> Position markers </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_Mark</span></span> and <span class="bracket"><span class="id">ltac_mark</span></span> are dummy definitions used as sentinel
    by tactics, to mark a certain position in the context or in the goal. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="ltac_Mark">ltac_Mark</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="ltac_mark">ltac_mark</a></span> : <span class="id"><a href="LibTactics.html#ltac_Mark">ltac_Mark</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">gen_until_mark</span></span> repeats <span class="bracket"><span class="tactic">generalize</span></span> on hypotheses from the 
    context, starting from the bottom and stopping as soon as reaching
    an hypothesis of type <span class="bracket"><span class="id">Mark</span></span>. If fails if <span class="bracket"><span class="id">Mark</span></span> does not
    appear in the context. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">gen_until_mark</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;| <span class="id"><a href="LibTactics.html#ltac_Mark">ltac_Mark</a></span> =&gt; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">generalize</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="id">gen_until_mark</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">intro_until_mark</span></span> repeats <span class="bracket"><span class="tactic">intro</span></span> until reaching an hypothesis of
    type <span class="bracket"><span class="id">Mark</span></span>. It throws away the hypothesis <span class="bracket"><span class="id">Mark</span></span>. 
    It fails if <span class="bracket"><span class="id">Mark</span></span> does not appear as an hypothesis in the 
    goal. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">intro_until_mark</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;| |- (<span class="id"><a href="LibTactics.html#ltac_Mark">ltac_Mark</a></span> -&gt; <span class="id">_</span>) =&gt; <span class="tactic">intros</span> <span class="id">_</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="tactic">intro</span>; <span class="id">intro_until_mark</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> List of arguments for tactics  </h2>
<br/>
<div class="doc">A datatype of type <span class="bracket"><span class="id">list</span> <span class="id">Boxer</span></span> is used to manipulate list of
    Coq values in ltac. Notation is <span class="bracket">&gt;&gt; <span class="id">v1</span> <span class="id">v2</span> ... <span class="id">vN</span></span> for building
    a list containing the values <span class="bracket"><span class="id">v1</span></span> through <span class="bracket"><span class="id">vN</span></span>. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> "'&gt;&gt;'" :=<br/>
&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span> <span class="id">v8</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v8</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v8</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span> <span class="id">v8</span> <span class="id">v9</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v8</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v9</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v8</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v9</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span> <span class="id">v8</span> <span class="id">v9</span> <span class="id">v10</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v8</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v9</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v10</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v8</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v9</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v10</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span> <span class="id">v8</span> <span class="id">v9</span> <span class="id">v10</span> <span class="id">v11</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v8</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v9</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v10</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v11</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v8</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v9</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v10</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v11</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span> <span class="id">v8</span> <span class="id">v9</span> <span class="id">v10</span> <span class="id">v11</span> <span class="id">v12</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v8</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v9</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v10</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v11</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v12</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v8</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v9</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v10</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v11</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v12</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<span class="kwd">Notation</span> "'&gt;&gt;' <span class="id">v1</span> <span class="id">v2</span> <span class="id">v3</span> <span class="id">v4</span> <span class="id">v5</span> <span class="id">v6</span> <span class="id">v7</span> <span class="id">v8</span> <span class="id">v9</span> <span class="id">v10</span> <span class="id">v11</span> <span class="id">v12</span> <span class="id">v13</span>" :=<br/>
&nbsp;&nbsp;((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v1</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v2</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v3</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v4</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v5</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v6</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v7</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v8</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v9</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v10</span>)<br/>
&nbsp;&nbsp;&nbsp;::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v11</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v12</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">v13</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v1</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v2</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v3</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v4</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v5</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v6</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v7</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v8</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v9</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v10</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v11</span> <span class="tactic">at</span> <span class="id">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;<span class="id">v12</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">v13</span> <span class="tactic">at</span> <span class="id">level</span> 0)<br/>
&nbsp;&nbsp;: <span class="id">ltac_scope</span>.<br/>
<br/>
<br/>
<div class="doc">The tactic <span class="bracket"><span class="id">list_boxer_of</span></span> inputs a term <span class="bracket"><span class="id">E</span></span> and returns a term 
    of type "list boxer", according to the following rules:
    - if <span class="bracket"><span class="id">E</span></span> is already of type "list Boxer", then it returns <span class="bracket"><span class="id">E</span></span>;
    - otherwise, it returns the list <span class="bracket">(<span class="id">boxer</span> <span class="id">E</span>)::<span class="id">nil</span></span>. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">list_boxer_of</span> <span class="id">E</span> := <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list">List.list</a></span> <span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span> =&gt; <span class="id">constr</span>:(<span class="id">E</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">constr</span>:((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">E</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> Databases of lemmas  </h2>
<br/>
<div class="doc">Use the hint facility to implement a database mapping
    terms to terms. To declare a new database, use a definition:
    <span class="bracket"><span class="kwd">Definition</span> <span class="id">mydatabase</span> := <span class="id">True</span>.</span>
    Then, to map <span class="bracket"><span class="id">mykey</span></span> to <span class="bracket"><span class="id">myvalue</span></span>, write the hint:
    <span class="bracket"><span class="kwd">Hint</span> <span class="kwd">Extern</span> 1 (<span class="id">Register</span> <span class="id">mydatabase</span> <span class="id">mykey</span>) =&gt; <span class="id">Provide</span> <span class="id">myvalue</span>.</span>
    Finally, to query the value associated with a key, run the
    tactic <span class="bracket"><span class="id">ltac_database_get</span> <span class="id">mydatabase</span> <span class="id">mykey</span></span>. This will leave
    at the head of the goal the term <span class="bracket"><span class="id">myvalue</span></span>. It can then be
    named and exploited using <span class="bracket"><span class="tactic">intro</span></span>. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ltac_database">ltac_database</a></span> (<span class="id">D</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>) (<span class="id">T</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>) (<span class="id">A</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">Register</span>' <span class="id">D</span> <span class="id">T</span>" := (<span class="id"><a href="LibTactics.html#ltac_database">ltac_database</a></span> (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">D</span>) (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">T</span>) <span class="id">_</span>) <br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 69, <span class="id">D</span> <span class="tactic">at</span> <span class="id">level</span> 0, <span class="id">T</span> <span class="tactic">at</span> <span class="id">level</span> 0).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ltac_database_provide">ltac_database_provide</a></span> : <span class="kwd">forall</span> (<span class="id">A</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>) (<span class="id">D</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>) (<span class="id">T</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="LibTactics.html#ltac_database">ltac_database</a></span> <span class="id"><a href="LibTactics.html#D">D</a></span> <span class="id"><a href="LibTactics.html#T">T</a></span> <span class="id"><a href="LibTactics.html#A">A</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9899')">Proof.</div>
<div class="proofscript" id="proof9899">
 <span class="tactic">split</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">Provide</span> <span class="id">T</span> := <span class="tactic">apply</span> (@<span class="id"><a href="LibTactics.html#ltac_database_provide">ltac_database_provide</a></span> (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">T</span>)).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">ltac_database_get</span> <span class="id">D</span> <span class="id">T</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">A</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> <span class="id">evar</span> (<span class="id">A</span>:<span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span>);<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : <span class="id"><a href="LibTactics.html#ltac_database">ltac_database</a></span> (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">D</span>) (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">T</span>) <span class="id">A</span>); <br/>
&nbsp;&nbsp;[ <span class="tactic">subst</span> <span class="id">A</span>; <span class="tactic">auto</span> <br/>
&nbsp;&nbsp;| <span class="tactic">subst</span> <span class="id">A</span>; <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id"><a href="LibTactics.html#ltac_database">ltac_database</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">L</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">L</span> <span class="kwd">end</span>; <span class="tactic">clear</span> <span class="id">H</span> ].<br/>
<br/>
<br/>
<h2> On-the-fly removal of hypotheses </h2>
<br/>
<div class="doc">In a list of arguments <span class="bracket">&gt;&gt; <span class="id">H1</span> <span class="id">H2</span> .. <span class="id">HN</span></span> passed to a tactic
    such as <span class="bracket"><span class="id">lets</span></span> or <span class="bracket"><span class="id">applys</span></span> or <span class="bracket"><span class="id">forwards</span></span> or <span class="bracket"><span class="id">specializes</span></span>,
    the term <span class="bracket"><span class="id">rm</span></span>, an identity function, can be placed in front
    of the name of an hypothesis to be deleted. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="rm">rm</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">X</span>:<span class="id"><a href="LibTactics.html#A">A</a></span>) := <span class="id"><a href="LibTactics.html#X">X</a></span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">rm_term</span> <span class="id">E</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">T</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">T</span> |- <span class="id">_</span> =&gt; <span class="tactic">try</span> <span class="tactic">clear</span> <span class="id">H</span> <span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">rm_inside</span> <span class="id">E</span></span> calls <span class="bracket"><span class="id">rm_term</span> <span class="id">Ei</span></span> for any subterm 
    of the form <span class="bracket"><span class="id">rm</span> <span class="id">Ei</span></span> found in E </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">rm_inside</span> <span class="id">E</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">go</span> <span class="id">E</span> := <span class="id">rm_inside</span> <span class="id">E</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">E</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="LibTactics.html#rm">rm</a></span> ?<span class="id">X</span> =&gt; <span class="id">rm_term</span> <span class="id">X</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span>; <span class="id">go</span> <span class="id">X5</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span>; <span class="id">go</span> <span class="id">X5</span>; <span class="id">go</span> <span class="id">X6</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> ?<span class="id">X7</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span>; <span class="id">go</span> <span class="id">X5</span>; <span class="id">go</span> <span class="id">X6</span>; <span class="id">go</span> <span class="id">X7</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> ?<span class="id">X7</span> ?<span class="id">X8</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span>; <span class="id">go</span> <span class="id">X5</span>; <span class="id">go</span> <span class="id">X6</span>; <span class="id">go</span> <span class="id">X7</span>; <span class="id">go</span> <span class="id">X8</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> ?<span class="id">X7</span> ?<span class="id">X8</span> ?<span class="id">X9</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span>; <span class="id">go</span> <span class="id">X5</span>; <span class="id">go</span> <span class="id">X6</span>; <span class="id">go</span> <span class="id">X7</span>; <span class="id">go</span> <span class="id">X8</span>; <span class="id">go</span> <span class="id">X9</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> ?<span class="id">X7</span> ?<span class="id">X8</span> ?<span class="id">X9</span> ?<span class="id">X10</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">go</span> <span class="id">X1</span>; <span class="id">go</span> <span class="id">X2</span>; <span class="id">go</span> <span class="id">X3</span>; <span class="id">go</span> <span class="id">X4</span>; <span class="id">go</span> <span class="id">X5</span>; <span class="id">go</span> <span class="id">X6</span>; <span class="id">go</span> <span class="id">X7</span>; <span class="id">go</span> <span class="id">X8</span>; <span class="id">go</span> <span class="id">X9</span>; <span class="id">go</span> <span class="id">X10</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">For faster performance, one may deactivate <span class="bracket"><span class="id">rm_inside</span></span> by
    replacing the body of this definition with <span class="bracket"><span class="id">idtac</span></span>. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">fast_rm_inside</span> <span class="id">E</span> :=<br/>
&nbsp;&nbsp;<span class="id">rm_inside</span> <span class="id">E</span>.<br/>
<br/>
<br/>
<h2> Numbers as arguments </h2>
<br/>
<div class="doc">When tactic takes a natural number as argument, it may be
    parsed either as a natural number or as a relative number. 
    In order for tactics to convert their arguments into natural numbers, 
    we provide a conversion tactic. </div>
&nbsp;<br/>
<span class="kwd">Require</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html">BinPos</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html">Coq.ZArith.BinInt</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ltac_nat_from_int">ltac_nat_from_int</a></span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z">BinInt.Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="LibTactics.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">BinInt.Z0</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">BinInt.Zpos</span> <span class="id">p</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#nat_of_P">BinPos.nat_of_P</a></span> <span class="id">p</span><br/>
&nbsp;&nbsp;| <span class="id">BinInt.Zneg</span> <span class="id">p</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">nat_from_number</span> <span class="id">N</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">N</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">constr</span>:(<span class="id">N</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z">BinInt.Z</a></span> =&gt; <span class="kwd">let</span> <span class="id">N</span>' := <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#ltac_nat_from_int">ltac_nat_from_int</a></span> <span class="id">N</span>) <span class="kwd">in</span> <span class="id">eval</span> <span class="tactic">compute</span> <span class="kwd">in</span> <span class="id">N</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_pattern</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span></span> is the same as <span class="bracket"><span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span></span> except that
    <span class="bracket"><span class="id">K</span></span> is a Coq natural rather than a Ltac integer. Syntax 
    <span class="bracket"><span class="id">ltac_pattern</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">K</span> <span class="kwd">in</span> <span class="id">H</span></span> is also available. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">ltac_pattern</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">nat_from_number</span> <span class="id">K</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| 1 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 1<br/>
&nbsp;&nbsp;| 2 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 2<br/>
&nbsp;&nbsp;| 3 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 3<br/>
&nbsp;&nbsp;| 4 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 4<br/>
&nbsp;&nbsp;| 5 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 5<br/>
&nbsp;&nbsp;| 6 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 6<br/>
&nbsp;&nbsp;| 7 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 7<br/>
&nbsp;&nbsp;| 8 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 8<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">ltac_pattern</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">nat_from_number</span> <span class="id">K</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| 1 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 1 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 2 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 2 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 3 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 3 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 4 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 4 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 5 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 5 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 6 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 6 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 7 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 7 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| 8 =&gt; <span class="tactic">pattern</span> <span class="id">E</span> <span class="tactic">at</span> 8 <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> Testing tactics </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">show</span> <span class="id">tac</span></span> executes a tactic <span class="bracket"><span class="id">tac</span></span> that produces a result,
    and then display its result. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show</span>" <span class="id">tactic</span>(<span class="id">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">R</span> := <span class="id">tac</span> <span class="kwd">in</span> <span class="id">pose</span> <span class="id">R</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">dup</span> <span class="id">N</span></span> produces <span class="bracket"><span class="id">N</span></span> copies of the current goal. It is useful
    for building examples on which to illustrate behaviour of tactics.
    <span class="bracket"><span class="id">dup</span></span> is short for <span class="bracket"><span class="id">dup</span> 2</span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dup_lemma">dup_lemma</a></span> : <span class="kwd">forall</span> <span class="id">P</span>, <span class="id"><a href="LibTactics.html#P">P</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof9900')">Proof.</div>
<div class="proofscript" id="proof9900">
 <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">dup_tactic</span> <span class="id">N</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> 0 =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ?<span class="id">N</span>' =&gt; <span class="tactic">apply</span> <span class="id"><a href="LibTactics.html#dup_lemma">dup_lemma</a></span>; [ | <span class="id">dup_tactic</span> <span class="id">N</span>' ]<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">dup</span>" <span class="id">constr</span>(<span class="id">N</span>) := <br/>
&nbsp;&nbsp;<span class="id">dup_tactic</span> <span class="id">N</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">dup</span>" := <br/>
&nbsp;&nbsp;<span class="id">dup</span> 2.<br/>
<br/>
<br/>
<h2> Check no evar in goal </h2>
<br/>
<span class="kwd">Ltac</span> <span class="id">check_noevar</span> <span class="id">M</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">M</span> <span class="kwd">with</span> <span class="id">M</span> =&gt; <span class="id">idtac</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">check_noevar_hyp</span> <span class="id">H</span> := <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">T</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">T</span> =&gt; <span class="id">idtac</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">check_noevar_goal</span> := <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">G</span> =&gt; <span class="kwd">match</span> <span class="id">G</span> <span class="kwd">with</span> <span class="id">G</span> =&gt; <span class="id">idtac</span> <span class="kwd">end</span> <span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> Tagging of hypotheses </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">get_last_hyp</span> <span class="id">tt</span></span> is a function that returns the last hypothesis
    at the bottom of the context. It is useful to obtain the default
    name associated with the hypothesis, e.g. 
    <span class="bracket"><span class="tactic">intro</span>; <span class="kwd">let</span> <span class="id">H</span> := <span class="id">get_last_hyp</span> <span class="id">tt</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> "<span class="id">P</span>" <span class="id">H</span> <span class="kwd">in</span> ...</span> </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">get_last_hyp</span> <span class="id">tt</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">H</span>) <span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> Tagging of hypotheses </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_tag_subst</span></span> is a specific marker for hypotheses 
    which is used to tag hypotheses that are equalities to 
    be substituted. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ltac_tag_subst">ltac_tag_subst</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">x</span>:<span class="id"><a href="LibTactics.html#A">A</a></span>) := <span class="id"><a href="LibTactics.html#x">x</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_to_generalize</span></span> is a specific marker for hypotheses 
    to be generalized. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ltac_to_generalize">ltac_to_generalize</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>) (<span class="id">x</span>:<span class="id"><a href="LibTactics.html#A">A</a></span>) := <span class="id"><a href="LibTactics.html#x">x</a></span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">gen_to_generalize</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">H</span>: <span class="id"><a href="LibTactics.html#ltac_to_generalize">ltac_to_generalize</a></span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">generalize</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">mark_to_generalize</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">T</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">T</span> <span class="kwd">with</span> (<span class="id"><a href="LibTactics.html#ltac_to_generalize">ltac_to_generalize</a></span> <span class="id">T</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
<br/>
<br/>
<h2> Deconstructing terms </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">get_head</span> <span class="id">E</span></span> is a tactic that returns the head constant of the 
    term <span class="bracket"><span class="id">E</span></span>, ie, when applied to a term of the form <span class="bracket"><span class="id">P</span> <span class="id">x1</span> ... <span class="id">xN</span></span> 
    it returns <span class="bracket"><span class="id">P</span></span>. If <span class="bracket"><span class="id">E</span></span> is not an application, it returns <span class="bracket"><span class="id">E</span></span>. 
    Warning: the tactic seems to loop in some cases when the goal is 
    a product and one uses the result of this function. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">get_head</span> <span class="id">E</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">E</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)  <br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)  <br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)  <br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>) <br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)  <br/>
&nbsp;&nbsp;| ?<span class="id">P</span> <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;| ?<span class="id">P</span> =&gt; <span class="id">constr</span>:(<span class="id">P</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">get_fun_arg</span> <span class="id">E</span></span> is a tactic that decomposes an application
  term <span class="bracket"><span class="id">E</span></span>, ie, when applied to a term of the form <span class="bracket"><span class="id">X1</span> ... <span class="id">XN</span></span> 
  it returns a pair made of <span class="bracket"><span class="id">X1</span> .. <span class="id">X</span>(<span class="id">N</span>-1)</span> and <span class="bracket"><span class="id">XN</span></span>. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">get_fun_arg</span> <span class="id">E</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">E</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> ?<span class="id">X7</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span> <span class="id">X6</span>,<span class="id">X</span>))<br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X6</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span>,<span class="id">X</span>))<br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X5</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span>,<span class="id">X</span>))  <br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X4</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span>,<span class="id">X</span>))<br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X3</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span> <span class="id">X2</span>,<span class="id">X</span>)) <br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X2</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span>,<span class="id">X</span>))<br/>
&nbsp;&nbsp;| ?<span class="id">X1</span> ?<span class="id">X</span> =&gt; <span class="id">constr</span>:((<span class="id">X1</span>,<span class="id">X</span>))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<h2> Action at occurence and action not at occurence </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">ltac_action_at</span> <span class="id">K</span> <span class="id">of</span> <span class="id">E</span> <span class="tactic">do</span> <span class="id">Tac</span></span> isolates the <span class="bracket"><span class="id">K</span></span>-th occurence of <span class="bracket"><span class="id">E</span></span> in the
    goal, setting it in the form <span class="bracket"><span class="id">P</span> <span class="id">E</span></span> for some named pattern <span class="bracket"><span class="id">P</span></span>,
    then calls tactic <span class="bracket"><span class="id">Tac</span></span>, and finally unfolds <span class="bracket"><span class="id">P</span></span>. Syntax
    <span class="bracket"><span class="id">ltac_action_at</span> <span class="id">K</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">do</span> <span class="id">Tac</span></span> is also available. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">ltac_action_at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="id">of</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">do</span>" <span class="id">tactic</span>(<span class="id">Tac</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">ltac_pattern</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">P</span> <span class="id">_</span> =&gt; <span class="tactic">set</span> (<span class="id">p</span>:=<span class="id">P</span>) <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;<span class="id">Tac</span>; <span class="tactic">unfold</span> <span class="id">p</span>; <span class="tactic">clear</span> <span class="id">p</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">ltac_action_at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="id">of</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="tactic">do</span>" <span class="id">tactic</span>(<span class="id">Tac</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">ltac_pattern</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> ?<span class="id">P</span> <span class="id">_</span> =&gt; <span class="tactic">set</span> (<span class="id">p</span>:=<span class="id">P</span>) <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>;<br/>
&nbsp;&nbsp;<span class="id">Tac</span>; <span class="tactic">unfold</span> <span class="id">p</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">p</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">protects</span> <span class="id">E</span> <span class="tactic">do</span> <span class="id">Tac</span></span> temporarily assigns a name to the expression <span class="bracket"><span class="id">E</span></span> 
    so that the execution of tactic <span class="bracket"><span class="id">Tac</span></span> will not modify <span class="bracket"><span class="id">E</span></span>. This is
    useful for instance to restrict the action of <span class="bracket"><span class="tactic">simpl</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">protects</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">do</span>" <span class="id">tactic</span>(<span class="id">Tac</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *; <span class="tactic">assert</span> (<span class="id">H</span> : <span class="id">X</span> = <span class="id">E</span>) <span class="tactic">by</span> <span class="tactic">reflexivity</span>; <br/>
&nbsp;&nbsp;<span class="id">clearbody</span> <span class="id">X</span>; <span class="id">Tac</span>; <span class="tactic">subst</span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">protects</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">do</span>" <span class="id">tactic</span>(<span class="id">Tac</span>) "/" :=<br/>
&nbsp;&nbsp;<span class="id">protects</span> <span class="id">E</span> <span class="tactic">do</span> <span class="id">Tac</span>.<br/>
<br/>
<h2> An alias for <span class="bracket"><span class="id">eq</span></span> </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">eq</span>'</span> is an alias for <span class="bracket"><span class="id">eq</span></span> to be used for equalities in 
    inductive definitions, so that they don't get mixed with
    equalities generated by <span class="bracket"><span class="tactic">inversion</span></span>. </div>
<br/>
<span class="kwd">Definition</span> <span class="id">eq</span>' := @<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>. <br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id">eq</span>'.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">x</span> '='' <span class="id">y</span>" := (@<span class="id">eq</span>' <span class="id">_</span> <span class="id">x</span> <span class="id">y</span>) <br/>
&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 70).<br/>
<br/>
<br/>
<br/>
<h1> Backward and forward chaining </h1>
<br/>
<br/>
<h2> Application </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">rapply</span></span> is a tactic similar to <span class="bracket"><span class="tactic">eapply</span></span> except that it is
    based on the <span class="bracket"><span class="tactic">refine</span></span> tactics, and thus is strictly more 
    powerful (at least in theory :). In short, it is able to perform
    on-the-fly conversions when required for arguments to match,
    and it is able to instantiate existentials when required. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span>  <br/>
&nbsp;&nbsp;[ <span class="id">eexact</span> (@<span class="id">t</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span>) <br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span>) <br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;| <span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;].<br/>
<br/>
<div class="doc">The tactics <span class="bracket"><span class="id">applys_N</span> <span class="id">T</span></span>, where <span class="bracket"><span class="id">N</span></span> is a natural number,
    provides a more efficient way of using <span class="bracket"><span class="id">applys</span> <span class="id">T</span></span>. It avoids
    trying out all possible arities, by specifying explicitely
    the arity of function <span class="bracket"><span class="id">T</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_0</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_1</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_2</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_3</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_4</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_5</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_6</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_7</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_8</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_9</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rapply_10</span>" <span class="id">constr</span>(<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">refine</span> (@<span class="id">t</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">lets_base</span> <span class="id">H</span> <span class="id">E</span></span> adds an hypothesis <span class="bracket"><span class="id">H</span> : <span class="id">T</span></span> to the context, where <span class="bracket"><span class="id">T</span></span> is 
    the type of term <span class="bracket"><span class="id">E</span></span>. If <span class="bracket"><span class="id">H</span></span> is an introduction pattern, it will
    destruct <span class="bracket"><span class="id">H</span></span> according to the pattern. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">lets_base</span> <span class="id">I</span> <span class="id">E</span> := <span class="tactic">generalize</span> <span class="id">E</span>; <span class="tactic">intros</span> <span class="id">I</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">applys_to</span> <span class="id">H</span> <span class="id">E</span></span> transform the type of hypothesis <span class="bracket"><span class="id">H</span></span> by 
    replacing it by the result of the application of the term 
    <span class="bracket"><span class="id">E</span></span> to <span class="bracket"><span class="id">H</span></span>. Intuitively, it is equivalent to <span class="bracket"><span class="id">lets</span> <span class="id">H</span>: (<span class="id">E</span> <span class="id">H</span>)</span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_to</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">H</span>';<br/>
&nbsp;&nbsp;(<span class="id">first</span> [ <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">lets_base</span> <span class="id">H</span> (<span class="id">E</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') ]<br/>
&nbsp;&nbsp;); <span class="tactic">clear</span> <span class="id">H</span>'.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">constructors</span></span> calls <span class="bracket"><span class="id">constructor</span></span> or <span class="bracket"><span class="id">econstructor</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">constructors</span>" :=<br/>
&nbsp;&nbsp;<span class="id">first</span> [ <span class="id">constructor</span> | <span class="id">econstructor</span> ]; <span class="tactic">unfold</span> <span class="id">eq</span>'.<br/>
<br/>
<br/>
<h2> Assertions </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">false_goal</span></span> replaces any goal by the goal <span class="bracket"><span class="id">False</span></span>. 
    Contrary to the tactic <span class="bracket"><span class="id">false</span></span> (below), it does not try to do
    anything else </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false_goal</span>" :=<br/>
&nbsp;&nbsp;<span class="tactic">elimtype</span> <span class="id">False</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">false_post</span></span> is the underlying tactic used to prove goals
    of the form <span class="bracket"><span class="id">False</span></span>. In the default implementation, it proves
    the goal if the context contains <span class="bracket"><span class="id">False</span></span> or an hypothesis of the
    form <span class="bracket"><span class="id">C</span> <span class="id">x1</span> .. <span class="id">xN</span>  =  <span class="id">D</span> <span class="id">y1</span> .. <span class="id">yM</span></span>, or if the <span class="bracket"><span class="tactic">congruence</span></span> tactic
    finds a proof of <span class="bracket"><span class="id">x</span> &lt;&gt; <span class="id">x</span></span> for some <span class="bracket"><span class="id">x</span></span>. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">false_post</span> :=<br/>
&nbsp;&nbsp;<span class="id">solve</span> [ <span class="tactic">assumption</span> | <span class="tactic">discriminate</span> | <span class="tactic">congruence</span> ].<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">false</span></span> replaces any goal by the goal <span class="bracket"><span class="id">False</span></span>, and calls <span class="bracket"><span class="id">false_post</span></span> </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" :=<br/>
&nbsp;&nbsp;<span class="id">false_goal</span>; <span class="tactic">try</span> <span class="id">false_post</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tryfalse</span></span> tries to solve a goal by contradiction, and leaves
    the goal unchanged if it cannot solve it.
    It is equivalent to <span class="bracket"><span class="tactic">try</span> <span class="id">solve</span> \[ <span class="id">false</span> \]</span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse</span>" :=<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [ <span class="id">false</span> ].<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tryfalse</span> <span class="tactic">by</span> <span class="id">tac</span> /</span> is that same as <span class="bracket"><span class="id">tryfalse</span></span> except that
    it tries to solve the goal using tactic <span class="bracket"><span class="id">tac</span></span> if <span class="bracket"><span class="tactic">assumption</span></span>
    and <span class="bracket"><span class="tactic">discriminate</span></span> do not apply.
    It is equivalent to <span class="bracket"><span class="tactic">try</span> <span class="id">solve</span> \[ <span class="id">false</span>; <span class="id">tac</span> \]</span>. 
    Example: <span class="bracket"><span class="id">tryfalse</span> <span class="tactic">by</span> <span class="tactic">congruence</span>/</span> </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse</span>" "<span class="tactic">by</span>" <span class="id">tactic</span>(<span class="id">tac</span>) "/" :=<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [ <span class="id">false</span>; <span class="id">instantiate</span>; <span class="id">tac</span> ].<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">false</span> <span class="id">T</span></span> tries <span class="bracket"><span class="id">false</span>; <span class="tactic">apply</span> <span class="id">T</span></span>, or otherwise adds <span class="bracket"><span class="id">T</span></span> as
    an assumption and calls <span class="bracket"><span class="id">false</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" <span class="id">constr</span>(<span class="id">T</span>) "<span class="tactic">by</span>" <span class="id">tactic</span>(<span class="id">tac</span>) "/" :=<br/>
&nbsp;&nbsp;<span class="id">false_goal</span>; <span class="id">first</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id">first</span> [ <span class="tactic">apply</span> <span class="id">T</span> | <span class="tactic">eapply</span> <span class="id">T</span> | <span class="id">rapply</span> <span class="id">T</span>]; <span class="id">instantiate</span>; <span class="id">tac</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">lets_base</span> <span class="id">H</span> <span class="id">T</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">first</span> [ <span class="tactic">discriminate</span> <span class="id">H</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">false</span>; <span class="id">instantiate</span>; <span class="id">tac</span> ] ].<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">false</span> <span class="id">T</span> <span class="tactic">by</span> <span class="id">idtac</span>/.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">false_invert</span></span> proves any goal provided there is at least 
    one hypothesis <span class="bracket"><span class="id">H</span></span> in the context that can be proved absurd
    by calling <span class="bracket"><span class="tactic">inversion</span> <span class="id">H</span></span>. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">false_invert_tactic</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span> |- <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span> [ <span class="tactic">inversion</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">clear</span> <span class="id">H</span>; <span class="id">false_invert_tactic</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">fail</span> 2 ] <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false_invert</span>" :=<br/>
&nbsp;&nbsp;<span class="id">false_invert_tactic</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">tryfalse_invert</span></span> tries to prove the goal using
    <span class="bracket"><span class="id">false</span></span> or <span class="bracket"><span class="id">false_invert</span></span>, and leaves the goal
    unchanged if it does not succeed. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse_invert</span>" :=<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [ <span class="id">false</span> | <span class="id">false_invert</span> ].<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">asserts</span> <span class="id">H</span>: <span class="id">T</span></span> is another syntax for <span class="bracket"><span class="tactic">assert</span> (<span class="id">H</span> : <span class="id">T</span>)</span>, which
    also works with introduction patterns. For instance, one can write:
    <span class="bracket"><span class="id">asserts</span> \[<span class="id">x</span> <span class="id">P</span>\] (<span class="id">exists</span> <span class="id">n</span>, <span class="id">n</span> = 3)</span>, or 
    <span class="bracket"><span class="id">asserts</span> \[<span class="id">H</span>|<span class="id">H</span>\] (<span class="id">n</span> = 0 \/ <span class="id">n</span> = 1). *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">assert</span> (<span class="id">H</span> : <span class="id">T</span>); 
  [ | <span class="tactic">generalize</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">I</span> ].

(** [<span class="id">asserts</span> <span class="id">H1</span> .. <span class="id">HN</span>: <span class="id">T</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span>
    [<span class="id">asserts</span> \[<span class="id">H1</span> \[<span class="id">H2</span> \[.. <span class="id">HN</span>\]\]\]\]: <span class="id">T</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">asserts</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">asserts</span> [<span class="id">I1</span> [<span class="id">I2</span> <span class="id">I3</span>]]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I4</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">asserts</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> <span class="id">I4</span>]]]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">asserts</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> [<span class="id">I4</span> <span class="id">I5</span>]]]]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I6</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">asserts</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> [<span class="id">I4</span> [<span class="id">I5</span> <span class="id">I6</span>]]]]]: <span class="id">T</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">asserts</span>: <span class="id">T</span></span> is <span class="bracket"><span class="id">asserts</span> <span class="id">H</span>: <span class="id">T</span></span> with <span class="bracket"><span class="id">H</span></span> being chosen automatically. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">asserts</span> <span class="id">H</span> : <span class="id">T</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">cuts</span> <span class="id">H</span>: <span class="id">T</span></span> is the same as <span class="bracket"><span class="id">asserts</span> <span class="id">H</span>: <span class="id">T</span></span> except that the two subgoals
    generated are swapped: the subgoal <span class="bracket"><span class="id">T</span></span> comes second. Note that contrary
    to <span class="bracket"><span class="tactic">cut</span></span>, it introduces the hypothesis. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">T</span>); [ <span class="tactic">intros</span> <span class="id">I</span> | <span class="id">idtac</span> ].<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">cuts</span>: <span class="id">T</span></span> is <span class="bracket"><span class="id">cuts</span> <span class="id">H</span>: <span class="id">T</span></span> with <span class="bracket"><span class="id">H</span></span> being chosen automatically. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">cuts</span> <span class="id">H</span>: <span class="id">T</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">cuts</span> <span class="id">H1</span> .. <span class="id">HN</span>: <span class="id">T</span></span> is a shorthand for 
    <span class="bracket"><span class="id">cuts</span> \[<span class="id">H1</span> \[<span class="id">H2</span> \[.. <span class="id">HN</span>\]\]\]\</span>: T]. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">cuts</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">cuts</span> [<span class="id">I1</span> [<span class="id">I2</span> <span class="id">I3</span>]]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I4</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">cuts</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> <span class="id">I4</span>]]]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">cuts</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> [<span class="id">I4</span> <span class="id">I5</span>]]]]: <span class="id">T</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)<br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I6</span>) ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="id">cuts</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> [<span class="id">I4</span> [<span class="id">I5</span> <span class="id">I6</span>]]]]]: <span class="id">T</span>.<br/>
<br/>
<br/>
<h2> Instantiation and forward-chaining </h2>
<br/>
<div class="doc">The instantiation tactics are used to instantiate a lemma <span class="bracket"><span class="id">E</span></span>
    (whose type is a product) on some arguments. The type of <span class="bracket"><span class="id">E</span></span> is
    made of implications and universal quantifications, e.g.
    <span class="bracket"><span class="kwd">forall</span> <span class="id">x</span>, <span class="id">P</span> <span class="id">x</span> -&gt; <span class="kwd">forall</span> <span class="id">y</span> <span class="id">z</span>, <span class="id">Q</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id">R</span> <span class="id">z</span></span>.
    
    The first possibility is to provide arguments in order: first <span class="bracket"><span class="id">x</span></span>,
    then a proof of <span class="bracket"><span class="id">P</span> <span class="id">x</span></span>, then <span class="bracket"><span class="id">y</span></span> etc... In this mode, called "Args",
    all the arguments are to be provided. If a wildcard is provided
    (written <span class="bracket"><span class="id">__</span></span>), then an existential variable will be introduced in
    place of the argument.
    It often saves a lot of time to give only the dependent variables,
    (here <span class="bracket"><span class="id">x</span></span>, <span class="bracket"><span class="id">y</span></span> and <span class="bracket"><span class="id">z</span></span>), and have the hypotheses generated as 
    subgoals. In this "Vars" mode, only variables are to be provided. 
    For instance, lemma <span class="bracket"><span class="id">E</span></span> applied to <span class="bracket">3</span> and <span class="bracket">4</span> is a term
    of type <span class="bracket"><span class="kwd">forall</span> <span class="id">z</span>, <span class="id">Q</span> 3 4 <span class="id">z</span> -&gt; <span class="id">R</span> <span class="id">z</span></span>, and <span class="bracket"><span class="id">P</span> 3</span> is a new subgoal.
    It is possible to use wildcards to introduce existential variables.
    However, there are situations where some of the hypotheses already
    exists, and it saves time to instantiate the lemma <span class="bracket"><span class="id">E</span></span> using the 
    hypotheses. For instance, suppose <span class="bracket"><span class="id">F</span></span> is a term of type <span class="bracket"><span class="id">P</span> 2</span>. 
    Then the application of <span class="bracket"><span class="id">E</span></span> to <span class="bracket"><span class="id">F</span></span> in this "Hyps" mode is a term of type
    <span class="bracket"><span class="kwd">forall</span> <span class="id">y</span> <span class="id">z</span>, <span class="id">Q</span> 2 <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id">R</span> <span class="id">z</span></span>. Each wildcard use
    will generate an assertion instead, for instance if <span class="bracket"><span class="id">G</span></span> has type
    <span class="bracket"><span class="id">Q</span> 2 3 4</span>, then the application of <span class="bracket"><span class="id">E</span></span> to a wildcard and to <span class="bracket"><span class="id">G</span></span> 
    in mode-h is a term of type <span class="bracket"><span class="id">R</span> 4</span>, and <span class="bracket"><span class="id">P</span> 2</span> is a new subgoal.
    It is very convenient to give some arguments the lemma should be
    instantiated on, and let the tactic find out automatically where
    underscores should be insterted. Underscore arguments <span class="bracket"><span class="id">__</span></span> are
    interpret as follows: an underscore means that we want to skip the
    argument that has the same type as the next real argument provided
    (real means not an underscore). If there is no real argument after 
    underscore, then the underscore is used for the first possible argument.
   
    The general syntax is <span class="bracket"><span class="id">tactic</span> (&gt;&gt; <span class="id">E1</span> .. <span class="id">EN</span>)</span> where <span class="bracket"><span class="id">tactic</span></span> is
    the name of the tactic (possibly with some arguments) and <span class="bracket"><span class="id">Ei</span></span>
    are the arguments. Moreover, some tactics accept the syntax
    <span class="bracket"><span class="id">tactic</span> <span class="id">E1</span> .. <span class="id">EN</span></span> as short for <span class="bracket"><span class="id">tactic</span> (&gt;&gt;<span class="id">Hnts</span> <span class="id">E1</span> .. <span class="id">EN</span>)</span> for
    values of <span class="bracket"><span class="id">N</span></span> up to 5.
    Finally, if the argument <span class="bracket"><span class="id">EN</span></span> given is a triple-underscore <span class="bracket"><span class="id">___</span></span>,
    then it is equivalent to providing a list of wildcards, with
    the appropriate number of wildcards. This means that all
    the remaining arguments of the lemma will be instantiated. </div>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">app_assert</span> <span class="id">t</span> <span class="id">P</span> <span class="id">cont</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : <span class="id">P</span>); [ | <span class="id">cont</span>(<span class="id">t</span> <span class="id">H</span>); <span class="tactic">clear</span> <span class="id">H</span> ].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">app_evar</span> <span class="id">t</span> <span class="id">A</span> <span class="id">cont</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">evar</span> (<span class="id">x</span>:<span class="id">A</span>); <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span>' := <span class="id">constr</span>:(<span class="id">t</span> <span class="id">x</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span>'' := (<span class="id">eval</span> <span class="tactic">unfold</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">t</span>') <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">x</span>; <span class="id">cont</span> <span class="id">t</span>''.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">app_arg</span> <span class="id">t</span> <span class="id">P</span> <span class="id">v</span> <span class="id">cont</span> := <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : <span class="id">P</span>); [ <span class="tactic">apply</span> <span class="id">v</span> | <span class="id">cont</span>(<span class="id">t</span> <span class="id">H</span>); <span class="tactic">try</span> <span class="tactic">clear</span> <span class="id">H</span> ].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">build_app_alls</span> <span class="id">t</span> <span class="id">final</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rec</span> <span class="id">go</span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">t</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">app_assert</span> <span class="id">t</span> <span class="id">P</span> <span class="id">go</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">_</span>:?<span class="id">A</span>, <span class="id">_</span> =&gt; <span class="id">app_evar</span> <span class="id">t</span> <span class="id">A</span> <span class="id">go</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">final</span> <span class="id">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="id">go</span> <span class="id">t</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">boxerlist_next_type</span> <span class="id">vs</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">vs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span>)<br/>
&nbsp;&nbsp;| (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span>)::?<span class="id">vs</span>' =&gt; <span class="id">boxerlist_next_type</span> <span class="id">vs</span>'<br/>
&nbsp;&nbsp;| (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id"><a href="LibTactics.html#ltac_wilds">ltac_wilds</a></span>)::<span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span>)<br/>
&nbsp;&nbsp;| (@<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">T</span> <span class="id">_</span>)::<span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">T</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">build_app_hnts</span> <span class="id">t</span> <span class="id">vs</span> <span class="id">final</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rec</span> <span class="id">go</span> <span class="id">t</span> <span class="id">vs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">vs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id">first</span> [ <span class="id">final</span> <span class="id">t</span> | <span class="tactic">fail</span> 1 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id"><a href="LibTactics.html#ltac_wilds">ltac_wilds</a></span>)::<span class="id">_</span> =&gt; <span class="id">first</span> [ <span class="id">build_app_alls</span> <span class="id">t</span> <span class="id">final</span> | <span class="tactic">fail</span> 1 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">v</span>)::?<span class="id">vs</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cont</span> <span class="id">t</span>' := <span class="id">go</span> <span class="id">t</span>' <span class="id">vs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cont</span>' <span class="id">t</span>' := <span class="id">go</span> <span class="id">t</span>' <span class="id">vs</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">T</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">t</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">T</span> := <span class="id">eval</span> <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">T</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">v</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">first</span> [ <span class="kwd">let</span> <span class="id">U</span> := <span class="id">boxerlist_next_type</span> <span class="id">vs</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">U</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">first</span> [ <span class="id">app_assert</span> <span class="id">t</span> <span class="id">P</span> <span class="id">cont</span>' | <span class="tactic">fail</span> 3 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">_</span>:?<span class="id">A</span>, <span class="id">_</span> =&gt; <span class="id">first</span> [ <span class="id">app_evar</span> <span class="id">t</span> <span class="id">A</span> <span class="id">cont</span>' | <span class="tactic">fail</span> 3 ] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">U</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">first</span> [ <span class="id">app_assert</span> <span class="id">t</span> <span class="id">U</span> <span class="id">cont</span>' | <span class="tactic">fail</span> 3 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">_</span>:<span class="id">U</span>, <span class="id">_</span> =&gt; <span class="id">first</span> [ <span class="id">app_evar</span> <span class="id">t</span> <span class="id">U</span> <span class="id">cont</span>' | <span class="tactic">fail</span> 3 ] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">first</span> [ <span class="id">app_assert</span> <span class="id">t</span> <span class="id">P</span> <span class="id">cont</span> | <span class="tactic">fail</span> 3 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">_</span>:?<span class="id">A</span>, <span class="id">_</span> =&gt; <span class="id">first</span> [ <span class="id">app_evar</span> <span class="id">t</span> <span class="id">A</span> <span class="id">cont</span> | <span class="tactic">fail</span> 3 ] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">fail</span> 2 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">first</span> [ <span class="id">app_arg</span> <span class="id">t</span> <span class="id">P</span> <span class="id">v</span> <span class="id">cont</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">app_assert</span> <span class="id">t</span> <span class="id">P</span> <span class="id">cont</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">fail</span> 3 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">forall</span> <span class="id">_</span>:?<span class="id">A</span>, <span class="id">_</span> =&gt; <span class="id">first</span> [ <span class="id">cont</span>' (<span class="id">t</span> <span class="id">v</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">app_evar</span> <span class="id">t</span> <span class="id">A</span> <span class="id">cont</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">fail</span> 3 ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">go</span> <span class="id">t</span> <span class="id">vs</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">build_app</span> <span class="id">args</span> <span class="id">final</span> := <br/>
&nbsp;&nbsp;<span class="id">first</span> [ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">args</span> <span class="kwd">with</span> (@<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">T</span> ?<span class="id">t</span>)::?<span class="id">vs</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="id">constr</span>:(<span class="id">t</span>:<span class="id">T</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">build_app_hnts</span> <span class="id">t</span> <span class="id">vs</span> <span class="id">final</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="tactic">fail</span> 1 "<span class="kwd">Instantiation</span> <span class="id">fails</span> <span class="kwd">for</span>:" <span class="id">args</span>].<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">unfold_head_until_product</span> <span class="id">T</span> :=<br/>
&nbsp;&nbsp;<span class="id">eval</span> <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">T</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">args_unfold_head_if_not_product</span> <span class="id">args</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">args</span> <span class="kwd">with</span> (@<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">T</span> ?<span class="id">t</span>)::?<span class="id">vs</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">T</span>' := <span class="id">unfold_head_until_product</span> <span class="id">T</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constr</span>:((@<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">T</span>' <span class="id">t</span>)::<span class="id">vs</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>. <br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">args_unfold_head_if_not_product_but_params</span> <span class="id">args</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">args</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;| (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">t</span>)::(<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">v</span>)::?<span class="id">vs</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">args_unfold_head_if_not_product</span> <span class="id">args</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">args</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">lets</span> <span class="id">H</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span>)</span> will instantiate lemma <span class="bracket"><span class="id">E0</span></span>
    on the arguments <span class="bracket"><span class="id">Ei</span></span> (which may be wildcards <span class="bracket"><span class="id">__</span></span>),
    and name <span class="bracket"><span class="id">H</span></span> the resulting term. <span class="bracket"><span class="id">H</span></span> may be an introduction
    pattern, or a sequence of introduction patterns <span class="bracket"><span class="id">I1</span> <span class="id">I2</span> <span class="id">IN</span></span>,
    or empty. 
    Syntax <span class="bracket"><span class="id">lets</span> <span class="id">H</span>: <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span></span> is also available. If the last
    argument <span class="bracket"><span class="id">EN</span></span> is <span class="bracket"><span class="id">___</span></span> (triple-underscore), then all
    arguments of <span class="bracket"><span class="id">H</span></span> will be instantiated. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">lets_build</span> <span class="id">I</span> <span class="id">Ei</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">args_unfold_head_if_not_product_but_params</span> <span class="id">args</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">R</span> =&gt; <span class="id">lets_base</span> <span class="id">I</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets_build</span> <span class="id">I</span> <span class="id">E</span>; <span class="id">fast_rm_inside</span> <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">lets</span> <span class="id">H</span>: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I3</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> [<span class="id">I2</span> <span class="id">I3</span>]]: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> <span class="id">I4</span>]]]: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>) <br/>
&nbsp;":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> [<span class="id">I4</span> <span class="id">I5</span>]]]]: <span class="id">E</span>.<br/>
&nbsp;<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E0</span> <span class="id">A1</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>.<br/>
<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">forwards</span> <span class="id">H</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span>)</span> is short for 
    <span class="bracket"><span class="id">forwards</span> <span class="id">H</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span> <span class="id">___</span>)</span>. 
    The arguments <span class="bracket"><span class="id">Ei</span></span> can be wildcards <span class="bracket"><span class="id">__</span></span> (except <span class="bracket"><span class="id">E0</span></span>).
    <span class="bracket"><span class="id">H</span></span> may be an introduction pattern, or a sequence of
    introduction pattern, or empty. 
    Syntax <span class="bracket"><span class="id">forwards</span> <span class="id">H</span>: <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span></span> is also available. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">forwards_build_app_arg</span> <span class="id">Ei</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> (<span class="id">args</span> ++ ((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">___</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">args_unfold_head_if_not_product</span> <span class="id">args</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">args</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">forwards_then</span> <span class="id">Ei</span> <span class="id">cont</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">forwards_build_app_arg</span> <span class="id">Ei</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">args_unfold_head_if_not_product_but_params</span> <span class="id">args</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">cont</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">Ei</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">forwards_build_app_arg</span> <span class="id">Ei</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">I</span>: <span class="id">args</span>. <br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) :=  <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">forwards</span> <span class="id">H</span>: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> [<span class="id">I1</span> <span class="id">I2</span>]: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I3</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> [<span class="id">I1</span> [<span class="id">I2</span> <span class="id">I3</span>]]: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> <span class="id">I4</span>]]]: <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <br/>
&nbsp;<span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>) <br/>
&nbsp;":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> [<span class="id">I1</span> [<span class="id">I2</span> [<span class="id">I3</span> [<span class="id">I4</span> <span class="id">I5</span>]]]]: <span class="id">E</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) <br/>
&nbsp;<span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">forwards</span> <span class="id">I</span>: (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards_nounfold</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">Ei</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> (<span class="id">args</span> ++ ((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">___</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">R</span> =&gt; <span class="id">lets_base</span> <span class="id">I</span> <span class="id">R</span>);<br/>
&nbsp;&nbsp;<span class="id">fast_rm_inside</span> <span class="id">Ei</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">forwards_nounfold_then</span> <span class="id">Ei</span> <span class="id">cont</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> (<span class="id">args</span> ++ ((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">___</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">cont</span>;<br/>
&nbsp;&nbsp;<span class="id">fast_rm_inside</span> <span class="id">Ei</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">applys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span>)</span> instantiates lemma <span class="bracket"><span class="id">E0</span></span>
    on the arguments <span class="bracket"><span class="id">Ei</span></span> (which may be wildcards <span class="bracket"><span class="id">__</span></span>),
    and apply the resulting term to the current goal,
    using the tactic <span class="bracket"><span class="id">applys</span></span> defined earlier on.
    <span class="bracket"><span class="id">applys</span> <span class="id">E0</span> <span class="id">E1</span> <span class="id">E2</span> .. <span class="id">EN</span></span> is also available. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">applys_build</span> <span class="id">Ei</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">args_unfold_head_if_not_product_but_params</span> <span class="id">args</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">R</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">first</span> [ <span class="tactic">apply</span> <span class="id">R</span> | <span class="tactic">eapply</span> <span class="id">R</span> | <span class="id">rapply</span> <span class="id">R</span> ]).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">applys_base</span> <span class="id">E</span> := <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span> =&gt; <span class="id">applys_build</span> <span class="id">E</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">first</span> [ <span class="id">rapply</span> <span class="id">E</span> | <span class="id">applys_build</span> <span class="id">E</span> ]<br/>
&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">fast_rm_inside</span> <span class="id">E</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">applys_base</span> <span class="id">E</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">applys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">applys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">applys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">applys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">applys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">fapplys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">E1</span> .. <span class="id">EN</span>)</span> instantiates lemma <span class="bracket"><span class="id">E0</span></span>
    on the arguments <span class="bracket"><span class="id">Ei</span></span> and on the argument <span class="bracket"><span class="id">___</span></span> meaning
    that all evars should be explicitly instantiated,
    and apply the resulting term to the current goal.
    <span class="bracket"><span class="id">fapplys</span> <span class="id">E0</span> <span class="id">E1</span> <span class="id">E2</span> .. <span class="id">EN</span></span> is also available. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">fapplys_build</span> <span class="id">Ei</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> (<span class="id">args</span> ++ ((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">___</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">args_unfold_head_if_not_product_but_params</span> <span class="id">args</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">R</span> =&gt; <span class="tactic">apply</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapplys</span>" <span class="id">constr</span>(<span class="id">E0</span>) :=  <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E0</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span> =&gt; <span class="id">fapplys_build</span> <span class="id">E0</span> <br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">fapplys_build</span> (&gt;&gt; <span class="id">E0</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapplys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=<br/>
&nbsp;&nbsp;<span class="id">fapplys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapplys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">fapplys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapplys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">fapplys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapplys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">fapplys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapplys</span>" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">fapplys</span> (&gt;&gt; <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">specializes</span> <span class="id">H</span> (&gt;&gt; <span class="id">E1</span> <span class="id">E2</span> .. <span class="id">EN</span>)</span> will instantiate hypothesis <span class="bracket"><span class="id">H</span></span>
    on the arguments <span class="bracket"><span class="id">Ei</span></span> (which may be wildcards <span class="bracket"><span class="id">__</span></span>). If the last
    argument <span class="bracket"><span class="id">EN</span></span> is <span class="bracket"><span class="id">___</span></span> (triple-underscore), then all arguments of 
    <span class="bracket"><span class="id">H</span></span> get instantiated. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">specializes_build</span> <span class="id">H</span> <span class="id">Ei</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">H</span>';<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">list_boxer_of</span> <span class="id">Ei</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">constr</span>:((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">H</span>')::<span class="id">args</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span> := <span class="id">args_unfold_head_if_not_product</span> <span class="id">args</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">build_app</span> <span class="id">args</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">R</span> =&gt; <span class="id">lets</span> <span class="id">H</span>: <span class="id">R</span>);<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>'.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">specializes_base</span> <span class="id">H</span> <span class="id">Ei</span> :=<br/>
&nbsp;&nbsp;<span class="id">specializes_build</span> <span class="id">H</span> <span class="id">Ei</span>; <span class="id">fast_rm_inside</span> <span class="id">Ei</span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id">specializes_base</span> <span class="id">H</span> (<span class="id">___</span>).  <br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id">specializes_base</span> <span class="id">H</span> <span class="id">A</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=<br/>
&nbsp;&nbsp;<span class="id">specializes</span> <span class="id">H</span> (&gt;&gt; <span class="id">A1</span> <span class="id">A2</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=<br/>
&nbsp;&nbsp;<span class="id">specializes</span> <span class="id">H</span> (&gt;&gt; <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=<br/>
&nbsp;&nbsp;<span class="id">specializes</span> <span class="id">H</span> (&gt;&gt; <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=<br/>
&nbsp;&nbsp;<span class="id">specializes</span> <span class="id">H</span> (&gt;&gt; <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>).<br/>
<br/>
<br/>
<h2> Experimental tactics for application </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">fapply</span></span> is a version of <span class="bracket"><span class="tactic">apply</span></span> based on <span class="bracket"><span class="id">forwards</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapply</span>" <span class="id">constr</span>(<span class="id">E</span>) := <br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">forwards</span> <span class="id">H</span>: <span class="id">E</span>; <br/>
&nbsp;&nbsp;<span class="id">first</span> [ <span class="tactic">apply</span> <span class="id">H</span> | <span class="tactic">eapply</span> <span class="id">H</span> | <span class="id">rapply</span> <span class="id">H</span> | <span class="id">hnf</span>; <span class="tactic">apply</span> <span class="id">H</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">hnf</span>; <span class="tactic">eapply</span> <span class="id">H</span> | <span class="id">applys</span> <span class="id">H</span> ].<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">sapply</span></span> stands for "super apply". It tries
    <span class="bracket"><span class="tactic">apply</span></span>, <span class="bracket"><span class="tactic">eapply</span></span>, <span class="bracket"><span class="id">applys</span></span> and <span class="bracket"><span class="id">fapply</span></span>,
    and also tries to head-normalize the goal first. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sapply</span>" <span class="id">constr</span>(<span class="id">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span> [ <span class="tactic">apply</span> <span class="id">H</span> | <span class="tactic">eapply</span> <span class="id">H</span> | <span class="id">rapply</span> <span class="id">H</span> | <span class="id">applys</span> <span class="id">H</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">hnf</span>; <span class="tactic">apply</span> <span class="id">H</span> | <span class="id">hnf</span>; <span class="tactic">eapply</span> <span class="id">H</span> | <span class="id">hnf</span>; <span class="id">applys</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">fapply</span> <span class="id">H</span> ]. <br/>
<br/>
<h2> Adding assumptions </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">lets_simpl</span> <span class="id">H</span>: <span class="id">E</span></span> is the same as <span class="bracket"><span class="id">lets</span> <span class="id">H</span>: <span class="id">E</span></span> excepts that it
    calls <span class="bracket"><span class="tactic">simpl</span></span> on the hypothesis H. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets_simpl</span>" <span class="id">ident</span>(<span class="id">H</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">H</span>: <span class="id">E</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">lets_hnf</span> <span class="id">H</span>: <span class="id">E</span></span> is the same as <span class="bracket"><span class="id">lets</span> <span class="id">H</span>: <span class="id">E</span></span> excepts that it
    calls <span class="bracket"><span class="id">hnf</span></span> to set the definition in head normal form. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets_hnf</span>" <span class="id">ident</span>(<span class="id">H</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">lets</span> <span class="id">H</span>: <span class="id">E</span>; <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">lets_simpl</span>: <span class="id">E</span></span> is the same as <span class="bracket"><span class="id">lets_simpl</span> <span class="id">H</span>: <span class="id">E</span></span> with 
   the name <span class="bracket"><span class="id">H</span></span> being choosed automatically. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets_simpl</span>" ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">lets_simpl</span> <span class="id">H</span>: <span class="id">T</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">lets_hnf</span>: <span class="id">E</span></span> is the same as <span class="bracket"><span class="id">lets_hnf</span> <span class="id">H</span>: <span class="id">E</span></span> with 
   the name <span class="bracket"><span class="id">H</span></span> being choosed automatically. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets_hnf</span>" ":" <span class="id">constr</span>(<span class="id">T</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">lets_hnf</span> <span class="id">H</span>: <span class="id">T</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">put</span> <span class="id">X</span>: <span class="id">E</span></span> is a synonymous for <span class="bracket"><span class="id">pose</span> (<span class="id">X</span> := <span class="id">E</span>)</span>.
    Other syntaxes are <span class="bracket"><span class="id">put</span>: <span class="id">E</span></span>. </div>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">put</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">X</span> := <span class="id">E</span>).<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">put</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">pose</span> (<span class="id">X</span> := <span class="id">E</span>).<br/>
<br/>
<br/>
<h2> Application of tautologies </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">logic</span> <span class="id">E</span></span>, where <span class="bracket"><span class="id">E</span></span> is a fact, is equivalent to 
    <span class="bracket"><span class="tactic">assert</span> <span class="id">H</span>:<span class="id">E</span>; [<span class="tactic">tauto</span> | <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>]. <span class="id">It</span> <span class="id">is</span> <span class="id">useful</span> <span class="kwd">for</span> <span class="id">instance</span>
    <span class="id">to</span> <span class="id">prove</span> <span class="id">a</span> <span class="id">conjunction</span> [<span class="id">A</span> /\ <span class="id">B</span>] <span class="tactic">by</span> <span class="id">showing</span> <span class="id">first</span> [<span class="id">A</span>] <span class="id">and</span> <span class="kwd">then</span> [<span class="id">A</span> -&gt; <span class="id">B</span>],
    <span class="id">through</span> <span class="id">the</span> <span class="id">command</span> [<span class="id">logic</span> (<span class="id">foral</span> <span class="id">A</span> <span class="id">B</span>, <span class="id">A</span> -&gt; (<span class="id">A</span> -&gt; <span class="id">B</span>) -&gt; <span class="id">A</span> /\ <span class="id">B</span>)] *)

<span class="kwd">Ltac</span> <span class="id">logic_base</span> <span class="id">E</span> <span class="id">cont</span> :=
  <span class="tactic">assert</span> (<span class="id">H</span>:<span class="id">E</span>); [ <span class="id">cont</span> <span class="id">tt</span> | <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">logic</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">logic_base</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="tactic">tauto</span>).


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Application</span> <span class="id">modulo</span> <span class="id">equalities</span> *)

(** <span class="id">The</span> <span class="id">tactic</span> [<span class="id">equates</span>] <span class="id">replaces</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span>
    [<span class="id">P</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>] <span class="kwd">with</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">P</span> <span class="id">x</span> ?<span class="id">a</span> <span class="id">z</span>] <span class="id">and</span> <span class="id">a</span>
    <span class="kwd">subgoal</span> [?<span class="id">a</span> = <span class="id">y</span>]. <span class="id">The</span> <span class="id">introduction</span> <span class="id">of</span> <span class="id">the</span> <span class="id">evar</span> [?<span class="id">a</span>] <span class="id">makes</span>
    <span class="id">it</span> <span class="id">possible</span> <span class="id">to</span> <span class="tactic">apply</span> <span class="id">lemmas</span> <span class="id">that</span> <span class="id">would</span> <span class="id">not</span> <span class="tactic">apply</span> <span class="id">to</span> <span class="id">the</span>
    <span class="id">original</span> <span class="id">goal</span>, <span class="kwd">for</span> <span class="id">example</span> <span class="id">a</span> <span class="id">lemma</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> 
    [<span class="kwd">forall</span> <span class="id">n</span> <span class="id">m</span>, <span class="id">P</span> <span class="id">n</span> <span class="id">n</span> <span class="id">m</span>], <span class="id">because</span> [<span class="id">x</span>] <span class="id">and</span> [<span class="id">y</span>] <span class="id">might</span> <span class="id">be</span> <span class="id">equal</span>
    <span class="id">but</span> <span class="id">not</span> <span class="id">convertible</span>.
    
    <span class="id">Usage</span> <span class="id">is</span> [<span class="id">equates</span> <span class="id">i1</span> ... <span class="id">ik</span>], <span class="kwd">where</span> <span class="id">the</span> <span class="id">indices</span> <span class="id">are</span> <span class="id">the</span>
    <span class="id">positions</span> <span class="id">of</span> <span class="id">the</span> <span class="id">arguments</span> <span class="id">to</span> <span class="id">be</span> <span class="id">replaced</span> <span class="tactic">by</span> <span class="id">evars</span>, 
    <span class="id">counting</span> <span class="id">from</span> <span class="id">the</span> <span class="id">right</span>-<span class="id">hand</span> <span class="id">side</span>. <span class="id">If</span> [0] <span class="id">is</span> <span class="id">given</span> <span class="kwd">as</span>
    <span class="id">argument</span>, <span class="kwd">then</span> <span class="id">the</span> <span class="id">entire</span> <span class="id">goal</span> <span class="id">is</span> <span class="id">replaced</span> <span class="tactic">by</span> <span class="id">an</span> <span class="id">evar</span>. *)

<span class="kwd">Section</span> <span class="id"><a name="equatesLemma">equatesLemma</a></span>.
<span class="kwd">Variables</span> 
  (<span class="id"><a name="equatesLemma.A0">A0</a></span> <span class="id"><a name="equatesLemma.A1">A1</a></span> : <span class="kwd">Type</span>)
  (<span class="id"><a name="equatesLemma.A2">A2</a></span> : <span class="kwd">forall</span> (<span class="id">x1</span> : <span class="id"><a href="LibTactics.html#A1">A1</a></span>), <span class="kwd">Type</span>) 
  (<span class="id"><a name="equatesLemma.A3">A3</a></span> : <span class="kwd">forall</span> (<span class="id">x1</span> : <span class="id"><a href="LibTactics.html#A1">A1</a></span>) (<span class="id">x2</span> : <span class="id"><a href="LibTactics.html#A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>), <span class="kwd">Type</span>)
  (<span class="id"><a name="equatesLemma.A4">A4</a></span> : <span class="kwd">forall</span> (<span class="id">x1</span> : <span class="id"><a href="LibTactics.html#A1">A1</a></span>) (<span class="id">x2</span> : <span class="id"><a href="LibTactics.html#A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>) (<span class="id">x3</span> : <span class="id"><a href="LibTactics.html#A3">A3</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>), <span class="kwd">Type</span>)
  (<span class="id"><a name="equatesLemma.A5">A5</a></span> : <span class="kwd">forall</span> (<span class="id">x1</span> : <span class="id"><a href="LibTactics.html#A1">A1</a></span>) (<span class="id">x2</span> : <span class="id"><a href="LibTactics.html#A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>) (<span class="id">x3</span> : <span class="id"><a href="LibTactics.html#A3">A3</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>) (<span class="id">x4</span> : <span class="id"><a href="LibTactics.html#A4">A4</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span>), <span class="kwd">Type</span>)
  (<span class="id"><a name="equatesLemma.A6">A6</a></span> : <span class="kwd">forall</span> (<span class="id">x1</span> : <span class="id"><a href="LibTactics.html#A1">A1</a></span>) (<span class="id">x2</span> : <span class="id"><a href="LibTactics.html#A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>) (<span class="id">x3</span> : <span class="id"><a href="LibTactics.html#A3">A3</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>) (<span class="id">x4</span> : <span class="id"><a href="LibTactics.html#A4">A4</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span>) (<span class="id">x5</span> : <span class="id"><a href="LibTactics.html#A5">A5</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span>), <span class="kwd">Type</span>).

<span class="kwd">Lemma</span> <span class="id"><a name="equates_0">equates_0</a></span> : <span class="kwd">forall</span> (<span class="id">P</span> <span class="id">Q</span>:<span class="kwd">Prop</span>),
  <span class="id"><a href="LibTactics.html#P">P</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> = <span class="id"><a href="LibTactics.html#Q">Q</a></span> -&gt; <span class="id"><a href="LibTactics.html#Q">Q</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="equates_1">equates_1</a></span> : 
  <span class="kwd">forall</span> (<span class="id">P</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A0">A0</a></span>-&gt;<span class="kwd">Prop</span>) <span class="id">x1</span> <span class="id">y1</span>,
  <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#x1">x1</a></span> = <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="equates_2">equates_2</a></span> : 
  <span class="kwd">forall</span> <span class="id">y1</span> (<span class="id">P</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A0">A0</a></span>-&gt;<span class="kwd">forall</span>(<span class="id">x1</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A1">A1</a></span>),<span class="kwd">Prop</span>) <span class="id">x1</span> <span class="id">x2</span>,
  <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#y1">y1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> -&gt; <span class="id"><a href="LibTactics.html#x1">x1</a></span> = <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="equates_3">equates_3</a></span> : 
  <span class="kwd">forall</span> <span class="id">y1</span> (<span class="id">P</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A0">A0</a></span>-&gt;<span class="kwd">forall</span>(<span class="id">x1</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A1">A1</a></span>)(<span class="id">x2</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>),<span class="kwd">Prop</span>) <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>,
  <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#y1">y1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> -&gt; <span class="id"><a href="LibTactics.html#x1">x1</a></span> = <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="equates_4">equates_4</a></span> :
  <span class="kwd">forall</span> <span class="id">y1</span> (<span class="id">P</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A0">A0</a></span>-&gt;<span class="kwd">forall</span>(<span class="id">x1</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A1">A1</a></span>)(<span class="id">x2</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>)(<span class="id">x3</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A3">A3</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>),<span class="kwd">Prop</span>) <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span>,
  <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#y1">y1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span> -&gt; <span class="id"><a href="LibTactics.html#x1">x1</a></span> = <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="equates_5">equates_5</a></span> :
  <span class="kwd">forall</span> <span class="id">y1</span> (<span class="id">P</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A0">A0</a></span>-&gt;<span class="kwd">forall</span>(<span class="id">x1</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A1">A1</a></span>)(<span class="id">x2</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>)(<span class="id">x3</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A3">A3</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>)(<span class="id">x4</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A4">A4</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span>),<span class="kwd">Prop</span>) <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span>,
  <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#y1">y1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span> <span class="id"><a href="LibTactics.html#x5">x5</a></span> -&gt; <span class="id"><a href="LibTactics.html#x1">x1</a></span> = <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span> <span class="id"><a href="LibTactics.html#x5">x5</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="equates_6">equates_6</a></span> :
  <span class="kwd">forall</span> <span class="id">y1</span> (<span class="id">P</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A0">A0</a></span>-&gt;<span class="kwd">forall</span>(<span class="id">x1</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A1">A1</a></span>)(<span class="id">x2</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A2">A2</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span>)(<span class="id">x3</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A3">A3</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span>)(<span class="id">x4</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A4">A4</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span>)(<span class="id">x5</span>:<span class="id"><a href="LibTactics.html#equatesLemma.A5">A5</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span>),<span class="kwd">Prop</span>) 
  <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span>,
  <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#y1">y1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span> <span class="id"><a href="LibTactics.html#x5">x5</a></span> <span class="id"><a href="LibTactics.html#x6">x6</a></span> -&gt; <span class="id"><a href="LibTactics.html#x1">x1</a></span> = <span class="id"><a href="LibTactics.html#y1">y1</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span> <span class="id"><a href="LibTactics.html#x1">x1</a></span> <span class="id"><a href="LibTactics.html#x2">x2</a></span> <span class="id"><a href="LibTactics.html#x3">x3</a></span> <span class="id"><a href="LibTactics.html#x4">x4</a></span> <span class="id"><a href="LibTactics.html#x5">x5</a></span> <span class="id"><a href="LibTactics.html#x6">x6</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">End</span> <span class="id"><a href="LibTactics.html#equatesLemma">equatesLemma</a></span>.

<span class="kwd">Ltac</span> <span class="id">equates_lemma</span> <span class="id">n</span> :=
  <span class="kwd">match</span> <span class="id">nat_from_number</span> <span class="id">n</span> <span class="kwd">with</span>
  | 0 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_0">equates_0</a></span>)
  | 1 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_1">equates_1</a></span>)
  | 2 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_2">equates_2</a></span>)
  | 3 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_3">equates_3</a></span>)
  | 4 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_4">equates_4</a></span>)
  | 5 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_5">equates_5</a></span>)
  | 6 =&gt; <span class="id">constr</span>:(<span class="id"><a href="LibTactics.html#equates_6">equates_6</a></span>)
  <span class="kwd">end</span>.  

<span class="kwd">Ltac</span> <span class="id">equates_one</span> <span class="id">n</span> :=
  <span class="kwd">let</span> <span class="id">L</span> := <span class="id">equates_lemma</span> <span class="id">n</span> <span class="kwd">in</span>
  <span class="tactic">eapply</span> <span class="id">L</span>.

<span class="kwd">Ltac</span> <span class="id">equates_several</span> <span class="id">E</span> <span class="id">cont</span> :=
  <span class="kwd">let</span> <span class="id">all_pos</span> := <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span> 
    | <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list">List.list</a></span> <span class="id"><a href="LibTactics.html#Boxer">Boxer</a></span> =&gt; <span class="id">constr</span>:(<span class="id">E</span>)
    | <span class="id">_</span> =&gt; <span class="id">constr</span>:((<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> <span class="id">E</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)
    <span class="kwd">end</span> <span class="kwd">in</span>
  <span class="kwd">let</span> <span class="id">rec</span> <span class="id">go</span> <span class="id">pos</span> :=
     <span class="kwd">match</span> <span class="id">pos</span> <span class="kwd">with</span>
     | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id">cont</span> <span class="id">tt</span>
     | (<span class="id"><a href="LibTactics.html#boxer">boxer</a></span> ?<span class="id">n</span>)::?<span class="id">pos</span>' =&gt; <span class="id">equates_one</span> <span class="id">n</span>; [ <span class="id">instantiate</span>; <span class="id">go</span> <span class="id">pos</span>' | ]
     <span class="kwd">end</span> <span class="kwd">in</span>
  <span class="id">go</span> <span class="id">all_pos</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">equates_several</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">idtac</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) :=
  <span class="id">equates</span> (&gt;&gt; <span class="id">n1</span> <span class="id">n2</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) :=
  <span class="id">equates</span> (&gt;&gt; <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) <span class="id">constr</span>(<span class="id">n4</span>) :=
  <span class="id">equates</span> (&gt;&gt; <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">n4</span>).

(** [<span class="id">applys_eq</span> <span class="id">H</span> <span class="id">i1</span> .. <span class="id">iK</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span>
    [<span class="id">equates</span> <span class="id">i1</span> .. <span class="id">iK</span>] <span class="id">followed</span> <span class="tactic">by</span> [<span class="tactic">apply</span> <span class="id">H</span>]
    <span class="id">on</span> <span class="id">the</span> <span class="id">first</span> <span class="kwd">subgoal</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">equates_several</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">sapply</span> <span class="id">H</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> (&gt;&gt; <span class="id">n1</span> <span class="id">n2</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> (&gt;&gt; <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) <span class="id">constr</span>(<span class="id">n4</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> (&gt;&gt; <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">n4</span>).


(* ********************************************************************** *)
(** * <span class="id">Introduction</span> <span class="id">and</span> <span class="id">generalization</span> *)

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Introduction</span> *)

(** [<span class="id">introv</span>] <span class="id">is</span> <span class="id">used</span> <span class="id">to</span> <span class="id">name</span> <span class="id">only</span> <span class="id">non</span>-<span class="tactic">dependent</span> <span class="id">hypothesis</span>.
 - <span class="id">If</span> [<span class="id">introv</span>] <span class="id">is</span> <span class="id">called</span> <span class="id">on</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">H</span>],
   <span class="id">it</span> <span class="id">should</span> <span class="id">introduce</span> <span class="id">all</span> <span class="id">the</span> <span class="id">variables</span> <span class="id">quantified</span> <span class="kwd">with</span> <span class="id">a</span>
   [<span class="kwd">forall</span>] <span class="tactic">at</span> <span class="id">the</span> <span class="id">head</span> <span class="id">of</span> <span class="id">the</span> <span class="id">goal</span>, <span class="id">but</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="id">introduce</span>
   <span class="id">hypotheses</span> <span class="id">that</span> <span class="id">preceed</span> <span class="id">an</span> <span class="id">arrow</span> <span class="id">constructor</span>, <span class="id">like</span> <span class="kwd">in</span> [<span class="id">P</span> -&gt; <span class="id">Q</span>]. 
 - <span class="id">If</span> [<span class="id">introv</span>] <span class="id">is</span> <span class="id">called</span> <span class="id">on</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">that</span> <span class="id">is</span> <span class="id">not</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span>
   [<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">H</span>] <span class="id">nor</span> [<span class="id">P</span> -&gt; <span class="id">Q</span>], <span class="id">the</span> <span class="id">tactic</span> <span class="id">unfolds</span> <span class="id">definitions</span>
   <span class="id">until</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">takes</span> <span class="id">the</span> <span class="id">form</span> [<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">H</span>] <span class="id">or</span> [<span class="id">P</span> -&gt; <span class="id">Q</span>].
   <span class="id">If</span> <span class="id">unfolding</span> <span class="id">definitions</span> <span class="id">does</span> <span class="id">not</span> <span class="id">produces</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">this</span> <span class="id">form</span>,
   <span class="kwd">then</span> <span class="id">the</span> <span class="id">tactic</span> [<span class="id">introv</span>] <span class="id">does</span> <span class="id">nothing</span> <span class="tactic">at</span> <span class="id">all</span>. *)
   
(* [<span class="id">introv_rec</span>] <span class="id">introduces</span> <span class="id">all</span> <span class="id">visible</span> <span class="id">variables</span>.
   <span class="id">It</span> <span class="id">does</span> <span class="id">not</span> <span class="tactic">try</span> <span class="id">to</span> <span class="tactic">unfold</span> <span class="id">any</span> <span class="id">definition</span>. *)

<span class="kwd">Ltac</span> <span class="id">introv_rec</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">idtac</span>
  | |- <span class="kwd">forall</span> <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="tactic">intro</span>; <span class="id">introv_rec</span>
  | |- <span class="id">_</span> =&gt; <span class="id">idtac</span>
  <span class="kwd">end</span>.

(* [<span class="id">introv_noarg</span>] <span class="id">forces</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">to</span> <span class="id">be</span> <span class="id">a</span> [<span class="kwd">forall</span>] <span class="id">or</span> <span class="id">an</span> [-&gt;],
   <span class="id">and</span> <span class="kwd">then</span> <span class="id">calls</span> [<span class="id">introv_rec</span>] <span class="id">to</span> <span class="id">introduces</span> <span class="id">variables</span>
   (<span class="id">possibly</span> <span class="id">none</span>, <span class="kwd">in</span> <span class="id">which</span> <span class="tactic">case</span> [<span class="id">introv</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">hnf</span>]).
   <span class="id">If</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">is</span> <span class="id">not</span> <span class="id">a</span> <span class="id">product</span>, <span class="kwd">then</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="tactic">do</span> <span class="id">anything</span>. *)

<span class="kwd">Ltac</span> <span class="id">introv_noarg</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">idtac</span>
  | |- <span class="kwd">forall</span> <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">introv_rec</span>
  | |- ?<span class="id">G</span> =&gt; <span class="id">hnf</span>;
     <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
     | |- ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="id">idtac</span>
     | |- <span class="kwd">forall</span> <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id">introv_rec</span>
     <span class="kwd">end</span>
  | |- <span class="id">_</span> =&gt; <span class="id">idtac</span>
  <span class="kwd">end</span>.

  (* <span class="id">simpler</span> <span class="id">yet</span> <span class="id">perhaps</span> <span class="id">less</span> <span class="id">efficient</span> <span class="id">imlementation</span> *)
  <span class="kwd">Ltac</span> <span class="id">introv_noarg_not_optimized</span> :=
    <span class="tactic">intro</span>; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:<span class="id">_</span>|-<span class="id">_</span> =&gt; <span class="id">revert</span> <span class="id">H</span> <span class="kwd">end</span>; <span class="id">introv_rec</span>.

(* [<span class="id">introv_arg</span> <span class="id">H</span>] <span class="id">introduces</span> <span class="id">one</span> <span class="id">non</span>-<span class="tactic">dependent</span> <span class="id">hypothesis</span> 
   <span class="id">under</span> <span class="id">the</span> <span class="id">name</span> [<span class="id">H</span>], <span class="id">after</span> <span class="id">introducing</span> <span class="id">the</span> <span class="id">variables</span>
   <span class="id">quantified</span> <span class="kwd">with</span> <span class="id">a</span> [<span class="kwd">forall</span>] <span class="id">that</span> <span class="id">preceeds</span> <span class="id">this</span> <span class="id">hypothesis</span>. 
   <span class="id">This</span> <span class="id">tactic</span> <span class="id">fails</span> <span class="kwd">if</span> <span class="id">there</span> <span class="id">does</span> <span class="id">not</span> <span class="id">exist</span> <span class="id">a</span> <span class="id">hypothesis</span>
   <span class="id">to</span> <span class="id">be</span> <span class="id">introduced</span>. *)

<span class="kwd">Ltac</span> <span class="id">introv_arg</span> <span class="id">H</span> :=
  <span class="id">hnf</span>; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- ?<span class="id">P</span> -&gt; ?<span class="id">Q</span> =&gt; <span class="tactic">intros</span> <span class="id">H</span>
  | |- <span class="kwd">forall</span> <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="tactic">intro</span>; <span class="id">introv_arg</span> <span class="id">H</span>
  <span class="kwd">end</span>.

(* [<span class="id">introv</span> <span class="id">I1</span> .. <span class="id">IN</span>] <span class="id">iterates</span> [<span class="id">introv</span> <span class="id">Ik</span>] *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" :=
  <span class="id">introv_noarg</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) :=
  <span class="id">introv_arg</span> <span class="id">I1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I6</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I6</span>) <span class="id">simple_intropattern</span>(<span class="id">I7</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span> <span class="id">I7</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I6</span>) <span class="id">simple_intropattern</span>(<span class="id">I7</span>) <span class="id">simple_intropattern</span>(<span class="id">I8</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span> <span class="id">I7</span> <span class="id">I8</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I6</span>) <span class="id">simple_intropattern</span>(<span class="id">I7</span>) <span class="id">simple_intropattern</span>(<span class="id">I8</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I9</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span> <span class="id">I7</span> <span class="id">I8</span> <span class="id">I9</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">introv</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) <span class="id">simple_intropattern</span>(<span class="id">I2</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) <span class="id">simple_intropattern</span>(<span class="id">I5</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I6</span>) <span class="id">simple_intropattern</span>(<span class="id">I7</span>) <span class="id">simple_intropattern</span>(<span class="id">I8</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I9</span>) <span class="id">simple_intropattern</span>(<span class="id">I10</span>) :=
  <span class="id">introv</span> <span class="id">I1</span>; <span class="id">introv</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span> <span class="id">I7</span> <span class="id">I8</span> <span class="id">I9</span> <span class="id">I10</span>.

(** [<span class="id">intros_all</span>] <span class="id">repeats</span> [<span class="tactic">intro</span>] <span class="kwd">as</span> <span class="id">long</span> <span class="kwd">as</span> <span class="id">possible</span>. <span class="id">Contrary</span> <span class="id">to</span> [<span class="tactic">intros</span>],
    <span class="id">it</span> <span class="id">unfolds</span> <span class="id">any</span> <span class="id">definition</span> <span class="id">on</span> <span class="id">the</span> <span class="id">way</span>. <span class="kwd">Remark</span> <span class="id">that</span> <span class="id">it</span> <span class="id">also</span> <span class="id">unfolds</span> <span class="id">the</span>
    <span class="id">definition</span> <span class="id">of</span> <span class="id">negation</span>, <span class="id">so</span> <span class="id">applying</span> [<span class="id">introz</span>] <span class="id">to</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span>
    [<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">P</span> <span class="id">x</span> -&gt; ~<span class="id">Q</span>] <span class="id">will</span> <span class="id">introduce</span> [<span class="id">x</span>] <span class="id">and</span> [<span class="id">P</span> <span class="id">x</span>] <span class="id">and</span> [<span class="id">Q</span>], <span class="id">and</span> <span class="id">will</span>
    <span class="id">leave</span> [<span class="id">False</span>] <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intros_all</span>" :=
  <span class="tactic">repeat</span> <span class="tactic">intro</span>.

(** [<span class="id">intros_hnf</span>] <span class="id">introduces</span> <span class="id">an</span> <span class="id">hypothesis</span> <span class="id">and</span> <span class="id">sets</span> <span class="kwd">in</span> <span class="id">head</span> <span class="id">normal</span> <span class="id">form</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intro_hnf</span>" :=
  <span class="tactic">intro</span>; <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>.



(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Generalization</span> *)

(** [<span class="id">gen</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> <span class="id">calling</span> [<span class="tactic">generalize</span> <span class="tactic">dependent</span>] 
    <span class="id">successively</span> <span class="id">on</span> <span class="id">variables</span> [<span class="id">XN</span>]...[<span class="id">X1</span>]. <span class="id">Note</span> <span class="id">that</span> <span class="id">the</span> <span class="id">variables</span>
    <span class="id">are</span> <span class="id">generalized</span> <span class="kwd">in</span> <span class="id">reverse</span> <span class="id">order</span>, <span class="id">following</span> <span class="id">the</span> <span class="id">convention</span> <span class="id">of</span>
    <span class="id">the</span> [<span class="tactic">generalize</span>] <span class="id">tactic</span>: <span class="id">it</span> <span class="id">means</span> <span class="id">that</span> [<span class="id">X1</span>] <span class="id">will</span> <span class="id">be</span> <span class="id">the</span> <span class="id">first</span>
    <span class="id">quantified</span> <span class="id">variable</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">resulting</span> <span class="id">goal</span>. *) 

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) :=
  <span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) :=
  <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) :=
  <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>)  :=
  <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) :=
  <span class="id">gen</span> <span class="id">X5</span>; <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) 
 <span class="id">ident</span>(<span class="id">X6</span>) :=
  <span class="id">gen</span> <span class="id">X6</span>; <span class="id">gen</span> <span class="id">X5</span>; <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) 
 <span class="id">ident</span>(<span class="id">X6</span>) <span class="id">ident</span>(<span class="id">X7</span>) :=
  <span class="id">gen</span> <span class="id">X7</span>; <span class="id">gen</span> <span class="id">X6</span>; <span class="id">gen</span> <span class="id">X5</span>; <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) 
 <span class="id">ident</span>(<span class="id">X6</span>) <span class="id">ident</span>(<span class="id">X7</span>) <span class="id">ident</span>(<span class="id">X8</span>) :=
  <span class="id">gen</span> <span class="id">X8</span>; <span class="id">gen</span> <span class="id">X7</span>; <span class="id">gen</span> <span class="id">X6</span>; <span class="id">gen</span> <span class="id">X5</span>; <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) 
 <span class="id">ident</span>(<span class="id">X6</span>) <span class="id">ident</span>(<span class="id">X7</span>) <span class="id">ident</span>(<span class="id">X8</span>) <span class="id">ident</span>(<span class="id">X9</span>) :=
  <span class="id">gen</span> <span class="id">X9</span>; <span class="id">gen</span> <span class="id">X8</span>; <span class="id">gen</span> <span class="id">X7</span>; <span class="id">gen</span> <span class="id">X6</span>; <span class="id">gen</span> <span class="id">X5</span>; <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) 
 <span class="id">ident</span>(<span class="id">X6</span>) <span class="id">ident</span>(<span class="id">X7</span>) <span class="id">ident</span>(<span class="id">X8</span>) <span class="id">ident</span>(<span class="id">X9</span>) <span class="id">ident</span>(<span class="id">X10</span>) :=
  <span class="id">gen</span> <span class="id">X10</span>; <span class="id">gen</span> <span class="id">X9</span>; <span class="id">gen</span> <span class="id">X8</span>; <span class="id">gen</span> <span class="id">X7</span>; <span class="id">gen</span> <span class="id">X6</span>; <span class="id">gen</span> <span class="id">X5</span>; <span class="id">gen</span> <span class="id">X4</span>; <span class="id">gen</span> <span class="id">X3</span>; <span class="id">gen</span> <span class="id">X2</span>; <span class="id">gen</span> <span class="id">X1</span>.

(** [<span class="id">generalizes</span> <span class="id">X</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> <span class="id">calling</span> [<span class="tactic">generalize</span> <span class="id">X</span>; <span class="tactic">clear</span> <span class="id">X</span>]. 
    <span class="id">It</span> <span class="id">is</span> <span class="id">weaker</span> <span class="id">than</span> <span class="id">tactic</span> [<span class="id">gen</span> <span class="id">X</span>] <span class="id">since</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="id">support</span>
    <span class="id">dependencies</span>. <span class="id">It</span> <span class="id">is</span> <span class="id">mainly</span> <span class="id">intended</span> <span class="kwd">for</span> <span class="id">writing</span> <span class="id">tactics</span>. *) 
 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">generalizes</span>" <span class="id">hyp</span>(<span class="id">X</span>) :=
  <span class="tactic">generalize</span> <span class="id">X</span>; <span class="tactic">clear</span> <span class="id">X</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">generalizes</span>" <span class="id">hyp</span>(<span class="id">X1</span>) <span class="id">hyp</span>(<span class="id">X2</span>) :=
  <span class="id">generalizes</span> <span class="id">X1</span>; <span class="id">generalizes</span> <span class="id">X2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">generalizes</span>" <span class="id">hyp</span>(<span class="id">X1</span>) <span class="id">hyp</span>(<span class="id">X2</span>) <span class="id">hyp</span>(<span class="id">X3</span>) :=
  <span class="id">generalizes</span> <span class="id">X1</span> <span class="id">X2</span>; <span class="id">generalizes</span> <span class="id">X3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">generalizes</span>" <span class="id">hyp</span>(<span class="id">X1</span>) <span class="id">hyp</span>(<span class="id">X2</span>) <span class="id">hyp</span>(<span class="id">X3</span>) <span class="id">hyp</span>(<span class="id">X4</span>) :=
  <span class="id">generalizes</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span>; <span class="id">generalizes</span> <span class="id">X4</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Naming</span> *)

(** [<span class="id">sets</span> <span class="id">X</span>: <span class="id">E</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *], <span class="id">that</span> <span class="id">is</span>,
    <span class="id">it</span> <span class="id">replaces</span> <span class="id">all</span> <span class="id">occurences</span> <span class="id">of</span> [<span class="id">E</span>] <span class="tactic">by</span> <span class="id">a</span> <span class="tactic">fresh</span> <span class="id">meta</span>-<span class="id">variable</span> [<span class="id">X</span>]
    <span class="id">whose</span> <span class="id">definition</span> <span class="id">is</span> [<span class="id">E</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *.

(** [<span class="id">def_to_eq</span> <span class="id">E</span> <span class="id">X</span> <span class="id">H</span>] <span class="id">applies</span> <span class="id">when</span> [<span class="id">X</span> := <span class="id">E</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">local</span> 
    <span class="id">definition</span>. <span class="id">It</span> <span class="id">adds</span> <span class="id">an</span> <span class="tactic">assumption</span> [<span class="id">H</span>: <span class="id">X</span> = <span class="id">E</span>] 
    <span class="id">and</span> <span class="kwd">then</span> <span class="id">clears</span> <span class="id">the</span> <span class="id">definition</span> <span class="id">of</span> [<span class="id">X</span>].
    [<span class="id">def_to_eq_sym</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">generates</span>
    <span class="id">the</span> <span class="id">equality</span> [<span class="id">H</span>: <span class="id">E</span> = <span class="id">X</span>]. *)

<span class="kwd">Ltac</span> <span class="id">def_to_eq</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span> :=
  <span class="tactic">assert</span> (<span class="id">HX</span> : <span class="id">X</span> = <span class="id">E</span>) <span class="tactic">by</span> <span class="tactic">reflexivity</span>; <span class="id">clearbody</span> <span class="id">X</span>.
<span class="kwd">Ltac</span> <span class="id">def_to_eq_sym</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span> :=
  <span class="tactic">assert</span> (<span class="id">HX</span> : <span class="id">E</span> = <span class="id">X</span>) <span class="tactic">by</span> <span class="tactic">reflexivity</span>; <span class="id">clearbody</span> <span class="id">X</span>.

(** [<span class="id">set_eq</span> <span class="id">X</span> <span class="id">H</span>: <span class="id">E</span>] <span class="id">generates</span> <span class="id">the</span> <span class="id">equality</span> [<span class="id">H</span>: <span class="id">X</span> = <span class="id">E</span>],
    <span class="kwd">for</span> <span class="id">a</span> <span class="tactic">fresh</span> <span class="id">name</span> [<span class="id">X</span>], <span class="id">and</span> <span class="id">replaces</span> [<span class="id">E</span>] <span class="tactic">by</span> [<span class="id">X</span>] <span class="kwd">in</span> <span class="id">the</span>
    <span class="id">current</span> <span class="id">goal</span>. <span class="id">Syntaxes</span> [<span class="id">set_eq</span> <span class="id">X</span>: <span class="id">E</span>] <span class="id">and</span>
    [<span class="id">set_eq</span>: <span class="id">E</span>] <span class="id">are</span> <span class="id">also</span> <span class="id">available</span>. <span class="id">Similarly</span>,
    [<span class="id">set_eq</span> &lt;- <span class="id">X</span> <span class="id">H</span>: <span class="id">E</span>] <span class="id">generates</span> <span class="id">the</span> <span class="id">equality</span> [<span class="id">H</span>: <span class="id">E</span> = <span class="id">X</span>]. 

    [<span class="id">sets_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span>] <span class="id">does</span> <span class="id">the</span> <span class="id">same</span> <span class="id">but</span> <span class="id">replaces</span> [<span class="id">E</span>] <span class="tactic">by</span> [<span class="id">X</span>]
    <span class="id">everywhere</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>. [<span class="id">sets_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">replaces</span> <span class="kwd">in</span> [<span class="id">H</span>].
    [<span class="id">set_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span> <span class="kwd">in</span> |-] <span class="id">performs</span> <span class="id">no</span> <span class="id">substitution</span> <span class="tactic">at</span> <span class="id">all</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>); <span class="id">def_to_eq</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">set_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">set_eq</span> <span class="id">X</span>: <span class="id">E</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>); <span class="id">def_to_eq_sym</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">set_eq</span> &lt;- <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">set_eq</span> &lt;- <span class="id">X</span>: <span class="id">E</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *; <span class="id">def_to_eq</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">sets_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">sets_eq</span> <span class="id">X</span>: <span class="id">E</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *; <span class="id">def_to_eq_sym</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">sets_eq</span> &lt;- <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq</span>" "&lt;-" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">sets_eq</span> &lt;- <span class="id">X</span>: <span class="id">E</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">def_to_eq</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">set_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">set_eq</span> <span class="id">X</span>: <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">def_to_eq_sym</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">set_eq</span> &lt;- <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">set_eq</span> &lt;- <span class="id">X</span>: <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "|-" :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> |-; <span class="id">def_to_eq</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "|-" :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">set_eq</span> <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span> <span class="kwd">in</span> |-.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "|-" :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">set_eq</span> <span class="id">X</span>: <span class="id">E</span> <span class="kwd">in</span> |-.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) <span class="id">ident</span>(<span class="id">HX</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "|-" :=
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> |-; <span class="id">def_to_eq_sym</span> <span class="id">X</span> <span class="id">HX</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "|-" :=
  <span class="kwd">let</span> <span class="id">HX</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="id">X</span> <span class="kwd">in</span> <span class="id">set_eq</span> &lt;- <span class="id">X</span> <span class="id">HX</span>: <span class="id">E</span> <span class="kwd">in</span> |-.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">set_eq</span>" "&lt;-" ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "|-" :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">set_eq</span> &lt;- <span class="id">X</span>: <span class="id">E</span> <span class="kwd">in</span> |-.

(** [<span class="id">gen_eq</span> <span class="id">X</span>: <span class="id">E</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">tactic</span> <span class="id">whose</span> <span class="id">purpose</span> <span class="id">is</span> <span class="id">to</span> <span class="id">introduce</span> 
    <span class="id">equalities</span> <span class="id">so</span> <span class="kwd">as</span> <span class="id">to</span> <span class="id">work</span> <span class="id">around</span> <span class="id">the</span> <span class="id">limitation</span> <span class="id">of</span> <span class="id">the</span> [<span class="tactic">induction</span>]
    <span class="id">tactic</span> <span class="id">which</span> <span class="id">typically</span> <span class="id">loses</span> <span class="id">information</span>. [<span class="id">gen_eq</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">X</span>] <span class="id">replaces</span> 
    <span class="id">all</span> <span class="id">occurences</span> <span class="id">of</span> <span class="id">term</span> [<span class="id">E</span>] <span class="kwd">with</span> <span class="id">a</span> <span class="tactic">fresh</span> <span class="id">variable</span> [<span class="id">X</span>] <span class="id">and</span> <span class="id">the</span> <span class="id">equality</span>
    [<span class="id">X</span> = <span class="id">E</span>] <span class="kwd">as</span> <span class="id">extra</span> <span class="id">hypothesis</span> <span class="id">to</span> <span class="id">the</span> <span class="id">current</span> <span class="id">conclusion</span>. <span class="id">In</span> <span class="id">other</span> <span class="id">words</span>
    <span class="id">a</span> <span class="id">conclusion</span> [<span class="id">C</span>] <span class="id">will</span> <span class="id">be</span> <span class="id">turned</span> <span class="id">into</span> [(<span class="id">X</span> = <span class="id">E</span>) -&gt; <span class="id">C</span>].
    [<span class="id">gen_eq</span>: <span class="id">E</span>] <span class="id">and</span> [<span class="id">gen_eq</span>: <span class="id">E</span> <span class="kwd">as</span> <span class="id">X</span>] <span class="id">are</span> <span class="id">also</span> <span class="id">accepted</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen_eq</span>" <span class="id">ident</span>(<span class="id">X</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">EQ</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">sets_eq</span> <span class="id">X</span> <span class="id">EQ</span>: <span class="id">E</span>; <span class="id">revert</span> <span class="id">EQ</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen_eq</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">X</span>" <span class="kwd">in</span> <span class="id">gen_eq</span> <span class="id">X</span>: <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen_eq</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">X</span>) :=
  <span class="id">gen_eq</span> <span class="id">X</span>: <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen_eq</span>" <span class="id">ident</span>(<span class="id">X1</span>) ":" <span class="id">constr</span>(<span class="id">E1</span>) ","
  <span class="id">ident</span>(<span class="id">X2</span>) ":" <span class="id">constr</span>(<span class="id">E2</span>) :=
  <span class="id">gen_eq</span> <span class="id">X2</span>: <span class="id">E2</span>; <span class="id">gen_eq</span> <span class="id">X1</span>: <span class="id">E1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">gen_eq</span>" <span class="id">ident</span>(<span class="id">X1</span>) ":" <span class="id">constr</span>(<span class="id">E1</span>) ","
  <span class="id">ident</span>(<span class="id">X2</span>) ":" <span class="id">constr</span>(<span class="id">E2</span>) "," <span class="id">ident</span>(<span class="id">X3</span>) ":" <span class="id">constr</span>(<span class="id">E3</span>) :=
  <span class="id">gen_eq</span> <span class="id">X3</span>: <span class="id">E3</span>; <span class="id">gen_eq</span> <span class="id">X2</span>: <span class="id">E2</span>; <span class="id">gen_eq</span> <span class="id">X1</span>: <span class="id">E1</span>.

(** [<span class="id">sets_let</span> <span class="id">X</span>] <span class="id">finds</span> <span class="id">the</span> <span class="id">first</span> <span class="kwd">let</span>-<span class="id">expression</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>
    <span class="id">and</span> <span class="id">names</span> <span class="id">its</span> <span class="id">body</span> [<span class="id">X</span>]. [<span class="id">sets_eq_let</span> <span class="id">X</span>] <span class="id">is</span> <span class="id">similar</span>,
    <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">generates</span> <span class="id">an</span> <span class="id">explicit</span> <span class="id">equality</span>.
    <span class="id">Tactics</span> [<span class="id">sets_let</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">and</span> [<span class="id">sets_eq_let</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">H</span>]
    <span class="id">allow</span> <span class="id">specifying</span> <span class="id">a</span> <span class="id">particular</span> <span class="id">hypothesis</span> (<span class="tactic">by</span> <span class="id">default</span>,
    <span class="id">the</span> <span class="id">first</span> <span class="id">one</span> <span class="id">that</span> <span class="id">contains</span> <span class="id">a</span> [<span class="kwd">let</span>] <span class="id">is</span> <span class="id">considered</span>).

    <span class="id">Known</span> <span class="id">limitation</span>: <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="id">seem</span> <span class="id">possible</span> <span class="id">to</span> <span class="id">support</span>
    <span class="id">naming</span> <span class="id">of</span> <span class="id">multiple</span> <span class="kwd">let</span>-<span class="kwd">in</span> <span class="id">constructs</span> <span class="id">inside</span> <span class="id">a</span> <span class="id">term</span>, <span class="id">from</span> <span class="id">ltac</span>. *)

<span class="kwd">Ltac</span> <span class="id">sets_let_base</span> <span class="id">tac</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- <span class="id">context</span>[<span class="kwd">let</span> <span class="id">_</span> := ?<span class="id">E</span> <span class="kwd">in</span> <span class="id">_</span>] =&gt; <span class="id">tac</span> <span class="id">E</span>; <span class="id">cbv</span> <span class="id">zeta</span>
  | <span class="id">H</span>: <span class="id">context</span>[<span class="kwd">let</span> <span class="id">_</span> := ?<span class="id">E</span> <span class="kwd">in</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt; <span class="id">tac</span> <span class="id">E</span>; <span class="id">cbv</span> <span class="id">zeta</span> <span class="kwd">in</span> <span class="id">H</span>
  <span class="kwd">end</span>. 

<span class="kwd">Ltac</span> <span class="id">sets_let_in_base</span> <span class="id">H</span> <span class="id">tac</span> :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span>[<span class="kwd">let</span> <span class="id">_</span> := ?<span class="id">E</span> <span class="kwd">in</span> <span class="id">_</span>] =&gt; 
    <span class="id">tac</span> <span class="id">E</span>; <span class="id">cbv</span> <span class="id">zeta</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_let</span>" <span class="id">ident</span>(<span class="id">X</span>) := 
  <span class="id">sets_let_base</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">E</span> =&gt; <span class="id">sets</span> <span class="id">X</span>: <span class="id">E</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_let</span>" <span class="id">ident</span>(<span class="id">X</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="id">sets_let_in_base</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">E</span> =&gt; <span class="id">sets</span> <span class="id">X</span>: <span class="id">E</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq_let</span>" <span class="id">ident</span>(<span class="id">X</span>) := 
  <span class="id">sets_let_base</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">E</span> =&gt; <span class="id">sets_eq</span> <span class="id">X</span>: <span class="id">E</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sets_eq_let</span>" <span class="id">ident</span>(<span class="id">X</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="id">sets_let_in_base</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">E</span> =&gt; <span class="id">sets_eq</span> <span class="id">X</span>: <span class="id">E</span>).

  

(* ********************************************************************** *)
(** * <span class="id">Rewriting</span> *)

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Rewriting</span> *)

(** [<span class="id">rewrite_all</span> <span class="id">E</span>] <span class="id">iterates</span> <span class="id">version</span> <span class="id">of</span> [<span class="tactic">rewrite</span> <span class="id">E</span>] <span class="kwd">as</span> <span class="id">long</span> <span class="kwd">as</span> <span class="id">possible</span>. 
    <span class="id">Warning</span>: <span class="id">this</span> <span class="id">tactic</span> <span class="id">can</span> <span class="id">easily</span> <span class="id">get</span> <span class="id">into</span> <span class="id">an</span> <span class="id">infinite</span> <span class="id">loop</span>. 
    <span class="kwd">Syntax</span> <span class="kwd">for</span> <span class="id">rewriting</span> <span class="id">from</span> <span class="id">right</span> <span class="id">to</span> <span class="id">left</span> <span class="id">and</span>/<span class="id">or</span> <span class="id">into</span> <span class="id">an</span> <span class="id">hypothese</span>
    <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> <span class="id">the</span> <span class="id">one</span> <span class="id">of</span> [<span class="tactic">rewrite</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">ident</span>(<span class="id">H</span>) :=
  <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">ident</span>(<span class="id">H</span>) :=
  <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" :=
  <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" :=
  <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> *.

(** [<span class="id">asserts_rewrite</span> <span class="id">E</span>] <span class="id">asserts</span> <span class="id">that</span> <span class="id">an</span> <span class="id">equality</span> [<span class="id">E</span>] <span class="id">holds</span> (<span class="id">generating</span> <span class="id">a</span> 
    <span class="id">corresponding</span> <span class="kwd">subgoal</span>) <span class="id">and</span> <span class="tactic">rewrite</span> <span class="id">it</span> <span class="id">straight</span> <span class="id">away</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">current</span> 
    <span class="id">goal</span>. <span class="id">It</span> <span class="id">avoids</span> <span class="id">giving</span> <span class="id">a</span> <span class="id">name</span> <span class="id">to</span> <span class="id">the</span> <span class="id">equality</span> <span class="id">and</span> <span class="id">later</span> <span class="id">clearing</span> <span class="id">it</span>. 
    <span class="kwd">Syntax</span> <span class="kwd">for</span> <span class="id">rewriting</span> <span class="id">from</span> <span class="id">right</span> <span class="id">to</span> <span class="id">left</span> <span class="id">and</span>/<span class="id">or</span> <span class="id">into</span> <span class="id">an</span> <span class="id">hypothese</span>
    <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> <span class="id">the</span> <span class="id">one</span> <span class="id">of</span> [<span class="tactic">rewrite</span>]. <span class="id">Note</span>: <span class="id">the</span> <span class="id">tactic</span> [<span class="id">replaces</span>] 
    <span class="id">plays</span> <span class="id">a</span> <span class="id">similar</span> <span class="id">role</span>. *)

<span class="kwd">Ltac</span> <span class="id">asserts_rewrite_tactic</span> <span class="id">E</span> <span class="id">action</span> :=
  <span class="kwd">let</span> <span class="id">EQ</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> (<span class="tactic">assert</span> (<span class="id">EQ</span> : <span class="id">E</span>);
  [ <span class="id">idtac</span> | <span class="id">action</span> <span class="id">EQ</span>; <span class="tactic">clear</span> <span class="id">EQ</span> ]).

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> <span class="id">EQ</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> &lt;- <span class="id">EQ</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">asserts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">H</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">asserts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> &lt;- <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">H</span>).

(** [<span class="id">cuts_rewrite</span> <span class="id">E</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">asserts_rewrite</span> <span class="id">E</span>] <span class="id">except</span>
    <span class="id">that</span> <span class="id">subgoals</span> <span class="id">are</span> <span class="id">permuted</span>. *)

<span class="kwd">Ltac</span> <span class="id">cuts_rewrite_tactic</span> <span class="id">E</span> <span class="id">action</span> :=
  <span class="kwd">let</span> <span class="id">EQ</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> (<span class="id">cuts</span> <span class="id">EQ</span>: <span class="id">E</span>; 
  [ <span class="id">action</span> <span class="id">EQ</span>; <span class="tactic">clear</span> <span class="id">EQ</span> | <span class="id">idtac</span> ]).

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> <span class="id">EQ</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> &lt;- <span class="id">EQ</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">cuts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">H</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">cuts_rewrite_tactic</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">EQ</span> =&gt; <span class="tactic">rewrite</span> &lt;- <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">H</span>).

(** [<span class="id">rewrite_except</span> <span class="id">H</span> <span class="id">EQ</span>] <span class="id">rewrites</span> <span class="id">equality</span> [<span class="id">EQ</span>] <span class="id">everywhere</span>
    <span class="id">but</span> <span class="kwd">in</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Ltac</span> <span class="id">rewrite_except</span> <span class="id">H</span> <span class="id">EQ</span> :=
  <span class="kwd">let</span> <span class="id">K</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">T</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">in</span> 
  <span class="tactic">set</span> (<span class="id">K</span> := <span class="id">T</span>) <span class="kwd">in</span> <span class="id">H</span>;
  <span class="tactic">rewrite</span> <span class="id">EQ</span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id">K</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">K</span>.

(** [<span class="id">rewrites</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span>] <span class="id">applies</span> <span class="id">when</span> [<span class="id">E</span>] <span class="id">is</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">T1</span> = <span class="id">T2</span>]
    <span class="id">rewrites</span> <span class="id">the</span> <span class="id">equality</span> [<span class="id">E</span>] <span class="tactic">at</span> <span class="id">the</span> [<span class="id">K</span>]-<span class="id">th</span> <span class="id">occurence</span> <span class="id">of</span> [<span class="id">T1</span>]
    <span class="kwd">in</span> <span class="id">the</span> <span class="id">current</span> <span class="id">goal</span>. 
    <span class="id">Syntaxes</span> [<span class="id">rewrites</span> &lt;- <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span>] <span class="id">and</span> [<span class="id">rewrites</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span> <span class="kwd">in</span> <span class="id">H</span>]
    <span class="id">are</span> <span class="id">also</span> <span class="id">available</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrites</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span> ?<span class="id">T1</span> = ?<span class="id">T2</span> =&gt;
    <span class="id">ltac_action_at</span> <span class="id">K</span> <span class="id">of</span> <span class="id">T1</span> <span class="tactic">do</span> (<span class="tactic">rewrite</span> <span class="id">E</span>) <span class="kwd">end</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrites</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span> ?<span class="id">T1</span> = ?<span class="id">T2</span> =&gt;
    <span class="id">ltac_action_at</span> <span class="id">K</span> <span class="id">of</span> <span class="id">T2</span> <span class="tactic">do</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">E</span>) <span class="kwd">end</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrites</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span> ?<span class="id">T1</span> = ?<span class="id">T2</span> =&gt;
    <span class="id">ltac_action_at</span> <span class="id">K</span> <span class="id">of</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">do</span> (<span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>) <span class="kwd">end</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrites</span>" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span> ?<span class="id">T1</span> = ?<span class="id">T2</span> =&gt;
    <span class="id">ltac_action_at</span> <span class="id">K</span> <span class="id">of</span> <span class="id">T2</span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">do</span> (<span class="tactic">rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>) <span class="kwd">end</span>.


(* ---------------------------------------------------------------------- *)
(**  ** <span class="id">Replace</span> *)

(** [<span class="id">replaces</span> <span class="id">E</span> <span class="kwd">with</span> <span class="id">F</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">replace</span> <span class="id">E</span> <span class="kwd">with</span> <span class="id">F</span>] <span class="id">except</span> <span class="id">that</span>
    <span class="id">the</span> <span class="id">equality</span> [<span class="id">E</span> = <span class="id">F</span>] <span class="id">is</span> <span class="id">generated</span> <span class="kwd">as</span> <span class="id">first</span> <span class="kwd">subgoal</span>. <span class="kwd">Syntax</span>
    [<span class="id">replaces</span> <span class="id">E</span> <span class="kwd">with</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">also</span> <span class="id">available</span>. <span class="id">Note</span> <span class="id">that</span> <span class="id">contrary</span> <span class="id">to</span>
    [<span class="tactic">replace</span>], [<span class="id">replaces</span>] <span class="id">does</span> <span class="id">not</span> <span class="tactic">try</span> <span class="id">to</span> <span class="id">solve</span> <span class="id">the</span> <span class="id">equality</span> 
    <span class="tactic">by</span> [<span class="tactic">assumption</span>]. <span class="id">Note</span>: [<span class="id">replaces</span> <span class="id">E</span> <span class="kwd">with</span> <span class="id">F</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span>
    [<span class="id">asserts_rewrite</span> (<span class="id">E</span> = <span class="id">F</span>)]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">replaces</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">with</span>" <span class="id">constr</span>(<span class="id">F</span>) :=
  <span class="kwd">let</span> <span class="id">T</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">assert</span> (<span class="id">T</span>: <span class="id">E</span> = <span class="id">F</span>); [ | <span class="tactic">replace</span> <span class="id">E</span> <span class="kwd">with</span> <span class="id">F</span>; <span class="tactic">clear</span> <span class="id">T</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">replaces</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">with</span>" <span class="id">constr</span>(<span class="id">F</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">T</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">assert</span> (<span class="id">T</span>: <span class="id">E</span> = <span class="id">F</span>); [ | <span class="tactic">replace</span> <span class="id">E</span> <span class="kwd">with</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">T</span> ].


(** [<span class="id">replaces</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span> <span class="kwd">with</span> <span class="id">F</span>] <span class="id">replaces</span> <span class="id">the</span> [<span class="id">K</span>]-<span class="id">th</span> <span class="id">occurence</span> <span class="id">of</span> [<span class="id">E</span>]
    <span class="kwd">with</span> [<span class="id">F</span>] <span class="kwd">in</span> <span class="id">the</span> <span class="id">current</span> <span class="id">goal</span>. <span class="kwd">Syntax</span> [<span class="id">replaces</span> <span class="id">E</span> <span class="tactic">at</span> <span class="id">K</span> <span class="kwd">with</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>]
    <span class="id">is</span> <span class="id">also</span> <span class="id">available</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">replaces</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="kwd">with</span>" <span class="id">constr</span>(<span class="id">F</span>) :=
  <span class="kwd">let</span> <span class="id">T</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">assert</span> (<span class="id">T</span>: <span class="id">E</span> = <span class="id">F</span>); [ | <span class="id">rewrites</span> <span class="id">T</span> <span class="tactic">at</span> <span class="id">K</span>; <span class="tactic">clear</span> <span class="id">T</span> ].
 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">replaces</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="tactic">at</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="kwd">with</span>" <span class="id">constr</span>(<span class="id">F</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">T</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">assert</span> (<span class="id">T</span>: <span class="id">E</span> = <span class="id">F</span>); [ | <span class="id">rewrites</span> <span class="id">T</span> <span class="tactic">at</span> <span class="id">K</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">T</span> ].


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Renaming</span> *)

(** [<span class="id">renames</span> <span class="id">X1</span> <span class="id">to</span> <span class="id">Y1</span>, ..., <span class="id">XN</span> <span class="id">to</span> <span class="id">YN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> <span class="id">a</span> <span class="id">sequence</span> <span class="id">of</span>
    <span class="id">renaming</span> <span class="id">operations</span> [<span class="tactic">rename</span> <span class="id">Xi</span> <span class="id">into</span> <span class="id">Yi</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">renames</span>" <span class="id">ident</span>(<span class="id">X1</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y1</span>) :=
  <span class="tactic">rename</span> <span class="id">X1</span> <span class="id">into</span> <span class="id">Y1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">renames</span>" <span class="id">ident</span>(<span class="id">X1</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y1</span>) ","
 <span class="id">ident</span>(<span class="id">X2</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y2</span>) :=
  <span class="id">renames</span> <span class="id">X1</span> <span class="id">to</span> <span class="id">Y1</span>; <span class="id">renames</span> <span class="id">X2</span> <span class="id">to</span> <span class="id">Y2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">renames</span>" <span class="id">ident</span>(<span class="id">X1</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y1</span>) ","
 <span class="id">ident</span>(<span class="id">X2</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y2</span>) "," <span class="id">ident</span>(<span class="id">X3</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y3</span>) :=
  <span class="id">renames</span> <span class="id">X1</span> <span class="id">to</span> <span class="id">Y1</span>; <span class="id">renames</span> <span class="id">X2</span> <span class="id">to</span> <span class="id">Y2</span>, <span class="id">X3</span> <span class="id">to</span> <span class="id">Y3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">renames</span>" <span class="id">ident</span>(<span class="id">X1</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y1</span>) ","
 <span class="id">ident</span>(<span class="id">X2</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y2</span>) "," <span class="id">ident</span>(<span class="id">X3</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y3</span>) ","
 <span class="id">ident</span>(<span class="id">X4</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y4</span>) :=
  <span class="id">renames</span> <span class="id">X1</span> <span class="id">to</span> <span class="id">Y1</span>; <span class="id">renames</span> <span class="id">X2</span> <span class="id">to</span> <span class="id">Y2</span>, <span class="id">X3</span> <span class="id">to</span> <span class="id">Y3</span>, <span class="id">X4</span> <span class="id">to</span> <span class="id">Y4</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">renames</span>" <span class="id">ident</span>(<span class="id">X1</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y1</span>) ","
 <span class="id">ident</span>(<span class="id">X2</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y2</span>) "," <span class="id">ident</span>(<span class="id">X3</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y3</span>) ","
 <span class="id">ident</span>(<span class="id">X4</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y4</span>) "," <span class="id">ident</span>(<span class="id">X5</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y5</span>) :=
  <span class="id">renames</span> <span class="id">X1</span> <span class="id">to</span> <span class="id">Y1</span>; <span class="id">renames</span> <span class="id">X2</span> <span class="id">to</span> <span class="id">Y2</span>, <span class="id">X3</span> <span class="id">to</span> <span class="id">Y3</span>, <span class="id">X4</span> <span class="id">to</span> <span class="id">Y4</span>, <span class="id">X5</span> <span class="id">to</span> <span class="id">Y5</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">renames</span>" <span class="id">ident</span>(<span class="id">X1</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y1</span>) ","
 <span class="id">ident</span>(<span class="id">X2</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y2</span>) "," <span class="id">ident</span>(<span class="id">X3</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y3</span>) ","
 <span class="id">ident</span>(<span class="id">X4</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y4</span>) "," <span class="id">ident</span>(<span class="id">X5</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y5</span>) ","
 <span class="id">ident</span>(<span class="id">X6</span>) "<span class="id">to</span>" <span class="id">ident</span>(<span class="id">Y6</span>) :=
  <span class="id">renames</span> <span class="id">X1</span> <span class="id">to</span> <span class="id">Y1</span>; <span class="id">renames</span> <span class="id">X2</span> <span class="id">to</span> <span class="id">Y2</span>, <span class="id">X3</span> <span class="id">to</span> <span class="id">Y3</span>, <span class="id">X4</span> <span class="id">to</span> <span class="id">Y4</span>, <span class="id">X5</span> <span class="id">to</span> <span class="id">Y5</span>, <span class="id">X6</span> <span class="id">to</span> <span class="id">Y6</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Unfolding</span> *)

(** [<span class="id">unfolds</span>] <span class="id">unfolds</span> <span class="id">the</span> <span class="id">head</span> <span class="id">definition</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>, <span class="id">i.e</span>. <span class="kwd">if</span> <span class="id">the</span>
    <span class="id">goal</span> <span class="id">has</span> <span class="id">form</span> [<span class="id">P</span> <span class="id">x1</span> ... <span class="id">xN</span>] <span class="kwd">then</span> <span class="id">it</span> <span class="id">calls</span> [<span class="tactic">unfold</span> <span class="id">P</span>].
    <span class="id">If</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">is</span> <span class="id">an</span> <span class="id">equality</span>, <span class="id">it</span> <span class="id">tries</span> <span class="id">to</span> <span class="tactic">unfold</span> <span class="id">the</span> <span class="id">head</span> <span class="id">constant</span>
    <span class="id">on</span> <span class="id">the</span> <span class="id">left</span>-<span class="id">hand</span> <span class="id">side</span>, <span class="id">and</span> <span class="id">otherwise</span> <span class="id">tries</span> <span class="id">on</span> <span class="id">the</span> <span class="id">right</span>-<span class="id">hand</span> <span class="id">side</span>.
    <span class="id">If</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">is</span> <span class="id">a</span> <span class="id">product</span>, <span class="id">it</span> <span class="id">calls</span> [<span class="tactic">intros</span>] <span class="id">first</span>. *)

<span class="kwd">Ltac</span> <span class="id">apply_to_head_of</span> <span class="id">E</span> <span class="id">cont</span> :=
  <span class="kwd">let</span> <span class="id">go</span> <span class="id">E</span> :=  
    <span class="kwd">let</span> <span class="id">P</span> := <span class="id">get_head</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">cont</span> <span class="id">P</span> <span class="kwd">in</span>
  <span class="kwd">match</span> <span class="id">E</span> <span class="kwd">with</span>
  | <span class="kwd">forall</span> <span class="id">_</span>,<span class="id">_</span> =&gt; <span class="tactic">intros</span>; <span class="id">apply_to_head_of</span> <span class="id">E</span> <span class="id">cont</span>
  | ?<span class="id">A</span> = ?<span class="id">B</span> =&gt; <span class="id">first</span> [ <span class="id">go</span> <span class="id">A</span> | <span class="id">go</span> <span class="id">B</span> ]
  | ?<span class="id">A</span> =&gt; <span class="id">go</span> <span class="id">A</span> 
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">unfolds_base</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">G</span> =&gt; 
   <span class="id">apply_to_head_of</span> <span class="id">G</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="tactic">unfold</span> <span class="id">P</span>) <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" :=
  <span class="id">unfolds_base</span>.

(** [<span class="id">unfolds</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">unfolds</span> <span class="id">the</span> <span class="id">head</span> <span class="id">definition</span> <span class="id">of</span> <span class="id">hypothesis</span> [<span class="id">H</span>], <span class="id">i.e</span>. <span class="kwd">if</span> 
    [<span class="id">H</span>] <span class="id">has</span> <span class="id">type</span> [<span class="id">P</span> <span class="id">x1</span> ... <span class="id">xN</span>] <span class="kwd">then</span> <span class="id">it</span> <span class="id">calls</span> [<span class="tactic">unfold</span> <span class="id">P</span> <span class="kwd">in</span> <span class="id">H</span>]. *)

<span class="kwd">Ltac</span> <span class="id">unfolds_in_base</span> <span class="id">H</span> :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> ?<span class="id">G</span> =&gt; 
   <span class="id">apply_to_head_of</span> <span class="id">G</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="tactic">unfold</span> <span class="id">P</span> <span class="kwd">in</span> <span class="id">H</span>) <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">unfolds_in_base</span> <span class="id">H</span>.

(** [<span class="id">unfolds</span> <span class="id">P1</span>,..,<span class="id">PN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shortcut</span> <span class="kwd">for</span> [<span class="tactic">unfold</span> <span class="id">P1</span>,..,<span class="id">PN</span> <span class="kwd">in</span> *]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span>,<span class="id">F3</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) "," <span class="id">reference</span>(<span class="id">F4</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span>,<span class="id">F3</span>,<span class="id">F4</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) "," <span class="id">reference</span>(<span class="id">F4</span>) "," <span class="id">reference</span>(<span class="id">F5</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span>,<span class="id">F3</span>,<span class="id">F4</span>,<span class="id">F5</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) "," <span class="id">reference</span>(<span class="id">F4</span>) "," <span class="id">reference</span>(<span class="id">F5</span>) "," <span class="id">reference</span>(<span class="id">F6</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span>,<span class="id">F3</span>,<span class="id">F4</span>,<span class="id">F5</span>,<span class="id">F6</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) "," <span class="id">reference</span>(<span class="id">F4</span>) "," <span class="id">reference</span>(<span class="id">F5</span>) 
 "," <span class="id">reference</span>(<span class="id">F6</span>) "," <span class="id">reference</span>(<span class="id">F7</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span>,<span class="id">F3</span>,<span class="id">F4</span>,<span class="id">F5</span>,<span class="id">F6</span>,<span class="id">F7</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) "," <span class="id">reference</span>(<span class="id">F4</span>) "," <span class="id">reference</span>(<span class="id">F5</span>) 
 "," <span class="id">reference</span>(<span class="id">F6</span>) "," <span class="id">reference</span>(<span class="id">F7</span>) "," <span class="id">reference</span>(<span class="id">F8</span>) :=
  <span class="tactic">unfold</span> <span class="id">F1</span>,<span class="id">F2</span>,<span class="id">F3</span>,<span class="id">F4</span>,<span class="id">F5</span>,<span class="id">F6</span>,<span class="id">F7</span>,<span class="id">F8</span> <span class="kwd">in</span> *.

(** [<span class="id">folds</span> <span class="id">P1</span>,..,<span class="id">PN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shortcut</span> <span class="kwd">for</span> [<span class="id">fold</span> <span class="id">P1</span> <span class="kwd">in</span> *; ..; <span class="id">fold</span> <span class="id">PN</span> <span class="kwd">in</span> *]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">folds</span>" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="id">fold</span> <span class="id">H</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">folds</span>" <span class="id">constr</span>(<span class="id">H1</span>) "," <span class="id">constr</span>(<span class="id">H2</span>) :=
  <span class="id">folds</span> <span class="id">H1</span>; <span class="id">folds</span> <span class="id">H2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">folds</span>" <span class="id">constr</span>(<span class="id">H1</span>) "," <span class="id">constr</span>(<span class="id">H2</span>) "," <span class="id">constr</span>(<span class="id">H3</span>) :=
  <span class="id">folds</span> <span class="id">H1</span>; <span class="id">folds</span> <span class="id">H2</span>; <span class="id">folds</span> <span class="id">H3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">folds</span>" <span class="id">constr</span>(<span class="id">H1</span>) "," <span class="id">constr</span>(<span class="id">H2</span>) "," <span class="id">constr</span>(<span class="id">H3</span>)
 "," <span class="id">constr</span>(<span class="id">H4</span>) :=
  <span class="id">folds</span> <span class="id">H1</span>; <span class="id">folds</span> <span class="id">H2</span>; <span class="id">folds</span> <span class="id">H3</span>; <span class="id">folds</span> <span class="id">H4</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">folds</span>" <span class="id">constr</span>(<span class="id">H1</span>) "," <span class="id">constr</span>(<span class="id">H2</span>) "," <span class="id">constr</span>(<span class="id">H3</span>)
 "," <span class="id">constr</span>(<span class="id">H4</span>) "," <span class="id">constr</span>(<span class="id">H5</span>) :=
  <span class="id">folds</span> <span class="id">H1</span>; <span class="id">folds</span> <span class="id">H2</span>; <span class="id">folds</span> <span class="id">H3</span>; <span class="id">folds</span> <span class="id">H4</span>; <span class="id">folds</span> <span class="id">H5</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Simplification</span> *)

(** [<span class="id">simpls</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shortcut</span> <span class="kwd">for</span> [<span class="tactic">simpl</span> <span class="kwd">in</span> *]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" :=
  <span class="tactic">simpl</span> <span class="kwd">in</span> *.

(** [<span class="id">simpls</span> <span class="id">P1</span>,..,<span class="id">PN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shortcut</span> <span class="kwd">for</span> 
    [<span class="tactic">simpl</span> <span class="id">P1</span> <span class="kwd">in</span> *; ..; <span class="tactic">simpl</span> <span class="id">PN</span> <span class="kwd">in</span> *]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" <span class="id">reference</span>(<span class="id">F1</span>) :=
  <span class="tactic">simpl</span> <span class="id">F1</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) :=
  <span class="id">simpls</span> <span class="id">F1</span>; <span class="id">simpls</span> <span class="id">F2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) :=
  <span class="id">simpls</span> <span class="id">F1</span>; <span class="id">simpls</span> <span class="id">F2</span>; <span class="id">simpls</span> <span class="id">F3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) 
 "," <span class="id">reference</span>(<span class="id">F3</span>) "," <span class="id">reference</span>(<span class="id">F4</span>) :=
  <span class="id">simpls</span> <span class="id">F1</span>; <span class="id">simpls</span> <span class="id">F2</span>; <span class="id">simpls</span> <span class="id">F3</span>; <span class="id">simpls</span> <span class="id">F4</span>.

(** [<span class="id">unsimpl</span> <span class="id">E</span>] <span class="id">replaces</span> <span class="id">all</span> <span class="id">occurence</span> <span class="id">of</span> [<span class="id">X</span>] <span class="tactic">by</span> [<span class="id">E</span>], <span class="kwd">where</span> [<span class="id">X</span>] <span class="id">is</span> 
   <span class="id">the</span> <span class="id">result</span> <span class="id">which</span> <span class="id">the</span> <span class="id">tactic</span> [<span class="tactic">simpl</span>] <span class="id">would</span> <span class="id">give</span> <span class="id">when</span> <span class="id">applied</span> <span class="id">to</span> [<span class="id">E</span>]. 
   <span class="id">It</span> <span class="id">is</span> <span class="id">useful</span> <span class="id">to</span> <span class="id">undo</span> <span class="id">what</span> [<span class="tactic">simpl</span>] <span class="id">has</span> <span class="id">simplified</span> <span class="id">too</span> <span class="id">far</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unsimpl</span>" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="kwd">let</span> <span class="id">F</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">E</span>) <span class="kwd">in</span> <span class="id">change</span> <span class="id">F</span> <span class="kwd">with</span> <span class="id">E</span>.

(** [<span class="id">unsimpl</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">unsimpl</span> <span class="id">E</span>] <span class="id">but</span> <span class="id">it</span> <span class="id">applies</span>
    <span class="id">inside</span> <span class="id">a</span> <span class="id">particular</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unsimpl</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="kwd">let</span> <span class="id">F</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">E</span>) <span class="kwd">in</span> <span class="id">change</span> <span class="id">F</span> <span class="kwd">with</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.

(** [<span class="id">unsimpl</span> <span class="id">E</span> <span class="kwd">in</span> *] <span class="id">applies</span> [<span class="id">unsimpl</span> <span class="id">E</span>] <span class="id">everywhere</span> <span class="id">possible</span>.
    [<span class="id">unsimpls</span> <span class="id">E</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">synonymous</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unsimpl</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" := 
  <span class="kwd">let</span> <span class="id">F</span> := (<span class="id">eval</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">E</span>) <span class="kwd">in</span> <span class="id">change</span> <span class="id">F</span> <span class="kwd">with</span> <span class="id">E</span> <span class="kwd">in</span> *.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unsimpls</span>" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">unsimpl</span> <span class="id">E</span> <span class="kwd">in</span> *.

(** [<span class="id">nosimpl</span> <span class="id">t</span>] <span class="id">protects</span> <span class="id">the</span> <span class="id">Coq</span> <span class="id">term</span>[<span class="id">t</span>] <span class="id">against</span> <span class="id">some</span> <span class="id">forms</span> <span class="id">of</span> 
    <span class="id">simplification</span>. <span class="id">See</span> <span class="id">Gonthier</span>'<span class="id">s</span> <span class="id">work</span> <span class="kwd">for</span> <span class="id">details</span> <span class="id">on</span> <span class="id">this</span> <span class="id">trick</span>. *)

<span class="kwd">Notation</span> "'<span class="id">nosimpl</span>' <span class="id">t</span>" := (<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> =&gt; <span class="id">t</span> <span class="kwd">end</span>)
  (<span class="tactic">at</span> <span class="id">level</span> 10).


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Evaluation</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hnfs</span>" := <span class="id">hnf</span> <span class="kwd">in</span> *.

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Substitution</span> *)

(** [<span class="id">substs</span>] <span class="id">does</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">subst</span>], <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="tactic">fail</span>
    <span class="id">when</span> <span class="id">there</span> <span class="id">are</span> <span class="id">circular</span> <span class="id">equalities</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">substs</span>" :=
  <span class="tactic">repeat</span> (<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">x</span> = ?<span class="id">y</span> |- <span class="id">_</span> =&gt; 
            <span class="id">first</span> [ <span class="tactic">subst</span> <span class="id">x</span> | <span class="tactic">subst</span> <span class="id">y</span> ] <span class="kwd">end</span>).

(** <span class="id">Implementation</span> <span class="id">of</span> [<span class="id">substs</span> <span class="id">below</span>], <span class="id">which</span> <span class="id">allows</span> <span class="id">to</span> <span class="id">call</span>
    [<span class="tactic">subst</span>] <span class="id">on</span> <span class="id">all</span> <span class="id">the</span> <span class="id">hypotheses</span> <span class="id">that</span> <span class="id">lie</span> <span class="id">beyond</span> <span class="id">a</span> <span class="id">given</span>
    <span class="id">position</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">proof</span> <span class="id">context</span>. *)

<span class="kwd">Ltac</span> <span class="id">substs_below</span> <span class="id">limit</span> := 
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt;
  <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>
  | <span class="id">limit</span> =&gt; <span class="id">idtac</span>
  | ?<span class="id">x</span> = ?<span class="id">y</span> =&gt; 
    <span class="id">first</span> [ <span class="tactic">subst</span> <span class="id">x</span>; <span class="id">substs_below</span> <span class="id">limit</span>
          | <span class="tactic">subst</span> <span class="id">y</span>; <span class="id">substs_below</span> <span class="id">limit</span>
          | <span class="id">generalizes</span> <span class="id">H</span>; <span class="id">substs_below</span> <span class="id">limit</span>; <span class="tactic">intro</span> ]  
  <span class="kwd">end</span> <span class="kwd">end</span>.

(** [<span class="id">substs</span> <span class="id">below</span> <span class="id">body</span> <span class="id">E</span>] <span class="id">applies</span> [<span class="tactic">subst</span>] <span class="id">on</span> <span class="id">all</span> <span class="id">equalities</span> <span class="id">that</span> <span class="id">appear</span>
    <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span> <span class="id">below</span> <span class="id">the</span> <span class="id">first</span> <span class="id">hypothesis</span> <span class="id">whose</span> <span class="id">body</span> <span class="id">is</span> [<span class="id">E</span>].
    <span class="id">If</span> <span class="id">there</span> <span class="id">is</span> <span class="id">no</span> <span class="id">such</span> <span class="id">hypothesis</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span>, <span class="id">it</span> <span class="id">is</span> <span class="id">equivalent</span>
    <span class="id">to</span> [<span class="tactic">subst</span>]. <span class="id">For</span> <span class="id">instance</span>, <span class="kwd">if</span> [<span class="id">H</span>] <span class="id">is</span> <span class="id">an</span> <span class="id">hypothesis</span>, <span class="kwd">then</span> 
    [<span class="id">substs</span> <span class="id">below</span> <span class="id">H</span>] <span class="id">will</span> <span class="id">substitute</span> <span class="id">equalities</span> <span class="id">below</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">substs</span>" "<span class="id">below</span>" "<span class="id">body</span>" <span class="id">constr</span>(<span class="id">M</span>) :=
  <span class="id">substs_below</span> <span class="id">M</span>.

(** [<span class="id">substs</span> <span class="id">below</span> <span class="id">H</span>] <span class="id">applies</span> [<span class="tactic">subst</span>] <span class="id">on</span> <span class="id">all</span> <span class="id">equalities</span> <span class="id">that</span> <span class="id">appear</span>
    <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span> <span class="id">below</span> <span class="id">the</span> <span class="id">hypothesis</span> <span class="id">named</span> [<span class="id">H</span>]. <span class="id">Note</span> <span class="id">that</span> 
    <span class="id">the</span> <span class="id">current</span> <span class="id">implementation</span> <span class="id">is</span> <span class="id">technically</span> <span class="id">incorrect</span> <span class="id">since</span> <span class="id">it</span>
    <span class="id">will</span> <span class="id">confuse</span> <span class="id">different</span> <span class="id">hypotheses</span> <span class="kwd">with</span> <span class="id">the</span> <span class="id">same</span> <span class="id">body</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">substs</span>" "<span class="id">below</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> ?<span class="id">M</span> =&gt; <span class="id">substs</span> <span class="id">below</span> <span class="id">body</span> <span class="id">M</span> <span class="kwd">end</span>.

(** [<span class="id">subst_hyp</span> <span class="id">H</span>] <span class="id">substitutes</span> <span class="id">the</span> <span class="id">equality</span> <span class="id">contained</span> <span class="kwd">in</span> [<span class="id">H</span>].
    <span class="id">The</span> <span class="id">behaviour</span> <span class="id">is</span> <span class="id">extended</span> <span class="kwd">in</span> <span class="id">LibData</span> --<span class="id">TODO</span> *)

<span class="kwd">Ltac</span> <span class="id">subst_hyp_base</span> <span class="id">H</span> :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> 
  | ?<span class="id">x</span> = ?<span class="id">y</span> =&gt; <span class="id">first</span> [ <span class="tactic">subst</span> <span class="id">x</span> | <span class="tactic">subst</span> <span class="id">y</span> ] 
  <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">subst_hyp</span>" <span class="id">hyp</span>(<span class="id">H</span>) := <span class="id">subst_hyp_base</span> <span class="id">H</span>.

(** [<span class="id">intro_subst</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> [<span class="tactic">intro</span> <span class="id">H</span>; <span class="id">subst_hyp</span> <span class="id">H</span>]:
    <span class="id">it</span> <span class="id">introduces</span> <span class="id">and</span> <span class="id">substitutes</span> <span class="id">the</span> <span class="id">equality</span> <span class="tactic">at</span> <span class="id">the</span> <span class="id">head</span>
    <span class="id">of</span> <span class="id">the</span> <span class="id">current</span> <span class="id">goal</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intro_subst</span>" := 
  <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> <span class="tactic">intros</span> <span class="id">H</span>; <span class="id">subst_hyp</span> <span class="id">H</span>.

(** [<span class="id">subst_local</span>] <span class="id">substitutes</span> <span class="id">all</span> <span class="id">local</span> <span class="id">definition</span> <span class="id">from</span> <span class="id">the</span> <span class="id">context</span> *)

<span class="kwd">Ltac</span> <span class="id">subst_local</span> :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>:=<span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">subst</span> <span class="id">H</span> <span class="kwd">end</span>.

(** [<span class="id">subst_eq</span> <span class="id">E</span>] <span class="id">takes</span> <span class="id">an</span> <span class="id">equality</span> [<span class="id">x</span> = <span class="id">t</span>] <span class="id">and</span> <span class="tactic">replace</span> [<span class="id">x</span>]
    <span class="kwd">with</span> [<span class="id">t</span>] <span class="id">everywhere</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> *)

<span class="kwd">Ltac</span> <span class="id">subst_eq_base</span> <span class="id">E</span> :=
  <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> <span class="id">lets</span> <span class="id">H</span>: <span class="id">E</span>; <span class="id">subst_hyp</span> <span class="id">H</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">subst_eq</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">subst_eq_base</span> <span class="id">E</span>. 


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Tactics</span> <span class="id">to</span> <span class="id">work</span> <span class="kwd">with</span> <span class="id">proof</span> <span class="id">irrelevance</span> *)

<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html">ProofIrrelevance</a></span>.

(** [<span class="id">pi_rewrite</span> <span class="id">E</span>] <span class="id">replaces</span> [<span class="id">E</span>] <span class="id">of</span> <span class="id">type</span> [<span class="kwd">Prop</span>] <span class="kwd">with</span> <span class="id">a</span> <span class="tactic">fresh</span> 
    <span class="id">unification</span> <span class="id">variable</span>, <span class="id">and</span> <span class="id">is</span> <span class="id">thus</span> <span class="id">a</span> <span class="id">practical</span> <span class="id">way</span> <span class="id">to</span>
    <span class="id">exploit</span> <span class="id">proof</span> <span class="id">irrelevance</span>, <span class="id">without</span> <span class="id">writing</span> <span class="id">explicitly</span>
    [<span class="tactic">rewrite</span> (<span class="id">proof_irrelevance</span> <span class="id">E</span> <span class="id">E</span>')]. <span class="id">Particularly</span> <span class="id">useful</span>
    <span class="id">when</span> [<span class="id">E</span>'] <span class="id">is</span> <span class="id">a</span> <span class="id">big</span> <span class="id">expression</span>. *)

<span class="kwd">Ltac</span> <span class="id">pi_rewrite_base</span> <span class="id">E</span> <span class="id">rewrite_tac</span> :=
  <span class="kwd">let</span> <span class="id">E</span>' := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">T</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">evar</span> (<span class="id">E</span>':<span class="id">T</span>);
  <span class="id">rewrite_tac</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html#proof_irrelevance">proof_irrelevance</a></span> <span class="id">_</span> <span class="id">E</span> <span class="id">E</span>'); <span class="tactic">subst</span> <span class="id">E</span>'.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">pi_rewrite</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">pi_rewrite_base</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="tactic">rewrite</span> <span class="id">X</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">pi_rewrite</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">pi_rewrite_base</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="tactic">rewrite</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">H</span>).


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Proving</span> <span class="id">equalities</span> *)

(** [<span class="id">fequal</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">variation</span> <span class="id">on</span> [<span class="tactic">f_equal</span>] <span class="id">which</span> <span class="id">has</span> <span class="id">a</span> <span class="id">better</span> <span class="id">behaviour</span>
    <span class="id">on</span> <span class="id">equalities</span> <span class="id">between</span> <span class="id">n</span>-<span class="id">ary</span> <span class="id">tuples</span>. *)

<span class="kwd">Ltac</span> <span class="id">fequal_base</span> :=
  <span class="kwd">let</span> <span class="id">go</span> := <span class="tactic">f_equal</span>; [ <span class="id">fequal_base</span> | ] <span class="kwd">in</span>
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) = (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) =&gt; <span class="id">go</span>
  | |- (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) = (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) =&gt; <span class="id">go</span>
  | |- (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) = (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) =&gt; <span class="id">go</span>
  | |- (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) = (<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>,<span class="id">_</span>) =&gt; <span class="id">go</span>
  | |- <span class="id">_</span> =&gt; <span class="tactic">f_equal</span>
  <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequal</span>" :=
  <span class="id">fequal_base</span>.

(** [<span class="id">fequals</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">fequal</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">tries</span> <span class="id">and</span> <span class="id">solve</span>
    <span class="id">all</span> <span class="tactic">trivial</span> <span class="id">subgoals</span>, <span class="kwd">using</span> [<span class="tactic">reflexivity</span>] <span class="id">and</span> [<span class="tactic">congruence</span>]
    (<span class="kwd">as</span> <span class="id">well</span> <span class="kwd">as</span> <span class="id">the</span> <span class="id">proof</span>-<span class="id">irrelevance</span> <span class="id">principle</span>).
    [<span class="id">fequals</span>] <span class="id">applies</span> <span class="id">to</span> <span class="id">goals</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">f</span> <span class="id">x1</span> .. <span class="id">xN</span> = <span class="id">f</span> <span class="id">y1</span> .. <span class="id">yN</span>]
    <span class="id">and</span> <span class="id">produces</span> <span class="id">some</span> <span class="id">subgoals</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">xi</span> = <span class="id">yi</span>]). *)

<span class="kwd">Ltac</span> <span class="id">fequal_post</span> :=
  <span class="id">first</span> [ <span class="tactic">reflexivity</span> | <span class="tactic">congruence</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html#proof_irrelevance">proof_irrelevance</a></span> | <span class="id">idtac</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequals</span>" :=
  <span class="id">fequal</span>; <span class="id">fequal_post</span>.

(** [<span class="id">fequals_rec</span>] <span class="id">calls</span> [<span class="id">fequals</span>] <span class="id">recursively</span>. 
    <span class="id">It</span> <span class="id">is</span> <span class="id">equivalent</span> <span class="id">to</span> [<span class="tactic">repeat</span> (<span class="tactic">progress</span> <span class="id">fequals</span>)]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequals_rec</span>" :=
  <span class="tactic">repeat</span> (<span class="tactic">progress</span> <span class="id">fequals</span>). 



(* ********************************************************************** *)
(** * <span class="id">Inversion</span> *)

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Basic</span> <span class="tactic">inversion</span> *)

(** [<span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">same</span> <span class="id">to</span> [<span class="tactic">inversion</span> <span class="id">H</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">puts</span> <span class="id">all</span> <span class="id">the</span>
    <span class="id">facts</span> <span class="id">obtained</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>. <span class="id">The</span> <span class="id">keyword</span> [<span class="id">keep</span>] <span class="id">means</span> <span class="id">that</span> <span class="id">the</span>
    <span class="id">hypothesis</span> [<span class="id">H</span>] <span class="id">should</span> <span class="id">not</span> <span class="id">be</span> <span class="id">removed</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">pose</span> <span class="id"><a href="LibTactics.html#ltac_mark">ltac_mark</a></span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="id">gen_until_mark</span>.

(** [<span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">inversion</span> <span class="id">H</span> <span class="kwd">as</span> ...] <span class="id">except</span>
    <span class="id">that</span> <span class="id">only</span> <span class="id">hypotheses</span> <span class="id">which</span> <span class="id">are</span> <span class="id">not</span> <span class="id">variable</span> <span class="id">need</span> <span class="id">to</span> <span class="id">be</span> <span class="id">named</span>
    <span class="id">explicitely</span>, <span class="kwd">in</span> <span class="id">a</span> <span class="id">similar</span> <span class="id">fashion</span> <span class="kwd">as</span> [<span class="id">introv</span>] <span class="id">is</span> <span class="id">used</span> <span class="id">to</span> <span class="id">name</span>
    <span class="id">only</span> <span class="id">hypotheses</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) :=
  <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>; <span class="id">introv</span> <span class="id">I1</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) :=
  <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>; <span class="id">introv</span> <span class="id">I1</span> <span class="id">I2</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) :=
  <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>; <span class="id">introv</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span>. 

(** [<span class="id">invert</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">same</span> <span class="id">to</span> [<span class="tactic">inversion</span> <span class="id">H</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">puts</span> <span class="id">all</span> <span class="id">the</span>
    <span class="id">facts</span> <span class="id">obtained</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">and</span> <span class="id">clears</span> <span class="id">hypothesis</span> [<span class="id">H</span>].
    <span class="id">In</span> <span class="id">other</span> <span class="id">words</span>, <span class="id">it</span> <span class="id">is</span> <span class="id">equivalent</span> <span class="id">to</span> [<span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.

(** [<span class="id">invert</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>]
    <span class="id">but</span> <span class="id">it</span> <span class="id">also</span> <span class="id">clears</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert_tactic</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">tactic</span>(<span class="id">tac</span>) :=
  <span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">H</span>'; <span class="id">tac</span> <span class="id">H</span>'; <span class="tactic">clear</span> <span class="id">H</span>'.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span>).


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Inversion</span> <span class="kwd">with</span> <span class="id">substitution</span> *)

(** <span class="id">Our</span> <span class="tactic">inversion</span> <span class="id">tactics</span> <span class="id">is</span> <span class="id">able</span> <span class="id">to</span> <span class="id">get</span> <span class="id">rid</span> <span class="id">of</span> <span class="tactic">dependent</span> <span class="id">equalities</span>
    <span class="id">generated</span> <span class="tactic">by</span> [<span class="tactic">inversion</span>], <span class="kwd">using</span> <span class="id">proof</span> <span class="id">irrelevance</span>. *)

(* --<span class="id">we</span> <span class="tactic">do</span> <span class="id">not</span> <span class="id">import</span> <span class="id">Eqdep</span> <span class="id">because</span> <span class="id">it</span> <span class="id">imports</span> <span class="id">nasty</span> <span class="id">hints</span> <span class="id">automatically</span> 
    <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Eqdep</span>. *)

<span class="kwd">Ltac</span> <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span> :=
  <span class="kwd">let</span> <span class="id">rec</span> <span class="id">go</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span> :=
    <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
    | |- (<span class="id"><a href="LibTactics.html#ltac_Mark">ltac_Mark</a></span> -&gt; <span class="id">_</span>) =&gt; <span class="tactic">intros</span> <span class="id">_</span>
    | |- (?<span class="id">x</span> = ?<span class="id">y</span> -&gt; <span class="id">_</span>) =&gt; <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">intro</span> <span class="id">H</span>; 
                           <span class="id">first</span> [ <span class="tactic">subst</span> <span class="id">x</span> | <span class="tactic">subst</span> <span class="id">y</span> ]; 
                           <span class="id">go</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span>
    | |- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> ?<span class="id">P</span> ?<span class="id">p</span> ?<span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> ?<span class="id">P</span> ?<span class="id">p</span> ?<span class="id">y</span> -&gt; <span class="id">_</span>) =&gt;
         <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">intro</span> <span class="id">H</span>; 
         <span class="tactic">generalize</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html#ProofIrrelevanceTheory.EqdepTheory.inj_pair2">inj_pair2</a></span> <span class="id">_</span> <span class="id">P</span> <span class="id">p</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>);
         <span class="tactic">clear</span> <span class="id">H</span>; <span class="id">go</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span>
    | |- (?<span class="id">P</span> -&gt; ?<span class="id">Q</span>) =&gt; <span class="id">i1</span>; <span class="id">go</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span> <span class="id">ltac</span>:(<span class="tactic">intro</span>)
    | |- (<span class="kwd">forall</span> <span class="id">_</span>, <span class="id">_</span>) =&gt; <span class="tactic">intro</span>; <span class="id">go</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span>
    <span class="kwd">end</span> <span class="kwd">in</span>
  <span class="tactic">generalize</span> <span class="id"><a href="LibTactics.html#ltac_mark">ltac_mark</a></span>; <span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>; <span class="id">go</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">i4</span> <span class="id">i5</span> <span class="id">i6</span>;
  <span class="tactic">unfold</span> <span class="id">eq</span>' <span class="kwd">in</span> *.

(** [<span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">same</span> <span class="id">to</span> [<span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> 
    <span class="id">applies</span> [<span class="tactic">subst</span>] <span class="id">to</span> <span class="id">all</span> <span class="id">the</span> <span class="id">equalities</span> <span class="id">generated</span> <span class="tactic">by</span> <span class="id">the</span> <span class="tactic">inversion</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) 
                   <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>).

(** [<span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span>
    [<span class="id">invert</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">applies</span> [<span class="tactic">subst</span>] <span class="id">to</span> <span class="id">all</span> <span class="id">the</span> 
    <span class="id">equalities</span> <span class="id">generated</span> <span class="tactic">by</span> <span class="id">the</span> <span class="tactic">inversion</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I1</span>) 
   <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I1</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I2</span>)
   <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I1</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I2</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I3</span>)
   <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I1</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I2</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I3</span>)
   <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I4</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I5</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I1</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I2</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I3</span>)
   <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I4</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I5</span>) <span class="id">ltac</span>:(<span class="tactic">intro</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I5</span>) <span class="id">simple_intropattern</span>(<span class="id">I6</span>) :=
  <span class="id">inverts_tactic</span> <span class="id">H</span> <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I1</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I2</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I3</span>)
   <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I4</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I5</span>) <span class="id">ltac</span>:(<span class="tactic">intros</span> <span class="id">I6</span>).

(** [<span class="id">inverts</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">same</span> <span class="id">to</span> [<span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> 
    <span class="id">clears</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.

(** [<span class="id">inverts</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>]
    <span class="id">but</span> <span class="id">it</span> <span class="id">also</span> <span class="id">clears</span> <span class="id">the</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts_tactic</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">tactic</span>(<span class="id">tac</span>) :=
  <span class="kwd">let</span> <span class="id">H</span>' := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">rename</span> <span class="id">H</span> <span class="id">into</span> <span class="id">H</span>'; <span class="id">tac</span> <span class="id">H</span>'; <span class="tactic">clear</span> <span class="id">H</span>'.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I5</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I5</span>) <span class="id">simple_intropattern</span>(<span class="id">I6</span>) :=
  <span class="id">invert_tactic</span> <span class="id">H</span> (<span class="kwd">fun</span> <span class="id">H</span> =&gt; <span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span>).

(** [<span class="id">inverts</span> <span class="id">H</span> <span class="kwd">as</span>] <span class="id">performs</span> <span class="id">an</span> <span class="tactic">inversion</span> <span class="id">on</span> <span class="id">hypothesis</span> [<span class="id">H</span>], <span class="id">substitutes</span>
    <span class="id">generated</span> <span class="id">equalities</span>, <span class="id">and</span> <span class="id">put</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">the</span> <span class="id">other</span> <span class="id">freshly</span>-<span class="id">created</span>
    <span class="id">hypotheses</span>, <span class="kwd">for</span> <span class="id">the</span> <span class="id">user</span> <span class="id">to</span> <span class="id">name</span> <span class="id">explicitly</span>. 
    [<span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span> <span class="kwd">as</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="tactic">clear</span> [<span class="id">H</span>].
    --<span class="id">TODO</span>: <span class="id">reimplement</span> [<span class="id">inverts</span>] <span class="id">above</span> <span class="kwd">using</span> <span class="id">this</span> <span class="id">one</span> *)

<span class="kwd">Ltac</span> <span class="id">inverts_as_tactic</span> <span class="id">H</span> :=
  <span class="kwd">let</span> <span class="id">rec</span> <span class="id">go</span> <span class="id">tt</span> :=
    <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
    | |- (<span class="id"><a href="LibTactics.html#ltac_Mark">ltac_Mark</a></span> -&gt; <span class="id">_</span>) =&gt; <span class="tactic">intros</span> <span class="id">_</span>
    | |- (?<span class="id">x</span> = ?<span class="id">y</span> -&gt; <span class="id">_</span>) =&gt; <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> <span class="tactic">intro</span> <span class="id">H</span>; 
                           <span class="id">first</span> [ <span class="tactic">subst</span> <span class="id">x</span> | <span class="tactic">subst</span> <span class="id">y</span> ]; 
                           <span class="id">go</span> <span class="id">tt</span>
    | |- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> ?<span class="id">P</span> ?<span class="id">p</span> ?<span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> ?<span class="id">P</span> ?<span class="id">p</span> ?<span class="id">y</span> -&gt; <span class="id">_</span>) =&gt;
         <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">intro</span> <span class="id">H</span>; 
         <span class="tactic">generalize</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html#ProofIrrelevanceTheory.EqdepTheory.inj_pair2">inj_pair2</a></span> <span class="id">_</span> <span class="id">P</span> <span class="id">p</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>);
         <span class="tactic">clear</span> <span class="id">H</span>; <span class="id">go</span> <span class="id">tt</span>
    | |- (<span class="kwd">forall</span> <span class="id">_</span>, <span class="id">_</span>) =&gt; 
       <span class="tactic">intro</span>; <span class="kwd">let</span> <span class="id">H</span> := <span class="id">get_last_hyp</span> <span class="id">tt</span> <span class="kwd">in</span> <span class="id">mark_to_generalize</span> <span class="id">H</span>; <span class="id">go</span> <span class="id">tt</span>
    <span class="kwd">end</span> <span class="kwd">in</span>
  <span class="id">pose</span> <span class="id"><a href="LibTactics.html#ltac_mark">ltac_mark</a></span>; <span class="tactic">inversion</span> <span class="id">H</span>; 
  <span class="tactic">generalize</span> <span class="id"><a href="LibTactics.html#ltac_mark">ltac_mark</a></span>; <span class="id">gen_until_mark</span>; 
  <span class="id">go</span> <span class="id">tt</span>; <span class="id">gen_to_generalize</span>; <span class="id">unfolds</span> <span class="id">ltac_to_generalize</span>;
  <span class="tactic">unfold</span> <span class="id">eq</span>' <span class="kwd">in</span> *.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" :=
  <span class="id">inverts_as_tactic</span> <span class="id">H</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" :=
  <span class="id">inverts_as_tactic</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I5</span>) <span class="id">simple_intropattern</span>(<span class="id">I6</span>) <span class="id">simple_intropattern</span>(<span class="id">I7</span>) :=
  <span class="id">inverts</span> <span class="id">H</span> <span class="kwd">as</span>; <span class="id">introv</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span> <span class="id">I7</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I1</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I2</span>) <span class="id">simple_intropattern</span>(<span class="id">I3</span>) <span class="id">simple_intropattern</span>(<span class="id">I4</span>) 
 <span class="id">simple_intropattern</span>(<span class="id">I5</span>) <span class="id">simple_intropattern</span>(<span class="id">I6</span>) <span class="id">simple_intropattern</span>(<span class="id">I7</span>)
 <span class="id">simple_intropattern</span>(<span class="id">I8</span>) :=
  <span class="id">inverts</span> <span class="id">H</span> <span class="kwd">as</span>; <span class="id">introv</span> <span class="id">I1</span> <span class="id">I2</span> <span class="id">I3</span> <span class="id">I4</span> <span class="id">I5</span> <span class="id">I6</span> <span class="id">I7</span> <span class="id">I8</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Injection</span> <span class="kwd">with</span> <span class="id">substitution</span> *)

(** <span class="id">Underlying</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">injects</span>] *)

<span class="kwd">Ltac</span> <span class="id">injects_tactic</span> <span class="id">H</span> :=
  <span class="kwd">let</span> <span class="id">rec</span> <span class="id">go</span> <span class="id">_</span> :=
    <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
    | |- (<span class="id"><a href="LibTactics.html#ltac_Mark">ltac_Mark</a></span> -&gt; <span class="id">_</span>) =&gt; <span class="tactic">intros</span> <span class="id">_</span>
    | |- (?<span class="id">x</span> = ?<span class="id">y</span> -&gt; <span class="id">_</span>) =&gt; <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="tactic">intro</span> <span class="id">H</span>; 
                           <span class="id">first</span> [ <span class="tactic">subst</span> <span class="id">x</span> | <span class="tactic">subst</span> <span class="id">y</span> | <span class="id">idtac</span> ]; 
                           <span class="id">go</span> <span class="id">tt</span>
    <span class="kwd">end</span> <span class="kwd">in</span>
  <span class="tactic">generalize</span> <span class="id"><a href="LibTactics.html#ltac_mark">ltac_mark</a></span>; <span class="tactic">injection</span> <span class="id">H</span>; <span class="id">go</span> <span class="id">tt</span>.

(** [<span class="id">injects</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">takes</span> <span class="id">an</span> <span class="id">hypothesis</span> [<span class="id">H</span>] <span class="id">of</span> <span class="id">the</span> <span class="id">form</span>
    [<span class="id">C</span> <span class="id">a1</span> .. <span class="id">aN</span> = <span class="id">C</span> <span class="id">b1</span> .. <span class="id">bN</span>] <span class="id">and</span> <span class="id">substitute</span> <span class="id">all</span> <span class="id">equalities</span>
    [<span class="id">ai</span> = <span class="id">bi</span>] <span class="id">that</span> <span class="id">have</span> <span class="id">been</span> <span class="id">generated</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">injects</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">injects_tactic</span> <span class="id">H</span>.

(** [<span class="id">injects</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">injects</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">but</span> <span class="id">clears</span> 
    <span class="id">the</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">injects</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">injects_tactic</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.

(** [<span class="id">inject</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">injection</span>]
    <span class="id">followed</span> <span class="tactic">by</span> [<span class="tactic">intros</span> <span class="id">X1</span> .. <span class="id">XN</span>] *)
   
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inject</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inject</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">X1</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">X1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inject</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">X1</span> <span class="id">X2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inject</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inject</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) 
 <span class="id">ident</span>(<span class="id">X4</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inject</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) 
 <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Inversion</span> <span class="id">and</span> <span class="tactic">injection</span> <span class="kwd">with</span> <span class="id">substitution</span> --<span class="id">rough</span> <span class="id">implementation</span> *)

(** <span class="id">The</span> <span class="id">tactics</span> [<span class="id">inversions</span>] <span class="id">and</span> [<span class="id">injections</span>] <span class="id">provided</span> <span class="kwd">in</span> <span class="id">this</span> <span class="id">section</span>
    <span class="id">are</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">inverts</span>] <span class="id">and</span> [<span class="id">injects</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">they</span> <span class="id">perform</span>
    <span class="id">substitution</span> <span class="id">on</span> <span class="id">all</span> <span class="id">equalities</span> <span class="id">from</span> <span class="id">the</span> <span class="id">context</span> <span class="id">and</span> <span class="id">not</span> <span class="id">only</span>
    <span class="id">the</span> <span class="id">ones</span> <span class="id">freshly</span> <span class="id">generated</span>. <span class="id">The</span> <span class="id">counterpart</span> <span class="id">is</span> <span class="id">that</span> <span class="id">they</span> <span class="id">have</span>
    <span class="id">simpler</span> <span class="id">implementations</span>. *)

(** [<span class="id">inversions</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">inversions</span> <span class="id">H</span>] <span class="id">but</span> <span class="id">it</span> <span class="id">does</span>
    <span class="id">not</span> <span class="tactic">clear</span> <span class="id">hypothesis</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inversions</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.

(** [<span class="id">inversions</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shortcut</span> <span class="kwd">for</span> [<span class="tactic">inversion</span> <span class="id">H</span>] <span class="id">followed</span> <span class="tactic">by</span> [<span class="tactic">subst</span>]
    <span class="id">and</span> [<span class="tactic">clear</span> <span class="id">H</span>].
    <span class="id">It</span> <span class="id">is</span> <span class="id">a</span> <span class="id">rough</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">inverts</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">which</span> <span class="id">behave</span>
    <span class="id">badly</span> <span class="id">when</span> <span class="id">the</span> <span class="id">proof</span> <span class="id">context</span> <span class="id">already</span> <span class="id">contains</span> <span class="id">equalities</span>. 
    <span class="id">It</span> <span class="id">is</span> <span class="id">provided</span> <span class="kwd">in</span> <span class="tactic">case</span> <span class="id">the</span> <span class="id">better</span> <span class="id">implementation</span> <span class="id">turns</span> <span class="id">out</span> <span class="id">to</span> <span class="id">be</span>
    <span class="id">too</span> <span class="id">slow</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inversions</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">H</span>.

(** [<span class="id">injections</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">injection</span> <span class="id">H</span>] <span class="id">followed</span>
    <span class="tactic">by</span> [<span class="tactic">intros</span>] <span class="id">and</span> [<span class="tactic">subst</span>]. <span class="id">It</span> <span class="id">is</span> <span class="id">a</span> <span class="id">rough</span> <span class="id">implementation</span> <span class="id">of</span> 
    [<span class="id">injects</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">which</span> <span class="id">behave</span>
    <span class="id">badly</span> <span class="id">when</span> <span class="id">the</span> <span class="id">proof</span> <span class="id">context</span> <span class="id">already</span> <span class="id">contains</span> <span class="id">equalities</span>,
    <span class="id">or</span> <span class="id">when</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">starts</span> <span class="kwd">with</span> <span class="id">a</span> <span class="kwd">forall</span> <span class="id">or</span> <span class="id">an</span> <span class="id">implication</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">injections</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.

(** [<span class="id">injections</span> <span class="id">H</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="tactic">injection</span> <span class="id">H</span>] <span class="id">followed</span>
    <span class="tactic">by</span> [<span class="tactic">intros</span>] <span class="id">and</span> [<span class="tactic">clear</span> <span class="id">H</span>] <span class="id">and</span> [<span class="tactic">subst</span>]. <span class="id">It</span> <span class="id">is</span> <span class="id">a</span> <span class="id">rough</span> 
    <span class="id">implementation</span> <span class="id">of</span> [<span class="id">injects</span> <span class="id">keep</span> <span class="id">H</span>] <span class="id">which</span> <span class="id">behave</span>
    <span class="id">badly</span> <span class="id">when</span> <span class="id">the</span> <span class="id">proof</span> <span class="id">context</span> <span class="id">already</span> <span class="id">contains</span> <span class="id">equalities</span>,
    <span class="id">or</span> <span class="id">when</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">starts</span> <span class="kwd">with</span> <span class="id">a</span> <span class="kwd">forall</span> <span class="id">or</span> <span class="id">an</span> <span class="id">implication</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">injections</span>" "<span class="id">keep</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Case</span> <span class="id">analysis</span> *)

(** [<span class="id">cases</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">case_eq</span> <span class="id">E</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">generates</span> <span class="id">the</span>
    <span class="id">equality</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span> <span class="id">and</span> <span class="id">not</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>, <span class="id">and</span> <span class="id">generates</span> <span class="id">the</span>
    <span class="id">equality</span> <span class="id">the</span> <span class="id">other</span> <span class="id">way</span> <span class="id">round</span>. <span class="id">The</span> <span class="id">syntax</span> [<span class="id">cases</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>]
    <span class="id">allows</span> <span class="id">specifying</span> <span class="id">the</span> <span class="id">name</span> [<span class="id">H</span>] <span class="id">of</span> <span class="id">that</span> <span class="id">hypothesis</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> 
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *; <span class="id">def_to_eq_sym</span> <span class="id">X</span> <span class="id">H</span> <span class="id">E</span>;
  <span class="tactic">destruct</span> <span class="id">X</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="kwd">let</span> <span class="id">x</span> := <span class="tactic">fresh</span> "<span class="id">Eq</span>" <span class="kwd">in</span> <span class="id">cases</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>.

(** [<span class="id">case_if_post</span>] <span class="id">is</span> <span class="id">to</span> <span class="id">be</span> <span class="id">defined</span> <span class="id">later</span> <span class="kwd">as</span> <span class="id">a</span> <span class="id">tactic</span> <span class="id">to</span> <span class="id">clean</span>
    <span class="id">up</span> <span class="id">goals</span>. *)

<span class="kwd">Ltac</span> <span class="id">case_if_post</span> := <span class="id">idtac</span>.

(** [<span class="id">case_if</span>] <span class="id">looks</span> <span class="kwd">for</span> <span class="id">a</span> <span class="tactic">pattern</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> ?<span class="id">E1</span> <span class="kwd">else</span> ?<span class="id">E2</span>]
    <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>, <span class="id">and</span> <span class="id">perform</span> <span class="id">a</span> <span class="tactic">case</span> <span class="id">analysis</span> <span class="id">on</span> [<span class="id">B</span>] <span class="tactic">by</span> <span class="id">calling</span> 
    [<span class="tactic">destruct</span> <span class="id">B</span>]. <span class="id">It</span> <span class="id">looks</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">first</span>, <span class="id">and</span> <span class="id">otherwise</span> <span class="kwd">in</span> <span class="id">the</span>
    <span class="id">first</span> <span class="id">hypothesis</span> <span class="id">that</span> <span class="id">contains</span> <span class="id">and</span> [<span class="kwd">if</span>] <span class="id">statement</span>. 
    [<span class="id">case_if</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">specify</span> <span class="id">which</span> <span class="id">hypothesis</span> <span class="id">to</span> <span class="id">consider</span>. 
    <span class="id">Syntaxes</span> [<span class="id">case_if</span> <span class="kwd">as</span> <span class="id">Eq</span>] <span class="id">and</span> [<span class="id">case_if</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Eq</span>] <span class="id">allows</span> <span class="id">to</span> <span class="id">name</span>
    <span class="id">the</span> <span class="id">hypothesis</span> <span class="id">coming</span> <span class="id">from</span> <span class="id">the</span> <span class="tactic">case</span> <span class="id">analysis</span>. *)

<span class="kwd">Ltac</span> <span class="id">case_if_on_tactic</span> <span class="id">E</span> <span class="id">Eq</span> :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span>
  | {<span class="id">_</span>}+{<span class="id">_</span>} =&gt; <span class="tactic">destruct</span> <span class="id">E</span> <span class="kwd">as</span> [<span class="id">Eq</span> | <span class="id">Eq</span>]
  | <span class="id">_</span> =&gt; <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> 
         <span class="id">sets_eq</span> &lt;- <span class="id">X</span> <span class="id">Eq</span>: <span class="id">E</span>;
         <span class="tactic">destruct</span> <span class="id">X</span>
  <span class="kwd">end</span>; <span class="id">case_if_post</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if_on</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="id">case_if_on_tactic</span> <span class="id">E</span> <span class="id">Eq</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
  | |- <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; <span class="id">case_if_on</span> <span class="id">B</span> <span class="kwd">as</span> <span class="id">Eq</span>
  | <span class="id">K</span>: <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt; <span class="id">case_if_on</span> <span class="id">B</span> <span class="kwd">as</span> <span class="id">Eq</span>
  <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; 
    <span class="id">case_if_on</span> <span class="id">B</span> <span class="kwd">as</span> <span class="id">Eq</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">case_if</span> <span class="kwd">as</span> <span class="id">Eq</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">case_if</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Eq</span>.


(** [<span class="id">cases_if</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">case_if</span>] <span class="kwd">with</span> <span class="id">two</span> <span class="id">main</span> <span class="id">differences</span>:
    <span class="kwd">if</span> <span class="id">it</span> <span class="id">creates</span> <span class="id">an</span> <span class="id">equality</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">x</span> = <span class="id">y</span>] <span class="id">or</span> [<span class="id">x</span> == <span class="id">y</span>],
     <span class="id">it</span> <span class="id">substitutes</span> <span class="id">it</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> *)

<span class="kwd">Ltac</span> <span class="id">cases_if_on_tactic</span> <span class="id">E</span> <span class="id">Eq</span> :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span>
  | {<span class="id">_</span>}+{<span class="id">_</span>} =&gt; <span class="tactic">destruct</span> <span class="id">E</span> <span class="kwd">as</span> [<span class="id">Eq</span>|<span class="id">Eq</span>]; <span class="tactic">try</span> <span class="id">subst_hyp</span> <span class="id">Eq</span>
  | <span class="id">_</span> =&gt; <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> 
         <span class="id">sets_eq</span> &lt;- <span class="id">X</span> <span class="id">Eq</span>: <span class="id">E</span>;
         <span class="tactic">destruct</span> <span class="id">X</span>
  <span class="kwd">end</span>; <span class="id">case_if_post</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if_on</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="id">cases_if_on_tactic</span> <span class="id">E</span> <span class="id">Eq</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
  | |- <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; <span class="id">case_if_on</span> <span class="id">B</span> <span class="kwd">as</span> <span class="id">Eq</span>
  | <span class="id">K</span>: <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt; <span class="id">case_if_on</span> <span class="id">B</span> <span class="kwd">as</span> <span class="id">Eq</span>
  <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; 
    <span class="id">cases_if_on</span> <span class="id">B</span> <span class="kwd">as</span> <span class="id">Eq</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">cases_if</span> <span class="kwd">as</span> <span class="id">Eq</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">cases_if</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Eq</span>.


(** [<span class="id">destruct_if</span>] <span class="id">looks</span> <span class="kwd">for</span> <span class="id">a</span> <span class="tactic">pattern</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> ?<span class="id">E1</span> <span class="kwd">else</span> ?<span class="id">E2</span>]
    <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>, <span class="id">and</span> <span class="id">perform</span> <span class="id">a</span> <span class="tactic">case</span> <span class="id">analysis</span> <span class="id">on</span> [<span class="id">B</span>] <span class="tactic">by</span> <span class="id">calling</span> 
    [<span class="tactic">destruct</span> <span class="id">B</span>]. <span class="id">It</span> <span class="id">looks</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">first</span>, <span class="id">and</span> <span class="id">otherwise</span> <span class="kwd">in</span> <span class="id">the</span>
    <span class="id">first</span> <span class="id">hypothesis</span> <span class="id">that</span> <span class="id">contains</span> <span class="id">and</span> [<span class="kwd">if</span>] <span class="id">statement</span>. *)

<span class="kwd">Ltac</span> <span class="id">destruct_if_post</span> := <span class="id">tryfalse</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" 
 "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq1</span>) <span class="id">simple_intropattern</span>(<span class="id">Eq2</span>) :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
  | |- <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> <span class="id">B</span> <span class="kwd">as</span> [<span class="id">Eq1</span>|<span class="id">Eq2</span>]
  | <span class="id">K</span>: <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">B</span> <span class="kwd">as</span> [<span class="id">Eq1</span>|<span class="id">Eq2</span>]
  <span class="kwd">end</span>; 
  <span class="id">destruct_if_post</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) 
 "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq1</span>) <span class="id">simple_intropattern</span>(<span class="id">Eq2</span>) :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; 
    <span class="tactic">destruct</span> <span class="id">B</span> <span class="kwd">as</span> [<span class="id">Eq1</span>|<span class="id">Eq2</span>] <span class="kwd">end</span>; 
  <span class="id">destruct_if_post</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="id">destruct_if</span> <span class="kwd">as</span> <span class="id">Eq</span> <span class="id">Eq</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="id">destruct_if</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Eq</span> <span class="id">Eq</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> "<span class="id">C</span>" <span class="kwd">in</span> <span class="id">destruct_if</span> <span class="kwd">as</span> <span class="id">Eq</span> <span class="id">Eq</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> "<span class="id">C</span>" <span class="kwd">in</span> <span class="id">destruct_if</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">Eq</span> <span class="id">Eq</span>.


(** [<span class="id">destruct_head_match</span>] <span class="id">performs</span> <span class="id">a</span> <span class="tactic">case</span> <span class="id">analysis</span> <span class="id">on</span> <span class="id">the</span> <span class="id">argument</span>
    <span class="id">of</span> <span class="id">the</span> <span class="id">head</span> <span class="tactic">pattern</span> <span class="id">matching</span> <span class="id">when</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">has</span> <span class="id">the</span> <span class="id">form</span> 
    [<span class="kwd">match</span> ?<span class="id">E</span> <span class="kwd">with</span> ...] <span class="id">or</span> [<span class="kwd">match</span> ?<span class="id">E</span> <span class="kwd">with</span> ... = <span class="id">_</span>] <span class="id">or</span>
    [<span class="id">_</span> = <span class="kwd">match</span> ?<span class="id">E</span> <span class="kwd">with</span> ...]. <span class="id">Due</span> <span class="id">to</span> <span class="id">the</span> <span class="id">limits</span> <span class="id">of</span> <span class="kwd">Ltac</span>, <span class="id">this</span> <span class="id">tactic</span>
    <span class="id">will</span> <span class="id">not</span> <span class="tactic">fail</span> <span class="kwd">if</span> <span class="id">a</span> <span class="kwd">match</span> <span class="id">does</span> <span class="id">not</span> <span class="id">occur</span>. <span class="id">Instead</span>, <span class="id">it</span> <span class="id">might</span>
    <span class="id">perform</span> <span class="id">a</span> <span class="tactic">case</span> <span class="id">analysis</span> <span class="id">on</span> <span class="id">an</span> <span class="id">unspecified</span> <span class="id">subterm</span> <span class="id">from</span> <span class="id">the</span> <span class="id">goal</span>. 
    --- <span class="id">Warning</span>: <span class="id">experimental</span>. *)

<span class="kwd">Ltac</span> <span class="id">find_head_match</span> <span class="id">T</span> :=
  <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span> <span class="id">context</span> [?<span class="id">E</span>] =&gt; 
    <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>  
    | <span class="id">E</span> =&gt; <span class="tactic">fail</span> 1 
    | <span class="id">_</span> =&gt; <span class="id">constr</span>:(<span class="id">E</span>) 
    <span class="kwd">end</span> 
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">destruct_head_match_core</span> <span class="id">cont</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
  | |- ?<span class="id">T1</span> = ?<span class="id">T2</span> =&gt; <span class="id">first</span> [ <span class="kwd">let</span> <span class="id">E</span> := <span class="id">find_head_match</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">cont</span> <span class="id">E</span>
		          | <span class="kwd">let</span> <span class="id">E</span> := <span class="id">find_head_match</span> <span class="id">T2</span> <span class="kwd">in</span> <span class="id">cont</span> <span class="id">E</span> ]
  | |- ?<span class="id">T1</span> =&gt; <span class="kwd">let</span> <span class="id">E</span> := <span class="id">find_head_match</span> <span class="id">T1</span> <span class="kwd">in</span> <span class="id">cont</span> <span class="id">E</span>    
  <span class="kwd">end</span>; 
  <span class="id">destruct_if_post</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_head_match</span>" "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) :=
  <span class="id">destruct_head_match_core</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">E</span> =&gt; <span class="tactic">destruct</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">I</span>).

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_head_match</span>" :=
  <span class="id">destruct_head_match_core</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">E</span> =&gt; <span class="tactic">destruct</span> <span class="id">E</span>).


(**--<span class="id">provided</span> <span class="kwd">for</span> <span class="id">compatibility</span> <span class="kwd">with</span> [<span class="id">remember</span>] *)

(** [<span class="id">cases</span>' <span class="id">E</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">case_eq</span> <span class="id">E</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">generates</span> <span class="id">the</span>
    <span class="id">equality</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span> <span class="id">and</span> <span class="id">not</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>. <span class="id">The</span> <span class="id">syntax</span> [<span class="id">cases</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>]
    <span class="id">allows</span> <span class="id">specifying</span> <span class="id">the</span> <span class="id">name</span> [<span class="id">H</span>] <span class="id">of</span> <span class="id">that</span> <span class="id">hypothesis</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>'" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> "<span class="id">TEMP</span>" <span class="kwd">in</span> 
  <span class="tactic">set</span> (<span class="id">X</span> := <span class="id">E</span>) <span class="kwd">in</span> *; <span class="id">def_to_eq</span> <span class="id">X</span> <span class="id">H</span> <span class="id">E</span>;
  <span class="tactic">destruct</span> <span class="id">X</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>'" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="kwd">let</span> <span class="id">x</span> := <span class="tactic">fresh</span> "<span class="id">Eq</span>" <span class="kwd">in</span> <span class="id">cases</span>' <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>.

(** [<span class="id">cases_if</span>'] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">cases_if</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">generates</span>
    <span class="id">the</span> <span class="id">symmetric</span> <span class="id">equality</span>. *)

<span class="kwd">Ltac</span> <span class="id">cases_if_on</span>' <span class="id">E</span> <span class="id">Eq</span> :=
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">E</span> <span class="kwd">with</span>
  | {<span class="id">_</span>}+{<span class="id">_</span>} =&gt; <span class="tactic">destruct</span> <span class="id">E</span> <span class="kwd">as</span> [<span class="id">Eq</span>|<span class="id">Eq</span>]; <span class="tactic">try</span> <span class="id">subst_hyp</span> <span class="id">Eq</span>
  | <span class="id">_</span> =&gt; <span class="kwd">let</span> <span class="id">X</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> 
         <span class="id">sets_eq</span> <span class="id">X</span> <span class="id">Eq</span>: <span class="id">E</span>;
         <span class="tactic">destruct</span> <span class="id">X</span>
  <span class="kwd">end</span>; <span class="id">case_if_post</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>'" "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">Eq</span>) :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
  | |- <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] =&gt; <span class="id">cases_if_on</span>' <span class="id">B</span> <span class="id">Eq</span>
  | <span class="id">K</span>: <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">B</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>] |- <span class="id">_</span> =&gt; <span class="id">cases_if_on</span>' <span class="id">B</span> <span class="id">Eq</span>
  <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>'" :=
  <span class="kwd">let</span> <span class="id">Eq</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">cases_if</span>' <span class="kwd">as</span> <span class="id">Eq</span>.


(* ********************************************************************** *)
(** * <span class="kwd">Induction</span> *)

(** [<span class="id">inductions</span> <span class="id">E</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> [<span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span>].
    [<span class="id">inductions</span> <span class="id">E</span> <span class="id">gen</span> <span class="id">X1</span> .. <span class="id">XN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span>
    [<span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> .. <span class="id">XN</span>]. *)

<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Program.Equality.html">Coq.Program.Equality</a></span>.

<span class="kwd">Ltac</span> <span class="id">inductions_post</span> :=
  <span class="tactic">unfold</span> <span class="id">eq</span>' <span class="kwd">in</span> *.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>)
 <span class="id">ident</span>(<span class="id">X3</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>)
 <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>)
 <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>)
 <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) <span class="id">ident</span>(<span class="id">X6</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span> <span class="id">X6</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>)
 <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) <span class="id">ident</span>(<span class="id">X6</span>) <span class="id">ident</span>(<span class="id">X7</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span> <span class="id">X6</span> <span class="id">X7</span>; <span class="id">inductions_post</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inductions</span>" <span class="id">ident</span>(<span class="id">E</span>) "<span class="id">gen</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>)
 <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) <span class="id">ident</span>(<span class="id">X5</span>) <span class="id">ident</span>(<span class="id">X6</span>) <span class="id">ident</span>(<span class="id">X7</span>) <span class="id">ident</span>(<span class="id">X8</span>) :=
  <span class="tactic">dependent</span> <span class="tactic">induction</span> <span class="id">E</span> <span class="id">generalizing</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">X3</span> <span class="id">X4</span> <span class="id">X5</span> <span class="id">X6</span> <span class="id">X7</span> <span class="id">X8</span>; <span class="id">inductions_post</span>.

(** [<span class="id">induction_wf</span> <span class="id">IH</span>: <span class="id">E</span> <span class="id">X</span>] <span class="id">is</span> <span class="id">used</span> <span class="id">to</span> <span class="tactic">apply</span> <span class="id">the</span> <span class="id">well</span>-<span class="id">founded</span> <span class="tactic">induction</span>
    <span class="id">principle</span>, <span class="kwd">for</span> <span class="id">a</span> <span class="id">given</span> <span class="id">well</span>-<span class="id">founded</span> <span class="id">relation</span>. <span class="id">It</span> <span class="id">applies</span> <span class="id">to</span> <span class="id">a</span> <span class="id">goal</span>
    [<span class="id">PX</span>] <span class="kwd">where</span> [<span class="id">PX</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">proposition</span> <span class="id">on</span> [<span class="id">X</span>]. <span class="id">First</span>, <span class="id">it</span> <span class="id">sets</span> <span class="id">up</span> <span class="id">the</span>
    <span class="id">goal</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">form</span> [(<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id">P</span> <span class="id">a</span>) <span class="id">X</span>], <span class="kwd">using</span> [<span class="tactic">pattern</span> <span class="id">X</span>], <span class="id">and</span> <span class="kwd">then</span>
    <span class="id">it</span> <span class="id">applies</span> <span class="id">the</span> <span class="id">well</span>-<span class="id">founded</span> <span class="tactic">induction</span> <span class="id">principle</span> <span class="id">instantiated</span> <span class="id">on</span> [<span class="id">E</span>],
    <span class="kwd">where</span> [<span class="id">E</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">term</span> <span class="id">of</span> <span class="id">type</span> [<span class="id">well_founded</span> <span class="id">R</span>], <span class="id">and</span> [<span class="id">R</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">binary</span>
    <span class="id">relation</span>.
    <span class="id">Syntaxes</span> [<span class="id">induction_wf</span>: <span class="id">E</span> <span class="id">X</span>] <span class="id">and</span> [<span class="id">induction_wf</span> <span class="id">E</span> <span class="id">X</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">induction_wf</span>" <span class="id">ident</span>(<span class="id">IH</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) <span class="id">ident</span>(<span class="id">X</span>) :=
  <span class="tactic">pattern</span> <span class="id">X</span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_ind">well_founded_ind</a></span> <span class="id">E</span>); <span class="tactic">clear</span> <span class="id">X</span>; <span class="tactic">intros</span> <span class="id">X</span> <span class="id">IH</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">induction_wf</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) <span class="id">ident</span>(<span class="id">X</span>) :=
  <span class="kwd">let</span> <span class="id">IH</span> := <span class="tactic">fresh</span> "<span class="id">IH</span>" <span class="kwd">in</span> <span class="id">induction_wf</span> <span class="id">IH</span>: <span class="id">E</span> <span class="id">X</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">induction_wf</span>" ":" <span class="id">constr</span>(<span class="id">E</span>) <span class="id">ident</span>(<span class="id">X</span>) :=
  <span class="id">induction_wf</span>: <span class="id">E</span> <span class="id">X</span>.


(* ********************************************************************** *)
(** * <span class="id">Decidable</span> <span class="id">equality</span> *)

(** [<span class="id">decides_equality</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">decide</span> <span class="id">equality</span>] <span class="id">excepts</span> <span class="id">that</span> <span class="id">it</span> 
    <span class="id">is</span> <span class="id">able</span> <span class="id">to</span> <span class="tactic">unfold</span> <span class="id">definitions</span> <span class="tactic">at</span> <span class="id">head</span> <span class="id">of</span> <span class="id">the</span> <span class="id">current</span> <span class="id">goal</span>. *)

<span class="kwd">Ltac</span> <span class="id">decides_equality_tactic</span> :=
  <span class="id">first</span> [ <span class="id">decide</span> <span class="id">equality</span> | <span class="tactic">progress</span>(<span class="id">unfolds</span>); <span class="id">decides_equality_tactic</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">decides_equality</span>" :=
  <span class="id">decides_equality_tactic</span>.


(* ********************************************************************** *)
(** * <span class="id">Equivalence</span> *)

(** [<span class="id">iff</span> <span class="id">H</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">prove</span> <span class="id">an</span> <span class="id">equivalence</span> [<span class="id">P</span> &lt;-&gt; <span class="id">Q</span>] <span class="id">and</span> <span class="id">name</span> [<span class="id">H</span>]
    <span class="id">the</span> <span class="id">hypothesis</span> <span class="id">obtained</span> <span class="kwd">in</span> <span class="id">each</span> <span class="tactic">case</span>. <span class="id">The</span> <span class="id">syntaxes</span> [<span class="id">iff</span>] <span class="id">and</span> [<span class="id">iff</span> <span class="id">H1</span> <span class="id">H2</span>]
    <span class="id">are</span> <span class="id">also</span> <span class="id">available</span> <span class="id">to</span> <span class="id">specify</span> <span class="id">zero</span> <span class="id">or</span> <span class="id">two</span> <span class="id">names</span>. <span class="id">The</span> <span class="id">tactic</span> [<span class="id">iff</span> &lt;- <span class="id">H</span>]
    <span class="id">swaps</span> <span class="id">the</span> <span class="id">two</span> <span class="id">subgoals</span>, <span class="id">i.e</span>. <span class="id">produces</span> (<span class="id">Q</span> -&gt; <span class="id">P</span>) <span class="kwd">as</span> <span class="id">first</span> <span class="kwd">subgoal</span>. *)

<span class="kwd">Lemma</span> <span class="id"><a name="iff_intro_swap">iff_intro_swap</a></span> : <span class="kwd">forall</span> (<span class="id">P</span> <span class="id">Q</span> : <span class="kwd">Prop</span>), 
  (<span class="id"><a href="LibTactics.html#Q">Q</a></span> -&gt; <span class="id"><a href="LibTactics.html#P">P</a></span>) -&gt; (<span class="id"><a href="LibTactics.html#P">P</a></span> -&gt; <span class="id"><a href="LibTactics.html#Q">Q</a></span>) -&gt; (<span class="id"><a href="LibTactics.html#P">P</a></span> &lt;-&gt; <span class="id"><a href="LibTactics.html#Q">Q</a></span>).
<span class="kwd">Proof</span>. <span class="tactic">intuition</span>. <span class="kwd">Qed</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" <span class="id">simple_intropattern</span>(<span class="id">H1</span>) <span class="id">simple_intropattern</span>(<span class="id">H2</span>) :=
  <span class="tactic">split</span>; [ <span class="tactic">intros</span> <span class="id">H1</span> | <span class="tactic">intros</span> <span class="id">H2</span> ].
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" <span class="id">simple_intropattern</span>(<span class="id">H</span>) :=
  <span class="id">iff</span> <span class="id">H</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" :=
  <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">H</span>" <span class="kwd">in</span> <span class="id">iff</span> <span class="id">H</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" "&lt;-" <span class="id">simple_intropattern</span>(<span class="id">H1</span>) <span class="id">simple_intropattern</span>(<span class="id">H2</span>) :=
  <span class="tactic">apply</span> <span class="id"><a href="LibTactics.html#iff_intro_swap">iff_intro_swap</a></span>; [ <span class="tactic">intros</span> <span class="id">H1</span> | <span class="tactic">intros</span> <span class="id">H2</span> ].
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" "&lt;-" <span class="id">simple_intropattern</span>(<span class="id">H</span>) :=
  <span class="id">iff</span> &lt;- <span class="id">H</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" "&lt;-" :=
  <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> "<span class="id">H</span>" <span class="kwd">in</span> <span class="id">iff</span> &lt;- <span class="id">H</span>.


(* ********************************************************************** *)
(** * <span class="id">N</span>-<span class="id">ary</span> <span class="id">Conjunctions</span> <span class="id">and</span> <span class="id">Disjunctions</span> *)

(* ---------------------------------------------------------------------- *)
(** <span class="id">N</span>-<span class="id">ary</span> <span class="id">Conjunctions</span> <span class="id">Splitting</span> <span class="kwd">in</span> <span class="id">Goals</span> *)

(** <span class="id">Underlying</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">splits</span>]. *)

<span class="kwd">Ltac</span> <span class="id">splits_tactic</span> <span class="id">N</span> :=
  <span class="kwd">match</span> <span class="id">N</span> <span class="kwd">with</span>
  | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="tactic">fail</span>
  | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id">idtac</span>
  | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ?<span class="id">N</span>' =&gt; <span class="tactic">split</span>; [| <span class="id">splits_tactic</span> <span class="id">N</span>']
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">unfold_goal_until_conjunction</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">idtac</span>
  | <span class="id">_</span> =&gt; <span class="tactic">progress</span>(<span class="id">unfolds</span>); <span class="id">unfold_goal_until_conjunction</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">get_term_conjunction_arity</span> <span class="id">T</span> :=
  <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>
  | <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(8)
  | <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(7)
  | <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(6)
  | <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(5)
  | <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(4)
  | <span class="id">_</span> /\ <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(3)
  | <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="id">constr</span>:(2)
  | <span class="id">_</span> -&gt; ?<span class="id">T</span>' =&gt; <span class="id">get_term_conjunction_arity</span> <span class="id">T</span>'
  | <span class="id">_</span> =&gt; <span class="kwd">let</span> <span class="id">P</span> := <span class="id">get_head</span> <span class="id">T</span> <span class="kwd">in</span>
         <span class="kwd">let</span> <span class="id">T</span>' := <span class="id">eval</span> <span class="tactic">unfold</span> <span class="id">P</span> <span class="kwd">in</span> <span class="id">T</span> <span class="kwd">in</span>
         <span class="kwd">match</span> <span class="id">T</span>' <span class="kwd">with</span> 
         | <span class="id">T</span> =&gt; <span class="tactic">fail</span> 1
         | <span class="id">_</span> =&gt; <span class="id">get_term_conjunction_arity</span> <span class="id">T</span>'
         <span class="kwd">end</span> 
         (* <span class="id">todo</span>: <span class="id">warning</span> <span class="id">this</span> <span class="id">can</span> <span class="id">loop</span>... *)
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">get_goal_conjunction_arity</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">T</span> =&gt; <span class="id">get_term_conjunction_arity</span> <span class="id">T</span> <span class="kwd">end</span>.

(** [<span class="id">splits</span>] <span class="id">applies</span> <span class="id">to</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [(<span class="id">T1</span> /\ .. /\ <span class="id">TN</span>)] <span class="id">and</span>
    <span class="tactic">destruct</span> <span class="id">it</span> <span class="id">into</span> [<span class="id">N</span>] <span class="id">subgoals</span> [<span class="id">T1</span>] .. [<span class="id">TN</span>]. <span class="id">If</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">is</span> <span class="id">not</span> <span class="id">a</span> 
    <span class="id">conjunction</span>, <span class="kwd">then</span> <span class="id">it</span> <span class="id">unfolds</span> <span class="id">the</span> <span class="id">head</span> <span class="id">definition</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits</span>" :=
  <span class="id">unfold_goal_until_conjunction</span>;
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">get_goal_conjunction_arity</span> <span class="kwd">in</span>
  <span class="id">splits_tactic</span> <span class="id">N</span>.

(** [<span class="id">splits</span> <span class="id">N</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">splits</span>], <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">will</span> <span class="tactic">unfold</span> <span class="kwd">as</span> <span class="id">many</span>
    <span class="id">definitions</span> <span class="kwd">as</span> <span class="id">necessary</span> <span class="id">to</span> <span class="id">obtain</span> <span class="id">an</span> [<span class="id">N</span>]-<span class="id">ary</span> <span class="id">conjunction</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits</span>" <span class="id">constr</span>(<span class="id">N</span>) := 
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">in</span>
  <span class="id">splits_tactic</span> <span class="id">N</span>.

(** [<span class="id">splits_all</span>] <span class="id">will</span> <span class="id">recursively</span> <span class="tactic">split</span> <span class="id">any</span> <span class="id">conjunction</span>, <span class="id">unfolding</span>
    <span class="id">definitions</span> <span class="id">when</span> <span class="id">necessary</span>. <span class="id">Warning</span>: <span class="id">this</span> <span class="id">tactic</span> <span class="id">will</span> <span class="id">loop</span>
    <span class="id">on</span> <span class="id">goals</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">well_founded</span> <span class="id">R</span>]. <span class="id">Todo</span>: <span class="id">fix</span> <span class="id">this</span> *)

<span class="kwd">Ltac</span> <span class="id">splits_all_base</span> := <span class="tactic">repeat</span> <span class="tactic">split</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits_all</span>" := 
  <span class="id">splits_all_base</span>.


(* ---------------------------------------------------------------------- *)
(** <span class="id">N</span>-<span class="id">ary</span> <span class="id">Conjunctions</span> <span class="id">Deconstruction</span> *)

(** <span class="id">Underlying</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">destructs</span>]. *)

<span class="kwd">Ltac</span> <span class="id">destructs_conjunction_tactic</span> <span class="id">N</span> <span class="id">T</span> :=
  <span class="kwd">match</span> <span class="id">N</span> <span class="kwd">with</span>
  | 2 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? ?]
  | 3 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? [? ?]]
  | 4 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? [? [? ?]]]
  | 5 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? [? [? [? ?]]]]
  | 6 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? [? [? [? [? ?]]]]]
  | 7 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? [? [? [? [? [? ?]]]]]]
  <span class="kwd">end</span>. 

(** [<span class="id">destructs</span> <span class="id">T</span>] <span class="id">allows</span> <span class="id">destructing</span> <span class="id">a</span> <span class="id">term</span> [<span class="id">T</span>] <span class="id">which</span> <span class="id">is</span> <span class="id">a</span> <span class="id">N</span>-<span class="id">ary</span> 
    <span class="id">conjunction</span>. <span class="id">It</span> <span class="id">is</span> <span class="id">equivalent</span> <span class="id">to</span> [<span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> (<span class="id">H1</span> .. <span class="id">HN</span>)], 
    <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="id">require</span> <span class="id">to</span> <span class="id">manually</span> <span class="id">specify</span> <span class="id">N</span> <span class="id">different</span> 
    <span class="id">names</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destructs</span>" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="kwd">let</span> <span class="id">TT</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">T</span> <span class="kwd">in</span>
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">get_term_conjunction_arity</span> <span class="id">TT</span> <span class="kwd">in</span> 
  <span class="id">destructs_conjunction_tactic</span> <span class="id">N</span> <span class="id">T</span>.

(** [<span class="id">destructs</span> <span class="id">N</span> <span class="id">T</span>] <span class="id">is</span> <span class="id">equivalent</span> <span class="id">to</span> [<span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> (<span class="id">H1</span> .. <span class="id">HN</span>)],
    <span class="id">except</span> <span class="id">that</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="id">require</span> <span class="id">to</span> <span class="id">manually</span> <span class="id">specify</span> <span class="id">N</span> <span class="id">different</span> 
    <span class="id">names</span>. <span class="kwd">Remark</span> <span class="id">that</span> <span class="id">it</span> <span class="id">is</span> <span class="id">not</span> <span class="id">restricted</span> <span class="id">to</span> <span class="id">N</span>-<span class="id">ary</span> <span class="id">conjunctions</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destructs</span>" <span class="id">constr</span>(<span class="id">N</span>) <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">in</span>
  <span class="id">destructs_conjunction_tactic</span> <span class="id">N</span> <span class="id">T</span>.


(* ---------------------------------------------------------------------- *)
(** <span class="id">Proving</span> <span class="id">goals</span> <span class="id">which</span> <span class="id">are</span> <span class="id">N</span>-<span class="id">ary</span> <span class="id">disjunctions</span> *)

(** <span class="id">Underlying</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">branch</span>]. *)

<span class="kwd">Ltac</span> <span class="id">branch_tactic</span> <span class="id">K</span> <span class="id">N</span> := 
  <span class="kwd">match</span> <span class="id">constr</span>:((<span class="id">K</span>,<span class="id">N</span>)) <span class="kwd">with</span>
  | (<span class="id">_</span>,0) =&gt; <span class="tactic">fail</span> 1
  | (0,<span class="id">_</span>) =&gt; <span class="tactic">fail</span> 1
  | (1,1) =&gt; <span class="id">idtac</span>
  | (1,<span class="id">_</span>) =&gt; <span class="id">left</span>
  | (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ?<span class="id">K</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ?<span class="id">N</span>') =&gt; <span class="id">right</span>; <span class="id">branch_tactic</span> <span class="id">K</span>' <span class="id">N</span>'
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">unfold_goal_until_disjunction</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">idtac</span>
  | <span class="id">_</span> =&gt; <span class="tactic">progress</span>(<span class="id">unfolds</span>); <span class="id">unfold_goal_until_disjunction</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">get_term_disjunction_arity</span> <span class="id">T</span> :=
  <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>
  | <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(8)
  | <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(7)
  | <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(6)
  | <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(5)
  | <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(4)
  | <span class="id">_</span> \/ <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(3)
  | <span class="id">_</span> \/ <span class="id">_</span> =&gt; <span class="id">constr</span>:(2)
  | <span class="id">_</span> -&gt; ?<span class="id">T</span>' =&gt; <span class="id">get_term_disjunction_arity</span> <span class="id">T</span>'
  | <span class="id">_</span> =&gt; <span class="kwd">let</span> <span class="id">P</span> := <span class="id">get_head</span> <span class="id">T</span> <span class="kwd">in</span>
         <span class="kwd">let</span> <span class="id">T</span>' := <span class="id">eval</span> <span class="tactic">unfold</span> <span class="id">P</span> <span class="kwd">in</span> <span class="id">T</span> <span class="kwd">in</span>
         <span class="kwd">match</span> <span class="id">T</span>' <span class="kwd">with</span> 
         | <span class="id">T</span> =&gt; <span class="tactic">fail</span> 1
         | <span class="id">_</span> =&gt; <span class="id">get_term_disjunction_arity</span> <span class="id">T</span>'
         <span class="kwd">end</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">get_goal_disjunction_arity</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">T</span> =&gt; <span class="id">get_term_disjunction_arity</span> <span class="id">T</span> <span class="kwd">end</span>.

(** [<span class="id">branch</span> <span class="id">N</span>] <span class="id">applies</span> <span class="id">to</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> 
    [<span class="id">P1</span> \/ ... \/ <span class="id">PK</span> \/ ... \/ <span class="id">PN</span>] <span class="id">and</span> <span class="id">leaves</span> <span class="id">the</span> <span class="id">goal</span> [<span class="id">PK</span>].
    <span class="id">It</span> <span class="id">only</span> <span class="id">able</span> <span class="id">to</span> <span class="tactic">unfold</span> <span class="id">the</span> <span class="id">head</span> <span class="id">definition</span> (<span class="kwd">if</span> <span class="id">there</span> <span class="id">is</span> <span class="id">one</span>),
    <span class="id">but</span> <span class="kwd">for</span> <span class="id">more</span> <span class="id">complex</span> <span class="id">unfolding</span> <span class="id">one</span> <span class="id">should</span> <span class="id">use</span> <span class="id">the</span> <span class="id">tactic</span>
    [<span class="id">branch</span> <span class="id">K</span> <span class="id">of</span> <span class="id">N</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branch</span>" <span class="id">constr</span>(<span class="id">K</span>) :=
  <span class="kwd">let</span> <span class="id">K</span> := <span class="id">nat_from_number</span> <span class="id">K</span> <span class="kwd">in</span>
  <span class="id">unfold_goal_until_disjunction</span>; 
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">get_goal_disjunction_arity</span> <span class="kwd">in</span>
  <span class="id">branch_tactic</span> <span class="id">K</span> <span class="id">N</span>.

(** [<span class="id">branch</span> <span class="id">K</span> <span class="id">of</span> <span class="id">N</span>] <span class="id">is</span> <span class="id">similar</span> <span class="id">to</span> [<span class="id">branch</span> <span class="id">K</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">the</span>
    <span class="id">arity</span> <span class="id">of</span> <span class="id">the</span> <span class="id">disjunction</span> [<span class="id">N</span>] <span class="id">is</span> <span class="id">given</span> <span class="id">manually</span>, <span class="id">and</span> <span class="id">so</span> <span class="id">this</span>
    <span class="id">version</span> <span class="id">of</span> <span class="id">the</span> <span class="id">tactic</span> <span class="id">is</span> <span class="id">able</span> <span class="id">to</span> <span class="tactic">unfold</span> <span class="id">definitions</span>.
    <span class="id">In</span> <span class="id">other</span> <span class="id">words</span>, <span class="id">applies</span> <span class="id">to</span> <span class="id">a</span> <span class="id">goal</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> 
    [<span class="id">P1</span> \/ ... \/ <span class="id">PK</span> \/ ... \/ <span class="id">PN</span>] <span class="id">and</span> <span class="id">leaves</span> <span class="id">the</span> <span class="id">goal</span> [<span class="id">PK</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branch</span>" <span class="id">constr</span>(<span class="id">K</span>) "<span class="id">of</span>" <span class="id">constr</span>(<span class="id">N</span>) :=
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">in</span>
  <span class="kwd">let</span> <span class="id">K</span> := <span class="id">nat_from_number</span> <span class="id">K</span> <span class="kwd">in</span>
  <span class="id">branch_tactic</span> <span class="id">K</span> <span class="id">N</span>.


(* ---------------------------------------------------------------------- *)
(** <span class="id">N</span>-<span class="id">ary</span> <span class="id">Disjunction</span> <span class="id">Deconstruction</span> *)

(** <span class="id">Underlying</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">branches</span>]. *)

<span class="kwd">Ltac</span> <span class="id">destructs_disjunction_tactic</span> <span class="id">N</span> <span class="id">T</span> :=
  <span class="kwd">match</span> <span class="id">N</span> <span class="kwd">with</span>
  | 2 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? | ?]
  | 3 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? | [? | ?]]
  | 4 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? | [? | [? | ?]]]
  | 5 =&gt; <span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [? | [? | [? | [? | ?]]]]
  <span class="kwd">end</span>.

(** [<span class="id">branches</span> <span class="id">T</span>] <span class="id">allows</span> <span class="id">destructing</span> <span class="id">a</span> <span class="id">term</span> [<span class="id">T</span>] <span class="id">which</span> <span class="id">is</span> <span class="id">a</span> <span class="id">N</span>-<span class="id">ary</span> 
    <span class="id">disjunction</span>. <span class="id">It</span> <span class="id">is</span> <span class="id">equivalent</span> <span class="id">to</span> [<span class="tactic">destruct</span> <span class="id">T</span> <span class="kwd">as</span> [ <span class="id">H1</span> | .. | <span class="id">HN</span> ] ], 
    <span class="id">and</span> <span class="id">produces</span> [<span class="id">N</span>] <span class="id">subgoals</span> <span class="id">corresponding</span> <span class="id">to</span> <span class="id">the</span> [<span class="id">N</span>] <span class="id">possible</span> <span class="id">cases</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branches</span>" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="kwd">let</span> <span class="id">TT</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">T</span> <span class="kwd">in</span>
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">get_term_disjunction_arity</span> <span class="id">TT</span> <span class="kwd">in</span>
  <span class="id">destructs_disjunction_tactic</span> <span class="id">N</span> <span class="id">T</span>.

(** [<span class="id">branches</span> <span class="id">N</span> <span class="id">T</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">same</span> <span class="kwd">as</span> [<span class="id">branches</span> <span class="id">T</span>] <span class="id">except</span> <span class="id">that</span> <span class="id">the</span> <span class="id">arity</span> <span class="id">is</span>
    <span class="id">forced</span> <span class="id">to</span> [<span class="id">N</span>]. <span class="id">This</span> <span class="id">version</span> <span class="id">is</span> <span class="id">useful</span> <span class="id">to</span> <span class="tactic">unfold</span> <span class="id">definitions</span> 
    <span class="id">on</span> <span class="id">the</span> <span class="id">fly</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branches</span>" <span class="id">constr</span>(<span class="id">N</span>) <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">in</span>
  <span class="id">destructs_disjunction_tactic</span> <span class="id">N</span> <span class="id">T</span>.
 

(* ---------------------------------------------------------------------- *)
(** <span class="id">N</span>-<span class="id">ary</span> <span class="id">Existentials</span> *)

(* <span class="id">Underlying</span> <span class="id">implementation</span> <span class="id">of</span> [<span class="id">exists</span>]. *)

<span class="kwd">Ltac</span> <span class="id">get_term_existential_arity</span> <span class="id">T</span> :=
  <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> <span class="id">x7</span> <span class="id">x8</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(8)
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span> <span class="id">x7</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(7)
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span> <span class="id">x6</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(6)
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">x5</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(5)
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(4)
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(3)
  | <span class="id">exists</span> <span class="id">x1</span> <span class="id">x2</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(2)
  | <span class="id">exists</span> <span class="id">x1</span>, <span class="id">_</span> =&gt; <span class="id">constr</span>:(1)
  | <span class="id">_</span> -&gt; ?<span class="id">T</span>' =&gt; <span class="id">get_term_existential_arity</span> <span class="id">T</span>'
  | <span class="id">_</span> =&gt; <span class="kwd">let</span> <span class="id">P</span> := <span class="id">get_head</span> <span class="id">T</span> <span class="kwd">in</span>
         <span class="kwd">let</span> <span class="id">T</span>' := <span class="id">eval</span> <span class="tactic">unfold</span> <span class="id">P</span> <span class="kwd">in</span> <span class="id">T</span> <span class="kwd">in</span>
         <span class="kwd">match</span> <span class="id">T</span>' <span class="kwd">with</span> 
         | <span class="id">T</span> =&gt; <span class="tactic">fail</span> 1
         | <span class="id">_</span> =&gt; <span class="id">get_term_existential_arity</span> <span class="id">T</span>'
         <span class="kwd">end</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">get_goal_existential_arity</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">T</span> =&gt; <span class="id">get_term_existential_arity</span> <span class="id">T</span> <span class="kwd">end</span>.

(** [<span class="id">exists</span> <span class="id">T1</span> ... <span class="id">TN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> [<span class="id">exists</span> <span class="id">T1</span>; ...; <span class="id">exists</span> <span class="id">TN</span>].
    <span class="id">It</span> <span class="id">is</span> <span class="id">intended</span> <span class="id">to</span> <span class="id">prove</span> <span class="id">goals</span> <span class="id">of</span> <span class="id">the</span> <span class="id">form</span> [<span class="id">exist</span> <span class="id">X1</span> .. <span class="id">XN</span>, <span class="id">P</span>].
    <span class="id">If</span> <span class="id">an</span> <span class="id">argument</span> <span class="id">provided</span> <span class="id">is</span> [<span class="id">__</span>] (<span class="id">double</span> <span class="id">underscore</span>), <span class="kwd">then</span> <span class="id">an</span>
    <span class="id">evar</span> <span class="id">is</span> <span class="id">introduced</span>. [<span class="id">exists</span> <span class="id">T1</span> .. <span class="id">TN</span> <span class="id">___</span>] <span class="id">is</span> <span class="id">equivalent</span> <span class="id">to</span>
    [<span class="id">exists</span> <span class="id">T1</span> .. <span class="id">TN</span> <span class="id">__</span> <span class="id">__</span> <span class="id">__</span>] <span class="kwd">with</span> <span class="kwd">as</span> <span class="id">many</span> [<span class="id">__</span>] <span class="kwd">as</span> <span class="id">possible</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists_original</span>" <span class="id">constr</span>(<span class="id">T1</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" <span class="id">constr</span>(<span class="id">T1</span>) :=
  <span class="kwd">match</span> <span class="id">T1</span> <span class="kwd">with</span>
  | <span class="id"><a href="LibTactics.html#ltac_wild">ltac_wild</a></span> =&gt; <span class="id">esplit</span>
  | <span class="id"><a href="LibTactics.html#ltac_wilds">ltac_wilds</a></span> =&gt; <span class="tactic">repeat</span> <span class="id">esplit</span>
  | <span class="id">_</span> =&gt; <span class="id">exists</span> <span class="id">T1</span>
  <span class="kwd">end</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">exists</span> <span class="id">T2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">exists</span> <span class="id">T2</span>; <span class="id">exists</span> <span class="id">T3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">exists</span> <span class="id">T2</span>; <span class="id">exists</span> <span class="id">T3</span>; <span class="id">exists</span> <span class="id">T4</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) 
 <span class="id">constr</span>(<span class="id">T5</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">exists</span> <span class="id">T2</span>; <span class="id">exists</span> <span class="id">T3</span>; <span class="id">exists</span> <span class="id">T4</span>; <span class="id">exists</span> <span class="id">T5</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) 
 <span class="id">constr</span>(<span class="id">T5</span>) <span class="id">constr</span>(<span class="id">T6</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">exists</span> <span class="id">T2</span>; <span class="id">exists</span> <span class="id">T3</span>; <span class="id">exists</span> <span class="id">T4</span>; <span class="id">exists</span> <span class="id">T5</span>; <span class="id">exists</span> <span class="id">T6</span>.

(* <span class="id">The</span> <span class="id">tactic</span> [<span class="id">exists___</span> <span class="id">N</span>] <span class="id">is</span> <span class="id">short</span> <span class="kwd">for</span> [<span class="id">exists</span> <span class="id">__</span> ... <span class="id">__</span>] 
   <span class="kwd">with</span> [<span class="id">N</span>] <span class="id">double</span>-<span class="id">underscores</span>. <span class="id">The</span> <span class="id">tactic</span> [<span class="id">exists_</span>] <span class="id">is</span> <span class="id">equivalent</span> 
   <span class="id">to</span> <span class="id">calling</span> [<span class="id">exists___</span> <span class="id">N</span>], <span class="kwd">where</span> <span class="id">the</span> <span class="id">value</span> <span class="id">of</span> [<span class="id">N</span>] <span class="id">is</span> <span class="id">obtained</span>
   <span class="tactic">by</span> <span class="id">counting</span> <span class="id">the</span> <span class="id">number</span> <span class="id">of</span> <span class="id">existentials</span> <span class="id">syntactically</span> <span class="id">present</span>
   <span class="tactic">at</span> <span class="id">the</span> <span class="id">head</span> <span class="id">of</span> <span class="id">the</span> <span class="id">goal</span>. <span class="id">The</span> <span class="id">behaviour</span> <span class="id">of</span> [<span class="id">exists___</span>] <span class="id">differs</span>
   <span class="id">from</span> <span class="id">that</span> <span class="id">of</span> [<span class="id">exists</span> <span class="id">___</span>] <span class="id">is</span> <span class="id">the</span> <span class="tactic">case</span> <span class="kwd">where</span> <span class="id">the</span> <span class="id">goal</span> <span class="id">is</span> <span class="id">a</span> 
   <span class="id">definition</span> <span class="id">which</span> <span class="id">yields</span> <span class="id">an</span> <span class="id">existential</span> <span class="id">only</span> <span class="id">after</span> <span class="id">unfolding</span>. *)   

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists___</span>" <span class="id">constr</span>(<span class="id">N</span>) :=
  <span class="kwd">let</span> <span class="id">rec</span> <span class="id">aux</span> <span class="id">N</span> := 
    <span class="kwd">match</span> <span class="id">N</span> <span class="kwd">with</span>
    | 0 =&gt; <span class="id">idtac</span>
    | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ?<span class="id">N</span>' =&gt; <span class="id">esplit</span>; <span class="id">aux</span> <span class="id">N</span>'
    <span class="kwd">end</span> <span class="kwd">in</span>
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">in</span> <span class="id">aux</span> <span class="id">N</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists___</span>" := 
  <span class="kwd">let</span> <span class="id">N</span> := <span class="id">get_goal_existential_arity</span> <span class="kwd">in</span>
  <span class="id">exists___</span> <span class="id">N</span>.


(* ---------------------------------------------------------------------- *)
(** <span class="id">Existentials</span> <span class="id">and</span> <span class="id">conjunctions</span> <span class="kwd">in</span> <span class="id">hypotheses</span> *)

(** <span class="id">todo</span>: <span class="id">doc</span> *)

<span class="kwd">Ltac</span> <span class="id">intuit_core</span> :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | <span class="id">H</span>: <span class="id">_</span> /\ <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>
  | <span class="id">H</span>: <span class="id">exists</span> <span class="id">a</span>, <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">intuit_from</span> <span class="id">H</span> :=
  <span class="id">first</span> [ <span class="tactic">progress</span> (<span class="id">intuit_core</span>)
        | <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">intuit_core</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intuit</span>" :=
  <span class="id">intuit_core</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intuit</span>" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="id">intuit_from</span> <span class="id">H</span>.


(* ********************************************************************** *)
(** * <span class="id">Tactics</span> <span class="id">to</span> <span class="id">prove</span> <span class="id">typeclass</span> <span class="id">instances</span> *)

(** [<span class="id">typeclass</span>] <span class="id">is</span> <span class="id">an</span> <span class="id">automation</span> <span class="id">tactic</span> <span class="id">specialized</span> <span class="kwd">for</span> <span class="id">finding</span>
    <span class="id">typeclass</span> <span class="id">instances</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">typeclass</span>" := 
  <span class="kwd">let</span> <span class="id">go</span> <span class="id">_</span> := <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span> <span class="kwd">in</span>
  <span class="id">solve</span> [ <span class="id">go</span> <span class="id">tt</span> | <span class="id">constructor</span>; <span class="id">go</span> <span class="id">tt</span> ].

(** [<span class="id">solve_typeclass</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">simpler</span> <span class="id">version</span> <span class="id">of</span> [<span class="id">typeclass</span>], <span class="id">to</span> <span class="id">use</span>
    <span class="kwd">in</span> <span class="id">hint</span> <span class="id">tactics</span> <span class="kwd">for</span> <span class="id">resolving</span> <span class="id">instances</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">solve_typeclass</span>" := 
  <span class="id">solve</span> [ <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span> ].


(* ********************************************************************** *)
(** * <span class="id">Tactics</span> <span class="id">to</span> <span class="id">invoke</span> <span class="id">automation</span> *)

(* ---------------------------------------------------------------------- *)
(** ** [<span class="id">jauto</span>], <span class="id">a</span> <span class="id">new</span> <span class="id">automation</span> <span class="id">tactics</span> *)

(** [<span class="id">jauto</span>] <span class="id">is</span> <span class="id">better</span> <span class="tactic">at</span> [<span class="tactic">intuition</span> <span class="tactic">eauto</span>] <span class="id">because</span> <span class="id">it</span> <span class="id">can</span> <span class="id">open</span> <span class="id">existentials</span>
    <span class="id">from</span> <span class="id">the</span> <span class="id">context</span>. <span class="id">In</span> <span class="id">the</span> <span class="id">same</span> <span class="id">time</span>, [<span class="id">jauto</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">faster</span> <span class="id">than</span> 
    [<span class="tactic">intuition</span> <span class="tactic">eauto</span>] <span class="id">because</span> <span class="id">it</span> <span class="id">does</span> <span class="id">not</span> <span class="tactic">destruct</span> <span class="id">disjunctions</span> <span class="id">from</span> <span class="id">the</span> 
    <span class="id">context</span>. <span class="id">The</span> <span class="id">strategy</span> <span class="id">of</span> [<span class="id">jauto</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">summarized</span> <span class="kwd">as</span> <span class="id">follows</span>:
    - <span class="id">open</span> <span class="id">all</span> <span class="id">the</span> <span class="id">existentials</span> <span class="id">and</span> <span class="id">conjunctions</span> <span class="id">from</span> <span class="id">the</span> <span class="id">context</span>
    - <span class="id">call</span> <span class="id">esplit</span> <span class="id">and</span> <span class="tactic">split</span> <span class="id">on</span> <span class="id">the</span> <span class="id">existentials</span> <span class="id">and</span> <span class="id">conjunctions</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>
    - <span class="id">call</span> <span class="tactic">eauto</span>. *)

<span class="kwd">Ltac</span> <span class="id">jauto_set_hyps</span> :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt; 
    <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>
    | <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span>
    | <span class="id">exists</span> <span class="id">a</span>, <span class="id">_</span> =&gt; <span class="tactic">destruct</span> <span class="id">H</span> 
    | <span class="id">_</span> =&gt; <span class="id">generalizes</span> <span class="id">H</span>
    <span class="kwd">end</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">jauto_set_goal</span> :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
  | |- <span class="id">exists</span> <span class="id">a</span>, <span class="id">_</span> =&gt; <span class="id">esplit</span>
  | |- <span class="id">_</span> /\ <span class="id">_</span> =&gt; <span class="tactic">split</span>
  <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">jauto_set</span> :=
  <span class="tactic">intros</span>; <span class="id">jauto_set_hyps</span>; 
  <span class="tactic">intros</span>; <span class="id">jauto_set_goal</span>;
  <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span> <span class="kwd">in</span> *.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">jauto</span>" :=
  <span class="tactic">try</span> <span class="id">solve</span> [ <span class="id">jauto_set</span>; <span class="tactic">eauto</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">jauto_fast</span>" :=
  <span class="tactic">try</span> <span class="id">solve</span> [ <span class="tactic">auto</span> | <span class="tactic">eauto</span> | <span class="id">jauto</span> ].

(** [<span class="id">iauto</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">shorthand</span> <span class="kwd">for</span> [<span class="tactic">intuition</span> <span class="tactic">eauto</span>] *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iauto</span>" := <span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">intuition</span> <span class="tactic">eauto</span>].


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Definitions</span> <span class="id">of</span> <span class="id">automation</span> <span class="id">tactics</span> *)

(** <span class="id">The</span> <span class="id">two</span> <span class="id">following</span> <span class="id">tactics</span> <span class="id">defined</span> <span class="id">the</span> <span class="id">default</span> <span class="id">behaviour</span> <span class="id">of</span> 
    "<span class="id">light</span> <span class="id">automation</span>" <span class="id">and</span> "<span class="id">strong</span> <span class="id">automation</span>". <span class="id">These</span> <span class="id">tactics</span>
    <span class="id">may</span> <span class="id">be</span> <span class="id">redefined</span> <span class="tactic">at</span> <span class="id">any</span> <span class="id">time</span> <span class="kwd">using</span> <span class="id">the</span> <span class="id">syntax</span> [<span class="kwd">Ltac</span> .. ::= ..]. *)

(** [<span class="id">auto_tilde</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">tactic</span> <span class="id">which</span> <span class="id">will</span> <span class="id">be</span> <span class="id">called</span> <span class="id">each</span> <span class="id">time</span> <span class="id">a</span> <span class="id">symbol</span>
    [~] <span class="id">is</span> <span class="id">used</span> <span class="id">after</span> <span class="id">a</span> <span class="id">tactic</span>. *)

<span class="kwd">Ltac</span> <span class="id">auto_tilde_default</span> := <span class="tactic">auto</span>.
<span class="kwd">Ltac</span> <span class="id">auto_tilde</span> := <span class="id">auto_tilde_default</span>.

(** [<span class="id">auto_star</span>] <span class="id">is</span> <span class="id">the</span> <span class="id">tactic</span> <span class="id">which</span> <span class="id">will</span> <span class="id">be</span> <span class="id">called</span> <span class="id">each</span> <span class="id">time</span> <span class="id">a</span> <span class="id">symbol</span>
    [*] <span class="id">is</span> <span class="id">used</span> <span class="id">after</span> <span class="id">a</span> <span class="id">tactic</span>. *)

<span class="kwd">Ltac</span> <span class="id">auto_star_default</span> := <span class="tactic">try</span> <span class="id">solve</span> [ <span class="tactic">auto</span> | <span class="tactic">eauto</span> | <span class="tactic">intuition</span> <span class="tactic">eauto</span> ].
  (* <span class="id">TODO</span>: <span class="id">should</span> <span class="id">be</span> <span class="id">jauto</span> *)
<span class="kwd">Ltac</span> <span class="id">auto_star</span> := <span class="id">auto_star_default</span>.

(** [<span class="tactic">auto</span>~] <span class="id">is</span> <span class="id">a</span> <span class="id">notation</span> <span class="kwd">for</span> <span class="id">tactic</span> [<span class="id">auto_tilde</span>]. <span class="id">It</span> <span class="id">may</span> <span class="id">be</span> <span class="id">followed</span>
    <span class="tactic">by</span> <span class="id">lemmas</span> (<span class="id">or</span> <span class="id">proofs</span> <span class="id">terms</span>) <span class="id">which</span> <span class="tactic">auto</span> <span class="id">will</span> <span class="id">be</span> <span class="id">able</span> <span class="id">to</span> <span class="id">use</span>
    <span class="kwd">for</span> <span class="id">solving</span> <span class="id">the</span> <span class="id">goal</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "~" :=
  <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "~" <span class="id">constr</span>(<span class="id">E1</span>) :=
  <span class="id">lets</span>: <span class="id">E1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "~" <span class="id">constr</span>(<span class="id">E1</span>) <span class="id">constr</span>(<span class="id">E2</span>) :=
  <span class="id">lets</span>: <span class="id">E1</span>; <span class="id">lets</span>: <span class="id">E2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "~" <span class="id">constr</span>(<span class="id">E1</span>) <span class="id">constr</span>(<span class="id">E2</span>) <span class="id">constr</span>(<span class="id">E3</span>) :=
  <span class="id">lets</span>: <span class="id">E1</span>; <span class="id">lets</span>: <span class="id">E2</span>; <span class="id">lets</span>: <span class="id">E3</span>; <span class="id">auto_tilde</span>.

(** [<span class="tactic">auto</span>*] <span class="id">is</span> <span class="id">a</span> <span class="id">notation</span> <span class="kwd">for</span> <span class="id">tactic</span> [<span class="id">auto_star</span>]. <span class="id">It</span> <span class="id">may</span> <span class="id">be</span> <span class="id">followed</span>
    <span class="tactic">by</span> <span class="id">lemmas</span> (<span class="id">or</span> <span class="id">proofs</span> <span class="id">terms</span>) <span class="id">which</span> <span class="tactic">auto</span> <span class="id">will</span> <span class="id">be</span> <span class="id">able</span> <span class="id">to</span> <span class="id">use</span>
    <span class="kwd">for</span> <span class="id">solving</span> <span class="id">the</span> <span class="id">goal</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "*" :=
  <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "*" <span class="id">constr</span>(<span class="id">E1</span>) :=
  <span class="id">lets</span>: <span class="id">E1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "*" <span class="id">constr</span>(<span class="id">E1</span>) <span class="id">constr</span>(<span class="id">E2</span>) :=
  <span class="id">lets</span>: <span class="id">E1</span>; <span class="id">lets</span>: <span class="id">E2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">auto</span>" "*" <span class="id">constr</span>(<span class="id">E1</span>) <span class="id">constr</span>(<span class="id">E2</span>) <span class="id">constr</span>(<span class="id">E3</span>) :=
  <span class="id">lets</span>: <span class="id">E1</span>; <span class="id">lets</span>: <span class="id">E2</span>; <span class="id">lets</span>: <span class="id">E3</span>; <span class="id">auto_star</span>.

(** [<span class="id">auto_false</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">version</span> <span class="id">of</span> [<span class="tactic">auto</span>] <span class="id">able</span> <span class="id">to</span> <span class="id">spot</span> <span class="id">some</span> <span class="id">contradictions</span>.
    [<span class="id">auto_false</span>~] <span class="id">and</span> [<span class="id">auto_false</span>*] <span class="id">are</span> <span class="id">also</span> <span class="id">available</span>. *)

<span class="kwd">Ltac</span> <span class="id">auto_false_base</span> <span class="id">cont</span> := 
  <span class="tactic">try</span> <span class="id">solve</span> [ <span class="id">cont</span> <span class="id">tt</span> | <span class="id">tryfalse</span> <span class="tactic">by</span> <span class="tactic">congruence</span>/ 
            | <span class="tactic">try</span> <span class="tactic">split</span>; <span class="id">intros_all</span>; <span class="id">tryfalse</span> <span class="tactic">by</span> <span class="tactic">congruence</span>/ ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">auto_false</span>" :=
   <span class="id">auto_false_base</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">tt</span> =&gt; <span class="tactic">auto</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">auto_false</span>" "~" :=
   <span class="id">auto_false_base</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">tt</span> =&gt; <span class="tactic">auto</span>~).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">auto_false</span>" "*" :=
   <span class="id">auto_false_base</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">tt</span> =&gt; <span class="tactic">auto</span>*).


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Definitions</span> <span class="kwd">for</span> <span class="id">parsing</span> <span class="id">compatibility</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">f_equal</span>" :=
  <span class="tactic">f_equal</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">constructor</span>" := 
  <span class="id">constructor</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simple</span>" :=
  <span class="tactic">simpl</span>.

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Parsing</span> <span class="kwd">for</span> <span class="id">light</span> <span class="id">automation</span> *)

(** <span class="id">Any</span> <span class="id">tactic</span> <span class="id">followed</span> <span class="tactic">by</span> <span class="id">the</span> <span class="id">symbol</span> [~] <span class="id">will</span> <span class="id">have</span> [<span class="id">auto_tilde</span>] <span class="id">called</span>
    <span class="id">on</span> <span class="id">all</span> <span class="id">of</span> <span class="id">its</span> <span class="id">subgoals</span>. <span class="id">Three</span> <span class="id">exceptions</span>:
    - [<span class="id">cuts</span>] <span class="id">and</span> [<span class="id">asserts</span>] <span class="id">only</span> <span class="id">call</span> [<span class="tactic">auto</span>] <span class="id">on</span> <span class="id">their</span> <span class="id">first</span> <span class="kwd">subgoal</span>,
    - [<span class="tactic">apply</span>~] <span class="id">relies</span> <span class="id">on</span> [<span class="id">sapply</span>] <span class="id">rather</span> <span class="id">than</span> [<span class="tactic">apply</span>],
    - [<span class="id">tryfalse</span>~] <span class="id">is</span> <span class="id">defined</span> <span class="kwd">as</span> [<span class="id">tryfalse</span> <span class="tactic">by</span> <span class="id">auto_tilde</span>].

   <span class="id">Some</span> <span class="id">builtin</span> <span class="id">tactics</span> <span class="id">are</span> <span class="id">not</span> <span class="id">defined</span> <span class="kwd">using</span> <span class="id">tactic</span> <span class="id">notations</span> 
   <span class="id">and</span> <span class="id">thus</span> <span class="id">cannot</span> <span class="id">be</span> <span class="id">extended</span>, <span class="id">e.g</span>. [<span class="tactic">simpl</span>] <span class="id">and</span> [<span class="tactic">unfold</span>].
   <span class="id">For</span> <span class="id">these</span>, <span class="id">notation</span> <span class="id">such</span> <span class="kwd">as</span> [<span class="tactic">simpl</span>~] <span class="id">will</span> <span class="id">not</span> <span class="id">be</span> <span class="id">available</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
   <span class="id">equates</span> <span class="id">E</span>; <span class="tactic">auto</span>~.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "~" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) :=
  <span class="id">equates</span> <span class="id">n1</span> <span class="id">n2</span>; <span class="tactic">auto</span>~.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "~" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) :=
  <span class="id">equates</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span>; <span class="tactic">auto</span>~.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "~" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) <span class="id">constr</span>(<span class="id">n4</span>) :=
  <span class="id">equates</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">n4</span>; <span class="tactic">auto</span>~.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">n1</span> <span class="id">n2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) <span class="id">constr</span>(<span class="id">n4</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">n4</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">apply</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="id">sapply</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">split</span>" := <span class="tactic">split</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">right</span>" := <span class="id">right</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">left</span>" := <span class="id">left</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">destruct</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">destruct</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) :=
  <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">f_equal</span>" "~" :=
  <span class="tactic">f_equal</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">induction</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="tactic">induction</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">inversion</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="tactic">inversion</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">split</span>" "~" :=
  <span class="tactic">split</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">subst</span>" "~" :=
  <span class="tactic">subst</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">right</span>" "~" := 
  <span class="id">right</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">left</span>" "~" := 
  <span class="id">left</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">constructor</span>" "~" := 
  <span class="id">constructor</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">constructors</span>" "~" := 
  <span class="id">constructors</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" "~" :=
  <span class="id">false</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" "~" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">false</span> <span class="id">T</span> <span class="tactic">by</span> <span class="id">auto_tilde</span>/.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse</span>" "~" :=
  <span class="id">tryfalse</span> <span class="tactic">by</span> <span class="id">auto_tilde</span>/.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse_invert</span>" "~" :=
  <span class="id">first</span> [ <span class="id">tryfalse</span>~ | <span class="id">false_invert</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">H</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts</span> <span class="id">H</span>: <span class="id">E</span>; [ <span class="id">auto_tilde</span> | <span class="id">idtac</span> ].
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">H</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts</span> <span class="id">H</span>: <span class="id">E</span>; [ <span class="id">auto_tilde</span> | <span class="id">idtac</span> ].
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" "~" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts</span>: <span class="id">E</span>; [ <span class="id">auto_tilde</span> | <span class="id">idtac</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">lets</span>: <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E</span>; <span class="id">auto_tilde</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" ":" <span class="id">constr</span>(<span class="id">E</span>) :=  
  <span class="id">forwards</span>: <span class="id">E</span>; <span class="id">auto_tilde</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "~" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="id">sapply</span> <span class="id">H</span>; <span class="id">auto_tilde</span>. (*<span class="id">todo</span>?*)
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "~" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">specializes</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapply</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">fapply</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sapply</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">sapply</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">logic</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">logic_base</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">auto_tilde</span>).

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intros_all</span>" "~" :=
  <span class="id">intros_all</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "~" :=
  <span class="id">unfolds</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "~" <span class="id">reference</span>(<span class="id">F1</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "~" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>, <span class="id">F2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "~" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) "," <span class="id">reference</span>(<span class="id">F3</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>, <span class="id">F2</span>, <span class="id">F3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "~" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) "," <span class="id">reference</span>(<span class="id">F3</span>) ","  
 <span class="id">reference</span>(<span class="id">F4</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>, <span class="id">F2</span>, <span class="id">F3</span>, <span class="id">F4</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simple</span>" "~" :=
  <span class="tactic">simpl</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simple</span>" "~" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" "~" :=
  <span class="id">simpls</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hnfs</span>" "~" := 
  <span class="id">hnfs</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">substs</span>" "~" :=
  <span class="id">substs</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intro_hyp</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="id">subst_hyp</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intro_subst</span>" "~" := 
  <span class="id">intro_subst</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">subst_eq</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">subst_eq</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">rewrite</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">rewrite_all</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">rewrite_all</span> &lt;- <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">ident</span>(<span class="id">H</span>) :=
  <span class="id">rewrite_all</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">ident</span>(<span class="id">H</span>) :=
  <span class="id">rewrite_all</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" :=
  <span class="id">rewrite_all</span> <span class="id">E</span> <span class="kwd">in</span> *; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" :=
  <span class="id">rewrite_all</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> *; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts_rewrite</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts_rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">asserts_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">asserts_rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts_rewrite</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts_rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">cuts_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "~" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">cuts_rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequal</span>" "~" :=
  <span class="id">fequal</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequals</span>" "~" :=
  <span class="id">fequals</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">pi_rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">pi_rewrite</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">pi_rewrite</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">pi_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">invert</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">inverts</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">injects</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">injects</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inversions</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">inversions</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="id">cases</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>" "~" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">cases</span> <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "~" :=
  <span class="id">case_if</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "~" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">case_if</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "~" := 
  <span class="id">cases_if</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "~" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="id">cases_if</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "~" :=
  <span class="id">destruct_if</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "~" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">destruct_if</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_head_match</span>" "~" :=
  <span class="id">destruct_head_match</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>'" "~" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="id">cases</span>' <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>'" "~" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">cases</span>' <span class="id">E</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>'" "~" "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="id">cases_if</span>' <span class="kwd">as</span> <span class="id">H</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>'" "~" := 
  <span class="id">cases_if</span>'; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">decides_equality</span>" "~" :=
  <span class="id">decides_equality</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" "~" :=
  <span class="id">iff</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits</span>" "~" :=
  <span class="id">splits</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits</span>" "~" <span class="id">constr</span>(<span class="id">N</span>) := 
  <span class="id">splits</span> <span class="id">N</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits_all</span>" "~" :=
  <span class="id">splits_all</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destructs</span>" "~" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">destructs</span> <span class="id">T</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destructs</span>" "~" <span class="id">constr</span>(<span class="id">N</span>) <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">destructs</span> <span class="id">N</span> <span class="id">T</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branch</span>" "~" <span class="id">constr</span>(<span class="id">N</span>) :=
  <span class="id">branch</span> <span class="id">N</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branch</span>" "~" <span class="id">constr</span>(<span class="id">K</span>) "<span class="id">of</span>" <span class="id">constr</span>(<span class="id">N</span>) :=
  <span class="id">branch</span> <span class="id">K</span> <span class="id">of</span> <span class="id">N</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branches</span>" "~" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">branches</span> <span class="id">T</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branches</span>" "~" <span class="id">constr</span>(<span class="id">N</span>) <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">branches</span> <span class="id">N</span> <span class="id">T</span>; <span class="id">auto_tilde</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists___</span>" "~" :=
  <span class="id">exists___</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "~" <span class="id">constr</span>(<span class="id">T1</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "~" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "~" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "~" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span> <span class="id">T4</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "~" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) 
 <span class="id">constr</span>(<span class="id">T5</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span> <span class="id">T4</span> <span class="id">T5</span>; <span class="id">auto_tilde</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "~" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) 
 <span class="id">constr</span>(<span class="id">T5</span>) <span class="id">constr</span>(<span class="id">T6</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span> <span class="id">T4</span> <span class="id">T5</span> <span class="id">T6</span>; <span class="id">auto_tilde</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Parsing</span> <span class="kwd">for</span> <span class="id">strong</span> <span class="id">automation</span> *)

(** <span class="id">Any</span> <span class="id">tactic</span> <span class="id">followed</span> <span class="tactic">by</span> <span class="id">the</span> <span class="id">symbol</span> [*] <span class="id">will</span> <span class="id">have</span> [<span class="tactic">auto</span>*] <span class="id">called</span>
    <span class="id">on</span> <span class="id">all</span> <span class="id">of</span> <span class="id">its</span> <span class="id">subgoals</span>. <span class="id">The</span> <span class="id">exceptions</span> <span class="id">to</span> <span class="id">these</span> <span class="id">rules</span> <span class="id">are</span> <span class="id">the</span>
    <span class="id">same</span> <span class="kwd">as</span> <span class="kwd">for</span> <span class="id">light</span> <span class="id">automation</span>. 

    <span class="id">Exception</span>: <span class="id">use</span> [<span class="id">subs</span>*] <span class="id">instead</span> <span class="id">of</span> [<span class="tactic">subst</span>*] <span class="kwd">if</span> <span class="id">you</span> 
    <span class="id">import</span> <span class="id">the</span> <span class="id">library</span> [<span class="id">Coq.Classes.Equivalence</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
   <span class="id">equates</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "*" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) :=
  <span class="id">equates</span> <span class="id">n1</span> <span class="id">n2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "*" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) :=
  <span class="id">equates</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">equates</span>" "*" <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) <span class="id">constr</span>(<span class="id">n4</span>) :=
  <span class="id">equates</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">n4</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">n1</span> <span class="id">n2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys_eq</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">n1</span>) <span class="id">constr</span>(<span class="id">n2</span>) <span class="id">constr</span>(<span class="id">n3</span>) <span class="id">constr</span>(<span class="id">n4</span>) :=
  <span class="id">applys_eq</span> <span class="id">H</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">n4</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">apply</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="id">sapply</span> <span class="id">H</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">destruct</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">destruct</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) "<span class="kwd">as</span>" <span class="id">simple_intropattern</span>(<span class="id">I</span>) :=
  <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> <span class="id">I</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">f_equal</span>" "*" :=
  <span class="tactic">f_equal</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">induction</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="tactic">induction</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">inversion</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="tactic">inversion</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">split</span>" "*" :=
  <span class="tactic">split</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">subs</span>" "*" :=
  <span class="tactic">subst</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">subst</span>" "*" :=
  <span class="tactic">subst</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">right</span>" "*" := 
  <span class="id">right</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">left</span>" "*" := 
  <span class="id">left</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">constructor</span>" "*" := 
  <span class="id">constructor</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">constructors</span>" "*" := 
  <span class="id">constructors</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" "*" :=
  <span class="id">false</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">false</span>" "*" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">false</span> <span class="id">T</span> <span class="tactic">by</span> <span class="id">auto_star</span>/.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse</span>" "*" :=
  <span class="id">tryfalse</span> <span class="tactic">by</span> <span class="id">auto_star</span>/.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">tryfalse_invert</span>" "*" :=
  <span class="id">first</span> [ <span class="id">tryfalse</span>* | <span class="id">false_invert</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">H</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts</span> <span class="id">H</span>: <span class="id">E</span>; [ <span class="id">auto_star</span> | <span class="id">idtac</span> ].
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">H</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts</span> <span class="id">H</span>: <span class="id">E</span>; [ <span class="id">auto_star</span> | <span class="id">idtac</span> ].
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts</span>" "*" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts</span>: <span class="id">E</span>; [ <span class="id">auto_star</span> | <span class="id">idtac</span> ].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">lets</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">lets</span>: <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">lets</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">lets</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E</span>; <span class="id">auto_star</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" <span class="id">simple_intropattern</span>(<span class="id">I</span>) ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">forwards</span> <span class="id">I</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" ":" <span class="id">constr</span>(<span class="id">E</span>) :=  
  <span class="id">forwards</span>: <span class="id">E</span>; <span class="id">auto_star</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">forwards</span>" "*" ":" <span class="id">constr</span>(<span class="id">E0</span>) 
 <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">forwards</span>: <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) :=
  <span class="id">sapply</span> <span class="id">H</span>; <span class="id">auto_star</span>. (*<span class="id">todo</span>?*)
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">applys</span>" "*" <span class="id">constr</span>(<span class="id">E0</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">applys</span> <span class="id">E0</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" "*" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">specializes</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" "~" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">specializes</span>" <span class="id">hyp</span>(<span class="id">H</span>) <span class="id">constr</span>(<span class="id">A1</span>) <span class="id">constr</span>(<span class="id">A2</span>) <span class="id">constr</span>(<span class="id">A3</span>) <span class="id">constr</span>(<span class="id">A4</span>) <span class="id">constr</span>(<span class="id">A5</span>) :=
  <span class="id">specializes</span> <span class="id">H</span> <span class="id">A1</span> <span class="id">A2</span> <span class="id">A3</span> <span class="id">A4</span> <span class="id">A5</span>; <span class="id">auto_star</span>.


<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fapply</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">fapply</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sapply</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">sapply</span> <span class="id">E</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">logic</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">logic_base</span> <span class="id">E</span> <span class="id">ltac</span>:(<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">auto_star</span>).

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intros_all</span>" "*" :=
  <span class="id">intros_all</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "*" :=
  <span class="id">unfolds</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "*" <span class="id">reference</span>(<span class="id">F1</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "*" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>, <span class="id">F2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "*" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) "," <span class="id">reference</span>(<span class="id">F3</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>, <span class="id">F2</span>, <span class="id">F3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">unfolds</span>" "*" <span class="id">reference</span>(<span class="id">F1</span>) "," <span class="id">reference</span>(<span class="id">F2</span>) "," <span class="id">reference</span>(<span class="id">F3</span>) ","  
 <span class="id">reference</span>(<span class="id">F4</span>) :=
  <span class="id">unfolds</span> <span class="id">F1</span>, <span class="id">F2</span>, <span class="id">F3</span>, <span class="id">F4</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simple</span>" "*" :=
  <span class="tactic">simpl</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simple</span>" "*" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">simpls</span>" "*" :=
  <span class="id">simpls</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hnfs</span>" "*" := 
  <span class="id">hnfs</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">substs</span>" "*" :=
  <span class="id">substs</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intro_hyp</span>" "*" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="id">subst_hyp</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">intro_subst</span>" "*" := 
  <span class="id">intro_subst</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">subst_eq</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">subst_eq</span> <span class="id">E</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">rewrite</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="tactic">rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">rewrite</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">rewrite_all</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">rewrite_all</span> &lt;- <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">ident</span>(<span class="id">H</span>) :=
  <span class="id">rewrite_all</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">ident</span>(<span class="id">H</span>) :=
  <span class="id">rewrite_all</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" :=
  <span class="id">rewrite_all</span> <span class="id">E</span> <span class="kwd">in</span> *; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rewrite_all</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" "*" :=
  <span class="id">rewrite_all</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> *; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts_rewrite</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">asserts_rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">asserts_rewrite</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">asserts_rewrite</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">asserts_rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts_rewrite</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">cuts_rewrite</span> &lt;- <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">cuts_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cuts_rewrite</span>" "*" "&lt;-" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">cuts_rewrite</span> &lt;- <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequal</span>" "*" :=
  <span class="id">fequal</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">fequals</span>" "*" :=
  <span class="id">fequals</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">pi_rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">pi_rewrite</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">pi_rewrite</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">pi_rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">invert</span>" "*" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">invert</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inverts</span>" "*" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">inverts</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">injects</span>" "*" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">injects</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">inversions</span>" "*" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">inversions</span> <span class="id">H</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="id">cases</span> <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>" "*" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">cases</span> <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "*" :=
  <span class="id">case_if</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">case_if</span>" "*" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">case_if</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>. 
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "*" := 
  <span class="id">cases_if</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>" "*" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) := 
  <span class="id">cases_if</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
 <span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "*" :=
  <span class="id">destruct_if</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_if</span>" "*" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">destruct_if</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destruct_head_match</span>" "*" :=
  <span class="id">destruct_head_match</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>'" "*" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="id">cases</span>' <span class="id">E</span> <span class="kwd">as</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases</span>'" "*" <span class="id">constr</span>(<span class="id">E</span>) := 
  <span class="id">cases</span>' <span class="id">E</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>'" "*" "<span class="kwd">as</span>" <span class="id">ident</span>(<span class="id">H</span>) := 
  <span class="id">cases_if</span>' <span class="kwd">as</span> <span class="id">H</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">cases_if</span>'" "*" := 
  <span class="id">cases_if</span>'; <span class="id">auto_star</span>.


<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">decides_equality</span>" "*" :=
  <span class="id">decides_equality</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">iff</span>" "*" :=
  <span class="id">iff</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits</span>" "*" :=
  <span class="id">splits</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits</span>" "*" <span class="id">constr</span>(<span class="id">N</span>) := 
  <span class="id">splits</span> <span class="id">N</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">splits_all</span>" "*" :=
  <span class="id">splits_all</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destructs</span>" "*" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">destructs</span> <span class="id">T</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">destructs</span>" "*" <span class="id">constr</span>(<span class="id">N</span>) <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">destructs</span> <span class="id">N</span> <span class="id">T</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branch</span>" "*" <span class="id">constr</span>(<span class="id">N</span>) :=
  <span class="id">branch</span> <span class="id">N</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branch</span>" "*" <span class="id">constr</span>(<span class="id">K</span>) "<span class="id">of</span>" <span class="id">constr</span>(<span class="id">N</span>) :=
  <span class="id">branch</span> <span class="id">K</span> <span class="id">of</span> <span class="id">N</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branches</span>" "*" <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">branches</span> <span class="id">T</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">branches</span>" "*" <span class="id">constr</span>(<span class="id">N</span>) <span class="id">constr</span>(<span class="id">T</span>) :=
  <span class="id">branches</span> <span class="id">N</span> <span class="id">T</span>; <span class="id">auto_star</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists___</span>" "*" :=
  <span class="id">exists___</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "*" <span class="id">constr</span>(<span class="id">T1</span>) :=
  <span class="id">exists</span> <span class="id">T1</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "*" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "*" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "*" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span> <span class="id">T4</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "*" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) 
 <span class="id">constr</span>(<span class="id">T5</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span> <span class="id">T4</span> <span class="id">T5</span>; <span class="id">auto_star</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">exists</span>" "*" <span class="id">constr</span>(<span class="id">T1</span>) <span class="id">constr</span>(<span class="id">T2</span>) <span class="id">constr</span>(<span class="id">T3</span>) <span class="id">constr</span>(<span class="id">T4</span>) 
 <span class="id">constr</span>(<span class="id">T5</span>) <span class="id">constr</span>(<span class="id">T6</span>) :=
  <span class="id">exists</span> <span class="id">T1</span> <span class="id">T2</span> <span class="id">T3</span> <span class="id">T4</span> <span class="id">T5</span> <span class="id">T6</span>; <span class="id">auto_star</span>.



(* ********************************************************************** *)
(** * <span class="id">Tactics</span> <span class="id">to</span> <span class="id">sort</span> <span class="id">out</span> <span class="id">the</span> <span class="id">proof</span> <span class="id">context</span> *)

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Hiding</span> <span class="id">hypotheses</span> *)

(* <span class="id">Implementation</span> *)

<span class="kwd">Definition</span> <span class="id"><a name="ltac_something">ltac_something</a></span> (<span class="id">P</span>:<span class="kwd">Type</span>) (<span class="id">e</span>:<span class="id"><a href="LibTactics.html#P">P</a></span>) := <span class="id"><a href="LibTactics.html#e">e</a></span>.

<span class="kwd">Notation</span> "'<span class="id">Something</span>'" := 
  (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">_</span>).

<span class="kwd">Lemma</span> <span class="id"><a name="ltac_something_eq">ltac_something_eq</a></span> : <span class="kwd">forall</span> (<span class="id">e</span>:<span class="kwd">Type</span>),
  <span class="id"><a href="LibTactics.html#e">e</a></span> = (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id"><a href="LibTactics.html#e">e</a></span>).
<span class="kwd">Proof</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="ltac_something_hide">ltac_something_hide</a></span> : <span class="kwd">forall</span> (<span class="id">e</span>:<span class="kwd">Type</span>),
  <span class="id"><a href="LibTactics.html#e">e</a></span> -&gt; (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id"><a href="LibTactics.html#e">e</a></span>).
<span class="kwd">Proof</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

<span class="kwd">Lemma</span> <span class="id"><a name="ltac_something_show">ltac_something_show</a></span> : <span class="kwd">forall</span> (<span class="id">e</span>:<span class="kwd">Type</span>),
  (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id"><a href="LibTactics.html#e">e</a></span>) -&gt; <span class="id"><a href="LibTactics.html#e">e</a></span>.
<span class="kwd">Proof</span>. <span class="tactic">auto</span>. <span class="kwd">Qed</span>.

(** [<span class="id">hide_def</span> <span class="id">x</span>] <span class="id">and</span> [<span class="id">show_def</span> <span class="id">x</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">hide</span>/<span class="id">show</span> 
    <span class="id">the</span> <span class="id">body</span> <span class="id">of</span> <span class="id">the</span> <span class="id">definition</span> [<span class="id">x</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_def</span>" <span class="id">hyp</span>(<span class="id">x</span>) :=
  <span class="kwd">let</span> <span class="id">x</span>' := <span class="id">constr</span>:(<span class="id">x</span>) <span class="kwd">in</span> 
  <span class="kwd">let</span> <span class="id">T</span> := <span class="id">eval</span> <span class="tactic">unfold</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">x</span>' <span class="kwd">in</span>
  <span class="id">change</span> <span class="id">T</span> <span class="kwd">with</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">T</span>) <span class="kwd">in</span> <span class="id">x</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_def</span>" <span class="id">hyp</span>(<span class="id">x</span>) :=
  <span class="kwd">let</span> <span class="id">x</span>' := <span class="id">constr</span>:(<span class="id">x</span>) <span class="kwd">in</span> 
  <span class="kwd">let</span> <span class="id">U</span> := <span class="id">eval</span> <span class="tactic">unfold</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">x</span>' <span class="kwd">in</span>
  <span class="kwd">match</span> <span class="id">U</span> <span class="kwd">with</span> @<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> ?<span class="id">T</span> =&gt;
    <span class="id">change</span> <span class="id">U</span> <span class="kwd">with</span> <span class="id">T</span> <span class="kwd">in</span> <span class="id">x</span> <span class="kwd">end</span>.

(** [<span class="id">show_def</span>] <span class="id">unfolds</span> [<span class="id">Something</span>] <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_def</span>" :=
  <span class="tactic">unfold</span> <span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span>. 

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_def</span>" "<span class="kwd">in</span>" "*" :=
  <span class="tactic">unfold</span> <span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="kwd">in</span> *. 

(** [<span class="id">hide_defs</span>] <span class="id">and</span> [<span class="id">show_defs</span>] <span class="id">applies</span> <span class="id">to</span> <span class="id">all</span> <span class="id">definitions</span> *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_defs</span>" :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span> := ?<span class="id">T</span> |- <span class="id">_</span> =&gt;
    <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span>
    | @<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="tactic">fail</span> 1
    | <span class="id">_</span> =&gt; <span class="id">change</span> <span class="id">T</span> <span class="kwd">with</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">T</span>) <span class="kwd">in</span> <span class="id">H</span> 
    <span class="kwd">end</span>
  <span class="kwd">end</span>. 

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_defs</span>" :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span> := (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> ?<span class="id">T</span>) |- <span class="id">_</span> =&gt;
    <span class="id">change</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">T</span>) <span class="kwd">with</span> <span class="id">T</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">end</span>.


(** [<span class="id">hide_hyp</span> <span class="id">H</span>] <span class="id">replaces</span> <span class="id">the</span> <span class="id">type</span> <span class="id">of</span> [<span class="id">H</span>] <span class="kwd">with</span> <span class="id">the</span> <span class="id">notation</span> [<span class="id">Something</span>] 
    <span class="id">and</span> [<span class="id">show_hyp</span> <span class="id">H</span>] <span class="id">reveals</span> <span class="id">the</span> <span class="id">type</span> <span class="id">of</span> <span class="id">the</span> <span class="id">hypothesis</span>. <span class="id">Note</span> <span class="id">that</span> <span class="id">the</span>
    <span class="id">hidden</span> <span class="id">type</span> <span class="id">of</span> [<span class="id">H</span>] <span class="id">remains</span> <span class="id">convertible</span> <span class="id">the</span> <span class="id">real</span> <span class="id">type</span> <span class="id">of</span> [<span class="id">H</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_hyp</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">apply</span> <span class="id"><a href="LibTactics.html#ltac_something_show">ltac_something_show</a></span> <span class="kwd">in</span> <span class="id">H</span>. 

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_hyp</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">apply</span> <span class="id"><a href="LibTactics.html#ltac_something_hide">ltac_something_hide</a></span> <span class="kwd">in</span> <span class="id">H</span>. 

(** [<span class="id">hide_hyps</span>] <span class="id">and</span> [<span class="id">show_hyps</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">hide</span>/<span class="id">show</span> <span class="id">all</span> <span class="id">hypotheses</span>
    <span class="id">of</span> <span class="id">type</span> [<span class="kwd">Prop</span>]. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_hyps</span>" :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span>
    <span class="id">H</span>: @<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="id">show_hyp</span> <span class="id">H</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_hyps</span>" :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt;
    <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">T</span> <span class="kwd">with</span> 
    | <span class="kwd">Prop</span> =&gt; 
      <span class="kwd">match</span> <span class="id">T</span> <span class="kwd">with</span> 
      | @<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="tactic">fail</span> 2
      | <span class="id">_</span> =&gt; <span class="id">hide_hyp</span> <span class="id">H</span>
      <span class="kwd">end</span>
    | <span class="id">_</span> =&gt; <span class="tactic">fail</span> 1
    <span class="kwd">end</span>
  <span class="kwd">end</span>.

(** [<span class="id">hide</span> <span class="id">H</span>] <span class="id">and</span> [<span class="id">show</span> <span class="id">H</span>] <span class="id">automatically</span> <span class="id">select</span> <span class="id">between</span> 
    [<span class="id">hide_hyp</span>] <span class="id">or</span> [<span class="id">hide_def</span>], <span class="id">and</span> [<span class="id">show_hyp</span>] <span class="id">or</span> [<span class="id">show_def</span>].
    <span class="id">Similarly</span> [<span class="id">hide_all</span>] <span class="id">and</span> [<span class="id">show_all</span>] <span class="tactic">apply</span> <span class="id">to</span> <span class="id">all</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">first</span> [<span class="id">hide_def</span> <span class="id">H</span> | <span class="id">hide_hyp</span> <span class="id">H</span>].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">first</span> [<span class="id">show_def</span> <span class="id">H</span> | <span class="id">show_hyp</span> <span class="id">H</span>].

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_all</span>" :=
  <span class="id">hide_hyps</span>; <span class="id">hide_defs</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_all</span>" :=
  <span class="tactic">unfold</span> <span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="kwd">in</span> *.

(** [<span class="id">hide_term</span> <span class="id">E</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">hide</span> <span class="id">a</span> <span class="id">term</span> <span class="id">from</span> <span class="id">the</span> <span class="id">goal</span>.
    [<span class="id">show_term</span>] <span class="id">or</span> [<span class="id">show_term</span> <span class="id">E</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">reveal</span> <span class="id">it</span>.
    [<span class="id">hide_term</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">to</span> <span class="id">specify</span> <span class="id">an</span> <span class="id">hypothesis</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_term</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">change</span> <span class="id">E</span> <span class="kwd">with</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">E</span>).
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_term</span>" <span class="id">constr</span>(<span class="id">E</span>) :=
  <span class="id">change</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">E</span>) <span class="kwd">with</span> <span class="id">E</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_term</span>" :=
  <span class="tactic">unfold</span> <span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">hide_term</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">change</span> <span class="id">E</span> <span class="kwd">with</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">E</span>) <span class="kwd">in</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_term</span>" <span class="id">constr</span>(<span class="id">E</span>) "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="id">change</span> (@<span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="id">_</span> <span class="id">E</span>) <span class="kwd">with</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">show_term</span>" "<span class="kwd">in</span>" <span class="id">hyp</span>(<span class="id">H</span>) :=
  <span class="tactic">unfold</span> <span class="id"><a href="LibTactics.html#ltac_something">ltac_something</a></span> <span class="kwd">in</span> <span class="id">H</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Sorting</span> <span class="id">hypotheses</span> *)

(** [<span class="id">sort</span>] <span class="id">sorts</span> <span class="id">out</span> <span class="id">hypotheses</span> <span class="id">from</span> <span class="id">the</span> <span class="id">context</span> <span class="tactic">by</span> <span class="id">moving</span> <span class="id">all</span> <span class="id">the</span>
    <span class="id">propositions</span> (<span class="id">hypotheses</span> <span class="id">of</span> <span class="id">type</span> <span class="kwd">Prop</span>) <span class="id">to</span> <span class="id">the</span> <span class="id">bottom</span> <span class="id">of</span> <span class="id">the</span> <span class="id">context</span>. *)

<span class="kwd">Ltac</span> <span class="id">sort_tactic</span> :=
  <span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt;
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">T</span> <span class="kwd">with</span> <span class="kwd">Prop</span> =&gt;
    <span class="id">generalizes</span> <span class="id">H</span>; (<span class="tactic">try</span> <span class="id">sort_tactic</span>); <span class="tactic">intro</span>
  <span class="kwd">end</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">sort</span>" :=
  <span class="id">sort_tactic</span>.


(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Clearing</span> <span class="id">hypotheses</span> *)

(** [<span class="id">clears</span> <span class="id">X1</span> ... <span class="id">XN</span>] <span class="id">is</span> <span class="id">a</span> <span class="id">variation</span> <span class="id">on</span> [<span class="tactic">clear</span>] <span class="id">which</span> <span class="id">clears</span>
    <span class="id">the</span> <span class="id">variables</span> [<span class="id">X1</span>]..[<span class="id">XN</span>] <span class="kwd">as</span> <span class="id">well</span> <span class="kwd">as</span> <span class="id">all</span> <span class="id">the</span> <span class="id">hypotheses</span> <span class="id">which</span>
    <span class="id">depend</span> <span class="id">on</span> <span class="id">them</span>. <span class="id">Contrary</span> <span class="id">to</span> [<span class="tactic">clear</span>], <span class="id">it</span> <span class="id">never</span> <span class="id">fails</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" <span class="id">ident</span>(<span class="id">X1</span>) :=
  <span class="kwd">let</span> <span class="id">rec</span> <span class="id">doit</span> <span class="id">_</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> 
  | <span class="id">H</span>:<span class="id">context</span>[<span class="id">X1</span>] |- <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> (<span class="id">doit</span> <span class="id">tt</span>)
  | <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">X1</span>
  <span class="kwd">end</span> <span class="kwd">in</span> <span class="id">doit</span> <span class="id">tt</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) :=
  <span class="id">clears</span> <span class="id">X1</span>; <span class="id">clears</span> <span class="id">X2</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) :=
  <span class="id">clears</span> <span class="id">X1</span>; <span class="id">clears</span> <span class="id">X2</span>; <span class="tactic">clear</span> <span class="id">X3</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) :=
  <span class="id">clears</span> <span class="id">X1</span>; <span class="id">clears</span> <span class="id">X2</span>; <span class="tactic">clear</span> <span class="id">X3</span>; <span class="tactic">clear</span> <span class="id">X4</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>) 
 <span class="id">ident</span>(<span class="id">X5</span>) :=
  <span class="id">clears</span> <span class="id">X1</span>; <span class="id">clears</span> <span class="id">X2</span>; <span class="tactic">clear</span> <span class="id">X3</span>; <span class="tactic">clear</span> <span class="id">X4</span>; <span class="tactic">clear</span> <span class="id">X5</span>.
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" <span class="id">ident</span>(<span class="id">X1</span>) <span class="id">ident</span>(<span class="id">X2</span>) <span class="id">ident</span>(<span class="id">X3</span>) <span class="id">ident</span>(<span class="id">X4</span>)
 <span class="id">ident</span>(<span class="id">X5</span>) <span class="id">ident</span>(<span class="id">X6</span>) :=
  <span class="id">clears</span> <span class="id">X1</span>; <span class="id">clears</span> <span class="id">X2</span>; <span class="tactic">clear</span> <span class="id">X3</span>; <span class="tactic">clear</span> <span class="id">X4</span>; <span class="tactic">clear</span> <span class="id">X5</span>; <span class="tactic">clear</span> <span class="id">X6</span>.

(** [<span class="id">clears</span>] (<span class="id">without</span> <span class="id">any</span> <span class="id">argument</span>) <span class="id">clears</span> <span class="id">all</span> <span class="id">the</span> <span class="id">unused</span> <span class="id">variables</span>
    <span class="id">from</span> <span class="id">the</span> <span class="id">context</span>. <span class="id">In</span> <span class="id">other</span> <span class="id">words</span>, <span class="id">it</span> <span class="id">removes</span> <span class="id">any</span> <span class="id">variable</span>
    <span class="id">which</span> <span class="id">is</span> <span class="id">not</span> <span class="id">a</span> <span class="id">proposition</span> (<span class="id">i.e</span>. <span class="id">not</span> <span class="id">of</span> <span class="id">type</span> <span class="kwd">Prop</span>) <span class="id">and</span> <span class="id">which</span> 
    <span class="id">does</span> <span class="id">not</span> <span class="id">appear</span> <span class="kwd">in</span> <span class="id">another</span> <span class="id">hypothesis</span> <span class="id">nor</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>. *)

<span class="kwd">Ltac</span> <span class="id">clears_tactic</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt;
  <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">T</span> <span class="kwd">with</span> 
  | <span class="kwd">Prop</span> =&gt; <span class="id">generalizes</span> <span class="id">H</span>; (<span class="tactic">try</span> <span class="id">clears_tactic</span>); <span class="tactic">intro</span>
  | ?<span class="id">TT</span> =&gt; <span class="tactic">clear</span> <span class="id">H</span>; (<span class="tactic">try</span> <span class="id">clears_tactic</span>)
  | ?<span class="id">TT</span> =&gt; <span class="id">generalizes</span> <span class="id">H</span>; (<span class="tactic">try</span> <span class="id">clears_tactic</span>); <span class="tactic">intro</span>
  <span class="kwd">end</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears</span>" :=
  <span class="id">clears_tactic</span>.

(** [<span class="id">clears_all</span>] <span class="id">clears</span> <span class="id">all</span> <span class="id">the</span> <span class="id">hypotheses</span> <span class="id">from</span> <span class="id">the</span> <span class="id">context</span>
    <span class="id">that</span> <span class="id">can</span> <span class="id">be</span> <span class="id">cleared</span>. <span class="id">It</span> <span class="id">leaves</span> <span class="id">only</span> <span class="id">the</span> <span class="id">hypotheses</span> <span class="id">that</span> 
    <span class="id">are</span> <span class="id">mentioned</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">goal</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears_all</span>" :=
  <span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">H</span> <span class="kwd">end</span>.

(** [<span class="id">clears_last</span>] <span class="id">clears</span> <span class="id">the</span> <span class="id">last</span> <span class="id">hypothesis</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span>.
    [<span class="id">clears_last</span> <span class="id">N</span>] <span class="id">clears</span> <span class="id">the</span> <span class="id">last</span> [<span class="id">N</span>] <span class="id">hypotheses</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">context</span>. *)

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears_last</span>" := 
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <span class="id">H</span>: ?<span class="id">T</span> |- <span class="id">_</span> =&gt; <span class="tactic">clear</span> <span class="id">H</span> <span class="kwd">end</span>.

<span class="kwd">Ltac</span> <span class="id">clears_last_base</span> <span class="id">N</span> :=
  <span class="kwd">match</span> <span class="id">nat_from_number</span> <span class="id">N</span> <span class="kwd">with</span>
  | 0 =&gt; <span class="id">idtac</span>
  | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> ?<span class="id">p</span> =&gt; <span class="id">clears_last</span>; <span class="id">clears_last_base</span> <span class="id">p</span>
  <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">clears_last</span>" <span class="id">constr</span>(<span class="id">N</span>) := 
  <span class="id">clears_last_base</span> <span class="id">N</span>.


(* ********************************************************************** *)
(** * <span class="id">Tactics</span> <span class="kwd">for</span> <span class="id">development</span> <span class="id">purposes</span> *)

(* ---------------------------------------------------------------------- *)
(** ** <span class="id">Skipping</span> <span class="id">subgoals</span> *)

<span class="kwd">Ltac</span> <span class="id">skip_with_existential</span> :=
  <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- ?<span class="id">G</span> =&gt; 
    <span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span> <span class="id">evar</span>(<span class="id">H</span>:<span class="id">G</span>); <span class="id">eexact</span> <span class="id">H</span> <span class="kwd">end</span>.

<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">skip</span>'" := 
   <span class="id">skip_with_existential</span>. 

(** [<span class="id">skip</span> <span class="id">H</span>: <span class="id">T</span>] <span class="id">adds</span> <span class="id">an</span> <span class="tactic">assumption</span> <span class="id">named</span> [<span class="id">H</span>] <span class="id">of</span> <span class="id">type</span> [<span class="id">T</span>] <span class="id">to</span> <span class="id">the</span> 
    <span class="id">current</span> <span class="id">context</span>, <span class="id">blindly</span> <span class="id">assuming</span> <span class="id">that</span> <span class="id">it</span> <span class="id">is</span> <span class="id">true</span>.
    [<span class="id">skip</span>: <span class="id">T</span>] <span class="id">and</span> [<span class="id">skip</span> <span class="id">H_asserts</span>: <span class="id">T</span>] <span class="id">and</span> [<span class="id">skip_asserts</span>: <span class="id">T</span>] 
    <span class="id">are</span> <span class="id">other</span> <span class="id">possible</span> <span class="id">syntax</span>. 
    <span class="id">Note</span> <span class="id">that</span> <span class="id">H</span> <span class="id">may</span> <span class="id">be</span> <span class="id">an</span> <span class="tactic">intro</span> <span class="tactic">pattern</span>. 
    <span class="id">The</span> <span class="id">syntax</span> [<span class="id">skip</span> <span class="id">H1</span> .. <span class="id">HN</span>: <span class="id">T</span>] <span class="id">can</span> <span class="id">be</span> <span class="id">used</span> <span class="id">when</span> [<span class="id">T</span>] <span class="id">is</span> <span class="id">a</span> 
    <span class="id">conjunction</span> <span class="id">of</span> [<span class="id">N</span>] <span class="id">items</span>. *)

(* ********************************************************************** *)
(** * <span class="id">Compatibility</span> <span class="kwd">with</span> <span class="id">standard</span> <span class="id">library</span> *)

(** <span class="id">The</span> <span class="id">module</span> [<span class="kwd">Program</span>] <span class="id">contains</span> <span class="id">definitions</span> <span class="id">that</span> <span class="id">conflict</span> <span class="kwd">with</span> <span class="id">the</span>
    <span class="id">current</span> <span class="id">module</span>. <span class="id">If</span> <span class="id">you</span> <span class="id">import</span> [<span class="kwd">Program</span>], <span class="id">either</span> <span class="id">directly</span> <span class="id">or</span> <span class="id">indirectly</span>
    (<span class="id">e.g</span>. <span class="id">through</span> [<span class="id">Setoid</span>] <span class="id">or</span> [<span class="id">ZArith</span>]), <span class="id">you</span> <span class="id">will</span> <span class="id">need</span> <span class="id">to</span> <span class="id">import</span> <span class="id">the</span>
    <span class="id">compability</span> <span class="id">definitions</span> <span class="id">through</span> <span class="id">the</span> <span class="id">top</span>-<span class="id">level</span> <span class="id">command</span>:
    [<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">LibTacticsCompatibility</span>]. *)

<span class="kwd">Module</span> <span class="id"><a name="LibTacticsCompatibility">LibTacticsCompatibility</a></span>.
  <span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">apply</span>" "*" <span class="id">constr</span>(<span class="id">H</span>) :=
    <span class="id">sapply</span> <span class="id">H</span>; <span class="id">auto_star</span>.
  <span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="tactic">subst</span>" "*" :=
    <span class="tactic">subst</span>; <span class="id">auto_star</span>.
<span class="kwd">End</span> <span class="id"><a href="LibTactics.html#LibTacticsCompatibility">LibTacticsCompatibility</a></span>.

<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">nat_scope</span>.  
</span></div>
</div>
<div class="footer"><hr/>Generated by coq2html</div>
</body>
</html>
